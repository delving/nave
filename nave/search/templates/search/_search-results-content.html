{% load i18n staticfiles leaflet_tags urls_tags %}

{# HIDDEN FORM USED FOR QUERY/FACET TAG FUNCTIONALITY #}
<form class="hidden" name="form-query-fields" id="form-query-fields" aria-hidden="true">
    {# todo: change to include instead of exclude for better querystring garbage control #}
    {% form_hidden_fields request exclude="page,view,rows" %}
</form>


{# QUERY/FACET TAGS #}
{% block query-tags %}
    {% if request.REQUEST.q or request.REQUEST.qf %}
    <div class="query-tags">
        <div class="input-group">
            <div class="form-control" id="qtags"></div>
            <span class="input-group-btn">
                <button type="button" class="btn hidden" id="btn-clear-simple-search">
                    <i class="fa fa-times"></i>
                </button>
            </span>
        </div>
    </div>
    {% endif %}
{% endblock %}

{% block query-info %}
    <div class="sr-content query-info">
        <span class="count">{{ data.user_query.num_found}}</span> {% trans 'results' %}
    </div>
{% endblock %}

{# PAGINATION, PAGER, VIEW SWITCHER #}
{% block result-tools %}
    <div class="result-tools">
        {% if data.pagination.has_next or data.pagination.has_previous %}
            {% if not view == 'geo' %}
                {% if not pagination_top == False %}
                    {% include 'search/include/pagination.html' %}
                {% endif %}
                {% if not page_jump == False %}
                    {% include 'search/include/page-jump.html' %}
                {% endif %}
            {% endif %}
        {% endif %}
        {% include 'search/include/switch-view.html' with list_view=list_view %}
</div>
{% endblock %}

{% block results %}
    <div class="row results-container">
        {# SEARCH RESULTS #}
        <div class="{% if facets_layout == 'horizontal' %}col-sm-12{% else %}col-sm-9{% endif %}">
            {% if view == 'grid' %}
                {% include 'search/include/grid.html' with facets_layout=facets_layout grid_class=grid_class %}
            {% elif view == 'list' %}
                {% include 'search/include/list.html' %}
            {% elif view == 'geo' %}
                {% include 'search/include/geo.html' %}
            {% endif %}
        </div>
        {% if facets_layout == 'horizontal' %}
        {# HORIZONTAL FACETS #}
        <div class="col-sm-3">
            {% include 'search/include/facets_horizontal.html' %}
        </div>
        {% endif %}
    </div>
{% endblock %}

{# BOTTOM PAGINATION #}
{% block pagination-bottom %}
    {% if data.pagination.has_next or data.pagination.has_previous %}
        {% if not view == 'geo' %}
            {% include 'search/include/pagination.html' %}
        {% endif %}
    {% endif %}
{% endblock %}


{# remove if's to see what it looks like #}
{% if lod_facets %}
    <nav id="lod-facets-panel" class="side-panel right">
        <a href="#" id="show-side-panel-right" rel="tooltip" title="LOD Facets"><i class="lod-facets-link fa fa-link"></i></a>
        <div class="side-panel-inner">
            <div class="facets">
                {% for facet in data.facet_list %}
                    {% if facet.facet_link %}
                        <div class="facet-container" id="{{ facet.facet_link.name }}">
                            <div class="facet-header">
                                {{ facet.label }}
                                <span class="facet-tools">
                                    <a href="#" class="sort sort-alpha" data-sort-type="value" data-id="{{ facet.facet_link.name }}" data-text-ascending="A-Z" data-text-descending="Z-A"><i class="fa fa-sort"></i> <span>A-Z</span></a>
                                    <a href="#" class="sort sort-numeric" data-sort-type="count" data-id="{{ facet.facet_link.name }}" data-text-ascending="0-9" data-text-descending="9-0"><i class="fa fa-sort"></i> <span>0-9</span></a>
                                </span>
                            </div>
                            <div class="facet-body">
                                <ul class="list-unstyled list-facets">
                                    {% for term in facet.facet_link.links %}
                                        <li data-value="{{ term.value  }}" data-count="{{ term.count }}">
                                            <a href="{{ term.link }}">
                                                <i class="fa fa-fw {% if not term.is_selected %}fa-square-o{% else %}fa-check-square{% endif %}"></i>
                                                {{ term.value }} ({{ term.count }})
                                            </a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </nav>
{% endif %}


{#############################################################}
{# MODAL/LIGHTBOX FOR LINK VALUE DISPLAY                     #}
{#############################################################}

<div class="modal fade" id="lod-data">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">
                    <span class="current-literal">lod literal</span>
                    <small><span class="current-fieldname">lod fieldname</span></small>
                </h4>
            </div>
            <div class="modal-body">

                <div id="linked-data-container">
                    {#############################################################}
                    {# filled via ajax call                                      #}
                    {#############################################################}
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">{% trans 'Close' %}</button>
            </div>
        </div>
    </div>
</div>


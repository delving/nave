/*! Delving Instant - v1.3 - 2017-11-16
* https://github.com/delving/delving-instant
* Copyright (c) 2017 Delving B.V. info@delving.eu; Licensed MIT */
String.prototype.trunc=function(e,t){var n,i=this.length>e;return i?(n=i?this.substr(0,e-1):this,n=t&&i?n.substr(0,n.lastIndexOf(" ")):n,i?n+"&hellip;":n):void 0},function(e){e.DelvingInstant=function(t,n){var a=this;a.$el=e(t),a.el=t,a.$el.data("DelvingInstant",a),e("body").append('<input type="hidden" name="diw-state" id="diw-state" value=""/>'),a.setStatus=function(t){e("#diw-state").attr("value",t).trigger("change")},a.init=function(){for(a.setStatus("DIW_INIT"),a.options=e.extend(!0,e.DelvingInstant.defaultOptions,n),a.version="1.3.1",a.options.useSimpleSearch===!0&&a.showSearchForm(),a.options.useAdvancedSearch===!0&&a.showAdvancedSearchForm(),a.dataProviders="",a.dataOwner="",i=0,i=0;a.options.dataProviders.length>i;i++)a.dataProviders+="&hqf[]=delving_owner_facet:"+encodeURIComponent(n.dataProviders[i]),a.dataOwner+="&dataowner="+encodeURIComponent(n.dataProviders[i]);for(a.collectionSpecs="",i=0;a.options.collectionSpecs.length>i;i++)a.collectionSpecs+="&hqf[]=delving_spec:"+encodeURIComponent(n.collectionSpecs[i]);for(a.customFacetFields="",i=0;a.options.customFacets.length>i;i++)a.customFacetFields+="&facet.field="+encodeURIComponent(a.options.customFacets[i]);if(a.pId="",e.url().param(a.options.pageId)&&(a.pId="&"+a.options.pageId+"="+e.url().param(a.options.pageId)),a.searchIn="",a.options.searchIn.length>0&&(a.searchIn="&searchIn="+a.options.searchIn),a.options.configHelp){var t,r,o,l,s,c,u,d,p='<div id="diw-config-help" class="movable"><h4 class="header">DIW configuration help <small>Click and drag me to re-position</small></h4><p>You have configuration help turned on. Please make sure to set this to "false" for production mode</p><hr/><a class="btn" data-toggle="dropdown" href="#" id="show-help">Show me the good stuff!<span class="caret"></span></a><section id="diw-config-feedback"><div id="errors"></div><div id="resultsJson"></div><div id="resultFields"></div><div id="availableFacets"></div><div id="itemJson"></div><div id="itemFields"></div></section></div>',f=!1;e("body").append(p),e("#diw-config-help .header").on("mousedown",function(e){f=!0,t=e.pageX,r=e.pageY}),e("#diw-config-help").on("mouseup",function(){f=!1}),e("#diw-config-help").on("mouseleave",function(){f=!1}),e("#diw-config-help").on("mousemove",function(n){f&&(o=n.pageX-t,l=n.pageY-r,s=e("#diw-config-help").position().left,c=e("#diw-config-help").position().top,u=o+s,d=l+c,e("#diw-config-help").css({left:u,top:d}),t=n.pageX,r=n.pageY)}),e("#diw-config-help #show-help").on("click",function(){e(this).toggleClass("open").siblings("section").slideToggle("slow")})}},a.changeState=function(t){a.options.configHelp&&e("#diw-config-help #diw-config-feedback > div").html(""),window.history&&window.history.pushState&&a.options.usePushState?History.pushState(null,null,t):document.location.href=t},a.magicLinks=function(){var t=RegExp(a.options.itemId,"g");e(".diw-link").each(function(){var n,i;n=e(this).attr("href")?e(this).attr("href"):e(this).attr("data-href"),n.match(t)?i=decodeURIComponent(n)+a.pId:(i=decodeURIComponent("?query="+n.replace(/\??query=/g,""))+a.pId,e(this).attr("href")?e(this).attr("href",i):e(this).attr("data-href",i)),e(this).on("click",function(e){e.preventDefault(),a.changeState(i)})})},a.showDefaultImg=function(t){var n=new Image;n.src=a.options.defaultImg,n.onload=function(){e(t).attr("src",a.options.defaultImg)}},a.urlTester=function(e){var t=RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return t.test(e)?!0:!1},a.ajaxRequest=function(t,n){e.ajax({type:"GET",url:t,dataType:"jsonp",success:function(e){n(e)},error:function(e){console.log("DIW Error: ",e)},complete:function(){}})},a.showSearchForm=function(){var t="";t='<form action="" method="get" id="diw-search-form" class="form-inline">',a.options.useSearchIn===!0&&(t+='<select id="diw-search-in">',a.options.searchInFields&&a.options.searchInFields.length&&e(a.options.searchInFields).each(function(e,n){t+='<option value="'+n.name+'">'+n.label+"</option>"}),t+="</select>"),t+='<input type="text" name="query" id="diw-query-term" class="form-control" value="" required="true"/>',t+='<input type="submit" id="diw-query-submit" class="btn" value="'+a.options.label.search+'"/>',a.options.useAdvancedSearch===!0&&(t+=' <a href="#" id="diw-as-show">'+a.options.label.advancedSearch+"</a>"),t+="</form>",e(a.options.layout.simpleSearchBlock).html(t),e("#diw-query-term").focus(),e("#diw-search-form").submit(function(){var t=e("#diw-query-term"),n=t.val(),i=e("#diw-search-in").val();return i&&i.length&&(n=i+":"+t.val()),t.val().length>0?a.changeState(decodeURIComponent("?query="+n)):t.addClass("error"),a.options.usePushState===!1&&t.val(n),!1})},a.showAdvancedSearchForm=function(){var t=a.options.layout.advancedSearchBlock,n="";if(e(t).hide(),a.options.useAdvancedSearch===!0){a.options.advancedSearchFields&&a.options.advancedSearchFields.length?(n+='<select name="field" class="searchfield form-control">',e(a.options.advancedSearchFields).each(function(e,t){n+='<option value="'+t.name+'_text">'+t.label+"</option>"})):n+='<select name="field" class="searchfield form-control"><option value="dc_title_text">Titel</option><option value="dc_creator_text">Vervaardiger</option><option value="dc_date_text">Periode</option>',n+="</select>";var i='<div class="diw-as-container"><form method="get" action="#" id="diw-as-form" class="form-inline"><div class="diw-as-row"><select name="bool" class="input-small form-control"><option value="AND">'+a.options.label.boolAnd+"</option>"+'<option value="OR">'+a.options.label.boolOr+"</option>"+'<option value="NOT">'+a.options.label.boolNot+"</option>"+"</select>"+n+'<input type="text" name="query" class="form-control" value=""/>'+"</div>"+'<div class="btn-toolbar">'+'<div class="btn-group"><button id="diw-as-remove-row" class="btn btn-default">-</button><button id="diw-as-add-row" class="btn btn-default">+</button></div>'+'<div class="btn-group"><input type="submit" value="'+a.options.label.search+'" class="btn btn-primary"/></div>'+"</div>"+"</form>"+"</div>";e(i).appendTo(a.options.layout.advancedSearchBlock),e("#diw-as-show").on("click",function(n){n.preventDefault(),e(t).toggle("medium",function(){e(t).is(":visible")?(e("#diw-search-form input").addClass("disabled"),e("#diw-as-show").text(a.options.label.advancedSearchClose)):(e("#diw-search-form input").removeClass("disabled"),e("#diw-as-show").text(a.options.label.advancedSearch))})});var r=e("#diw-as-add-row"),o=e("#diw-as-remove-row"),l=0,s=e(".diw-as-row").clone();r.click(function(t){t.preventDefault(),3>l?(l++,s.clone().insertBefore(e(".btn-toolbar")),o.show()):r.hide()}),o.click(function(t){t.preventDefault(),l>0&&e(this).closest("div.btn-toolbar").prev(".diw-as-row").remove(),l--,0===l&&(o.hide(),r.show())}),e('select[name="bool"]').first().remove(),e("form#diw-as-form").on("submit",function(t){t.preventDefault();var n="";e("select.searchfield").each(function(t){var i="",a="",r="";i=e(this).val(),i.length>0&&(i+=":"),t>0&&(a=" "+e(this).prev('select[name="bool"]').find(":selected").val()+" "),r=e(this).next('input[type="text"]').val(),console.log(r),r.length>0&&(n+=a+i+r),console.log(n)}),a.changeState("?query="+n)})}},a.objectify=function(e,t){var n,i;return"result"===t&&(i=e.result,i===void 0&&(n=jQuery.parseJSON(e),i=n.result)),void 0===t&&(i=e,i===void 0&&(n=jQuery.parseJSON(e),i=n)),i},a.customQuery=function(e,t,n){function i(e){var t=a.objectify(e,"result");n(t)}var r=a.options.endPoint+"/api/search/v1/?"+e+"&format=jsonp&rows="+t+"&diw-version="+a.version;a.ajaxRequest(r,i)},a.getResults=function(t){function n(t){var n=a.objectify(t,"result");if(a.setStatus("DIW_GET_RESULTS"),a.showBreadcrumbs(n),a.options.showQueryInfo===!0&&a.showQueryInfo(n),n&&n.items.length>0?(a.showPagination(n),a.showSearchResults(n),a.options.showFacets===!0&&a.showFacets(n),a.magicLinks()):(e(a.options.layout.resultsBlock).empty(),e(a.options.layout.paginationBlock).empty(),e(a.options.layout.facetsBlock).empty(),e.tmpl("noResultTemplate",null).appendTo(a.options.layout.resultsBlock)),a.options.configHelp){var i='<h5>Available fields</h5> <pre><ul class="">';e.each(n.layout.layout,function(e,t){i+="<li>"+t.name+"</li>"}),i+="</ul></pre>",e("#diw-config-help #resultFields").html(i)}}a.options.endPoint.length&&a.options.orgId.length||alert("You need to configure the Delving Instant with a valid endPoint and orgId"),e(a.options.layout.itemMediaBlock).empty(),e(a.options.layout.itemDataBlock).empty(),e(a.options.layout.itemRelatedBlock).empty();var i,r;if(i=t.replace(/\s&\s|\+&\+/g,"+%26+").replace(/\(/g,"%28").replace(/\)/g,"%29"),r=a.options.endPoint+"/api/search/v1/?"+i,a.customFacetFields&&void 0!==a.customFacetFields&&(r+=a.custormFacetFields),a.dataProviders&&void 0!==a.dataProviders&&(r+=a.dataProviders),a.collectionSpecs&&void 0!==a.collectionSpecs&&(r+=a.collectionSpecs),a.searchIn&&void 0!==a.searchIn&&(r+=a.searchIn),r+="&format=jsonp&facetBoolType=OR&lang="+a.options.language+"&rows="+a.options.rows+"&diw-version="+a.version,console.log(r),a.options.configHelp){var o='<a href="'+r+'" target="_blank" class="badge" title="Opens in new tab">Results JSON source</a>';e("#diw-config-feedback #resultsJson").html(o)}a.ajaxRequest(r,n)},a.showQueryInfo=function(t){e(a.options.layout.queryInfoBlock).empty(),e.tmpl("queryInfoTemplate",t.query).appendTo(a.options.layout.queryInfoBlock),e(a.options.layout.queryInfoBlock+" a").each(function(){var t=e(this).text();e(this).text(t.replace(/.*:/g,""))}),a.showBreadcrumbs(t)},a.showBreadcrumbs=function(t){e(a.options.layout.breadcrumbsBlock).empty(),e.tmpl("breadcrumbsTemplate",t.query).appendTo(a.options.layout.breadcrumbsBlock),e(a.options.layout.breadcrumbsBlock+" a").each(function(){var t=e(this).text();e(this).text(t.replace(/.*:/g,""))})},a.showPagination=function(t){if(t.pagination.links.length>1){var n=t.query.breadCrumbs,i=n.length>1?n[n.length-1].href:t.query.terms;e(a.options.layout.paginationBlock).html(e.tmpl("paginationTemplate",t.pagination,qString=i))}else e(a.options.layout.paginationBlock).empty()},a.showSearchResults=function(t){var n="";n=null!==a.options.alternativeFieldLabelsPerSpecTrigger?a.options.alternativeFieldLabelsPerSpecTrigger:"europeana_collectionName","list"===a.options.resultsLayout?e(a.options.layout.resultsBlock).html(e.tmpl("resultTemplate",{data:t.items,uFields:a.options.resultFields,thumbnailField:a.options.thumbnailField,spec:n})):e(a.options.layout.resultsBlock).html(e.tmpl("gridTemplate",{data:t.items,thumbnailField:a.options.thumbnailField,spec:n})),a.setStatus("DIW_SHOW_RESULTS"),a.options.alternativeFieldLabelsPerSpec&&a.options.alternativeFieldLabelsPerSpec.length&&e(".media").each(function(){var t=e(this).find('input[name="spec"]').attr("value");e.each(e(this).find("label"),function(n,i){e.each(a.options.alternativeFieldLabelsPerSpec,function(n,a){a.spec===t&&e.each(a.fields,function(t,n){e(i).attr("for")===n.name&&e(i).html(n.label)})})})}),e(".diw-title a").each(function(){var t=e(this).text(),n=t.trunc(a.options.maxCharactersTitle,!0);e(this).html(n)}),a.options.textExpander&&e(".diw-data").expander({slicePoint:a.options.maxCharactersResults,expandText:a.options.label.expand,userCollapseText:a.options.label.collapse}),e(".diw-img").on("error",function(){var e=jQuery(this);a.showDefaultImg(e)}),e(document).attr("title",a.options.label.searchResults+": "+t.query.terms+" - "+a.options.dataProviders),e(a.options.layout.resultsBlock).append('<div class="media clearfix"><a style="color:#ccc;padding:2px 4px;font-size:11px;text-decoration: none" href="http://www.delving.eu" target="_blank">Powered by Delving</a></div><br/>')},a.showFacets=function(t){function n(t,n){var i=e("#"+t).find("ul"),r=e.makeArray(i.children("li"));i.hasClass("sorted")?(r.reverse(),i.empty(),e.each(r,function(e,t){i.append(t)}),i.removeClass("sorted")):(r.sort(function(t,i){var a=e(t).data(n),r=e(i).data(n);return r>a?-1:a>r?1:0}),i.empty(),e.each(r,function(e,t){i.append(t)}),i.addClass("sorted")),a.magicLinks()}var i="";a.options.configHelp&&(i="<h5>Available Facets</h5>",i+="<pre><ul>",e.each(t.facets,function(e,t){i+="<li>"+t.name+"</li>"}),i+="</ul></pre><hr/>",e("#diw-config-help #availableFacets").html(i));var r=[];if(e.isEmptyObject(a.options.displayFacets)?r=t.facets:(i="",e.each(a.options.displayFacets,function(n,o){var l=e.grep(t.facets,function(e){try{return e.name===o.name}catch(t){}})[0];try{r.push({label:o.label,name:l.name,isSelected:l.isSelected,links:l.links})}catch(s){if(a.options.configHelp)try{i+='<div class="error">'+o.name+" does not appear to be a facet</div>",e("#diw-config-help #errors").html(i)}catch(c){}}})),e(a.options.layout.facetsBlock).html(e.tmpl("facetTemplate",r,qString=t.query.terms)),a.options.collapseFacets===!0&&e(".diw-facet-container").length>0){var o=e(".diw-facet-container");e.each(o,function(){var t=e(this).find(".header"),n=e(this).find(".inner");e(this).find(".facet-tools");var i=e(this).find(".diw-facet-list"),a=i.find("input:checked");n.hide(),a.length>0&&(n.show(),t.addClass("open")),t.addClass("toggle").on("click",function(){t.toggleClass("open"),n.slideToggle("slow")})})}e(".diw-facet-container .facet-list-container").each(function(){$checked=e(this).find("input:checked"),$checked.length&&e(this).animate({scrollTop:$checked.offset().top-e(this).offset().top-20},1)}),e(".diw-facet-container .sort").on("click",function(t){t.preventDefault();var i=e(this).data("id"),a=e(this).data("sort-type");n(i,a)}),e(".diw-facet-container .inner").each(function(){$checked=e(this).find("input:checked"),$checked.length&&e(this).animate({scrollTop:$checked.offset().top-e(this).offset().top-50},1)})},a.getItem=function(t){function n(t){var n=a.objectify(t,"result"),i=n.item.fields,r={},o=[],l="";if(null!==a.options.alternativeFieldLabelsPerSpecTrigger)try{l=i[a.options.alternativeFieldLabelsPerSpecTrigger][0]}catch(s){l=i[a.options.alternativeFieldLabelsPerSpecTrigger]}else l=i.europeana_collectionName.join();if(a.setStatus("DIW_GET_ITEM"),n){if(e.each(a.options.itemImageFields,function(e,t){r[e]=n.item.fields[t]}),a.options.configHelp)try{var c="<h5>Available Item Fields</h5>";c+="<pre><ul>",e.each(n.layout.fields.field,function(e,t){c+="<li>"+t.name+"</li>"}),c+="</ul></pre>",e("#diw-config-help #itemFields").html(c)}catch(u){}if(e.isEmptyObject(a.options.itemFields)?o=n.layout.fields.field.map(function(e){return{key:e.name,i18n:e.i18n,value:n.item.fields[e.name]}}):e.each(a.options.itemFields,function(e,t){if(i[t.name]){var n=null;t.externalLink&&(n=a.urlTester(i[t.name])),o.push({i18n:t.label,key:t.name,value:i[t.name],newQuery:t.newQuery,externalLink:n,linkText:t.linkText,className:t.className,separator:t.separator})}}),a.options.showRelatedItems===!0)try{var d,p,f=n.relatedItems.item.map(function(t){return p=a.options.thumbnailField,fields=[],d=jQuery.isArray(t.fields[p])?t.fields[p][0]:t.fields[p],e.each(a.options.relatedItemsFields,function(e,n){t.fields[n.name]&&fields.push({i18n:n.label,key:n.name,value:t.fields[n.name],thumbnail:d})}),{hubId:t.fields.delving_hubId,thumbnail:d,title:t.fields[a.options.relatedItemsFields.title],fields:fields}});a.showRelatedItems(f)}catch(h){}a.showItem(o,r,l),a.magicLinks()}else e.tmpl("noResultTemplate",null).appendTo(a.options.layout.resultsBlock)}e(a.options.layout.facetsBlock).empty(),e(a.options.layout.resultsBlock).empty(),e(a.options.layout.paginationBlock).empty();var i=a.options.endPoint+"/api/search/v1/?"+t+"&format=jsonp&lang="+a.options.language+"&diw-version="+a.version;if(a.options.showRelatedItems===!0&&(i=i+"&mlt=true&mlt.count="+a.options.relatedItemsCount),""!==a.options.dataOwner&&(i=i+"&mlt.filterkey=delving_spec:"+a.options.dataOwner),a.options.configHelp){var r='<a href="'+i+'" class="badge" target="_blank" title="Opens in new tab">Item JSON source</a>';e("#diw-config-help #itemJson").html(r)}console.log(i),a.ajaxRequest(i,n)},a.showOriginalContextLink=function(t){a.options.linkToExternalLandingPage===!0&&t&&e.tmpl("externalLandingPageLink",{link:t}).appendTo(a.options.layout.itemMediaBlock)},a.showImageCarousel=function(t){e(a.options.layout.itemMediaBlock).html(e.tmpl("itemCarouselTemplate",{data:t})),a.showOriginalContextLink(t.externalLandingPage),e(".carousel").carousel({interval:!1}),e(".diw-carousel-nav a").on("click",function(t){t.preventDefault();var n=e(this).attr("data-to");e(".carousel").carousel(parseInt(n,10))})},a.switchZoom=function(e,t,n){function i(e){var t=!1,n=document.getElementById(e);return!n||"OBJECT"!==n.nodeName&&"EMBED"!==n.nodeName||(t=!0),t}function r(e){var t=document.getElementById(e);if(t){var n=document.createElement("div");t.parentNode.insertBefore(n,t),swfobject.removeSWF(e),n.setAttribute("id",e)}}var o="diw-zoom-viewer";if(a.options.useFlashZoom===!0&&swfobject.hasFlashPlayerVersion("7")){if(i(o)&&r(o),swfobject.hasFlashPlayerVersion("9")){var l={source:t,image:"/images/logo.png"},s={allowfullscreen:"true",allowscriptaccess:"always",wmode:"transparent"},c={id:"diw-zoom-viewer",name:"diw-zoom-viewer"};swfobject.embedSWF(a.options.deepZoomFlashFile,"diw-zoom-viewer","100%","100%","7","false",l,s,c)}}else t?n.openDzi(t):n.close(),Seadragon.Utils.cancelEvent(e)},a.showDeepZoom=function(t){e(a.options.layout.itemMediaBlock).html(e.tmpl("itemZoomTemplate",{data:t})),a.showOriginalContextLink(t.externalLandingPage),e("#diw-zoom-container").show();var n=e("input[name=diw-zoom-uri]").attr("value"),i=null;if(a.options.useFlashZoom===!0&&swfobject.hasFlashPlayerVersion("7")){var r={source:n,image:"/images/logo.png"},o={allowfullscreen:"true",allowscriptaccess:"always",wmode:"transparent"},l={id:"diw-zoom-viewer",name:"diw-zoom-viewer"};swfobject.embedSWF(a.options.deepZoomFlashFile,"diw-zoom-viewer","100%","100%","7","false",r,o,l)}else Seadragon.Config.imagePath=a.options.deepZoomControlImages,Seadragon.Config.autoHideControls=!1,i=new Seadragon.Viewer("diw-zoom-container"),i.addEventListener("error",function(){i.close(),e("#diw-zoom-container, .diw-carousel-nav, .diw-original-context").css("display","none"),a.showImageCarousel(t)}),i.openDzi(n);e(".diw-zoom-link").on("click",function(n){n.preventDefault(),a.switchZoom(n,e(this).attr("href"),i,t)})},a.showItem=function(t,n,i){a.setStatus("DIW_SHOW_ITEM"),e(a.options.layout.itemDataBlock).html(e.tmpl("itemTemplate",{data:t})),a.options.useDeepZoom===!0&&n.deepZoomUrl&&n.deepZoomUrl.length>0?a.showDeepZoom(n):a.showImageCarousel(n),e("html, body").animate({scrollTop:0},0),e("#diw-query-crumbs").length&&e("#diw-query-crumbs").append("<li>"+e("dd#dc_title").text()+"</li>"),a.options.alternativeFieldLabelsPerSpec&&a.options.alternativeFieldLabelsPerSpec.length&&e("span.diw-label").each(function(t,n){e.each(a.options.alternativeFieldLabelsPerSpec,function(t,a){a.spec===i&&e.each(a.fields,function(t,i){e(n).data("for")===i.name&&e(n).html(i.label)})})}),a.options.textExpander&&e(".diw-data").expander({slicePoint:a.options.maxCharactersItem,expandText:a.options.label.expand,userCollapseText:a.options.label.collapse});var r="Delving Search",o="";if(e.each(t,function(e,t){"dc_title"===t.key&&(r=t.value),"dc_creator"===t.key&&(o=t.value)}),e(document).attr("title",r+" - "+o),null!==e.cookie("diw-return-uri")){var l=e.cookie("diw-return-uri");e(a.options.layout.paginationBlock).html('<ul class="nav nav-pills"><li class="active"><a href="'+l+'" class="diw-b2results">'+a.options.label.returnToSearchResults+"</a></li></ul>"),e(".diw-b2results").click(function(t){t.preventDefault(),e.cookie("diw-return-uri",null),a.changeState(l)})}e(".diw-img").on("error",function(){var e=jQuery(this);a.showDefaultImg(e)}),e(".diw-img").each(function(){0===e(this).attr("src").length&&a.showDefaultImg(e(this))})},a.showRelatedItems=function(t){e(a.options.layout.itemRelatedBlock).html(e.tmpl("relatedItemsTemplate",{data:t})),setTimeout(function(){e("#diw-related-items img").each(function(){var t,n,i;t=e(this)[0].clientWidth,n=e(this)[0].clientHeight,i=n>t?"portrait":"landscape",e(this).addClass(i)})},1e3),e(".diw-title a").each(function(){var t=e(this).text(),n=t.trunc(a.options.maxCharactersTitle,!0);e(this).html(n)})},a.init(),e.template("resultTemplate",'{{each(index) data}}<div class="media">{{if spec}}<input type="hidden" name="spec" value="${item.fields[spec]}"/>{{else}}{{if item.fields["europeana_collectionName"]}}<input type="hidden" name="spec" value="${item.fields["europeana_collectionName"]}"/>{{/if}}{{/if}}<a data-hubId="${item.fields.delving_hubId}" class="pull-left diw-link" href="?'+a.options.itemId+'=${item.fields.delving_hubId}" title="'+a.options.label.goTo+' ${item.fields.delving_title}">'+'{{if item.fields["'+a.options.thumbnailField+'"]}}'+'<img  class="media-object diw-img" src="${item.fields.'+a.options.thumbnailField+'[0]}" alt="${item.fields.delving_title}" width="'+a.options.thumbnailWidth.replace("px","")+'" />'+"{{else}}"+"{{if item.fields.delving_thumbnail}}"+'><img class="media-object diw-img" src="${item.fields.delving_thumbnail[0]}" alt="${item.fields.delving_title}" width="'+a.options.thumbnailWidth.replace("px","")+'"  />'+"{{else}}"+'<img class="media-object diw-img" src="'+a.options.defaultImg+'" alt="${item.fields.delving_title}" width="'+a.options.thumbnailWidth+'" />'+"{{/if}}"+"{{/if}}"+"</a>"+'<div class="media-body">'+"{{each(index, field) uFields}}"+"{{if item.fields[field.name]}}"+'{{if field.label}}<label for="${field.name}">${field.label}:</label> {{/if}}'+'{{if field.name == "dc_title"}}'+'<div class="diw-title media-heading"><a class="diw-link" data-hubId="${item.fields.delving_hubId}" href="?'+a.options.itemId+'=${item.fields.delving_hubId}" title="'+a.options.label.goTo+' ${item.fields.delving_title}">'+'<span class="diw-data" name="${field.name}">${item.fields[field.name]}</span></a></div>'+"{{else}}"+'<span class="diw-data" name="${field.name}">{{html String(item.fields[field.name]).replace(/,/g,", ")}}</span><br/>'+"{{/if}}"+"{{/if}}"+"{{/each}}"+"</div>"+"</div>"+"{{/each}}"),e.template("gridTemplate",'<ul class="thumbnails">{{each data}}<li><div class="thumbnail"><a data-hubId="${item.fields.delving_hubId}" class="img  diw-link" href="?'+a.options.itemId+'=${item.fields.delving_hubId}" class="diw-link diw-2item" title="'+a.options.label.goTo+' ${item.fields.delving_title}"><span>'+"{{if item.fields."+a.options.thumbnailField+"}}"+'<img src="${item.fields.'+a.options.thumbnailField+'[0]}" width="'+a.options.thumbnailWidth.replace("px","")+'" class="diw-img" alt="${item.fields.delving_title}" />'+"{{else}}{{if item.fields.delving_thumbnail}}"+'<img src="${item.fields.delving_thumbnail[0]}" width="'+a.options.thumbnailWidth.replace("px","")+'" class="diw-img" alt="${item.fields.delving_title}" />'+"{{else}}"+'<img src="'+a.options.defaultImg+'" width="'+a.options.thumbnailWidth+'" class="diw-img" alt="${item.fields.delving_title}" />'+"{{/if}}{{/if}}"+"</span></a>"+'<div class="caption">'+'<div class="diw-title"><a href="?'+a.options.itemId+'=${item.fields.delving_hubId}" class="diw-link diw-2item" title="'+a.options.label.goTo+' ${item.fields.delving_title}">${item.fields.delving_title}</a></div>'+"</div>"+"</div></li>"+"{{/each}}"+"</ul>"),e.template("noResultTemplate",'<div class="diw-results-item"><span class="diw-no-results">'+a.options.label.noResults+"</span></div>"),e.template("queryInfoTemplate",'<div id="diw-query-summary"><h2 class="summary">'+a.options.label.numberOfResults+" <span>${numfound}</span></h2>"+"</div>"),e.template("breadcrumbsTemplate",'<ul id="diw-query-crumbs" class="breadcrumb">{{each(i) breadCrumbs}}<li><a href="?${href}" class="diw-link">${value}</a></li>{{/each}}</ul>'),e.template("paginationTemplate",'<div class="pagination"><ul><li {{if !hasPrevious}}class="disabled"{{/if}}><a href="?query=${qString}&page=${previousPageNumber}" class="diw-link prev">'+a.options.label.previous+"</a></li>"+"{{each links}}"+'<li {{if !isLinked}}class="active"{{/if}}><a href="?query=${qString}&page=${pageNumber}" class="diw-link {{if !isLinked}}current{{/if}}">${pageNumber}</a></li>'+"{{/each}}"+'<li {{if !hasNext}}class="disabled"{{/if}}><a href="?query=${qString}&page=${nextPageNumber}" class="diw-link next">'+a.options.label.next+" </a></li>"+"</ul>"+"</div>"),e.template("facetTemplate",'{{if links.length > 0}}<div class="diw-facet-container" id="${name}"><div class="header">${label}<i></i></div><div class="inner">{{if '+a.options.sortFacets+"}}"+'<div class="facet-tools">'+'<a href="" class="sort sort-alpha" data-sort-type="name" data-id="${name}">'+a.options.label.sort+" A-Z</a>"+'<a href="" class="sort sort-numeric" data-sort-type="count" data-id="${name}">'+a.options.label.sort+" 0-9</a>"+"</div>"+"{{/if}}"+'<div class="facet-list-container">'+'<ul class="diw-facet-list">'+"{{each links}}"+'<li data-name="${displayString}" data-count="${count}">'+'<div class="diw-facet-facet">'+"<label>"+'<input type="checkbox" {{if isSelected }}checked="true"{{/if}} class="diw-link" data-href="?query=${qString}${url}"/>'+'<span><a href="?query=${qString}${url}" class="diw-link  {{if isSelected }}active{{/if}}">${displayString}</a></span>'+"</label>"+"</div>"+"</li>"+"{{/each}}"+"</ul>"+"</div>"+"</div>"+"</div>"+"{{/if}}"),e.template("itemTemplate",'<div class="diw-results-item"><div class="bd"><div class="inner"><dl class="diw-field-list dl-horizontal">{{each data}}<dt><span class="diw-label" data-for="${key}">${i18n}</span></dt><dd class="diw-data" id="${key}">{{if newQuery === true}}{{each(i, val) value}}<a href="?query=${val}" class="diw-link ${className}">${val}</a><br/>{{/each}}{{else externalLink === true}}{{each(j, val) value}}{{if linkText && linkText.length}}<a target="_blank" href="${val}" class="external ${className}">${linkText}</a><br/>{{else}}<a target="_blank" href="${val}" class="external ${className}">${val}</a><br/>{{/if}}{{/each}}{{else}}{{if !(separator)}}<span class="${className}">{{html String(value).replace(/,/g,", ")}}</span>{{else}}{{each(k, val) value}}<span class="${className}">{{html String(val)}}</span>{{if separator && separator.length && (k+1 < value.length)}}{{html separator}}{{/if}}{{/each}}{{/if}}{{/if}}</dd>{{/each}}</dl></div></div></div>'),e.template("relatedItemsTemplate",'<div class="related-items"><div class="header">'+a.options.label.relatedItems+"</div>"+'<ul class="thumbnails">'+"{{each data}}"+"<li>"+'<div class="thumbnail">'+'<a href="?'+a.options.itemId+'=${hubId}" class="img">'+'<img src="${thumbnail}" class="diw-img media-object" alt="${title}" width="'+a.options.thumbnailWidth.replace("px","")+'"/>'+"</a>"+'{{if fields.length}}<ul class="related-item-fields">'+"{{each(i, field) fields}}"+'{{if field.key == "dc_title" || field.key == "delving_title"}}'+'<li class="diw-title ${field.key}"><a href="?'+a.options.itemId+'=${hubId}">${field.value}</a></li>'+"{{else}}"+'<li class="${field.key}">{{if field.i18n}}<span class="field-label">{{/if}}${field.i18n}</span><span class="field-value">${field.value}</span></li>'+"{{/if}}"+"{{/each}}"+"</ul>{{/if}}"+"</div>"+"</li>"+"{{/each}}"+"</ul>"+"</div>"),e.template("itemZoomTemplate",'{{if data.deepZoomUrl}}{{each(d, url) data.deepZoomUrl}}<input type="hidden" name="diw-zoom-uri" value="${url}"/>{{/each}}<div id="diw-zoom-container"><div id="diw-zoom-viewer"></div></div>{{each(i, src) data.image}}<div class="hide print-image"><img src="${src}" /></div>{{/each}}{{/if}}{{if data.thumb && data.thumb.length > 1}}<div class="diw-carousel-nav">{{each(t, src) data.thumb}}<a href="${data.deepZoomUrl[t]}" data-to="${t}" class="diw-zoom-link"><img src="${src}" alt="thumb" class="diw-thumb-mini"/></a>{{/each}}</div>{{/if}}'),e.template("itemCarouselTemplate",'<div id="diw-carousel" class="carousel slide"><div class="carousel-inner">{{if data.image && data.image.length}}{{each(i, src) data.image}}<div class="item {{if i === 0}}active{{/if}}"><img src="${src}" style="max-width: 100%;" class="diw-img" /></div>{{/each}}{{else}}{{each(i, srcAlt) data.imageAlt}}<div class="item {{if i === 0}}active{{/if}}"><img src="${srcAlt}" style="max-width: 100%;" class="diw-img" /></div>{{/each}}{{/if}}</div>{{if data.thumb && data.thumb.length > 1}}<a class="carousel-control left" href="#diw-carousel" data-slide="prev">&lsaquo;</a><a class="carousel-control right" href="#diw-carousel" data-slide="next">&rsaquo;</a>{{/if}}</div>{{if data.thumb && data.thumb.length > 1}}<div class="diw-carousel-nav">{{each(t, src) data.thumb}}<a href="#diw-carousel" data-to="${t}"><img src="${src}" alt="thumb" class="diw-thumb-mini"/></a>{{/each}}</div>{{/if}}'),e.template("externalLandingPageLink",'{{if link.length}}<div id="diw-original-context" class="diw-original-context"><a href="${link}" target="_blank">'+a.options.label.viewInOriginalContext+"</a></div>"+"{{/if}}"),e.template("itemNavTemplate",'<a href="#" class="diw-b2results">'+a.options.labelReturn+"</a>"),History.Adapter.bind(window,"statechange",function(){e("body").removeClass("diw-init diw-search diw-search-results diw-detail");var t=e.url(),n=t.attr("query").replace(a.options.itemId,"id").replace("*%3A*","*:*");t.param("query")&&(window.scrollTo(0,0),a.getResults(n.replace(";")),e.cookie("diw-return-uri",t.attr("base")+t.attr("relative"),{path:"/"}),e("body").addClass("diw-search diw-search-results")),t.param(a.options.itemId)&&(e("body").addClass("diw-detail"),a.getItem(n)),n.length||e("body").addClass("diw-init")}),e(window).trigger("statechange")},e.DelvingInstant.defaultOptions={endPoint:"",orgId:"",dataProviders:[],collectionSpecs:[],dataOwner:"",searchIn:"",hasDigitalObject:!1,rows:"12",language:"en",resultsLayout:"list",gridGutterWidth:10,defaultImg:"images/blank.png",queryParam:"query",itemId:"diw-id",pageId:"page_id",activateAddThis:!1,addThisPubId:"",layout:{simpleSearchBlock:"#diw-search",advancedSearchBlock:"#diw-advanced-search",paginationBlock:".diw-pagination",queryInfoBlock:"#diw-query-info",breadcrumbsBlock:"#diw-breadcrumbs",resultsBlock:"#diw-results",facetsBlock:"#diw-sidebar",relatedItemsBlock:"#diw-related",itemMediaBlock:"#diw-item-media",itemDataBlock:"#diw-item-data",itemRelatedBlock:"#diw-item-related"},label:{advancedSearch:"Advanced search",advancedSearchClose:"Close advanced search",collapse:"Less&nbsp;[-]",expand:"More&nbsp;[+]",viewInOriginalContext:"View in original context",goTo:"Go to: ",next:"Next",noResults:":-( nothing found",previous:"Previous",numberOfResults:"Number of results: ",returnToSearchResults:"Return to search-results",search:"Search",searchResults:"Search-results",relatedItems:"Related items",sort:"sort"},textExpander:!1,linkToExternalLandingPage:!1,maxCharactersResults:"500",maxCharactersItem:"1200",maxCharactersTitle:"100",thumbnailField:"delving_thumbnail",thumbnailWidth:"144",resultFields:[],alternativeFieldLabelsPerSpecTrigger:null,resultFieldsAlternativeLabels:[],showFacets:!0,collapseFacets:!1,sortFacets:!1,customFacets:[],displayFacets:[],itemFields:[],itemImageFields:{},relatedItemsFields:[],showQueryInfo:!0,useSimpleSearch:!0,useAdvancedSearch:!1,advancedSearchFields:[],useSearchIn:!1,searchInFields:[],useDeepZoom:!1,useFlashZoom:!0,deepZoomFlashFile:"flash/OpenZoomViewer.swf",deepZoomControlImages:"images/seadragon/",configHelp:!1,showRelatedItems:!1,relatedItemsCount:5,usePushState:!0},e.fn.delvingInstant=function(t){return this.each(function(){new e.DelvingInstant(this,t)})},e.fn.getDelvingInstant=function(){this.data("DelvingInstant")}}(jQuery);
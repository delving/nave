/*! Delving Instant - v1.7.1 - 2019-12-03
* https://github.com/delving/delving-instant
* Copyright (c) 2019 Delving B.V. info@delving.eu; Licensed MIT */

var VS_Store=function(){"use strict";var t="undefined"!=typeof window?window:document,e=t.document,i={};if("undefined"!=typeof Storage){function n(){return t.sessionStorage}i.get=function(t){var e=n().getItem(t);return e?"{"===e.charAt(0)?JSON.parse(e):e:void 0},i.set=function(t,e){var i="{"===JSON.stringify(e).charAt(0)?JSON.stringify(e):e;return n().setItem(t,i)},i.remove=function(t){return n().removeItem(t)}}else i.get=function(t){if(t){var i=e.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));if(i){var n=decodeURIComponent(i[1]);return"{"===n.charAt(0)?JSON.parse(n):n}}},i.set=function(t,i){if(t&&i){var n="{"===JSON.stringify(i).charAt(0)?JSON.stringify(i):i;e.cookie=encodeURIComponent(t)+"="+encodeURIComponent(n)+"; path=/; samesite=lax"}},i.remove=function(t){t&&(e.cookie=escape(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; samesite=lax")};return i}();window.VS_Store=VS_Store;var VS_Urls=function(){"use strict";("undefined"!=typeof window?window:document).document;var t={getParams:function(t){var e={},i=document.createElement("a");i.href=t;for(var n=i.search.substring(1).split("&"),r=0;r<n.length;r++){var o=n[r].split("=");e[o[0]]=decodeURIComponent(o[1])}return e},getQueryString:function(t,e){var i=e||window.location.href,n=new RegExp("[?&]"+t+"=([^&#]*)","i").exec(i);return n?n[1]:null},setUrlParameter:function(t,e,i){t=encodeURIComponent(t),e=encodeURIComponent(e);var n=i.split("?")[0],r=t+"="+e,o="?"+r;if(void 0==i.split("?")[1]?urlQueryString="":urlQueryString="?"+i.split("?")[1],urlQueryString){var s=new RegExp("([?&])"+t+"[^&]*"),a=new RegExp("([?&])"+t+"=[^&;]+[&;]?");o=void 0===e||null===e||""===e?(o=urlQueryString.replace(a,"$1")).replace(/[&;]$/,""):null!==urlQueryString.match(s)?urlQueryString.replace(s,"$1"+r):(urlQueryString="")?"?"+r:urlQueryString+"&"+r}return n+(o="?"===o?"":o)},isUrl:function(t){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}};return t}();window.VS_Urls=VS_Urls,Array.prototype.map||(Array.prototype.map=function(t,e){var i,n,r;if(null==this)throw new TypeError(" this is null or not defined");var o=Object(this),s=o.length>>>0;if("[object Function]"!={}.toString.call(t))throw new TypeError(t+" is not a function");for(e&&(i=e),n=new Array(s),r=0;r<s;){var a,l;r in o&&(a=o[r],l=t.call(i,a,r,o),n[r]=l),r++}return n}),function(t,e){var i={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],r={anchor:"fragment"},o={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},s=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g,a=/(?:^|&|;)([^&=;]*)=?([^&;]*)/g;t.fn.url=function(n){var r,o,s="";return this.length&&(s=t(this).attr((r=this[0],(o=r.tagName)!==e?i[o.toLowerCase()]:o))||""),t.url(s,n)},t.url=function(t,i){return 1===arguments.length&&!0===t&&(i=!0,t=e),i=i||!1,{data:function(t,e){for(var i=decodeURI(t),r=o[e?"strict":"loose"].exec(i),l={attr:{},param:{},seg:{}},h=14;h--;)l.attr[n[h]]=r[h]||"";return l.param.query={},l.param.fragment={},l.attr.query.replace(s,function(t,e,i){e&&(l.param.query[e]?jQuery.isArray(l.param.query[e])?l.param.query[e].push(i):l.param.query[e]=[l.param.query[e],i]:l.param.query[e]=i)}),l.attr.fragment.replace(a,function(t,e,i){e&&(l.param.fragment[e]=i)}),l.seg.path=l.attr.path.replace(/^\/+|\/+$/g,"").split("/"),l.seg.fragment=l.attr.fragment.replace(/^\/+|\/+$/g,"").split("/"),l.attr.base=l.attr.host?l.attr.protocol+"://"+l.attr.host+(l.attr.port?":"+l.attr.port:""):"",l}(t=t||window.location.toString(),i),attr:function(t){return(t=r[t]||t)!==e?this.data.attr[t]:this.data.attr},param:function(t){return t!==e?this.data.param.query[t]:this.data.param.query},fparam:function(t){return t!==e?this.data.param.fragment[t]:this.data.param.fragment},segment:function(t){return t===e?this.data.seg.path:(t=t<0?this.data.seg.path.length+t:t-1,this.data.seg.path[t])},fsegment:function(t){return t===e?this.data.seg.fragment:(t=t<0?this.data.seg.fragment.length+t:t-1,this.data.seg.fragment[t])}}}}(jQuery),function(t,e){"use strict";var i=t.History=t.History||{},n=t.jQuery;if(void 0!==i.Adapter)throw new Error("History.js Adapter has already been loaded...");i.Adapter={bind:function(t,e,i){n(t).bind(e,i)},trigger:function(t,e,i){n(t).trigger(e,i)},extractEventData:function(t,e,i){return e&&e.originalEvent&&e.originalEvent[t]||i&&i[t]||void 0},onDomLoad:function(t){n(t)}},void 0!==i.init&&i.init()}(window),function(t,e){"use strict";var i=t.console||void 0,n=t.document,r=t.navigator,o=!1,s=t.setTimeout,a=t.clearTimeout,l=t.setInterval,h=t.clearInterval,c=t.JSON,u=t.alert,d=t.History=t.History||{},p=t.history;try{(o=t.sessionStorage).setItem("TEST","1"),o.removeItem("TEST")}catch(t){o=!1}if(c.stringify=c.stringify||c.encode,c.parse=c.parse||c.decode,void 0!==d.init)throw new Error("History.js Core has already been loaded...");d.init=function(t){return void 0!==d.Adapter&&(void 0!==d.initCore&&d.initCore(),void 0!==d.initHtml4&&d.initHtml4(),!0)},d.initCore=function(e){if(void 0!==d.initCore.initialized)return!1;if(d.initCore.initialized=!0,d.options=d.options||{},d.options.hashChangeInterval=d.options.hashChangeInterval||100,d.options.safariPollInterval=d.options.safariPollInterval||500,d.options.doubleCheckInterval=d.options.doubleCheckInterval||500,d.options.disableSuid=d.options.disableSuid||!1,d.options.storeInterval=d.options.storeInterval||1e3,d.options.busyDelay=d.options.busyDelay||250,d.options.debug=d.options.debug||!1,d.options.initialTitle=d.options.initialTitle||n.title,d.options.html4Mode=d.options.html4Mode||!1,d.options.delayInit=d.options.delayInit||!1,d.intervalList=[],d.clearAllIntervals=function(){var t,e=d.intervalList;if(void 0!==e&&null!==e){for(t=0;t<e.length;t++)h(e[t]);d.intervalList=null}},d.debug=function(){d.options.debug&&d.log.apply(d,arguments)},d.log=function(){var t,e,r,o,s,a=!(void 0===i||void 0===i.log||void 0===i.log.apply),l=n.getElementById("log");for(a?(t=(o=Array.prototype.slice.call(arguments)).shift(),void 0!==i.debug?i.debug.apply(i,[t,o]):i.log.apply(i,[t,o])):t="\n"+arguments[0]+"\n",e=1,r=arguments.length;e<r;++e){if("object"==typeof(s=arguments[e])&&void 0!==c)try{s=c.stringify(s)}catch(t){}t+="\n"+s+"\n"}return l?(l.value+=t+"\n-----\n",l.scrollTop=l.scrollHeight-l.clientHeight):a||u(t),!0},d.getInternetExplorerMajorVersion=function(){return d.getInternetExplorerMajorVersion.cached=void 0!==d.getInternetExplorerMajorVersion.cached?d.getInternetExplorerMajorVersion.cached:function(){for(var t=3,e=n.createElement("div"),i=e.getElementsByTagName("i");(e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e")&&i[0];);return t>4&&t}()},d.isInternetExplorer=function(){return d.isInternetExplorer.cached=void 0!==d.isInternetExplorer.cached?d.isInternetExplorer.cached:Boolean(d.getInternetExplorerMajorVersion())},d.options.html4Mode?d.emulated={pushState:!0,hashChange:!0}:d.emulated={pushState:!Boolean(t.history&&t.history.pushState&&t.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(r.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(r.userAgent))),hashChange:Boolean(!("onhashchange"in t||"onhashchange"in n)||d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<8)},d.enabled=!d.emulated.pushState,d.bugs={setHash:Boolean(!d.emulated.pushState&&"Apple Computer, Inc."===r.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(r.userAgent)),safariPoll:Boolean(!d.emulated.pushState&&"Apple Computer, Inc."===r.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(r.userAgent)),ieDoubleCheck:Boolean(d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(d.isInternetExplorer()&&d.getInternetExplorerMajorVersion()<7)},d.isEmptyObject=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},d.cloneObject=function(t){var e,i;return t?(e=c.stringify(t),i=c.parse(e)):i={},i},d.getRootUrl=function(){var t=n.location.protocol+"//"+(n.location.hostname||n.location.host);return n.location.port&&(t+=":"+n.location.port),t+="/"},d.getBaseHref=function(){var t=n.getElementsByTagName("base"),e="";return 1===t.length&&(e=t[0].href.replace(/[^\/]+$/,"")),(e=e.replace(/\/+$/,""))&&(e+="/"),e},d.getBaseUrl=function(){return d.getBaseHref()||d.getBasePageUrl()||d.getRootUrl()},d.getPageUrl=function(){return((d.getState(!1,!1)||{}).url||d.getLocationHref()).replace(/\/+$/,"").replace(/[^\/]+$/,function(t,e,i){return/\./.test(t)?t:t+"/"})},d.getBasePageUrl=function(){return d.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t,e,i){return/[^\/]$/.test(t)?"":t}).replace(/\/+$/,"")+"/"},d.getFullUrl=function(t,e){var i=t,n=t.substring(0,1);return e=void 0===e||e,/[a-z]+\:\/\//.test(t)||(i="/"===n?d.getRootUrl()+t.replace(/^\/+/,""):"#"===n?d.getPageUrl().replace(/#.*/,"")+t:"?"===n?d.getPageUrl().replace(/[\?#].*/,"")+t:e?d.getBaseUrl()+t.replace(/^(\.\/)+/,""):d.getBasePageUrl()+t.replace(/^(\.\/)+/,"")),i.replace(/\#$/,"")},d.getShortUrl=function(t){var e=t,i=d.getBaseUrl(),n=d.getRootUrl();return d.emulated.pushState&&(e=e.replace(i,"")),e=e.replace(n,"/"),d.isTraditionalAnchor(e)&&(e="./"+e),e=e.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},d.getLocationHref=function(t){return(t=t||n).URL===t.location.href?t.location.href:t.location.href===decodeURIComponent(t.URL)?t.URL:t.location.hash&&decodeURIComponent(t.location.href.replace(/^[^#]+/,""))===t.location.hash?t.location.href:-1==t.URL.indexOf("#")&&-1!=t.location.href.indexOf("#")?t.location.href:t.URL||t.location.href},d.store={},d.idToState=d.idToState||{},d.stateToId=d.stateToId||{},d.urlToId=d.urlToId||{},d.storedStates=d.storedStates||[],d.savedStates=d.savedStates||[],d.normalizeStore=function(){d.store.idToState=d.store.idToState||{},d.store.urlToId=d.store.urlToId||{},d.store.stateToId=d.store.stateToId||{}},d.getState=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0);var i=d.getLastSavedState();return!i&&e&&(i=d.createStateObject()),t&&((i=d.cloneObject(i)).url=i.cleanUrl||i.url),i},d.getIdByState=function(t){var e,i=d.extractId(t.url);if(!i)if(e=d.getStateString(t),void 0!==d.stateToId[e])i=d.stateToId[e];else if(void 0!==d.store.stateToId[e])i=d.store.stateToId[e];else{for(;i=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0!==d.idToState[i]||void 0!==d.store.idToState[i];);d.stateToId[e]=i,d.idToState[i]=t}return i},d.normalizeState=function(t){var e,i;return t&&"object"==typeof t||(t={}),void 0!==t.normalized?t:(t.data&&"object"==typeof t.data||(t.data={}),(e={}).normalized=!0,e.title=t.title||"",e.url=d.getFullUrl(t.url?t.url:d.getLocationHref()),e.hash=d.getShortUrl(e.url),e.data=d.cloneObject(t.data),e.id=d.getIdByState(e),e.cleanUrl=e.url.replace(/\??\&_suid.*/,""),e.url=e.cleanUrl,i=!d.isEmptyObject(e.data),(e.title||i)&&!0!==d.options.disableSuid&&(e.hash=d.getShortUrl(e.url).replace(/\??\&_suid.*/,""),/\?/.test(e.hash)||(e.hash+="?"),e.hash+="&_suid="+e.id),e.hashedUrl=d.getFullUrl(e.hash),(d.emulated.pushState||d.bugs.safariPoll)&&d.hasUrlDuplicate(e)&&(e.url=e.hashedUrl),e)},d.createStateObject=function(t,e,i){var n={data:t,title:e,url:i};return n=d.normalizeState(n)},d.getStateById=function(t){return t=String(t),d.idToState[t]||d.store.idToState[t]||void 0},d.getStateString=function(t){var e;return e={data:d.normalizeState(t).data,title:t.title,url:t.url},c.stringify(e)},d.getStateId=function(t){return d.normalizeState(t).id},d.getHashByState=function(t){return d.normalizeState(t).hash},d.extractId=function(t){var e,i;return i=-1!=t.indexOf("#")?t.split("#")[0]:t,(e=/(.*)\&_suid=([0-9]+)$/.exec(i))&&e[1]||t,(e?String(e[2]||""):"")||!1},d.isTraditionalAnchor=function(t){return!/[\/\?\.]/.test(t)},d.extractState=function(t,e){var i,n,r=null;return e=e||!1,(i=d.extractId(t))&&(r=d.getStateById(i)),r||(n=d.getFullUrl(t),(i=d.getIdByUrl(n)||!1)&&(r=d.getStateById(i)),r||!e||d.isTraditionalAnchor(t)||(r=d.createStateObject(null,null,n))),r},d.getIdByUrl=function(t){return d.urlToId[t]||d.store.urlToId[t]||void 0},d.getLastSavedState=function(){return d.savedStates[d.savedStates.length-1]||void 0},d.getLastStoredState=function(){return d.storedStates[d.storedStates.length-1]||void 0},d.hasUrlDuplicate=function(t){var e;return(e=d.extractState(t.url))&&e.id!==t.id},d.storeState=function(t){return d.urlToId[t.url]=t.id,d.storedStates.push(d.cloneObject(t)),t},d.isLastSavedState=function(t){var e=!1;return d.savedStates.length&&(e=t.id===d.getLastSavedState().id),e},d.saveState=function(t){return!d.isLastSavedState(t)&&(d.savedStates.push(d.cloneObject(t)),!0)},d.getStateByIndex=function(t){return void 0===t?d.savedStates[d.savedStates.length-1]:t<0?d.savedStates[d.savedStates.length+t]:d.savedStates[t]},d.getCurrentIndex=function(){return d.savedStates.length<1?0:d.savedStates.length-1},d.getHash=function(t){var e=d.getLocationHref(t);return d.getHashByUrl(e)},d.unescapeHash=function(t){var e=d.normalizeHash(t);return e=decodeURIComponent(e)},d.normalizeHash=function(t){return t.replace(/[^#]*#/,"").replace(/#.*/,"")},d.setHash=function(t,e){var i,r;return!1!==e&&d.busy()?(d.pushQueue({scope:d,callback:d.setHash,args:arguments,queue:e}),!1):(d.busy(!0),(i=d.extractState(t,!0))&&!d.emulated.pushState?d.pushState(i.data,i.title,i.url,!1):d.getHash()!==t&&(d.bugs.setHash?(r=d.getPageUrl(),d.pushState(null,null,r+"#"+t,!1)):n.location.hash=t),d)},d.escapeHash=function(e){var i=d.normalizeHash(e);return i=t.encodeURIComponent(i),d.bugs.hashEscape||(i=i.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),i},d.getHashByUrl=function(t){var e=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return e=d.unescapeHash(e)},d.setTitle=function(t){var e,i=t.title;i||(e=d.getStateByIndex(0))&&e.url===t.url&&(i=e.title||d.options.initialTitle);try{n.getElementsByTagName("title")[0].innerHTML=i.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(t){}return n.title=i,d},d.queues=[],d.busy=function(t){if(void 0!==t?d.busy.flag=t:void 0===d.busy.flag&&(d.busy.flag=!1),!d.busy.flag){a(d.busy.timeout);var e=function(){var t,i,n;if(!d.busy.flag)for(t=d.queues.length-1;t>=0;--t)0!==(i=d.queues[t]).length&&(n=i.shift(),d.fireQueueItem(n),d.busy.timeout=s(e,d.options.busyDelay))};d.busy.timeout=s(e,d.options.busyDelay)}return d.busy.flag},d.busy.flag=!1,d.fireQueueItem=function(t){return t.callback.apply(t.scope||d,t.args||[])},d.pushQueue=function(t){return d.queues[t.queue||0]=d.queues[t.queue||0]||[],d.queues[t.queue||0].push(t),d},d.queue=function(t,e){return"function"==typeof t&&(t={callback:t}),void 0!==e&&(t.queue=e),d.busy()?d.pushQueue(t):d.fireQueueItem(t),d},d.clearQueue=function(){return d.busy.flag=!1,d.queues=[],d},d.stateChanged=!1,d.doubleChecker=!1,d.doubleCheckComplete=function(){return d.stateChanged=!0,d.doubleCheckClear(),d},d.doubleCheckClear=function(){return d.doubleChecker&&(a(d.doubleChecker),d.doubleChecker=!1),d},d.doubleCheck=function(t){return d.stateChanged=!1,d.doubleCheckClear(),d.bugs.ieDoubleCheck&&(d.doubleChecker=s(function(){return d.doubleCheckClear(),d.stateChanged||t(),!0},d.options.doubleCheckInterval)),d},d.safariStatePoll=function(){var e=d.extractState(d.getLocationHref());if(!d.isLastSavedState(e))return e||d.createStateObject(),d.Adapter.trigger(t,"popstate"),d},d.back=function(t){return!1!==t&&d.busy()?(d.pushQueue({scope:d,callback:d.back,args:arguments,queue:t}),!1):(d.busy(!0),d.doubleCheck(function(){d.back(!1)}),p.go(-1),!0)},d.forward=function(t){return!1!==t&&d.busy()?(d.pushQueue({scope:d,callback:d.forward,args:arguments,queue:t}),!1):(d.busy(!0),d.doubleCheck(function(){d.forward(!1)}),p.go(1),!0)},d.go=function(t,e){var i;if(t>0)for(i=1;i<=t;++i)d.forward(e);else{if(!(t<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(i=-1;i>=t;--i)d.back(e)}return d},d.emulated.pushState){var f=function(){};d.pushState=d.pushState||f,d.replaceState=d.replaceState||f}else d.onPopState=function(e,i){var n,r,o,s=!1;return d.doubleCheckComplete(),(r=d.getHash())?((o=d.extractState(r||d.getLocationHref(),!0))?d.replaceState(o.data,o.title,o.url,!1):(d.Adapter.trigger(t,"anchorchange"),d.busy(!1)),d.expectedStateId=!1,!1):((s=(n=d.Adapter.extractEventData("state",e,i)||!1)?d.getStateById(n):d.expectedStateId?d.getStateById(d.expectedStateId):d.extractState(d.getLocationHref()))||(s=d.createStateObject(null,null,d.getLocationHref())),d.expectedStateId=!1,d.isLastSavedState(s)?(d.busy(!1),!1):(d.storeState(s),d.saveState(s),d.setTitle(s),d.Adapter.trigger(t,"statechange"),d.busy(!1),!0))},d.Adapter.bind(t,"popstate",d.onPopState),d.pushState=function(e,i,n,r){if(d.getHashByUrl(n)&&d.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==r&&d.busy())return d.pushQueue({scope:d,callback:d.pushState,args:arguments,queue:r}),!1;d.busy(!0);var o=d.createStateObject(e,i,n);return d.isLastSavedState(o)?d.busy(!1):(d.storeState(o),d.expectedStateId=o.id,p.pushState(o.id,o.title,o.url),d.Adapter.trigger(t,"popstate")),!0},d.replaceState=function(e,i,n,r){if(d.getHashByUrl(n)&&d.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==r&&d.busy())return d.pushQueue({scope:d,callback:d.replaceState,args:arguments,queue:r}),!1;d.busy(!0);var o=d.createStateObject(e,i,n);return d.isLastSavedState(o)?d.busy(!1):(d.storeState(o),d.expectedStateId=o.id,p.replaceState(o.id,o.title,o.url),d.Adapter.trigger(t,"popstate")),!0};if(o){try{d.store=c.parse(o.getItem("History.store"))||{}}catch(t){d.store={}}d.normalizeStore()}else d.store={},d.normalizeStore();d.Adapter.bind(t,"unload",d.clearAllIntervals),d.saveState(d.storeState(d.extractState(d.getLocationHref(),!0))),o&&(d.onUnload=function(){var t,e,i;try{t=c.parse(o.getItem("History.store"))||{}}catch(e){t={}}for(e in t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{},d.idToState)d.idToState.hasOwnProperty(e)&&(t.idToState[e]=d.idToState[e]);for(e in d.urlToId)d.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=d.urlToId[e]);for(e in d.stateToId)d.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=d.stateToId[e]);d.store=t,d.normalizeStore(),i=c.stringify(t);try{o.setItem("History.store",i)}catch(t){if(t.code!==DOMException.QUOTA_EXCEEDED_ERR)throw t;o.length&&(o.removeItem("History.store"),o.setItem("History.store",i))}},d.intervalList.push(l(d.onUnload,d.options.storeInterval)),d.Adapter.bind(t,"beforeunload",d.onUnload),d.Adapter.bind(t,"unload",d.onUnload)),d.emulated.pushState||(d.bugs.safariPoll&&d.intervalList.push(l(d.safariStatePoll,d.options.safariPollInterval)),"Apple Computer, Inc."!==r.vendor&&"Mozilla"!==(r.appCodeName||"")||(d.Adapter.bind(t,"hashchange",function(){d.Adapter.trigger(t,"popstate")}),d.getHash()&&d.Adapter.onDomLoad(function(){d.Adapter.trigger(t,"hashchange")})))},d.options&&d.options.delayInit||d.init()}(window),function(t){t.cookie=function(e,i,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(i))||null===i||void 0===i)){if(n=t.extend({},n),null!==i&&void 0!==i||(n.expires=-1),"number"==typeof n.expires){var r=n.expires,o=n.expires=new Date;o.setDate(o.getDate()+r)}return i=String(i),document.cookie=[encodeURIComponent(e),"=",n.raw?i:encodeURIComponent(i),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}for(var s,a=(n=i||{}).raw?function(t){return t}:decodeURIComponent,l=document.cookie.split("; "),h=0;s=l[h]&&l[h].split("=");h++)if(a(s[0])===e)return a(s[1]||"");return null}}(jQuery),function(t){t.expander={version:"1.4.3",defaults:{slicePoint:100,preserveWords:!0,widow:4,expandText:"read more",expandPrefix:"&hellip; ",expandAfterSummary:!1,summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"slideDown",expandSpeed:250,collapseEffect:"slideUp",collapseSpeed:200,userCollapse:!0,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null}},t.fn.expander=function(e){var i="init";"string"==typeof e&&(i=e,e={});var n,r=t.extend({},t.expander.defaults,e),o=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,s=r.wordEnd||/(&(?:[^;]+;)?|[a-zA-Z\u00C0-\u0100]+)$/,a=/<\/?(\w+)[^>]*>/g,l=/<(\w+)[^>]*>/g,h=/<\/(\w+)>/g,c=/(<\/[^>]+>)\s*$/,u=/^<[^>]+>.?/,d={init:function(){this.each(function(){var e,i,s,d,m,g,v,_,y,b,w,S,x=[],T=[],E={},P=this,C=t(this),L=t([]),k=t.extend({},r,C.data("expander")||t.meta&&C.data()||{}),A=!!C.find("."+k.detailClass).length,R=!!C.find("*").filter(function(){var e=t(this).css("display");return/^block|table|list/.test(e)}).length,I=(R?"div":"span")+"."+k.detailClass,O="span."+k.moreClass,M=k.expandSpeed||0,D=t.trim(C.html()),z=(t.trim(C.text()),D.slice(0,k.slicePoint));if(!t.data(this,"expanderInit")){for(t.data(this,"expanderInit",!0),t.each(["onSlice","beforeExpand","afterExpand","onCollapse"],function(e,i){E[i]=t.isFunction(k[i])}),m=(z=p(z)).replace(a,"").length;m<k.slicePoint;)"<"==(d=D.charAt(z.length))&&(d=D.slice(z.length).match(u)[0]),z+=d,m++;for(g=(z=p(z,k.preserveWords)).match(l)||[],v=z.match(h)||[],s=[],t.each(g,function(t,e){o.test(e)||s.push(e)}),g=s,i=v.length,e=0;e<i;e++)v[e]=v[e].replace(h,"$1");if(t.each(g,function(e,i){var n=i.replace(l,"$1"),r=t.inArray(n,v);-1===r?(x.push(i),T.push("</"+n+">")):v.splice(r,1)}),T.reverse(),A)y=C.find(I).remove().html(),D=(z=C.html())+y,_="";else{if(y=D.slice(z.length),""===(b=t.trim(y.replace(a,"")))||b.split(/\s+/).length<k.widow)return;_=T.pop()||"",z+=T.join(""),y=x.join("")+y}k.moreLabel=C.find(O).length?"":function(t){var e='<span class="'+t.moreClass+'">'+t.expandPrefix;return e+='<a href="#">'+t.expandText+"</a></span>"}(k),R&&(y=D),z+=_,k.summary=z,k.details=y,k.lastCloseTag=_,E.onSlice&&(s=k.onSlice.call(P,k),k=s&&s.details?s:k);var F=function(t,e){var i="span",n=t.summary;e?(i="div",c.test(n)&&!t.expandAfterSummary?n=n.replace(c,t.moreLabel+"$1"):n+=t.moreLabel,n='<div class="'+t.summaryClass+'">'+n+"</div>"):n+=t.moreLabel;return[n,"<",i+' class="'+t.detailClass+'"',">",t.details,"</"+i+">"].join("")}(k,R);C.html(F),w=C.find(I),S=C.find(O),w[k.collapseEffect](0),S.find("a").unbind("click.expander").bind("click.expander",function(e){e.preventDefault(),S.hide(),L.hide(),E.beforeExpand&&k.beforeExpand.call(P);w.stop(!1,!0)[k.expandEffect](M,function(){w.css({zoom:""}),E.afterExpand&&k.afterExpand.call(P),function(e,i,r){e.collapseTimer&&(n=setTimeout(function(){f(e,i),t.isFunction(e.onCollapse)&&e.onCollapse.call(r,!1)},e.collapseTimer))}(k,w,P)})}),L=C.find("div."+k.summaryClass),k.userCollapse&&!C.find("span."+k.lessClass).length&&C.find(I).append('<span class="'+k.lessClass+'">'+k.userCollapsePrefix+'<a href="#">'+k.userCollapseText+"</a></span>"),C.find("span."+k.lessClass+" a").unbind("click.expander").bind("click.expander",function(e){e.preventDefault(),clearTimeout(n);var i=t(this).closest(I);f(k,i),E.onCollapse&&k.onCollapse.call(P,!0)})}})},destroy:function(){this.data("expander")&&(this.removeData("expander"),this.each(function(){var e=t(this),i=t.meta?t.extend({},r,e.data()):r,n=e.find("."+i.detailClass).contents();e.find("."+i.moreClass).remove(),e.find("."+i.summaryClass).remove(),e.find("."+i.detailClass).after(n).remove(),e.find("."+i.lessClass).remove()}))}};function p(e,i){return e.lastIndexOf("<")>e.lastIndexOf(">")&&(e=e.slice(0,e.lastIndexOf("<"))),i&&(e=e.replace(s,"")),t.trim(e)}function f(t,e){e.stop(!0,!0)[t.collapseEffect](t.collapseSpeed,function(){e.prev("span."+t.moreClass).show().length||e.parent().children("div."+t.summaryClass).show().find("span."+t.moreClass).show()})}return d[i]&&d[i].call(this),this},t.fn.expander.defaults=t.expander.defaults}(jQuery),function(t,e){var i,n=t.fn.domManip,r="_tmplitem",o=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},a={},l={key:0,data:{}},h=0,c=0,u=[];function d(e,i,n,r){var o={data:r||0===r||!1===r?r:i?i.data:{},_wrap:i?i._wrap:null,tmpl:null,parent:i||null,nodes:[],calls:y,nest:b,wrap:w,html:S,update:x};return e&&t.extend(o,e,{nodes:[],parent:i}),n&&(o.tmpl=n,o._ctnt=o._ctnt||o.tmpl(t,o),o.key=++h,(u.length?a:s)[h]=o),o}function p(e,i,n){var o,s=n?t.map(n,function(t){return"string"==typeof t?e.key?t.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+r+'="'+e.key+'" $2'):t:p(t,e,t._ctnt)}):e;return i?s:((s=s.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(e,i,n,r){_(o=t(n).get()),i&&(o=f(i).concat(o)),r&&(o=o.concat(f(r)))}),o||f(s))}function f(e){var i=document.createElement("div");return i.innerHTML=e,t.makeArray(i.childNodes)}function m(e){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+t.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(e,i,n,r,o,s,a){var l,h,c,u=t.tmpl.tag[n];if(!u)throw"Unknown template tag: "+n;return l=u._default||[],s&&!/\w$/.test(o)&&(o+=s,s=""),o?(o=v(o),a=a?","+v(a)+")":s?")":"",h=s?o.indexOf(".")>-1?o+v(s):"("+o+").call($item"+a:o,c=s?h:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"):c=h=l.$1||"null",r=v(r),"');"+u[i?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(c).split("$1").join(h).split("$2").join(r||l.$2||"")+"__.push('"})+"');}return __;")}function g(e,i){e._wrap=p(e,!0,t.isArray(i)?i:[o.test(i)?i:t(i).html()]).join("")}function v(t){return t?t.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function _(e){var i,n,o,l,u,p="_"+c,f={};for(o=0,l=e.length;o<l;o++)if(1===(i=e[o]).nodeType){for(u=(n=i.getElementsByTagName("*")).length-1;u>=0;u--)m(n[u]);m(i)}function m(e){var i,n,o,l,u=e;if(l=e.getAttribute(r)){for(;u.parentNode&&1===(u=u.parentNode).nodeType&&!(i=u.getAttribute(r)););i!==l&&(u=u.parentNode?11===u.nodeType?0:u.getAttribute(r)||0:0,(o=s[l])||((o=d(o=a[l],s[u]||a[u])).key=++h,s[h]=o),c&&m(l)),e.removeAttribute(r)}else c&&(o=t.data(e,"tmplItem"))&&(m(o.key),s[o.key]=o,u=(u=t.data(e.parentNode,"tmplItem"))?u.key:0);if(o){for(n=o;n&&n.key!=u;)n.nodes.push(e),n=n.parent;delete o._ctnt,delete o._wrap,t.data(e,"tmplItem",o)}function m(t){o=f[t+=p]=f[t]||d(o,s[o.parent.key+p]||o.parent)}}}function y(t,e,i,n){if(!t)return u.pop();u.push({_:t,tmpl:e,item:this,data:i,options:n})}function b(e,i,n){return t.tmpl(t.template(e),i,n,this)}function w(e,i){var n=e.options||{};return n.wrapped=i,t.tmpl(t.template(e.tmpl),e.data,n,e.item)}function S(e,i){var n=this._wrap;return t.map(t(t.isArray(n)?n.join(""):n).filter(e||"*"),function(t){return i?t.innerText||t.textContent:t.outerHTML||(e=t,(n=document.createElement("div")).appendChild(e.cloneNode(!0)),n.innerHTML);var e,n})}function x(){var e=this.nodes;t.tmpl(null,null,null,this).insertBefore(e[0]),t(e).remove()}t.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,n){t.fn[e]=function(r){var o,a,l,h,u=[],d=t(r),p=1===this.length&&this[0].parentNode;if(i=s||{},p&&11===p.nodeType&&1===p.childNodes.length&&1===d.length)d[n](this[0]),u=this;else{for(a=0,l=d.length;a<l;a++)c=a,o=(a>0?this.clone(!0):this).get(),t(d[a])[n](o),u=u.concat(o);c=0,u=this.pushStack(u,e,d.selector)}return h=i,i=null,t.tmpl.complete(h),u}}),t.fn.extend({tmpl:function(e,i,n){return t.tmpl(this[0],e,i,n)},tmplItem:function(){return t.tmplItem(this[0])},template:function(e){return t.template(e,this[0])},domManip:function(e,r,o,a){if(e[0]&&t.isArray(e[0])){for(var l,h=t.makeArray(arguments),u=e[0],d=u.length,p=0;p<d&&!(l=t.data(u[p++],"tmplItem")););l&&c&&(h[2]=function(e){t.tmpl.afterManip(this,e,o)}),n.apply(this,h)}else n.apply(this,arguments);return c=0,i||t.tmpl.complete(s),this}}),t.extend({tmpl:function(e,i,n,r){var o,h=!r;if(h)r=l,e=t.template[e]||t.template(null,e),a={};else if(!e)return e=r.tmpl,s[r.key]=r,r.nodes=[],r.wrapped&&g(r,r.wrapped),t(p(r,null,r.tmpl(t,r)));return e?("function"==typeof i&&(i=i.call(r||{})),n&&n.wrapped&&g(n,n.wrapped),o=t.isArray(i)?t.map(i,function(t){return t?d(n,r,e,t):null}):[d(n,r,e,i)],h?t(p(r,null,o)):o):[]},tmplItem:function(e){var i;for(e instanceof t&&(e=e[0]);e&&1===e.nodeType&&!(i=t.data(e,"tmplItem"))&&(e=e.parentNode););return i||l},template:function(e,i){return i?("string"==typeof i?i=m(i):i instanceof t&&(i=i[0]||{}),i.nodeType&&(i=t.data(i,"tmpl")||t.data(i,"tmpl",m(i.innerHTML))),"string"==typeof e?t.template[e]=i:i):e?"string"!=typeof e?t.template(null,e):t.template[e]||t.template(null,o.test(e)?e:t(e)):null},encode:function(t){return(""+t).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),t.extend(t.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(t){s={}},afterManip:function(e,i,n){var r=11===i.nodeType?t.makeArray(i.childNodes):1===i.nodeType?[i]:[];n.call(e,i),_(r),c++}})}(jQuery),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e=-1,i=-1,n=function(t){return parseFloat(t)||0},r=function(e){var i=null,r=[];return t(e).each(function(){var e=t(this),o=e.offset().top-n(e.css("margin-top")),s=r.length>0?r[r.length-1]:null;null===s?r.push(e):Math.floor(Math.abs(i-o))<=1?r[r.length-1]=s.add(e):r.push(e),i=o}),r},o=function(e){var i={byRow:!0,property:"height",target:null,remove:!1};return"object"==typeof e?t.extend(i,e):("boolean"==typeof e?i.byRow=e:"remove"===e&&(i.remove=!0),i)},s=t.fn.matchHeight=function(e){var i=o(e);if(i.remove){var n=this;return this.css(i.property,""),t.each(s._groups,function(t,e){e.elements=e.elements.not(n)}),this}return this.length<=1&&!i.target?this:(s._groups.push({elements:this,options:i}),s._apply(this,i),this)};s.version="0.7.2",s._groups=[],s._throttle=80,s._maintainScroll=!1,s._beforeUpdate=null,s._afterUpdate=null,s._rows=r,s._parse=n,s._parseOptions=o,s._apply=function(e,i){var a=o(i),l=t(e),h=[l],c=t(window).scrollTop(),u=t("html").outerHeight(!0),d=l.parents().filter(":hidden");return d.each(function(){var e=t(this);e.data("style-cache",e.attr("style"))}),d.css("display","block"),a.byRow&&!a.target&&(l.each(function(){var e=t(this),i=e.css("display");"inline-block"!==i&&"flex"!==i&&"inline-flex"!==i&&(i="block"),e.data("style-cache",e.attr("style")),e.css({display:i,"padding-top":"0","padding-bottom":"0","margin-top":"0","margin-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px",overflow:"hidden"})}),h=r(l),l.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||"")})),t.each(h,function(e,i){var r=t(i),o=0;if(a.target)o=a.target.outerHeight(!1);else{if(a.byRow&&r.length<=1)return void r.css(a.property,"");r.each(function(){var e=t(this),i=e.attr("style"),n=e.css("display");"inline-block"!==n&&"flex"!==n&&"inline-flex"!==n&&(n="block");var r={display:n};r[a.property]="",e.css(r),e.outerHeight(!1)>o&&(o=e.outerHeight(!1)),i?e.attr("style",i):e.css("display","")})}r.each(function(){var e=t(this),i=0;a.target&&e.is(a.target)||("border-box"!==e.css("box-sizing")&&(i+=n(e.css("border-top-width"))+n(e.css("border-bottom-width")),i+=n(e.css("padding-top"))+n(e.css("padding-bottom"))),e.css(a.property,o-i+"px"))})}),d.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||null)}),s._maintainScroll&&t(window).scrollTop(c/u*t("html").outerHeight(!0)),this},s._applyDataApi=function(){var e={};t("[data-match-height], [data-mh]").each(function(){var i=t(this),n=i.attr("data-mh")||i.attr("data-match-height");e[n]=n in e?e[n].add(i):i}),t.each(e,function(){this.matchHeight(!0)})};var a=function(e){s._beforeUpdate&&s._beforeUpdate(e,s._groups),t.each(s._groups,function(){s._apply(this.elements,this.options)}),s._afterUpdate&&s._afterUpdate(e,s._groups)};s._update=function(n,r){if(r&&"resize"===r.type){var o=t(window).width();if(o===e)return;e=o}n?-1===i&&(i=setTimeout(function(){a(r),i=-1},s._throttle)):a(r)},t(s._applyDataApi);var l=t.fn.on?"on":"bind";t(window)[l]("load",function(t){s._update(!1,t)}),t(window)[l]("resize orientationchange",function(t){s._update(!0,t)})});var imgLiquid=imgLiquid||{VER:"0.9.944"};function OpenSeadragon(t){return new OpenSeadragon.Viewer(t)}imgLiquid.bgs_Available=!1,imgLiquid.bgs_CheckRunned=!1,imgLiquid.injectCss=".imgLiquid img {visibility:hidden}",function(t){t.fn.extend({imgLiquid:function(e){this.defaults={fill:!0,verticalAlign:"center",horizontalAlign:"center",useBackgroundSize:!0,useDataHtmlAttr:!0,responsive:!0,delay:0,fadeInTime:0,removeBoxBackground:!0,hardPixels:!0,responsiveCheckTime:500,timecheckvisibility:500,onStart:null,onFinish:null,onItemStart:null,onItemFinish:null,onItemError:null},function(){if(!imgLiquid.bgs_CheckRunned){imgLiquid.bgs_CheckRunned=!0;var e=t('<span style="background-size:cover" />');t("body").append(e),function(){var t=e[0];if(t&&window.getComputedStyle){var i=window.getComputedStyle(t,null);i&&i.backgroundSize&&(imgLiquid.bgs_Available="cover"===i.backgroundSize)}}(),e.remove()}}();var i=this;return this.options=e,this.settings=t.extend({},this.defaults,this.options),this.settings.onStart&&this.settings.onStart(),this.each(function(e){function n(){(a.responsive||h.data("imgLiquid_oldProcessed"))&&h.data("imgLiquid_settings")&&(a=h.data("imgLiquid_settings"),l.actualSize=l.get(0).offsetWidth+l.get(0).offsetHeight/1e4,l.sizeOld&&l.actualSize!==l.sizeOld&&o(),l.sizeOld=l.actualSize,setTimeout(n,a.responsiveCheckTime))}function r(){h.data("imgLiquid_error",!0),l.addClass("imgLiquid_error"),a.onItemError&&a.onItemError(e,l,h),s()}function o(){var t,i,n,r,o,c,u,d,p=0,f=0,m=l.width(),g=l.height();void 0===h.data("owidth")&&h.data("owidth",h[0].width),void 0===h.data("oheight")&&h.data("oheight",h[0].height),a.fill===m/g>=h.data("owidth")/h.data("oheight")?(t="100%",i="auto",n=Math.floor(m),r=Math.floor(m*(h.data("oheight")/h.data("owidth")))):(t="auto",i="100%",n=Math.floor(g*(h.data("owidth")/h.data("oheight"))),r=Math.floor(g)),u=m-n,"left"===(o=a.horizontalAlign.toLowerCase())&&(f=0),"center"===o&&(f=.5*u),"right"===o&&(f=u),-1!==o.indexOf("%")&&((o=parseInt(o.replace("%",""),10))>0&&(f=.01*u*o)),d=g-r,"left"===(c=a.verticalAlign.toLowerCase())&&(p=0),"center"===c&&(p=.5*d),"bottom"===c&&(p=d),-1!==c.indexOf("%")&&((c=parseInt(c.replace("%",""),10))>0&&(p=.01*d*c)),a.hardPixels&&(t=n,i=r),h.css({width:t,height:i,"margin-left":Math.floor(f),"margin-top":Math.floor(p)}),h.data("imgLiquid_oldProcessed")||(h.fadeTo(a.fadeInTime,1),h.data("imgLiquid_oldProcessed",!0),a.removeBoxBackground&&l.css("background-image","none"),l.addClass("imgLiquid_nobgSize"),l.addClass("imgLiquid_ready")),a.onItemFinish&&a.onItemFinish(e,l,h),s()}function s(){e===i.length-1&&i.settings.onFinish&&i.settings.onFinish()}var a=i.settings,l=t(this),h=t("img:first",l);return h.length?(h.data("imgLiquid_settings")?(l.removeClass("imgLiquid_error").removeClass("imgLiquid_ready"),a=t.extend({},h.data("imgLiquid_settings"),i.options)):a=t.extend({},i.settings,function(){var t={};if(i.settings.useDataHtmlAttr){var e=l.attr("data-imgLiquid-fill"),n=l.attr("data-imgLiquid-horizontalAlign"),r=l.attr("data-imgLiquid-verticalAlign");("true"===e||"false"===e)&&(t.fill=Boolean("true"===e)),void 0===n||"left"!==n&&"center"!==n&&"right"!==n&&-1===n.indexOf("%")||(t.horizontalAlign=n),void 0===r||"top"!==r&&"bottom"!==r&&"center"!==r&&-1===r.indexOf("%")||(t.verticalAlign=r)}return imgLiquid.isIE&&i.settings.ieFadeInDisabled&&(t.fadeInTime=0),t}()),h.data("imgLiquid_settings",a),a.onItemStart&&a.onItemStart(e,l,h),void(imgLiquid.bgs_Available&&a.useBackgroundSize?(-1===l.css("background-image").indexOf(encodeURI(h.attr("src")))&&l.css({"background-image":'url("'+encodeURI(h.attr("src"))+'")'}),l.css({"background-size":a.fill?"cover":"contain","background-position":(a.horizontalAlign+" "+a.verticalAlign).toLowerCase(),"background-repeat":"no-repeat"}),t("a:first",l).css({display:"block",width:"100%",height:"100%"}),t("img",l).css({display:"none"}),a.onItemFinish&&a.onItemFinish(e,l,h),l.addClass("imgLiquid_bgSize"),l.addClass("imgLiquid_ready"),s()):function i(){if(h.data("oldSrc")&&h.data("oldSrc")!==h.attr("src")){var s=h.clone().removeAttr("style");return s.data("imgLiquid_settings",h.data("imgLiquid_settings")),h.parent().prepend(s),h.remove(),(h=s)[0].width=0,void setTimeout(i,10)}return h.data("imgLiquid_oldProcessed")?void o():(h.data("imgLiquid_oldProcessed",!1),h.data("oldSrc",h.attr("src")),t("img:not(:first)",l).css("display","none"),l.css({overflow:"hidden"}),h.fadeTo(0,0).removeAttr("width").removeAttr("height").css({visibility:"visible","max-width":"none","max-height":"none",width:"auto",height:"auto",display:"block"}),h.on("error",r),h[0].onerror=r,function t(){h.data("imgLiquid_error")||h.data("imgLiquid_loaded")||h.data("imgLiquid_oldProcessed")||(l.is(":visible")&&h[0].complete&&h[0].width>0&&h[0].height>0?(h.data("imgLiquid_loaded",!0),setTimeout(o,e*a.delay)):setTimeout(t,a.timecheckvisibility))}(),void n())}())):void r()})}})}(jQuery),function(){var t=imgLiquid.injectCss,e=document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i)}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],e):e(t.bootstrap={},t.jQuery,t.Popper)}(this,function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){var n,r,o;n=t,o=i[r=e],r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o})}return t}e=e&&e.hasOwnProperty("default")?e.default:e,i=i&&i.hasOwnProperty("default")?i.default:i;var s,a,l,h,c,u,d,p,f,m,g,v,_,y,b,w,S,x,T,E,P,C,L,k,A,R,I,O,M,D,z,F,N,B,j,H,U,q,W,G,V,Z,X,Y,$,K,Q,J,tt,et,it,nt,rt,ot,st,at,lt,ht,ct,ut,dt,pt,ft,mt,gt,vt,_t,yt,bt,wt,St,xt,Tt,Et,Pt,Ct,Lt,kt,At,Rt,It,Ot,Mt,Dt,zt,Ft,Nt,Bt,jt,Ht,Ut,qt,Wt,Gt,Vt,Zt,Xt,Yt,$t,Kt,Qt,Jt,te,ee,ie,ne,re,oe,se,ae,le,he,ce,ue,de,pe,fe,me,ge,ve,_e,ye,be,we,Se,xe,Te,Ee,Pe,Ce,Le,ke,Ae,Re,Ie,Oe,Me,De,ze,Fe,Ne,Be,je,He,Ue,qe,We,Ge,Ve,Ze,Xe,Ye,$e,Ke,Qe,Je,ti,ei,ii,ni,ri,oi,si,ai,li,hi,ci,ui,di,pi,fi,mi,gi,vi,_i,yi,bi,wi,Si,xi,Ti,Ei,Pi,Ci,Li,ki,Ai=function(t){var e="transitionend";var i={TRANSITION_END:"bsTransitionEnd",getUID:function(t){for(;t+=~~(1e6*Math.random()),document.getElementById(t););return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");e&&"#"!==e||(e=t.getAttribute("href")||"");try{return document.querySelector(e)?e:null}catch(t){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var i=t(e).css("transition-duration");return parseFloat(i)?(i=i.split(",")[0],1e3*parseFloat(i)):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(i){t(i).trigger(e)},supportsTransitionEnd:function(){return Boolean(e)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=n[r],s=e[r],a=s&&i.isElement(s)?"element":(l=s,{}.toString.call(l).match(/\s([a-z]+)/i)[1].toLowerCase());if(!new RegExp(o).test(a))throw new Error(t.toUpperCase()+': Option "'+r+'" provided type "'+a+'" but expected type "'+o+'".')}var l}};return t.fn.emulateTransitionEnd=function(e){var n=this,r=!1;return t(this).one(i.TRANSITION_END,function(){r=!0}),setTimeout(function(){r||i.triggerTransitionEnd(n)},e),this},t.event.special[i.TRANSITION_END]={bindType:e,delegateType:e,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},i}(e),Ri=(a="alert",h="."+(l="bs.alert"),c=(s=e).fn[a],u={CLOSE:"close"+h,CLOSED:"closed"+h,CLICK_DATA_API:"click"+h+".data-api"},d="alert",p="fade",f="show",m=function(){function t(t){this._element=t}var e=t.prototype;return e.close=function(t){var e=this._element;t&&(e=this._getRootElement(t)),this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},e.dispose=function(){s.removeData(this._element,l),this._element=null},e._getRootElement=function(t){var e=Ai.getSelectorFromElement(t),i=!1;return e&&(i=document.querySelector(e)),i||(i=s(t).closest("."+d)[0]),i},e._triggerCloseEvent=function(t){var e=s.Event(u.CLOSE);return s(t).trigger(e),e},e._removeElement=function(t){var e=this;if(s(t).removeClass(f),s(t).hasClass(p)){var i=Ai.getTransitionDurationFromElement(t);s(t).one(Ai.TRANSITION_END,function(i){return e._destroyElement(t,i)}).emulateTransitionEnd(i)}else this._destroyElement(t)},e._destroyElement=function(t){s(t).detach().trigger(u.CLOSED).remove()},t._jQueryInterface=function(e){return this.each(function(){var i=s(this),n=i.data(l);n||(n=new t(this),i.data(l,n)),"close"===e&&n[e](this)})},t._handleDismiss=function(t){return function(e){e&&e.preventDefault(),t.close(this)}},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}}]),t}(),s(document).on(u.CLICK_DATA_API,'[data-dismiss="alert"]',m._handleDismiss(new m)),s.fn[a]=m._jQueryInterface,s.fn[a].Constructor=m,s.fn[a].noConflict=function(){return s.fn[a]=c,m._jQueryInterface},m),Ii=(v="button",y="."+(_="bs.button"),b=".data-api",w=(g=e).fn[v],S="active","btn",T='[data-toggle^="button"]',E='[data-toggle="buttons"]',P="input",C=".active",L=".btn",k={CLICK_DATA_API:"click"+y+b,FOCUS_BLUR_DATA_API:(x="focus")+y+b+" blur"+y+b},A=function(){function t(t){this._element=t}var e=t.prototype;return e.toggle=function(){var t=!0,e=!0,i=g(this._element).closest(E)[0];if(i){var n=this._element.querySelector(P);if(n){if("radio"===n.type)if(n.checked&&this._element.classList.contains(S))t=!1;else{var r=i.querySelector(C);r&&g(r).removeClass(S)}if(t){if(n.hasAttribute("disabled")||i.hasAttribute("disabled")||n.classList.contains("disabled")||i.classList.contains("disabled"))return;n.checked=!this._element.classList.contains(S),g(n).trigger("change")}n.focus(),e=!1}}e&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(S)),t&&g(this._element).toggleClass(S)},e.dispose=function(){g.removeData(this._element,_),this._element=null},t._jQueryInterface=function(e){return this.each(function(){var i=g(this).data(_);i||(i=new t(this),g(this).data(_,i)),"toggle"===e&&i[e]()})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}}]),t}(),g(document).on(k.CLICK_DATA_API,T,function(t){t.preventDefault();var e=t.target;g(e).hasClass("btn")||(e=g(e).closest(L)),A._jQueryInterface.call(g(e),"toggle")}).on(k.FOCUS_BLUR_DATA_API,T,function(t){var e=g(t.target).closest(L)[0];g(e).toggleClass(x,/^focus(in)?$/.test(t.type))}),g.fn[v]=A._jQueryInterface,g.fn[v].Constructor=A,g.fn[v].noConflict=function(){return g.fn[v]=w,A._jQueryInterface},A),Oi=(I="carousel",M="."+(O="bs.carousel"),D=".data-api",z=(R=e).fn[I],F={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0},N={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean"},B="next",j="prev",H="left",U="right",q={SLIDE:"slide"+M,SLID:"slid"+M,KEYDOWN:"keydown"+M,MOUSEENTER:"mouseenter"+M,MOUSELEAVE:"mouseleave"+M,TOUCHEND:"touchend"+M,LOAD_DATA_API:"load"+M+D,CLICK_DATA_API:"click"+M+D},W="carousel",G="active",V="slide",Z="carousel-item-right",X="carousel-item-left",Y="carousel-item-next",$="carousel-item-prev",K=".active",Q=".active.carousel-item",J=".carousel-item",tt=".carousel-item-next, .carousel-item-prev",et=".carousel-indicators",it="[data-slide], [data-slide-to]",nt='[data-ride="carousel"]',rt=function(){function t(t,e){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this._config=this._getConfig(e),this._element=R(t)[0],this._indicatorsElement=this._element.querySelector(et),this._addEventListeners()}var e=t.prototype;return e.next=function(){this._isSliding||this._slide(B)},e.nextWhenVisible=function(){!document.hidden&&R(this._element).is(":visible")&&"hidden"!==R(this._element).css("visibility")&&this.next()},e.prev=function(){this._isSliding||this._slide(j)},e.pause=function(t){t||(this._isPaused=!0),this._element.querySelector(tt)&&(Ai.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},e.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},e.to=function(t){var e=this;this._activeElement=this._element.querySelector(Q);var i=this._getItemIndex(this._activeElement);if(!(t>this._items.length-1||t<0))if(this._isSliding)R(this._element).one(q.SLID,function(){return e.to(t)});else{if(i===t)return this.pause(),void this.cycle();var n=i<t?B:j;this._slide(n,this._items[t])}},e.dispose=function(){R(this._element).off(M),R.removeData(this._element,O),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},e._getConfig=function(t){return t=o({},F,t),Ai.typeCheckConfig(I,t,N),t},e._addEventListeners=function(){var t=this;this._config.keyboard&&R(this._element).on(q.KEYDOWN,function(e){return t._keydown(e)}),"hover"===this._config.pause&&(R(this._element).on(q.MOUSEENTER,function(e){return t.pause(e)}).on(q.MOUSELEAVE,function(e){return t.cycle(e)}),"ontouchstart"in document.documentElement&&R(this._element).on(q.TOUCHEND,function(){t.pause(),t.touchTimeout&&clearTimeout(t.touchTimeout),t.touchTimeout=setTimeout(function(e){return t.cycle(e)},500+t._config.interval)}))},e._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next()}},e._getItemIndex=function(t){return this._items=t&&t.parentNode?[].slice.call(t.parentNode.querySelectorAll(J)):[],this._items.indexOf(t)},e._getItemByDirection=function(t,e){var i=t===B,n=t===j,r=this._getItemIndex(e),o=this._items.length-1;if((n&&0===r||i&&r===o)&&!this._config.wrap)return e;var s=(r+(t===j?-1:1))%this._items.length;return-1===s?this._items[this._items.length-1]:this._items[s]},e._triggerSlideEvent=function(t,e){var i=this._getItemIndex(t),n=this._getItemIndex(this._element.querySelector(Q)),r=R.Event(q.SLIDE,{relatedTarget:t,direction:e,from:n,to:i});return R(this._element).trigger(r),r},e._setActiveIndicatorElement=function(t){if(this._indicatorsElement){var e=[].slice.call(this._indicatorsElement.querySelectorAll(K));R(e).removeClass(G);var i=this._indicatorsElement.children[this._getItemIndex(t)];i&&R(i).addClass(G)}},e._slide=function(t,e){var i,n,r,o=this,s=this._element.querySelector(Q),a=this._getItemIndex(s),l=e||s&&this._getItemByDirection(t,s),h=this._getItemIndex(l),c=Boolean(this._interval);if(t===B?(i=X,n=Y,r=H):(i=Z,n=$,r=U),l&&R(l).hasClass(G))this._isSliding=!1;else if(!this._triggerSlideEvent(l,r).isDefaultPrevented()&&s&&l){this._isSliding=!0,c&&this.pause(),this._setActiveIndicatorElement(l);var u=R.Event(q.SLID,{relatedTarget:l,direction:r,from:a,to:h});if(R(this._element).hasClass(V)){R(l).addClass(n),Ai.reflow(l),R(s).addClass(i),R(l).addClass(i);var d=Ai.getTransitionDurationFromElement(s);R(s).one(Ai.TRANSITION_END,function(){R(l).removeClass(i+" "+n).addClass(G),R(s).removeClass(G+" "+n+" "+i),o._isSliding=!1,setTimeout(function(){return R(o._element).trigger(u)},0)}).emulateTransitionEnd(d)}else R(s).removeClass(G),R(l).addClass(G),this._isSliding=!1,R(this._element).trigger(u);c&&this.cycle()}},t._jQueryInterface=function(e){return this.each(function(){var i=R(this).data(O),n=o({},F,R(this).data());"object"==typeof e&&(n=o({},n,e));var r="string"==typeof e?e:n.slide;if(i||(i=new t(this,n),R(this).data(O,i)),"number"==typeof e)i.to(e);else if("string"==typeof r){if(void 0===i[r])throw new TypeError('No method named "'+r+'"');i[r]()}else n.interval&&(i.pause(),i.cycle())})},t._dataApiClickHandler=function(e){var i=Ai.getSelectorFromElement(this);if(i){var n=R(i)[0];if(n&&R(n).hasClass(W)){var r=o({},R(n).data(),R(this).data()),s=this.getAttribute("data-slide-to");s&&(r.interval=!1),t._jQueryInterface.call(R(n),r),s&&R(n).data(O).to(s),e.preventDefault()}}},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return F}}]),t}(),R(document).on(q.CLICK_DATA_API,it,rt._dataApiClickHandler),R(window).on(q.LOAD_DATA_API,function(){for(var t=[].slice.call(document.querySelectorAll(nt)),e=0,i=t.length;e<i;e++){var n=R(t[e]);rt._jQueryInterface.call(n,n.data())}}),R.fn[I]=rt._jQueryInterface,R.fn[I].Constructor=rt,R.fn[I].noConflict=function(){return R.fn[I]=z,rt._jQueryInterface},rt),Mi=(st="collapse",lt="."+(at="bs.collapse"),ht=(ot=e).fn[st],ct={toggle:!0,parent:""},ut={toggle:"boolean",parent:"(string|element)"},dt={SHOW:"show"+lt,SHOWN:"shown"+lt,HIDE:"hide"+lt,HIDDEN:"hidden"+lt,CLICK_DATA_API:"click"+lt+".data-api"},pt="show",ft="collapse",mt="collapsing",gt="collapsed",vt="width","height",_t=".show, .collapsing",yt='[data-toggle="collapse"]',bt=function(){function t(t,e){this._isTransitioning=!1,this._element=t,this._config=this._getConfig(e),this._triggerArray=ot.makeArray(document.querySelectorAll('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'));for(var i=[].slice.call(document.querySelectorAll(yt)),n=0,r=i.length;n<r;n++){var o=i[n],s=Ai.getSelectorFromElement(o),a=[].slice.call(document.querySelectorAll(s)).filter(function(e){return e===t});null!==s&&0<a.length&&(this._selector=s,this._triggerArray.push(o))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var e=t.prototype;return e.toggle=function(){ot(this._element).hasClass(pt)?this.hide():this.show()},e.show=function(){var e,i,n=this;if(!(this._isTransitioning||ot(this._element).hasClass(pt)||(this._parent&&0===(e=[].slice.call(this._parent.querySelectorAll(_t)).filter(function(t){return t.getAttribute("data-parent")===n._config.parent})).length&&(e=null),e&&(i=ot(e).not(this._selector).data(at))&&i._isTransitioning))){var r=ot.Event(dt.SHOW);if(ot(this._element).trigger(r),!r.isDefaultPrevented()){e&&(t._jQueryInterface.call(ot(e).not(this._selector),"hide"),i||ot(e).data(at,null));var o=this._getDimension();ot(this._element).removeClass(ft).addClass(mt),this._element.style[o]=0,this._triggerArray.length&&ot(this._triggerArray).removeClass(gt).attr("aria-expanded",!0),this.setTransitioning(!0);var s="scroll"+(o[0].toUpperCase()+o.slice(1)),a=Ai.getTransitionDurationFromElement(this._element);ot(this._element).one(Ai.TRANSITION_END,function(){ot(n._element).removeClass(mt).addClass(ft).addClass(pt),n._element.style[o]="",n.setTransitioning(!1),ot(n._element).trigger(dt.SHOWN)}).emulateTransitionEnd(a),this._element.style[o]=this._element[s]+"px"}}},e.hide=function(){var t=this;if(!this._isTransitioning&&ot(this._element).hasClass(pt)){var e=ot.Event(dt.HIDE);if(ot(this._element).trigger(e),!e.isDefaultPrevented()){var i=this._getDimension();this._element.style[i]=this._element.getBoundingClientRect()[i]+"px",Ai.reflow(this._element),ot(this._element).addClass(mt).removeClass(ft).removeClass(pt);var n=this._triggerArray.length;if(0<n)for(var r=0;r<n;r++){var o=this._triggerArray[r],s=Ai.getSelectorFromElement(o);null!==s&&(ot([].slice.call(document.querySelectorAll(s))).hasClass(pt)||ot(o).addClass(gt).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[i]="";var a=Ai.getTransitionDurationFromElement(this._element);ot(this._element).one(Ai.TRANSITION_END,function(){t.setTransitioning(!1),ot(t._element).removeClass(mt).addClass(ft).trigger(dt.HIDDEN)}).emulateTransitionEnd(a)}}},e.setTransitioning=function(t){this._isTransitioning=t},e.dispose=function(){ot.removeData(this._element,at),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},e._getConfig=function(t){return(t=o({},ct,t)).toggle=Boolean(t.toggle),Ai.typeCheckConfig(st,t,ut),t},e._getDimension=function(){return ot(this._element).hasClass(vt)?vt:"height"},e._getParent=function(){var e=this,i=null;Ai.isElement(this._config.parent)?(i=this._config.parent,void 0!==this._config.parent.jquery&&(i=this._config.parent[0])):i=document.querySelector(this._config.parent);var n='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',r=[].slice.call(i.querySelectorAll(n));return ot(r).each(function(i,n){e._addAriaAndCollapsedClass(t._getTargetFromElement(n),[n])}),i},e._addAriaAndCollapsedClass=function(t,e){if(t){var i=ot(t).hasClass(pt);e.length&&ot(e).toggleClass(gt,!i).attr("aria-expanded",i)}},t._getTargetFromElement=function(t){var e=Ai.getSelectorFromElement(t);return e?document.querySelector(e):null},t._jQueryInterface=function(e){return this.each(function(){var i=ot(this),n=i.data(at),r=o({},ct,i.data(),"object"==typeof e&&e?e:{});if(!n&&r.toggle&&/show|hide/.test(e)&&(r.toggle=!1),n||(n=new t(this,r),i.data(at,n)),"string"==typeof e){if(void 0===n[e])throw new TypeError('No method named "'+e+'"');n[e]()}})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return ct}}]),t}(),ot(document).on(dt.CLICK_DATA_API,yt,function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var e=ot(this),i=Ai.getSelectorFromElement(this),n=[].slice.call(document.querySelectorAll(i));ot(n).each(function(){var t=ot(this),i=t.data(at)?"toggle":e.data();bt._jQueryInterface.call(t,i)})}),ot.fn[st]=bt._jQueryInterface,ot.fn[st].Constructor=bt,ot.fn[st].noConflict=function(){return ot.fn[st]=ht,bt._jQueryInterface},bt),Di=(St="dropdown",Tt="."+(xt="bs.dropdown"),Et=".data-api",Pt=(wt=e).fn[St],Ct=new RegExp("38|40|27"),Lt={HIDE:"hide"+Tt,HIDDEN:"hidden"+Tt,SHOW:"show"+Tt,SHOWN:"shown"+Tt,CLICK:"click"+Tt,CLICK_DATA_API:"click"+Tt+Et,KEYDOWN_DATA_API:"keydown"+Tt+Et,KEYUP_DATA_API:"keyup"+Tt+Et},kt="disabled",At="show","dropup",Rt="dropright",It="dropleft",Ot="dropdown-menu-right",Mt="position-static",Dt='[data-toggle="dropdown"]',zt=".dropdown form",Ft=".dropdown-menu",Nt=".navbar-nav",Bt=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",jt="top-start",Ht="top-end",Ut="bottom-start",qt="bottom-end",Wt="right-start",Gt="left-start",Vt={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic"},Zt={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string"},Xt=function(){function t(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var e=t.prototype;return e.toggle=function(){if(!this._element.disabled&&!wt(this._element).hasClass(kt)){var e=t._getParentFromElement(this._element),n=wt(this._menu).hasClass(At);if(t._clearMenus(),!n){var r={relatedTarget:this._element},o=wt.Event(Lt.SHOW,r);if(wt(e).trigger(o),!o.isDefaultPrevented()){if(!this._inNavbar){if(void 0===i)throw new TypeError("Bootstrap dropdown require Popper.js (https://popper.js.org)");var s=this._element;"parent"===this._config.reference?s=e:Ai.isElement(this._config.reference)&&(s=this._config.reference,void 0!==this._config.reference.jquery&&(s=this._config.reference[0])),"scrollParent"!==this._config.boundary&&wt(e).addClass(Mt),this._popper=new i(s,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===wt(e).closest(Nt).length&&wt(document.body).children().on("mouseover",null,wt.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),wt(this._menu).toggleClass(At),wt(e).toggleClass(At).trigger(wt.Event(Lt.SHOWN,r))}}}},e.dispose=function(){wt.removeData(this._element,xt),wt(this._element).off(Tt),this._element=null,(this._menu=null)!==this._popper&&(this._popper.destroy(),this._popper=null)},e.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},e._addEventListeners=function(){var t=this;wt(this._element).on(Lt.CLICK,function(e){e.preventDefault(),e.stopPropagation(),t.toggle()})},e._getConfig=function(t){return t=o({},this.constructor.Default,wt(this._element).data(),t),Ai.typeCheckConfig(St,t,this.constructor.DefaultType),t},e._getMenuElement=function(){if(!this._menu){var e=t._getParentFromElement(this._element);e&&(this._menu=e.querySelector(Ft))}return this._menu},e._getPlacement=function(){var t=wt(this._element.parentNode),e=Ut;return t.hasClass("dropup")?(e=jt,wt(this._menu).hasClass(Ot)&&(e=Ht)):t.hasClass(Rt)?e=Wt:t.hasClass(It)?e=Gt:wt(this._menu).hasClass(Ot)&&(e=qt),e},e._detectNavbar=function(){return 0<wt(this._element).closest(".navbar").length},e._getPopperConfig=function(){var t=this,e={};"function"==typeof this._config.offset?e.fn=function(e){return e.offsets=o({},e.offsets,t._config.offset(e.offsets)||{}),e}:e.offset=this._config.offset;var i={placement:this._getPlacement(),modifiers:{offset:e,flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(i.modifiers.applyStyle={enabled:!1}),i},t._jQueryInterface=function(e){return this.each(function(){var i=wt(this).data(xt);if(i||(i=new t(this,"object"==typeof e?e:null),wt(this).data(xt,i)),"string"==typeof e){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}})},t._clearMenus=function(e){if(!e||3!==e.which&&("keyup"!==e.type||9===e.which))for(var i=[].slice.call(document.querySelectorAll(Dt)),n=0,r=i.length;n<r;n++){var o=t._getParentFromElement(i[n]),s=wt(i[n]).data(xt),a={relatedTarget:i[n]};if(e&&"click"===e.type&&(a.clickEvent=e),s){var l=s._menu;if(wt(o).hasClass(At)&&!(e&&("click"===e.type&&/input|textarea/i.test(e.target.tagName)||"keyup"===e.type&&9===e.which)&&wt.contains(o,e.target))){var h=wt.Event(Lt.HIDE,a);wt(o).trigger(h),h.isDefaultPrevented()||("ontouchstart"in document.documentElement&&wt(document.body).children().off("mouseover",null,wt.noop),i[n].setAttribute("aria-expanded","false"),wt(l).removeClass(At),wt(o).removeClass(At).trigger(wt.Event(Lt.HIDDEN,a)))}}}},t._getParentFromElement=function(t){var e,i=Ai.getSelectorFromElement(t);return i&&(e=document.querySelector(i)),e||t.parentNode},t._dataApiKeydownHandler=function(e){if((/input|textarea/i.test(e.target.tagName)?!(32===e.which||27!==e.which&&(40!==e.which&&38!==e.which||wt(e.target).closest(Ft).length)):Ct.test(e.which))&&(e.preventDefault(),e.stopPropagation(),!this.disabled&&!wt(this).hasClass(kt))){var i=t._getParentFromElement(this),n=wt(i).hasClass(At);if((n||27===e.which&&32===e.which)&&(!n||27!==e.which&&32!==e.which)){var r=[].slice.call(i.querySelectorAll(Bt));if(0!==r.length){var o=r.indexOf(e.target);38===e.which&&0<o&&o--,40===e.which&&o<r.length-1&&o++,o<0&&(o=0),r[o].focus()}}else{if(27===e.which){var s=i.querySelector(Dt);wt(s).trigger("focus")}wt(this).trigger("click")}}},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return Vt}},{key:"DefaultType",get:function(){return Zt}}]),t}(),wt(document).on(Lt.KEYDOWN_DATA_API,Dt,Xt._dataApiKeydownHandler).on(Lt.KEYDOWN_DATA_API,Ft,Xt._dataApiKeydownHandler).on(Lt.CLICK_DATA_API+" "+Lt.KEYUP_DATA_API,Xt._clearMenus).on(Lt.CLICK_DATA_API,Dt,function(t){t.preventDefault(),t.stopPropagation(),Xt._jQueryInterface.call(wt(this),"toggle")}).on(Lt.CLICK_DATA_API,zt,function(t){t.stopPropagation()}),wt.fn[St]=Xt._jQueryInterface,wt.fn[St].Constructor=Xt,wt.fn[St].noConflict=function(){return wt.fn[St]=Pt,Xt._jQueryInterface},Xt),zi=($t="modal",Qt="."+(Kt="bs.modal"),Jt=(Yt=e).fn[$t],te={backdrop:!0,keyboard:!0,focus:!0,show:!0},ee={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},ie={HIDE:"hide"+Qt,HIDDEN:"hidden"+Qt,SHOW:"show"+Qt,SHOWN:"shown"+Qt,FOCUSIN:"focusin"+Qt,RESIZE:"resize"+Qt,CLICK_DISMISS:"click.dismiss"+Qt,KEYDOWN_DISMISS:"keydown.dismiss"+Qt,MOUSEUP_DISMISS:"mouseup.dismiss"+Qt,MOUSEDOWN_DISMISS:"mousedown.dismiss"+Qt,CLICK_DATA_API:"click"+Qt+".data-api"},ne="modal-scrollbar-measure",re="modal-backdrop",oe="modal-open",se="fade",ae="show",le=".modal-dialog",he='[data-toggle="modal"]',ce='[data-dismiss="modal"]',ue=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",de=".sticky-top",pe=function(){function t(t,e){this._config=this._getConfig(e),this._element=t,this._dialog=t.querySelector(le),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._scrollbarWidth=0}var e=t.prototype;return e.toggle=function(t){return this._isShown?this.hide():this.show(t)},e.show=function(t){var e=this;if(!this._isTransitioning&&!this._isShown){Yt(this._element).hasClass(se)&&(this._isTransitioning=!0);var i=Yt.Event(ie.SHOW,{relatedTarget:t});Yt(this._element).trigger(i),this._isShown||i.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),Yt(document.body).addClass(oe),this._setEscapeEvent(),this._setResizeEvent(),Yt(this._element).on(ie.CLICK_DISMISS,ce,function(t){return e.hide(t)}),Yt(this._dialog).on(ie.MOUSEDOWN_DISMISS,function(){Yt(e._element).one(ie.MOUSEUP_DISMISS,function(t){Yt(t.target).is(e._element)&&(e._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return e._showElement(t)}))}},e.hide=function(t){var e=this;if(t&&t.preventDefault(),!this._isTransitioning&&this._isShown){var i=Yt.Event(ie.HIDE);if(Yt(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var n=Yt(this._element).hasClass(se);if(n&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),Yt(document).off(ie.FOCUSIN),Yt(this._element).removeClass(ae),Yt(this._element).off(ie.CLICK_DISMISS),Yt(this._dialog).off(ie.MOUSEDOWN_DISMISS),n){var r=Ai.getTransitionDurationFromElement(this._element);Yt(this._element).one(Ai.TRANSITION_END,function(t){return e._hideModal(t)}).emulateTransitionEnd(r)}else this._hideModal()}}},e.dispose=function(){Yt.removeData(this._element,Kt),Yt(window,document,this._element,this._backdrop).off(Qt),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._scrollbarWidth=null},e.handleUpdate=function(){this._adjustDialog()},e._getConfig=function(t){return t=o({},te,t),Ai.typeCheckConfig($t,t,ee),t},e._showElement=function(t){var e=this,i=Yt(this._element).hasClass(se);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.scrollTop=0,i&&Ai.reflow(this._element),Yt(this._element).addClass(ae),this._config.focus&&this._enforceFocus();var n=Yt.Event(ie.SHOWN,{relatedTarget:t}),r=function(){e._config.focus&&e._element.focus(),e._isTransitioning=!1,Yt(e._element).trigger(n)};if(i){var o=Ai.getTransitionDurationFromElement(this._element);Yt(this._dialog).one(Ai.TRANSITION_END,r).emulateTransitionEnd(o)}else r()},e._enforceFocus=function(){var t=this;Yt(document).off(ie.FOCUSIN).on(ie.FOCUSIN,function(e){document!==e.target&&t._element!==e.target&&0===Yt(t._element).has(e.target).length&&t._element.focus()})},e._setEscapeEvent=function(){var t=this;this._isShown&&this._config.keyboard?Yt(this._element).on(ie.KEYDOWN_DISMISS,function(e){27===e.which&&(e.preventDefault(),t.hide())}):this._isShown||Yt(this._element).off(ie.KEYDOWN_DISMISS)},e._setResizeEvent=function(){var t=this;this._isShown?Yt(window).on(ie.RESIZE,function(e){return t.handleUpdate(e)}):Yt(window).off(ie.RESIZE)},e._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._isTransitioning=!1,this._showBackdrop(function(){Yt(document.body).removeClass(oe),t._resetAdjustments(),t._resetScrollbar(),Yt(t._element).trigger(ie.HIDDEN)})},e._removeBackdrop=function(){this._backdrop&&(Yt(this._backdrop).remove(),this._backdrop=null)},e._showBackdrop=function(t){var e=this,i=Yt(this._element).hasClass(se)?se:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className=re,i&&this._backdrop.classList.add(i),Yt(this._backdrop).appendTo(document.body),Yt(this._element).on(ie.CLICK_DISMISS,function(t){e._ignoreBackdropClick?e._ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"===e._config.backdrop?e._element.focus():e.hide())}),i&&Ai.reflow(this._backdrop),Yt(this._backdrop).addClass(ae),!t)return;if(!i)return void t();var n=Ai.getTransitionDurationFromElement(this._backdrop);Yt(this._backdrop).one(Ai.TRANSITION_END,t).emulateTransitionEnd(n)}else if(!this._isShown&&this._backdrop){Yt(this._backdrop).removeClass(ae);var r=function(){e._removeBackdrop(),t&&t()};if(Yt(this._element).hasClass(se)){var o=Ai.getTransitionDurationFromElement(this._backdrop);Yt(this._backdrop).one(Ai.TRANSITION_END,r).emulateTransitionEnd(o)}else r()}else t&&t()},e._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},e._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},e._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=t.left+t.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},e._setScrollbar=function(){var t=this;if(this._isBodyOverflowing){var e=[].slice.call(document.querySelectorAll(ue)),i=[].slice.call(document.querySelectorAll(de));Yt(e).each(function(e,i){var n=i.style.paddingRight,r=Yt(i).css("padding-right");Yt(i).data("padding-right",n).css("padding-right",parseFloat(r)+t._scrollbarWidth+"px")}),Yt(i).each(function(e,i){var n=i.style.marginRight,r=Yt(i).css("margin-right");Yt(i).data("margin-right",n).css("margin-right",parseFloat(r)-t._scrollbarWidth+"px")});var n=document.body.style.paddingRight,r=Yt(document.body).css("padding-right");Yt(document.body).data("padding-right",n).css("padding-right",parseFloat(r)+this._scrollbarWidth+"px")}},e._resetScrollbar=function(){var t=[].slice.call(document.querySelectorAll(ue));Yt(t).each(function(t,e){var i=Yt(e).data("padding-right");Yt(e).removeData("padding-right"),e.style.paddingRight=i||""});var e=[].slice.call(document.querySelectorAll(""+de));Yt(e).each(function(t,e){var i=Yt(e).data("margin-right");void 0!==i&&Yt(e).css("margin-right",i).removeData("margin-right")});var i=Yt(document.body).data("padding-right");Yt(document.body).removeData("padding-right"),document.body.style.paddingRight=i||""},e._getScrollbarWidth=function(){var t=document.createElement("div");t.className=ne,document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},t._jQueryInterface=function(e,i){return this.each(function(){var n=Yt(this).data(Kt),r=o({},te,Yt(this).data(),"object"==typeof e&&e?e:{});if(n||(n=new t(this,r),Yt(this).data(Kt,n)),"string"==typeof e){if(void 0===n[e])throw new TypeError('No method named "'+e+'"');n[e](i)}else r.show&&n.show(i)})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return te}}]),t}(),Yt(document).on(ie.CLICK_DATA_API,he,function(t){var e,i=this,n=Ai.getSelectorFromElement(this);n&&(e=document.querySelector(n));var r=Yt(e).data(Kt)?"toggle":o({},Yt(e).data(),Yt(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault();var s=Yt(e).one(ie.SHOW,function(t){t.isDefaultPrevented()||s.one(ie.HIDDEN,function(){Yt(i).is(":visible")&&i.focus()})});pe._jQueryInterface.call(Yt(e),r,this)}),Yt.fn[$t]=pe._jQueryInterface,Yt.fn[$t].Constructor=pe,Yt.fn[$t].noConflict=function(){return Yt.fn[$t]=Jt,pe._jQueryInterface},pe),Fi=(me="tooltip",ve="."+(ge="bs.tooltip"),_e=(fe=e).fn[me],ye="bs-tooltip",be=new RegExp("(^|\\s)"+ye+"\\S+","g"),xe={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!(Se={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"}),selector:!(we={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)"}),placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent"},Ee="out",Pe={HIDE:"hide"+ve,HIDDEN:"hidden"+ve,SHOW:(Te="show")+ve,SHOWN:"shown"+ve,INSERTED:"inserted"+ve,CLICK:"click"+ve,FOCUSIN:"focusin"+ve,FOCUSOUT:"focusout"+ve,MOUSEENTER:"mouseenter"+ve,MOUSELEAVE:"mouseleave"+ve},Ce="fade",Le="show",ke=".tooltip-inner",".arrow",Ae="hover",Re="focus","click","manual",Ie=function(){function t(t,e){if(void 0===i)throw new TypeError("Bootstrap tooltips require Popper.js (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var e=t.prototype;return e.enable=function(){this._isEnabled=!0},e.disable=function(){this._isEnabled=!1},e.toggleEnabled=function(){this._isEnabled=!this._isEnabled},e.toggle=function(t){if(this._isEnabled)if(t){var e=this.constructor.DATA_KEY,i=fe(t.currentTarget).data(e);i||(i=new this.constructor(t.currentTarget,this._getDelegateConfig()),fe(t.currentTarget).data(e,i)),i._activeTrigger.click=!i._activeTrigger.click,i._isWithActiveTrigger()?i._enter(null,i):i._leave(null,i)}else{if(fe(this.getTipElement()).hasClass(Le))return void this._leave(null,this);this._enter(null,this)}},e.dispose=function(){clearTimeout(this._timeout),fe.removeData(this.element,this.constructor.DATA_KEY),fe(this.element).off(this.constructor.EVENT_KEY),fe(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&fe(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,(this._activeTrigger=null)!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},e.show=function(){var t=this;if("none"===fe(this.element).css("display"))throw new Error("Please use show on visible elements");var e=fe.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){fe(this.element).trigger(e);var n=fe.contains(this.element.ownerDocument.documentElement,this.element);if(e.isDefaultPrevented()||!n)return;var r=this.getTipElement(),o=Ai.getUID(this.constructor.NAME);r.setAttribute("id",o),this.element.setAttribute("aria-describedby",o),this.setContent(),this.config.animation&&fe(r).addClass(Ce);var s="function"==typeof this.config.placement?this.config.placement.call(this,r,this.element):this.config.placement,a=this._getAttachment(s);this.addAttachmentClass(a);var l=!1===this.config.container?document.body:fe(document).find(this.config.container);fe(r).data(this.constructor.DATA_KEY,this),fe.contains(this.element.ownerDocument.documentElement,this.tip)||fe(r).appendTo(l),fe(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new i(this.element,r,{placement:a,modifiers:{offset:{offset:this.config.offset},flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(e){e.originalPlacement!==e.placement&&t._handlePopperPlacementChange(e)},onUpdate:function(e){t._handlePopperPlacementChange(e)}}),fe(r).addClass(Le),"ontouchstart"in document.documentElement&&fe(document.body).children().on("mouseover",null,fe.noop);var h=function(){t.config.animation&&t._fixTransition();var e=t._hoverState;t._hoverState=null,fe(t.element).trigger(t.constructor.Event.SHOWN),e===Ee&&t._leave(null,t)};if(fe(this.tip).hasClass(Ce)){var c=Ai.getTransitionDurationFromElement(this.tip);fe(this.tip).one(Ai.TRANSITION_END,h).emulateTransitionEnd(c)}else h()}},e.hide=function(t){var e=this,i=this.getTipElement(),n=fe.Event(this.constructor.Event.HIDE),r=function(){e._hoverState!==Te&&i.parentNode&&i.parentNode.removeChild(i),e._cleanTipClass(),e.element.removeAttribute("aria-describedby"),fe(e.element).trigger(e.constructor.Event.HIDDEN),null!==e._popper&&e._popper.destroy(),t&&t()};if(fe(this.element).trigger(n),!n.isDefaultPrevented()){if(fe(i).removeClass(Le),"ontouchstart"in document.documentElement&&fe(document.body).children().off("mouseover",null,fe.noop),this._activeTrigger.click=!1,this._activeTrigger[Re]=!1,this._activeTrigger[Ae]=!1,fe(this.tip).hasClass(Ce)){var o=Ai.getTransitionDurationFromElement(i);fe(i).one(Ai.TRANSITION_END,r).emulateTransitionEnd(o)}else r();this._hoverState=""}},e.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},e.isWithContent=function(){return Boolean(this.getTitle())},e.addAttachmentClass=function(t){fe(this.getTipElement()).addClass(ye+"-"+t)},e.getTipElement=function(){return this.tip=this.tip||fe(this.config.template)[0],this.tip},e.setContent=function(){var t=this.getTipElement();this.setElementContent(fe(t.querySelectorAll(ke)),this.getTitle()),fe(t).removeClass(Ce+" "+Le)},e.setElementContent=function(t,e){var i=this.config.html;"object"==typeof e&&(e.nodeType||e.jquery)?i?fe(e).parent().is(t)||t.empty().append(e):t.text(fe(e).text()):t[i?"html":"text"](e)},e.getTitle=function(){var t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t},e._getAttachment=function(t){return Se[t.toUpperCase()]},e._setListeners=function(){var t=this;this.config.trigger.split(" ").forEach(function(e){if("click"===e)fe(t.element).on(t.constructor.Event.CLICK,t.config.selector,function(e){return t.toggle(e)});else if("manual"!==e){var i=e===Ae?t.constructor.Event.MOUSEENTER:t.constructor.Event.FOCUSIN,n=e===Ae?t.constructor.Event.MOUSELEAVE:t.constructor.Event.FOCUSOUT;fe(t.element).on(i,t.config.selector,function(e){return t._enter(e)}).on(n,t.config.selector,function(e){return t._leave(e)})}fe(t.element).closest(".modal").on("hide.bs.modal",function(){return t.hide()})}),this.config.selector?this.config=o({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},e._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},e._enter=function(t,e){var i=this.constructor.DATA_KEY;(e=e||fe(t.currentTarget).data(i))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),fe(t.currentTarget).data(i,e)),t&&(e._activeTrigger["focusin"===t.type?Re:Ae]=!0),fe(e.getTipElement()).hasClass(Le)||e._hoverState===Te?e._hoverState=Te:(clearTimeout(e._timeout),e._hoverState=Te,e.config.delay&&e.config.delay.show?e._timeout=setTimeout(function(){e._hoverState===Te&&e.show()},e.config.delay.show):e.show())},e._leave=function(t,e){var i=this.constructor.DATA_KEY;(e=e||fe(t.currentTarget).data(i))||(e=new this.constructor(t.currentTarget,this._getDelegateConfig()),fe(t.currentTarget).data(i,e)),t&&(e._activeTrigger["focusout"===t.type?Re:Ae]=!1),e._isWithActiveTrigger()||(clearTimeout(e._timeout),e._hoverState=Ee,e.config.delay&&e.config.delay.hide?e._timeout=setTimeout(function(){e._hoverState===Ee&&e.hide()},e.config.delay.hide):e.hide())},e._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},e._getConfig=function(t){return"number"==typeof(t=o({},this.constructor.Default,fe(this.element).data(),"object"==typeof t&&t?t:{})).delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),Ai.typeCheckConfig(me,t,this.constructor.DefaultType),t},e._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},e._cleanTipClass=function(){var t=fe(this.getTipElement()),e=t.attr("class").match(be);null!==e&&e.length&&t.removeClass(e.join(""))},e._handlePopperPlacementChange=function(t){var e=t.instance;this.tip=e.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},e._fixTransition=function(){var t=this.getTipElement(),e=this.config.animation;null===t.getAttribute("x-placement")&&(fe(t).removeClass(Ce),this.config.animation=!1,this.hide(),this.show(),this.config.animation=e)},t._jQueryInterface=function(e){return this.each(function(){var i=fe(this).data(ge),n="object"==typeof e&&e;if((i||!/dispose|hide/.test(e))&&(i||(i=new t(this,n),fe(this).data(ge,i)),"string"==typeof e)){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return xe}},{key:"NAME",get:function(){return me}},{key:"DATA_KEY",get:function(){return ge}},{key:"Event",get:function(){return Pe}},{key:"EVENT_KEY",get:function(){return ve}},{key:"DefaultType",get:function(){return we}}]),t}(),fe.fn[me]=Ie._jQueryInterface,fe.fn[me].Constructor=Ie,fe.fn[me].noConflict=function(){return fe.fn[me]=_e,Ie._jQueryInterface},Ie),Ni=(Me="popover",ze="."+(De="bs.popover"),Fe=(Oe=e).fn[Me],Ne="bs-popover",Be=new RegExp("(^|\\s)"+Ne+"\\S+","g"),je=o({},Fi.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),He=o({},Fi.DefaultType,{content:"(string|element|function)"}),"fade",Ue=".popover-header",qe=".popover-body",We={HIDE:"hide"+ze,HIDDEN:"hidden"+ze,SHOW:"show"+ze,SHOWN:"shown"+ze,INSERTED:"inserted"+ze,CLICK:"click"+ze,FOCUSIN:"focusin"+ze,FOCUSOUT:"focusout"+ze,MOUSEENTER:"mouseenter"+ze,MOUSELEAVE:"mouseleave"+ze},Ge=function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),(e.prototype.constructor=e).__proto__=i;var o=n.prototype;return o.isWithContent=function(){return this.getTitle()||this._getContent()},o.addAttachmentClass=function(t){Oe(this.getTipElement()).addClass(Ne+"-"+t)},o.getTipElement=function(){return this.tip=this.tip||Oe(this.config.template)[0],this.tip},o.setContent=function(){var t=Oe(this.getTipElement());this.setElementContent(t.find(Ue),this.getTitle());var e=this._getContent();"function"==typeof e&&(e=e.call(this.element)),this.setElementContent(t.find(qe),e),t.removeClass("fade show")},o._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},o._cleanTipClass=function(){var t=Oe(this.getTipElement()),e=t.attr("class").match(Be);null!==e&&0<e.length&&t.removeClass(e.join(""))},n._jQueryInterface=function(t){return this.each(function(){var e=Oe(this).data(De),i="object"==typeof t?t:null;if((e||!/destroy|hide/.test(t))&&(e||(e=new n(this,i),Oe(this).data(De,e)),"string"==typeof t)){if(void 0===e[t])throw new TypeError('No method named "'+t+'"');e[t]()}})},r(n,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return je}},{key:"NAME",get:function(){return Me}},{key:"DATA_KEY",get:function(){return De}},{key:"Event",get:function(){return We}},{key:"EVENT_KEY",get:function(){return ze}},{key:"DefaultType",get:function(){return He}}]),n}(Fi),Oe.fn[Me]=Ge._jQueryInterface,Oe.fn[Me].Constructor=Ge,Oe.fn[Me].noConflict=function(){return Oe.fn[Me]=Fe,Ge._jQueryInterface},Ge),Bi=(Ze="scrollspy",Ye="."+(Xe="bs.scrollspy"),$e=(Ve=e).fn[Ze],Ke={offset:10,method:"auto",target:""},Qe={offset:"number",method:"string",target:"(string|element)"},Je={ACTIVATE:"activate"+Ye,SCROLL:"scroll"+Ye,LOAD_DATA_API:"load"+Ye+".data-api"},ti="dropdown-item",ei="active",ii='[data-spy="scroll"]',ni=".active",ri=".nav, .list-group",oi=".nav-link",si=".nav-item",ai=".list-group-item",li=".dropdown",hi=".dropdown-item",ci=".dropdown-toggle","offset",ui="position",di=function(){function t(t,e){var i=this;this._element=t,this._scrollElement="BODY"===t.tagName?window:t,this._config=this._getConfig(e),this._selector=this._config.target+" "+oi+","+this._config.target+" "+ai+","+this._config.target+" "+hi,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,Ve(this._scrollElement).on(Je.SCROLL,function(t){return i._process(t)}),this.refresh(),this._process()}var e=t.prototype;return e.refresh=function(){var t=this,e=this._scrollElement===this._scrollElement.window?"offset":ui,i="auto"===this._config.method?e:this._config.method,n=i===ui?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(t){var e,r=Ai.getSelectorFromElement(t);if(r&&(e=document.querySelector(r)),e){var o=e.getBoundingClientRect();if(o.width||o.height)return[Ve(e)[i]().top+n,r]}return null}).filter(function(t){return t}).sort(function(t,e){return t[0]-e[0]}).forEach(function(e){t._offsets.push(e[0]),t._targets.push(e[1])})},e.dispose=function(){Ve.removeData(this._element,Xe),Ve(this._scrollElement).off(Ye),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},e._getConfig=function(t){if("string"!=typeof(t=o({},Ke,"object"==typeof t&&t?t:{})).target){var e=Ve(t.target).attr("id");e||(e=Ai.getUID(Ze),Ve(t.target).attr("id",e)),t.target="#"+e}return Ai.typeCheckConfig(Ze,t,Qe),t},e._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},e._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},e._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},e._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),i=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),i<=t){var n=this._targets[this._targets.length-1];this._activeTarget!==n&&this._activate(n)}else{if(this._activeTarget&&t<this._offsets[0]&&0<this._offsets[0])return this._activeTarget=null,void this._clear();for(var r=this._offsets.length;r--;)this._activeTarget!==this._targets[r]&&t>=this._offsets[r]&&(void 0===this._offsets[r+1]||t<this._offsets[r+1])&&this._activate(this._targets[r])}},e._activate=function(t){this._activeTarget=t,this._clear();var e=this._selector.split(",");e=e.map(function(e){return e+'[data-target="'+t+'"],'+e+'[href="'+t+'"]'});var i=Ve([].slice.call(document.querySelectorAll(e.join(","))));i.hasClass(ti)?(i.closest(li).find(ci).addClass(ei),i.addClass(ei)):(i.addClass(ei),i.parents(ri).prev(oi+", "+ai).addClass(ei),i.parents(ri).prev(si).children(oi).addClass(ei)),Ve(this._scrollElement).trigger(Je.ACTIVATE,{relatedTarget:t})},e._clear=function(){var t=[].slice.call(document.querySelectorAll(this._selector));Ve(t).filter(ni).removeClass(ei)},t._jQueryInterface=function(e){return this.each(function(){var i=Ve(this).data(Xe);if(i||(i=new t(this,"object"==typeof e&&e),Ve(this).data(Xe,i)),"string"==typeof e){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}},{key:"Default",get:function(){return Ke}}]),t}(),Ve(window).on(Je.LOAD_DATA_API,function(){for(var t=[].slice.call(document.querySelectorAll(ii)),e=t.length;e--;){var i=Ve(t[e]);di._jQueryInterface.call(i,i.data())}}),Ve.fn[Ze]=di._jQueryInterface,Ve.fn[Ze].Constructor=di,Ve.fn[Ze].noConflict=function(){return Ve.fn[Ze]=$e,di._jQueryInterface},di),ji=(mi="."+(fi="bs.tab"),gi=(pi=e).fn.tab,vi={HIDE:"hide"+mi,HIDDEN:"hidden"+mi,SHOW:"show"+mi,SHOWN:"shown"+mi,CLICK_DATA_API:"click"+mi+".data-api"},_i="dropdown-menu",yi="active",bi="disabled","fade",wi="show",Si=".dropdown",xi=".nav, .list-group",Ti=".active",Ei="> li > .active",Pi='[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',Ci=".dropdown-toggle",Li="> .dropdown-menu .active",ki=function(){function t(t){this._element=t}var e=t.prototype;return e.show=function(){var t=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&pi(this._element).hasClass(yi)||pi(this._element).hasClass(bi))){var e,i,n=pi(this._element).closest(xi)[0],r=Ai.getSelectorFromElement(this._element);if(n){var o="UL"===n.nodeName?Ei:Ti;i=(i=pi.makeArray(pi(n).find(o)))[i.length-1]}var s=pi.Event(vi.HIDE,{relatedTarget:this._element}),a=pi.Event(vi.SHOW,{relatedTarget:i});if(i&&pi(i).trigger(s),pi(this._element).trigger(a),!a.isDefaultPrevented()&&!s.isDefaultPrevented()){r&&(e=document.querySelector(r)),this._activate(this._element,n);var l=function(){var e=pi.Event(vi.HIDDEN,{relatedTarget:t._element}),n=pi.Event(vi.SHOWN,{relatedTarget:i});pi(i).trigger(e),pi(t._element).trigger(n)};e?this._activate(e,e.parentNode,l):l()}}},e.dispose=function(){pi.removeData(this._element,fi),this._element=null},e._activate=function(t,e,i){var n=this,r=("UL"===e.nodeName?pi(e).find(Ei):pi(e).children(Ti))[0],o=i&&r&&pi(r).hasClass("fade"),s=function(){return n._transitionComplete(t,r,i)};if(r&&o){var a=Ai.getTransitionDurationFromElement(r);pi(r).one(Ai.TRANSITION_END,s).emulateTransitionEnd(a)}else s()},e._transitionComplete=function(t,e,i){if(e){pi(e).removeClass(wi+" "+yi);var n=pi(e.parentNode).find(Li)[0];n&&pi(n).removeClass(yi),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!1)}if(pi(t).addClass(yi),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),Ai.reflow(t),pi(t).addClass(wi),t.parentNode&&pi(t.parentNode).hasClass(_i)){var r=pi(t).closest(Si)[0];if(r){var o=[].slice.call(r.querySelectorAll(Ci));pi(o).addClass(yi)}t.setAttribute("aria-expanded",!0)}i&&i()},t._jQueryInterface=function(e){return this.each(function(){var i=pi(this),n=i.data(fi);if(n||(n=new t(this),i.data(fi,n)),"string"==typeof e){if(void 0===n[e])throw new TypeError('No method named "'+e+'"');n[e]()}})},r(t,null,[{key:"VERSION",get:function(){return"4.1.3"}}]),t}(),pi(document).on(vi.CLICK_DATA_API,Pi,function(t){t.preventDefault(),ki._jQueryInterface.call(pi(this),"show")}),pi.fn.tab=ki._jQueryInterface,pi.fn.tab.Constructor=ki,pi.fn.tab.noConflict=function(){return pi.fn.tab=gi,ki._jQueryInterface},ki);!function(t){if(void 0===t)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||4<=e[0])throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}(e),t.Util=Ai,t.Alert=Ri,t.Button=Ii,t.Carousel=Oi,t.Collapse=Mi,t.Dropdown=Di,t.Modal=zi,t.Popover=Ni,t.Scrollspy=Bi,t.Tab=ji,t.Tooltip=Fi,Object.defineProperty(t,"__esModule",{value:!0})}),function(t){t.version={versionStr:"2.4.0",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("0",10)};var e,i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},n=Object.prototype.toString,r=Object.prototype.hasOwnProperty;t.isFunction=function(e){return"function"===t.type(e)},t.isArray=Array.isArray||function(e){return"array"===t.type(e)},t.isWindow=function(t){return t&&"object"==typeof t&&"setInterval"in t},t.type=function(t){return null===t||void 0===t?String(t):i[n.call(t)]||"object"},t.isPlainObject=function(e){if(!e||"object"!==OpenSeadragon.type(e)||e.nodeType||t.isWindow(e))return!1;if(e.constructor&&!r.call(e,"constructor")&&!r.call(e.constructor.prototype,"isPrototypeOf"))return!1;var i;for(var n in e)i=n;return void 0===i||r.call(e,i)},t.isEmptyObject=function(t){for(var e in t)return!1;return!0},t.freezeObject=function(e){return Object.freeze?t.freezeObject=Object.freeze:t.freezeObject=function(t){return t},t.freezeObject(e)},t.supportsCanvas=(e=document.createElement("canvas"),!(!t.isFunction(e.getContext)||!e.getContext("2d"))),t.isCanvasTainted=function(t){var e=!1;try{t.getContext("2d").getImageData(0,0,1,1)}catch(t){e=!0}return e},t.pixelDensityRatio=function(){if(t.supportsCanvas){var e=document.createElement("canvas").getContext("2d"),i=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return Math.max(i,1)/n}return 1}()}(OpenSeadragon),function($){$.extend=function(){var t,e,i,n,r,o,s=arguments[0]||{},a=arguments.length,l=!1,h=1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},h=2),"object"==typeof s||OpenSeadragon.isFunction(s)||(s={}),a===h&&(s=this,--h);h<a;h++)if(null!==(t=arguments[h])||void 0!==t)for(e in t)i=s[e],s!==(n=t[e])&&(l&&n&&(OpenSeadragon.isPlainObject(n)||(r=OpenSeadragon.isArray(n)))?(r?(r=!1,o=i&&OpenSeadragon.isArray(i)?i:[]):o=i&&OpenSeadragon.isPlainObject(i)?i:{},s[e]=OpenSeadragon.extend(l,o,n)):void 0!==n&&(s[e]=n));return s};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var t=navigator.userAgent;return"string"==typeof t&&(-1!==t.indexOf("iPhone")||-1!==t.indexOf("iPad")||-1!==t.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(t,e){return function(){var i=arguments;return void 0===i&&(i=[]),e.apply(t,i)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(t){return"string"==typeof t&&(t=document.getElementById(t)),t},getElementPosition:function(t){var e,i,n=new $.Point;for(i=getOffsetParent(t=$.getElement(t),e="fixed"==$.getElementStyle(t).position);i;)n.x+=t.offsetLeft,n.y+=t.offsetTop,e&&(n=n.plus($.getPageScroll())),i=getOffsetParent(t=i,e="fixed"==$.getElementStyle(t).position);return n},getElementOffset:function(t){var e,i,n=(t=$.getElement(t))&&t.ownerDocument,r={top:0,left:0};return n?(e=n.documentElement,void 0!==t.getBoundingClientRect&&(r=t.getBoundingClientRect()),i=n==n.window?n:9===n.nodeType&&(n.defaultView||n.parentWindow),new $.Point(r.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0),r.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0))):new $.Point},getElementSize:function(t){return t=$.getElement(t),new $.Point(t.clientWidth,t.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(t){return(t=$.getElement(t)).currentStyle}:function(t){return t=$.getElement(t),window.getComputedStyle(t,"")},getCssPropertyWithVendorPrefix:function(t){var e={};return $.getCssPropertyWithVendorPrefix=function(t){if(void 0!==e[t])return e[t];var i=document.createElement("div").style,n=null;if(void 0!==i[t])n=t;else for(var r=["Webkit","Moz","MS","O","webkit","moz","ms","o"],o=$.capitalizeFirstLetter(t),s=0;s<r.length;s++){var a=r[s]+o;if(void 0!==i[a]){n=a;break}}return e[t]=n,n},$.getCssPropertyWithVendorPrefix(t)},capitalizeFirstLetter:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},positiveModulo:function(t,e){var i=t%e;return i<0&&(i+=e),i},pointInElement:function(t,e){t=$.getElement(t);var i=$.getElementOffset(t),n=$.getElementSize(t);return e.x>=i.x&&e.x<i.x+n.x&&e.y<i.y+n.y&&e.y>=i.y},getEvent:function(t){return $.getEvent=t?function(t){return t}:function(){return window.event},$.getEvent(t)},getMousePosition:function(t){if("number"==typeof t.pageX)$.getMousePosition=function(t){var e=new $.Point;return t=$.getEvent(t),e.x=t.pageX,e.y=t.pageY,e};else{if("number"!=typeof t.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(t){var e=new $.Point;return t=$.getEvent(t),e.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,e}}return $.getMousePosition(t)},getPageScroll:function(){var t=document.documentElement||{},e=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(e.scrollLeft||e.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!t.scrollLeft&&!t.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(t){if(void 0!==window.scrollTo)$.setPageScroll=function(t){window.scrollTo(t.x,t.y)};else{var e=$.getPageScroll();if(e.x===t.x&&e.y===t.y)return;document.body.scrollLeft=t.x,document.body.scrollTop=t.y;var i=$.getPageScroll();if(i.x!==e.x&&i.y!==e.y)return void($.setPageScroll=function(t){document.body.scrollLeft=t.x,document.body.scrollTop=t.y});if(document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y,(i=$.getPageScroll()).x!==e.x&&i.y!==e.y)return void($.setPageScroll=function(t){document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y});$.setPageScroll=function(t){}}return $.setPageScroll(t)},getWindowSize:function(){var t=document.documentElement||{},e=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(t.clientWidth||t.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!e.clientWidth&&!e.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(t){t=$.getElement(t);var e=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(e[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(e[1].style,{display:"table-row"}),$.extend(e[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),e[0].appendChild(e[1]),e[1].appendChild(e[2]),e[2].appendChild(t),e[0]},makeNeutralElement:function(t){var e=document.createElement(t),i=e.style;return i.background="transparent none",i.border="none",i.margin="0px",i.padding="0px",i.position="static",e},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(t){return $.makeTransparentImage=function(t){var e=$.makeNeutralElement("img");return e.src=t,e},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(t){var e=$.makeNeutralElement("img"),i=null;return(i=$.makeNeutralElement("span")).style.display="inline-block",e.onload=function(){i.style.width=i.style.width||e.width+"px",i.style.height=i.style.height||e.height+"px",e.onload=null,e=null},e.src=t,i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",i}),$.makeTransparentImage(t)},setElementOpacity:function(t,e,i){var n;t=$.getElement(t),i&&!$.Browser.alpha&&(e=Math.round(e)),$.Browser.opacity?t.style.opacity=e<1?e:"":e<1?(n="alpha(opacity="+Math.round(100*e)+")",t.style.filter=n):t.style.filter=""},setElementTouchActionNone:function(t){void 0!==(t=$.getElement(t)).style.touchAction?t.style.touchAction="none":void 0!==t.style.msTouchAction&&(t.style.msTouchAction="none")},addClass:function(t,e){(t=$.getElement(t)).className?-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=" "+e):t.className=e},indexOf:function(t,e,i){return Array.prototype.indexOf?this.indexOf=function(t,e,i){return t.indexOf(e,i)}:this.indexOf=function(t,e,i){var n,r,o=i||0;if(!t)throw new TypeError;if(0===(r=t.length)||o>=r)return-1;for(o<0&&(o=r-Math.abs(o)),n=o;n<r;n++)if(t[n]===e)return n;return-1},this.indexOf(t,e,i)},removeClass:function(t,e){var i,n,r=[];for(i=(t=$.getElement(t)).className.split(/\s+/),n=0;n<i.length;n++)i[n]&&i[n]!==e&&r.push(i[n]);t.className=r.join(" ")},addEvent:function(){if(window.addEventListener)return function(t,e,i,n){(t=$.getElement(t)).addEventListener(e,i,n)};if(window.attachEvent)return function(t,e,i,n){(t=$.getElement(t)).attachEvent("on"+e,i)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(t,e,i,n){(t=$.getElement(t)).removeEventListener(e,i,n)};if(window.detachEvent)return function(t,e,i,n){(t=$.getElement(t)).detachEvent("on"+e,i)};throw new Error("No known event model.")}(),cancelEvent:function(t){(t=$.getEvent(t)).preventDefault?$.cancelEvent=function(t){t.preventDefault()}:$.cancelEvent=function(t){(t=$.getEvent(t)).cancel=!0,t.returnValue=!1},$.cancelEvent(t)},stopEvent:function(t){(t=$.getEvent(t)).stopPropagation?$.stopEvent=function(t){t.stopPropagation()}:$.stopEvent=function(t){(t=$.getEvent(t)).cancelBubble=!0},$.stopEvent(t)},createCallback:function(t,e){var i,n=[];for(i=2;i<arguments.length;i++)n.push(arguments[i]);return function(){var i,r=n.concat([]);for(i=0;i<arguments.length;i++)r.push(arguments[i]);return e.apply(t,r)}},getUrlParameter:function(t){var e=URLPARAMS[t];return e||null},getUrlProtocol:function(t){var e=t.match(/^([a-z]+:)\/\//i);return null===e?window.location.protocol:e[1].toLowerCase()},createAjaxRequest:function(t){var e;try{e=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}if(e)window.XMLHttpRequest?$.createAjaxRequest=function(t){return t?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(t)},makeAjaxRequest:function(t,e,i){var n,r,o;$.isPlainObject(t)&&(e=t.success,i=t.error,n=t.withCredentials,r=t.headers,o=t.responseType||null,t=t.url);var s=$.getUrlProtocol(t),a=$.createAjaxRequest("file:"===s);if(!$.isFunction(e))throw new Error("makeAjaxRequest requires a success callback");a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=function(){},a.status>=200&&a.status<300||0===a.status&&"http:"!==s&&"https:"!==s?e(a):($.console.log("AJAX request returned %d: %s",a.status,t),$.isFunction(i)&&i(a)))};try{if(a.open("GET",t,!0),o&&(a.responseType=o),r)for(var l in r)r.hasOwnProperty(l)&&r[l]&&a.setRequestHeader(l,r[l]);n&&(a.withCredentials=!0),a.send(null)}catch(n){var h=n.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&void 0!==n.number&&-2147024891==n.number&&(h+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",n.name,h),a.onreadystatechange=function(){},window.XDomainRequest){var c=new XDomainRequest;if(c){c.onload=function(t){$.isFunction(e)&&e({responseText:c.responseText,status:200,statusText:"OK"})},c.onerror=function(t){$.isFunction(i)&&i({responseText:c.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{c.open("GET",t),c.send()}catch(t){$.isFunction(i)&&i(a,n)}}}else $.isFunction(i)&&i(a,n)}return a},jsonp:function(t){var e,i=t.url,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=t.callbackName||"openseadragon"+$.now(),o=window[r],s="$1"+r+"$2",a=t.param||"callback",l=t.callback;i=i.replace(/(\=)\?(&|$)|\?\?/i,s),i+=(/\?/.test(i)?"&":"?")+a+"="+r,window[r]=function(t){if(o)window[r]=o;else try{delete window[r]}catch(t){}l&&$.isFunction(l)&&l(t)},e=document.createElement("script"),void 0===t.async&&!1===t.async||(e.async="async"),t.scriptCharset&&(e.charset=t.scriptCharset),e.src=i,e.onload=e.onreadystatechange=function(t,i){(i||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,n&&e.parentNode&&n.removeChild(e),e=void 0)},n.insertBefore(e,n.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(t){if(window.DOMParser)$.parseXml=function(t){return(new DOMParser).parseFromString(t,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(t){var e=null;return(e=new ActiveXObject("Microsoft.XMLDOM")).async=!1,e.loadXML(t),e}}return $.parseXml(t)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(t){return!!FILEFORMATS[(t=t||"").toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var t=navigator.appVersion,e=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(e.substring(e.indexOf("MSIE")+5,e.indexOf(";",e.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(e.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(e.substring(e.indexOf("Firefox")+8))):e.indexOf("Safari")>=0?($.Browser.vendor=e.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(e.substring(e.substring(0,e.indexOf("Safari")).lastIndexOf("/")+1,e.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(e)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(t)}var i,n,r,o=window.location.search.substring(1).split("&");for(r=0;r<o.length;r++)(n=(i=o[r]).indexOf("="))>0&&(URLPARAMS[i.substring(0,n)]=decodeURIComponent(i.substring(n+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(t){};function getOffsetParent(t,e){return e&&t!=document.body?document.body:t.offsetParent}$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(t){var e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame;if(e&&i)$.requestAnimationFrame=function(){return e.apply(t,arguments)},$.cancelAnimationFrame=function(){return i.apply(t,arguments)};else{var n,r=[],o=[],s=0;$.requestAnimationFrame=function(t){return r.push([++s,t]),n||(n=setInterval(function(){if(r.length){var t=$.now(),e=o;for(o=r,r=e;o.length;)o.shift()[1](t)}else clearInterval(n),n=void 0},20)),s},$.cancelAnimationFrame=function(t){var e,i;for(e=0,i=r.length;e<i;e+=1)if(r[e][0]===t)return void r.splice(e,1);for(e=0,i=o.length;e<i;e+=1)if(o[e][0]===t)return void o.splice(e,1)}}}(window)}(OpenSeadragon),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.OpenSeadragon=e()}(this,function(){return OpenSeadragon}),function(t){var e={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.fullscreenElement},e.requestFullScreen=function(t){return t.requestFullscreen()},e.exitFullScreen=function(){document.exitFullscreen()},e.fullScreenEventName="fullscreenchange",e.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.msFullscreenElement},e.requestFullScreen=function(t){return t.msRequestFullscreen()},e.exitFullScreen=function(){document.msExitFullscreen()},e.fullScreenEventName="MSFullscreenChange",e.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.webkitFullscreenElement},e.requestFullScreen=function(t){return t.webkitRequestFullscreen()},e.exitFullScreen=function(){document.webkitExitFullscreen()},e.fullScreenEventName="webkitfullscreenchange",e.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},e.requestFullScreen=function(t){return t.webkitRequestFullScreen()},e.exitFullScreen=function(){document.webkitCancelFullScreen()},e.fullScreenEventName="webkitfullscreenchange",e.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(e.supportsFullScreen=!0,e.getFullScreenElement=function(){return document.mozFullScreenElement},e.requestFullScreen=function(t){return t.mozRequestFullScreen()},e.exitFullScreen=function(){document.mozCancelFullScreen()},e.fullScreenEventName="mozfullscreenchange",e.fullScreenErrorEventName="mozfullscreenerror"),e.isFullScreen=function(){return null!==e.getFullScreenElement()},e.cancelFullScreen=function(){t.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),e.exitFullScreen()},t.extend(t,e)}(OpenSeadragon),function(t){t.EventSource=function(){this.events={}},t.EventSource.prototype={addOnceHandler:function(t,e,i,n){var r=this;n=n||1;var o=0,s=function(i){++o===n&&r.removeHandler(t,s),e(i)};this.addHandler(t,s,i)},addHandler:function(e,i,n){var r=this.events[e];r||(this.events[e]=r=[]),i&&t.isFunction(i)&&(r[r.length]={handler:i,userData:n||null})},removeHandler:function(e,i){var n,r=this.events[e],o=[];if(r&&t.isArray(r)){for(n=0;n<r.length;n++)r[n].handler!==i&&o.push(r[n]);this.events[e]=o}},removeAllHandlers:function(t){if(t)this.events[t]=[];else for(var e in this.events)this.events[e]=[]},getHandler:function(t){var e=this.events[t];return e&&e.length?(e=1===e.length?[e[0]]:Array.apply(null,e),function(t,i){var n,r=e.length;for(n=0;n<r;n++)e[n]&&(i.eventSource=t,i.userData=e[n].userData,e[n].handler(i))}):null},raiseEvent:function(t,e){var i=this.getHandler(t);i&&(e||(e={}),i(this,e))}}}(OpenSeadragon),function(t){var e,i,n,r,o,s,a=[],l={};function h(e){var i,n=l[e.hash],r=n.activePointersLists.length;for(i=0;i<r;i++)n.activePointersLists[i].captureCount>0&&(t.removeEvent(t.MouseTracker.captureElement,"mousemove",n.mousemovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"mouseup",n.mouseupcaptured,!0),t.removeEvent(t.MouseTracker.captureElement,t.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",n.pointermovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,t.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",n.pointerupcaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"touchmove",n.touchmovecaptured,!0),t.removeEvent(t.MouseTracker.captureElement,"touchend",n.touchendcaptured,!0),n.activePointersLists[i].captureCount=0);for(i=0;i<r;i++)n.activePointersLists.pop()}function c(e){var i,n,r=l[e.hash];if(r.tracking){for(n=0;n<t.MouseTracker.subscribeEvents.length;n++)i=t.MouseTracker.subscribeEvents[n],t.removeEvent(e.element,i,r[i],!1);h(e),r.tracking=!1}}function u(e,i){var n=l[e.hash];if("pointerevent"===i)return{upName:t.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:n.pointerupcaptured,moveName:t.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:n.pointermovecaptured};if("mouse"===i)return{upName:"mouseup",upHandler:n.mouseupcaptured,moveName:"mousemove",moveHandler:n.mousemovecaptured};if("touch"===i)return{upName:"touchend",upHandler:n.touchendcaptured,moveName:"touchmove",moveHandler:n.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function d(e,i,n){var r,o=e.getActivePointersListByType(i);o.captureCount+=n||1,1===o.captureCount&&(t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?e.element.setCapture(!0):(r=u(e,t.MouseTracker.havePointerEvents?"pointerevent":i),G&&V(window.top)&&t.addEvent(window.top,r.upName,r.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,r.upName,r.upHandler,!0),t.addEvent(t.MouseTracker.captureElement,r.moveName,r.moveHandler,!0)))}function p(e,i,n){var r,o=e.getActivePointersListByType(i);o.captureCount-=n||1,0===o.captureCount&&(t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?e.element.releaseCapture():(r=u(e,t.MouseTracker.havePointerEvents?"pointerevent":i),G&&V(window.top)&&t.removeEvent(window.top,r.upName,r.upHandler,!0),t.removeEvent(t.MouseTracker.captureElement,r.moveName,r.moveHandler,!0),t.removeEvent(t.MouseTracker.captureElement,r.upName,r.upHandler,!0)))}function f(e){var i;if(t.MouseTracker.unprefixedPointerEvents)i=e.pointerType;else switch(e.pointerType){case 2:i="touch";break;case 3:i="pen";break;case 4:i="mouse";break;default:i=""}return i}function m(e){return t.getMousePosition(e)}function g(t,e){return v(m(t),e)}function v(e,i){var n=t.getElementOffset(i);return e.minus(n)}function _(e,i){return new t.Point((e.x+i.x)/2,(e.y+i.y)/2)}function y(e,i){var n={target:(i=t.getEvent(i)).target||i.srcElement,type:"wheel",shiftKey:i.shiftKey||!1,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX?i.pageX:i.clientX,pageY:i.pageY?i.pageY:i.clientY,deltaMode:"MozMousePixelScroll"==i.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==t.MouseTracker.wheelEventName?n.deltaY=-i.wheelDelta/t.DEFAULT_SETTINGS.pixelsPerWheelLine:n.deltaY=i.detail,b(e,n,i)}function b(e,i,n){var r;r=i.deltaY<0?1:-1,e.scrollHandler&&!1===e.scrollHandler({eventSource:e,pointerType:"mouse",position:g(i,e.element),scroll:r,shift:i.shiftKey,isTouchEvent:!1,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(n)}function w(t,e){if(t===e)return!1;for(;e&&e!==t;)e=e.parentNode;return e===t}function S(e,i){j(e,i,[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:m(i),currentTime:t.now()}])}function x(e,i){H(e,i,[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:m(i),currentTime:t.now()}])}function T(e){return t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?1===e?0:2===e?2:4===e?1:-1:e}function E(e,i){q(e,i=t.getEvent(i),[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:m(i),currentTime:t.now()}],T(i.button))&&p(e,"mouse")}function P(e,i){W(e,i=t.getEvent(i),[{id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:m(i),currentTime:t.now()}])}function C(t,e,i){var n,r=i.getLength(),o=[];if("touch"===i.type||i.contacts>0){for(n=0;n<r;n++)o.push(i.getByIndex(n));o.length>0&&(q(t,e,o,0),i.captureCount=1,p(t,i.type),H(t,e,o))}}function L(e,i){var n,r,o,s,l=i.changedTouches.length,h=[];for(n=t.now(),r=0;r<l;r++)h.push({id:i.changedTouches[r].identifier,type:"touch",currentPos:m(i.changedTouches[r]),currentTime:n});for(q(e,i,h,0)&&p(e,"touch",l),H(e,i,h),r=0;r<a.length;r++)if(a[r]!==e&&a[r].isTracking()&&w(a[r].element,e.element)){for(s=[],o=0;o<l;o++)s.push({id:i.changedTouches[o].identifier,type:"touch",currentPos:m(i.changedTouches[o]),currentTime:n});H(a[r],i,s)}t.cancelEvent(i)}function k(e,i){var n,r=i.changedTouches.length,o=[];for(n=0;n<r;n++)o.push({id:i.changedTouches[n].identifier,type:"touch",currentPos:m(i.changedTouches[n]),currentTime:t.now()});W(e,i,o),t.cancelEvent(i)}function A(e,i){i.currentTarget===i.relatedTarget||w(i.currentTarget,i.relatedTarget)||j(e,i,[{id:i.pointerId,type:f(i),isPrimary:i.isPrimary,currentPos:m(i),currentTime:t.now()}])}function R(e,i){i.currentTarget===i.relatedTarget||w(i.currentTarget,i.relatedTarget)||H(e,i,[{id:i.pointerId,type:f(i),isPrimary:i.isPrimary,currentPos:m(i),currentTime:t.now()}])}function I(e,i){var n;U(e,i,[n={id:i.pointerId,type:f(i),isPrimary:i.isPrimary,currentPos:m(i),currentTime:t.now()}],i.button)&&(t.stopEvent(i),d(e,n.type)),(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.cancelEvent(i)}function O(t,e){M(t,e)}function M(e,i){var n;q(e,i,[n={id:i.pointerId,type:f(i),isPrimary:i.isPrimary,currentPos:m(i),currentTime:t.now()}],i.button)&&p(e,n.type)}function D(t,e){z(t,e)}function z(e,i){W(e,i,[{id:i.pointerId,type:f(i),isPrimary:i.isPrimary,currentPos:m(i),currentTime:t.now()}])}function F(t,e){!function(t,e,i){q(t,e,i,0),H(t,e,i)}(t,e,[{id:e.pointerId,type:f(e)}])}function N(t,e){return e.hasOwnProperty("isPrimary")||(0===t.getLength()?e.isPrimary=!0:e.isPrimary=!1),e.speed=0,e.direction=0,e.contactPos=e.currentPos,e.contactTime=e.currentTime,e.lastPos=e.currentPos,e.lastTime=e.currentTime,t.add(e)}function B(t,e){var i,n;return t.getById(e.id)?(i=t.removeById(e.id),e.hasOwnProperty("isPrimary")||(n=t.getPrimary())||(n=t.getByIndex(0))&&(n.isPrimary=!0)):i=t.getLength(),i}function j(e,i,n){var r,o,s,a=e.getActivePointersListByType(n[0].type),l=n.length;for(r=0;r<l;r++)o=n[r],(s=a.getById(o.id))?(s.insideElement=!0,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=o.currentPos,s.currentTime=o.currentTime,o=s):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,N(a,o)),e.enterHandler&&!1===e.enterHandler({eventSource:e,pointerType:o.type,position:v(o.currentPos,e.element),buttons:a.buttons,pointers:e.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==a.buttons,isTouchEvent:"touch"===o.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)}function H(e,i,n){var r,o,s,a=e.getActivePointersListByType(n[0].type),l=n.length;for(r=0;r<l;r++)o=n[r],(s=a.getById(o.id))&&(s.captured?(s.insideElement=!1,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=o.currentPos,s.currentTime=o.currentTime):B(a,s),o=s),e.exitHandler&&!1===e.exitHandler({eventSource:e,pointerType:o.type,position:v(o.currentPos,e.element),buttons:a.buttons,pointers:e.getActivePointerCount(),insideElementPressed:!!s&&s.insideElementPressed,buttonDownAny:0!==a.buttons,isTouchEvent:"touch"===o.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)}function U(e,i,n,r){var o,s,a,h=l[e.hash],c=e.getActivePointersListByType(n[0].type),u=n.length;void 0!==i.buttons?c.buttons=i.buttons:t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?0===r?c.buttons+=1:1===r?c.buttons+=4:2===r?c.buttons+=2:3===r?c.buttons+=8:4===r?c.buttons+=16:5===r&&(c.buttons+=32):0===r?c.buttons|=1:1===r?c.buttons|=4:2===r?c.buttons|=2:3===r?c.buttons|=8:4===r?c.buttons|=16:5===r&&(c.buttons|=32);var d=e.getActivePointersListsExceptType(n[0].type);for(o=0;o<d.length;o++)C(e,i,d[o]);if(0!==r)return e.nonPrimaryPressHandler&&!1===e.nonPrimaryPressHandler({eventSource:e,pointerType:n[0].type,position:v(n[0].currentPos,e.element),button:r,buttons:c.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),!1;for(o=0;o<u;o++)s=n[o],(a=c.getById(s.id))?(a.captured=!0,a.insideElementPressed=!0,a.insideElement=!0,a.contactPos=s.currentPos,a.contactTime=s.currentTime,a.lastPos=a.currentPos,a.lastTime=a.currentTime,a.currentPos=s.currentPos,a.currentTime=s.currentTime,s=a):(s.captured=!0,s.insideElementPressed=!0,s.insideElement=!0,N(c,s)),c.addContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.addPoint(e,s),1===c.contacts?e.pressHandler&&!1===e.pressHandler({eventSource:e,pointerType:s.type,position:v(s.contactPos,e.element),buttons:c.buttons,isTouchEvent:"touch"===s.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i):2===c.contacts&&e.pinchHandler&&"touch"===s.type&&(h.pinchGPoints=c.asArray(),h.lastPinchDist=h.currentPinchDist=h.pinchGPoints[0].currentPos.distanceTo(h.pinchGPoints[1].currentPos),h.lastPinchCenter=h.currentPinchCenter=_(h.pinchGPoints[0].currentPos,h.pinchGPoints[1].currentPos));return!0}function q(e,i,n,r){var o,s,a,h,c,u,d=l[e.hash],p=e.getActivePointersListByType(n[0].type),f=n.length,m=!1,g=!1;if(void 0!==i.buttons?p.buttons=i.buttons:t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?0===r?p.buttons-=1:1===r?p.buttons-=4:2===r?p.buttons-=2:3===r?p.buttons-=8:4===r?p.buttons-=16:5===r&&(p.buttons-=32):0===r?p.buttons^=-2:1===r?p.buttons^=-5:2===r?p.buttons^=-3:3===r?p.buttons^=-9:4===r?p.buttons^=-17:5===r&&(p.buttons^=-33),0!==r)return e.nonPrimaryReleaseHandler&&!1===e.nonPrimaryReleaseHandler({eventSource:e,pointerType:n[0].type,position:v(n[0].currentPos,e.element),button:r,buttons:p.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),C(e,i,e.getActivePointersListByType("mouse")),!1;for(a=0;a<f;a++)h=n[a],(c=p.getById(h.id))&&(c.captured&&(c.captured=!1,m=!0,g=!0),c.lastPos=c.currentPos,c.lastTime=c.currentTime,c.currentPos=h.currentPos,c.currentTime=h.currentTime,c.insideElement||B(p,c),o=c.currentPos,s=c.currentTime,g?(p.removeContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&t.MouseTracker.gesturePointVelocityTracker.removePoint(e,c),0===p.contacts?(e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:c.type,position:v(o,e.element),buttons:p.buttons,insideElementPressed:c.insideElementPressed,insideElementReleased:c.insideElement,isTouchEvent:"touch"===c.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),e.dragEndHandler&&!c.currentPos.equals(c.contactPos)&&!1===e.dragEndHandler({eventSource:e,pointerType:c.type,position:v(c.currentPos,e.element),speed:c.speed,direction:c.direction,shift:i.shiftKey,isTouchEvent:"touch"===c.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),(e.clickHandler||e.dblClickHandler)&&c.insideElement&&(u=s-c.contactTime<=e.clickTimeThreshold&&c.contactPos.distanceTo(o)<=e.clickDistThreshold,e.clickHandler&&!1===e.clickHandler({eventSource:e,pointerType:c.type,position:v(c.currentPos,e.element),quick:u,shift:i.shiftKey,isTouchEvent:"touch"===c.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),e.dblClickHandler&&u&&(p.clicks++,1===p.clicks?(d.lastClickPos=o,d.dblClickTimeOut=setTimeout(function(){p.clicks=0},e.dblClickTimeThreshold)):2===p.clicks&&(clearTimeout(d.dblClickTimeOut),p.clicks=0,d.lastClickPos.distanceTo(o)<=e.dblClickDistThreshold&&!1===e.dblClickHandler({eventSource:e,pointerType:c.type,position:v(c.currentPos,e.element),shift:i.shiftKey,isTouchEvent:"touch"===c.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i),d.lastClickPos=null)))):2===p.contacts&&e.pinchHandler&&"touch"===c.type&&(d.pinchGPoints=p.asArray(),d.lastPinchDist=d.currentPinchDist=d.pinchGPoints[0].currentPos.distanceTo(d.pinchGPoints[1].currentPos),d.lastPinchCenter=d.currentPinchCenter=_(d.pinchGPoints[0].currentPos,d.pinchGPoints[1].currentPos))):e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:c.type,position:v(o,e.element),buttons:p.buttons,insideElementPressed:c.insideElementPressed,insideElementReleased:c.insideElement,isTouchEvent:"touch"===c.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i));return m}function W(e,i,n){var r,o,s,a,h,c=l[e.hash],u=e.getActivePointersListByType(n[0].type),d=n.length;for(void 0!==i.buttons&&(u.buttons=i.buttons),r=0;r<d;r++)o=n[r],(s=u.getById(o.id))?(o.hasOwnProperty("isPrimary")&&(s.isPrimary=o.isPrimary),s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=o.currentPos,s.currentTime=o.currentTime):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,N(u,o));e.stopHandler&&"mouse"===n[0].type&&(clearTimeout(e.stopTimeOut),e.stopTimeOut=setTimeout(function(){!function(t,e,i){t.stopHandler&&t.stopHandler({eventSource:t,pointerType:i,position:g(e,t.element),buttons:t.getActivePointersListByType(i).buttons,isTouchEvent:"touch"===i,originalEvent:e,preventDefaultAction:!1,userData:t.userData})}(e,i,n[0].type)},e.stopDelay)),0===u.contacts?e.moveHandler&&!1===e.moveHandler({eventSource:e,pointerType:n[0].type,position:v(n[0].currentPos,e.element),buttons:u.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i):1===u.contacts?(e.moveHandler&&(s=u.asArray()[0],!1===e.moveHandler({eventSource:e,pointerType:s.type,position:v(s.currentPos,e.element),buttons:u.buttons,isTouchEvent:"touch"===s.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)),e.dragHandler&&(h=(s=u.asArray()[0]).currentPos.minus(s.lastPos),!1===e.dragHandler({eventSource:e,pointerType:s.type,position:v(s.currentPos,e.element),buttons:u.buttons,delta:h,speed:s.speed,direction:s.direction,shift:i.shiftKey,isTouchEvent:"touch"===s.type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i))):2===u.contacts&&(e.moveHandler&&(a=u.asArray(),!1===e.moveHandler({eventSource:e,pointerType:a[0].type,position:v(_(a[0].currentPos,a[1].currentPos),e.element),buttons:u.buttons,isTouchEvent:"touch"===a[0].type,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)),e.pinchHandler&&"touch"===n[0].type&&(h=c.pinchGPoints[0].currentPos.distanceTo(c.pinchGPoints[1].currentPos))!=c.currentPinchDist&&(c.lastPinchDist=c.currentPinchDist,c.currentPinchDist=h,c.lastPinchCenter=c.currentPinchCenter,c.currentPinchCenter=_(c.pinchGPoints[0].currentPos,c.pinchGPoints[1].currentPos),!1===e.pinchHandler({eventSource:e,pointerType:"touch",gesturePoints:c.pinchGPoints,lastCenter:v(c.lastPinchCenter,e.element),center:v(c.currentPinchCenter,e.element),lastDistance:c.lastPinchDist,distance:c.currentPinchDist,shift:i.shiftKey,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i)))}t.MouseTracker=function(e){a.push(this);var i=arguments;t.isPlainObject(e)||(e={element:i[0],clickTimeThreshold:i[1],clickDistThreshold:i[2]}),this.hash=Math.random(),this.element=t.getElement(e.element),this.clickTimeThreshold=e.clickTimeThreshold||t.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=e.clickDistThreshold||t.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=e.dblClickTimeThreshold||t.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=e.dblClickDistThreshold||t.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=e.userData||null,this.stopDelay=e.stopDelay||50,this.enterHandler=e.enterHandler||null,this.exitHandler=e.exitHandler||null,this.pressHandler=e.pressHandler||null,this.nonPrimaryPressHandler=e.nonPrimaryPressHandler||null,this.releaseHandler=e.releaseHandler||null,this.nonPrimaryReleaseHandler=e.nonPrimaryReleaseHandler||null,this.moveHandler=e.moveHandler||null,this.scrollHandler=e.scrollHandler||null,this.clickHandler=e.clickHandler||null,this.dblClickHandler=e.dblClickHandler||null,this.dragHandler=e.dragHandler||null,this.dragEndHandler=e.dragEndHandler||null,this.pinchHandler=e.pinchHandler||null,this.stopHandler=e.stopHandler||null,this.keyDownHandler=e.keyDownHandler||null,this.keyUpHandler=e.keyUpHandler||null,this.keyHandler=e.keyHandler||null,this.focusHandler=e.focusHandler||null,this.blurHandler=e.blurHandler||null;var n=this;l[this.hash]={click:function(e){!function(e,i){e.clickHandler&&t.cancelEvent(i)}(n,e)},dblclick:function(e){!function(e,i){e.dblClickHandler&&t.cancelEvent(i)}(n,e)},keydown:function(e){!function(e,i){e.keyDownHandler&&(i=t.getEvent(i),e.keyDownHandler({eventSource:e,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(i))}(n,e)},keyup:function(e){!function(e,i){e.keyUpHandler&&(i=t.getEvent(i),e.keyUpHandler({eventSource:e,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(i))}(n,e)},keypress:function(e){!function(e,i){e.keyHandler&&(i=t.getEvent(i),e.keyHandler({eventSource:e,keyCode:i.keyCode?i.keyCode:i.charCode,ctrl:i.ctrlKey,shift:i.shiftKey,alt:i.altKey,meta:i.metaKey,originalEvent:i,preventDefaultAction:!1,userData:e.userData})||t.cancelEvent(i))}(n,e)},focus:function(e){!function(e,i){e.focusHandler&&(i=t.getEvent(i),!1===e.focusHandler({eventSource:e,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i))}(n,e)},blur:function(e){!function(e,i){e.blurHandler&&(i=t.getEvent(i),!1===e.blurHandler({eventSource:e,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&t.cancelEvent(i))}(n,e)},wheel:function(t){!function(t,e){b(t,e,e)}(n,t)},mousewheel:function(t){y(n,t)},DOMMouseScroll:function(t){y(n,t)},MozMousePixelScroll:function(t){y(n,t)},mouseenter:function(e){!function(e,i){i=t.getEvent(i),S(e,i)}(n,e)},mouseleave:function(e){!function(e,i){i=t.getEvent(i),x(e,i)}(n,e)},mouseover:function(e){!function(e,i){if((i=t.getEvent(i)).currentTarget===i.relatedTarget||w(i.currentTarget,i.relatedTarget))return;S(e,i)}(n,e)},mouseout:function(e){!function(e,i){if((i=t.getEvent(i)).currentTarget===i.relatedTarget||w(i.currentTarget,i.relatedTarget))return;x(e,i)}(n,e)},mousedown:function(e){!function(e,i){var n;i=t.getEvent(i),n={id:t.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:m(i),currentTime:t.now()},U(e,i,[n],T(i.button))&&(t.stopEvent(i),d(e,"mouse"));(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler)&&t.cancelEvent(i)}(n,e)},mouseup:function(t){!function(t,e){E(t,e)}(n,t)},mouseupcaptured:function(e){!function(e,i){E(e,i),t.stopEvent(i)}(n,e)},mousemove:function(t){!function(t,e){P(t,e)}(n,t)},mousemovecaptured:function(e){!function(e,i){P(e,i),t.stopEvent(i)}(n,e)},touchstart:function(e){!function(e,i){var n,r,o,s,l=i.changedTouches.length,h=[],c=e.getActivePointersListByType("touch");n=t.now(),c.getLength()>i.touches.length-l&&(t.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),C(e,i,c));for(r=0;r<l;r++)h.push({id:i.changedTouches[r].identifier,type:"touch",currentPos:m(i.changedTouches[r]),currentTime:n});for(j(e,i,h),r=0;r<a.length;r++)if(a[r]!==e&&a[r].isTracking()&&w(a[r].element,e.element)){for(s=[],o=0;o<l;o++)s.push({id:i.changedTouches[o].identifier,type:"touch",currentPos:m(i.changedTouches[o]),currentTime:n});j(a[r],i,s)}U(e,i,h,0)&&(t.stopEvent(i),d(e,"touch",l));t.cancelEvent(i)}(n,e)},touchend:function(t){!function(t,e){L(t,e)}(n,t)},touchendcaptured:function(e){!function(e,i){L(e,i),t.stopEvent(i)}(n,e)},touchmove:function(t){!function(t,e){k(t,e)}(n,t)},touchmovecaptured:function(e){!function(e,i){k(e,i),t.stopEvent(i)}(n,e)},touchcancel:function(t){!function(t,e){var i=t.getActivePointersListByType("touch");C(t,e,i)}(n,t)},gesturestart:function(t){!function(t,e){e.stopPropagation(),e.preventDefault()}(0,t)},gesturechange:function(t){!function(t,e){e.stopPropagation(),e.preventDefault()}(0,t)},pointerover:function(t){A(n,t)},MSPointerOver:function(t){A(n,t)},pointerout:function(t){R(n,t)},MSPointerOut:function(t){R(n,t)},pointerdown:function(t){I(n,t)},MSPointerDown:function(t){I(n,t)},pointerup:function(t){O(n,t)},MSPointerUp:function(t){O(n,t)},pointermove:function(t){D(n,t)},MSPointerMove:function(t){D(n,t)},pointercancel:function(t){F(n,t)},MSPointerCancel:function(t){F(n,t)},pointerupcaptured:function(e){!function(e,i){e.getActivePointersListByType(f(i)).getById(i.pointerId)&&M(e,i);t.stopEvent(i)}(n,e)},pointermovecaptured:function(e){!function(e,i){e.getActivePointersListByType(f(i)).getById(i.pointerId)&&z(e,i);t.stopEvent(i)}(n,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},e.startDisabled||this.setTracking(!0)},t.MouseTracker.prototype={destroy:function(){var t;for(c(this),this.element=null,t=0;t<a.length;t++)if(a[t]===this){a.splice(t,1);break}l[this.hash]=null,delete l[this.hash]},isTracking:function(){return l[this.hash].tracking},setTracking:function(e){return e?function(e){var i,n,r=l[e.hash];if(!r.tracking){for(n=0;n<t.MouseTracker.subscribeEvents.length;n++)i=t.MouseTracker.subscribeEvents[n],t.addEvent(e.element,i,r[i],!1);h(e),r.tracking=!0}}(this):c(this),this},getActivePointersListsExceptType:function(t){for(var e=l[this.hash],i=[],n=0;n<e.activePointersLists.length;++n)e.activePointersLists[n].type!==t&&i.push(e.activePointersLists[n]);return i},getActivePointersListByType:function(e){var i,n,r=l[this.hash],o=r.activePointersLists.length;for(i=0;i<o;i++)if(r.activePointersLists[i].type===e)return r.activePointersLists[i];return n=new t.MouseTracker.GesturePointList(e),r.activePointersLists.push(n),n},getActivePointerCount:function(){var t,e=l[this.hash],i=e.activePointersLists.length,n=0;for(t=0;t<i;t++)n+=e.activePointersLists[t].getLength();return n},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},t.MouseTracker.resetAllMouseTrackers=function(){for(var t=0;t<a.length;t++)a[t].isTracking()&&(a[t].setTracking(!1),a[t].setTracking(!0))},t.MouseTracker.gesturePointVelocityTracker=(e=[],i=0,n=0,r=function(t,e){return t.hash.toString()+e.type+e.id.toString()},o=function(){var i,r,o,s,a,l,h=e.length,c=t.now();for(s=c-n,n=c,i=0;i<h;i++)(o=(r=e[i]).gPoint).direction=Math.atan2(o.currentPos.y-r.lastPos.y,o.currentPos.x-r.lastPos.x),a=r.lastPos.distanceTo(o.currentPos),r.lastPos=o.currentPos,l=1e3*a/(s+1),o.speed=.75*l+.25*o.speed},{addPoint:function(s,a){var l=r(s,a);e.push({guid:l,gPoint:a,lastPos:a.currentPos}),1===e.length&&(n=t.now(),i=window.setInterval(o,50))},removePoint:function(t,n){var o,s=r(t,n),a=e.length;for(o=0;o<a;o++)if(e[o].guid===s){e.splice(o,1),0==--a&&window.clearInterval(i);break}}}),t.MouseTracker.captureElement=document,t.MouseTracker.wheelEventName=t.Browser.vendor==t.BROWSERS.IE&&t.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t.MouseTracker.supportsMouseCapture=(s=document.createElement("div"),t.isFunction(s.setCapture)&&t.isFunction(s.releaseCapture)),t.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",t.MouseTracker.wheelEventName],"DOMMouseScroll"==t.MouseTracker.wheelEventName&&t.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||t.Browser.vendor!==t.BROWSERS.IE)?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),t.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?t.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:t.MouseTracker.maxTouchPoints=0,t.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(t.MouseTracker.havePointerEvents=!0,t.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),t.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?t.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:t.MouseTracker.maxTouchPoints=0,t.MouseTracker.haveMouseEnter=!1):(t.MouseTracker.havePointerEvents=!1,t.Browser.vendor===t.BROWSERS.IE&&t.Browser.version<9?(t.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),t.MouseTracker.haveMouseEnter=!0):(t.MouseTracker.subscribeEvents.push("mouseover","mouseout"),t.MouseTracker.haveMouseEnter=!1),t.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&t.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&t.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),t.MouseTracker.mousePointerId="legacy-mouse",t.MouseTracker.maxTouchPoints=10),t.MouseTracker.GesturePointList=function(t){this._gPoints=[],this.type=t,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},t.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(t){return this._gPoints.push(t)},removeById:function(t){var e,i=this._gPoints.length;for(e=0;e<i;e++)if(this._gPoints[e].id===t){this._gPoints.splice(e,1);break}return this._gPoints.length},getByIndex:function(t){return t<this._gPoints.length?this._gPoints[t]:null},getById:function(t){var e,i=this._gPoints.length;for(e=0;e<i;e++)if(this._gPoints[e].id===t)return this._gPoints[e];return null},getPrimary:function(t){var e,i=this._gPoints.length;for(e=0;e<i;e++)if(this._gPoints[e].isPrimary)return this._gPoints[e];return null},addContact:function(){++this.contacts,this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var G=function(){try{return window.self!==window.top}catch(t){return!0}}();function V(t){try{return t.addEventListener&&t.removeEventListener}catch(t){return!1}}}(OpenSeadragon),function(t){t.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},t.Control=function(e,i,n){var r=e.parentNode;"number"==typeof i&&(t.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),i={anchor:i}),i.attachToViewer=void 0===i.attachToViewer||i.attachToViewer,this.autoFade=void 0===i.autoFade||i.autoFade,this.element=e,this.anchor=i.anchor,this.container=n,this.anchor==t.ControlAnchor.ABSOLUTE?(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof i.top?i.top+"px":i.top,this.wrapper.style.left="number"==typeof i.left?i.left+"px":i.left,this.wrapper.style.height="number"==typeof i.height?i.height+"px":i.height,this.wrapper.style.width="number"==typeof i.width?i.width+"px":i.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=t.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==t.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),i.attachToViewer?this.anchor==t.ControlAnchor.TOP_RIGHT||this.anchor==t.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):r.appendChild(this.wrapper)},t.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?this.anchor==t.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(e){this.element[t.SIGNAL]&&t.Browser.vendor==t.BROWSERS.IE?t.setElementOpacity(this.element,e,!0):t.setElementOpacity(this.wrapper,e,!0)}}}(OpenSeadragon),function(t){function e(t,e){var i,n=t.controls;for(i=n.length-1;i>=0;i--)if(n[i].element==e)return i;return-1}t.ControlDock=function(e){var i,n,r=["topleft","topright","bottomright","bottomleft"];for(t.extend(!0,this,{id:"controldock-"+t.now()+"-"+Math.floor(1e6*Math.random()),container:t.makeNeutralElement("div"),controls:[]},e),this.container.onsubmit=function(){return!1},this.element&&(this.element=t.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),n=0;n<r.length;n++)i=r[n],this.controls[i]=t.makeNeutralElement("div"),this.controls[i].style.position="absolute",i.match("left")&&(this.controls[i].style.left="0px"),i.match("right")&&(this.controls[i].style.right="0px"),i.match("top")&&(this.controls[i].style.top="0px"),i.match("bottom")&&(this.controls[i].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},t.ControlDock.prototype={addControl:function(i,n){var r=null;if(!(e(this,i=t.getElement(i))>=0)){switch(n.anchor){case t.ControlAnchor.TOP_RIGHT:r=this.controls.topright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingTop="0px";break;case t.ControlAnchor.BOTTOM_RIGHT:r=this.controls.bottomright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingBottom="0px";break;case t.ControlAnchor.BOTTOM_LEFT:r=this.controls.bottomleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingBottom="0px";break;case t.ControlAnchor.TOP_LEFT:r=this.controls.topleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingTop="0px";break;case t.ControlAnchor.ABSOLUTE:r=this.container,i.style.margin="0px",i.style.padding="0px";break;default:case t.ControlAnchor.NONE:r=this.container,i.style.margin="0px",i.style.padding="0px"}this.controls.push(new t.Control(i,n,r)),i.style.display="inline-block"}},removeControl:function(i){var n=e(this,i=t.getElement(i));return n>=0&&(this.controls[n].destroy(),this.controls.splice(n,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var t;for(t=this.controls.length-1;t>=0;t--)if(this.controls[t].isVisible())return!0;return!1},setControlsEnabled:function(t){var e;for(e=this.controls.length-1;e>=0;e--)this.controls[e].setVisible(t);return this}}}(OpenSeadragon),function(t){t.Placement=t.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(t){var e={},i=1;function n(e){return e=t.getElement(e),new t.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function r(e,i){if(i instanceof t.Overlay)return i;var n=null;if(i.element)n=t.getElement(i.element);else{var r=i.id?i.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(n=t.getElement(i.id))||((n=document.createElement("a")).href="#/overlay/"+r),n.id=r,t.addClass(n,i.className?i.className:"openseadragon-overlay")}var o=i.location,s=i.width,a=i.height;if(!o){var l=i.x,h=i.y;if(void 0!==i.px){var c=e.viewport.imageToViewportRectangle(new t.Rect(i.px,i.py,s||0,a||0));l=c.x,h=c.y,s=void 0!==s?c.width:void 0,a=void 0!==a?c.height:void 0}o=new t.Point(l,h)}var u=i.placement;return u&&"string"===t.type(u)&&(u=t.Placement[i.placement.toUpperCase()]),new t.Overlay({element:n,location:o,placement:u,onDraw:i.onDraw,checkResize:i.checkResize,width:s,height:a,rotationMode:i.rotationMode})}function o(t,e){var i;for(i=t.length-1;i>=0;i--)if(t[i].element===e)return i;return-1}function s(e,i){return t.requestAnimationFrame(function(){i(e)})}function a(e){t.requestAnimationFrame(function(){!function(e){var i,n,r,o;if(e.controlsShouldFade){for(i=t.now(),n=i-e.controlsFadeBeginTime,r=1-n/e.controlsFadeLength,r=Math.min(1,r),r=Math.max(0,r),o=e.controls.length-1;o>=0;o--)e.controls[o].autoFade&&e.controls[o].setOpacity(r);r>0&&a(e)}}(e)})}function l(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=t.now()+e.controlsFadeDelay,window.setTimeout(function(){a(e)},e.controlsFadeDelay))}function h(t){var e;for(t.controlsShouldFade=!1,e=t.controls.length-1;e>=0;e--)t.controls[e].setOpacity(1)}function c(){h(this)}function u(){l(this)}function d(e){var i={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",i),i.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return i.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return i.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function p(e){var i={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",i),i.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return i.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return i.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return i.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new t.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(this.viewport.degrees-90):this.viewport.setRotation(this.viewport.degrees+90),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(this.viewport.degrees+90):this.viewport.setRotation(this.viewport.degrees-90),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function f(t){var e;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x);var i={tracker:t.eventSource,position:t.position,quick:t.quick,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};this.raiseEvent("canvas-click",i),!i.preventDefaultAction&&this.viewport&&t.quick&&(e=this.gestureSettingsByDeviceType(t.pointerType)).clickToZoom&&(this.viewport.zoomBy(t.shift?1/this.zoomPerClick:this.zoomPerClick,e.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints())}function m(t){var e,i={tracker:t.eventSource,position:t.position,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};this.raiseEvent("canvas-double-click",i),!i.preventDefaultAction&&this.viewport&&(e=this.gestureSettingsByDeviceType(t.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(t.shift?1/this.zoomPerClick:this.zoomPerClick,e.zoomToRefPoint?this.viewport.pointFromPixel(t.position,!0):null),this.viewport.applyConstraints())}function g(t){var e,i={tracker:t.eventSource,position:t.position,delta:t.delta,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};if(this.raiseEvent("canvas-drag",i),!i.preventDefaultAction&&this.viewport){if(e=this.gestureSettingsByDeviceType(t.pointerType),this.panHorizontal||(t.delta.x=0),this.panVertical||(t.delta.y=0),this.viewport.flipped&&(t.delta.x=-t.delta.x),this.constrainDuringPan){var n=this.viewport.deltaPointsFromPixels(t.delta.negate());this.viewport.centerSpringX.target.value+=n.x,this.viewport.centerSpringY.target.value+=n.y;var r=this.viewport.getBounds(),o=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=n.x,this.viewport.centerSpringY.target.value-=n.y,r.x!=o.x&&(t.delta.x=0),r.y!=o.y&&(t.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(t.delta.negate()),e.flickEnabled&&!this.constrainDuringPan)}}function v(e){if(!e.preventDefaultAction&&this.viewport){var i=this.gestureSettingsByDeviceType(e.pointerType);if(i.flickEnabled&&e.speed>=i.flickMinSpeed){var n=0;this.panHorizontal&&(n=i.flickMomentum*e.speed*Math.cos(e.direction));var r=0;this.panVertical&&(r=i.flickMomentum*e.speed*Math.sin(e.direction));var o=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),s=this.viewport.pointFromPixel(new t.Point(o.x-n,o.y-r));this.viewport.panTo(s,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:e.eventSource,position:e.position,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent})}function _(t){this.raiseEvent("canvas-enter",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function y(e){window.location!=window.parent.location&&t.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function b(t){this.raiseEvent("canvas-press",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,insideElementPressed:t.insideElementPressed,insideElementReleased:t.insideElementReleased,originalEvent:t.originalEvent})}function w(t){this.raiseEvent("canvas-release",{tracker:t.eventSource,pointerType:t.pointerType,position:t.position,insideElementPressed:t.insideElementPressed,insideElementReleased:t.insideElementReleased,originalEvent:t.originalEvent})}function S(t){this.raiseEvent("canvas-nonprimary-press",{tracker:t.eventSource,position:t.position,pointerType:t.pointerType,button:t.button,buttons:t.buttons,originalEvent:t.originalEvent})}function x(t){this.raiseEvent("canvas-nonprimary-release",{tracker:t.eventSource,position:t.position,pointerType:t.pointerType,button:t.button,buttons:t.buttons,originalEvent:t.originalEvent})}function T(t){var e,i,n;if(!t.preventDefaultAction&&this.viewport&&((e=this.gestureSettingsByDeviceType(t.pointerType)).pinchToZoom&&(i=this.viewport.pointFromPixel(t.center,!0),n=this.viewport.pointFromPixel(t.lastCenter,!0).minus(i),this.panHorizontal||(n.x=0),this.panVertical||(n.y=0),this.viewport.zoomBy(t.distance/t.lastDistance,i,!0),e.zoomToRefPoint&&this.viewport.panBy(n,!0),this.viewport.applyConstraints()),e.pinchRotate)){var r=Math.atan2(t.gesturePoints[0].currentPos.y-t.gesturePoints[1].currentPos.y,t.gesturePoints[0].currentPos.x-t.gesturePoints[1].currentPos.x),o=Math.atan2(t.gesturePoints[0].lastPos.y-t.gesturePoints[1].lastPos.y,t.gesturePoints[0].lastPos.x-t.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(r-o)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:t.eventSource,gesturePoints:t.gesturePoints,lastCenter:t.lastCenter,center:t.center,lastDistance:t.lastDistance,distance:t.distance,shift:t.shift,originalEvent:t.originalEvent}),!1}function E(e){var i,n,r;if((r=t.now())-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=r,this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),!e.preventDefaultAction&&this.viewport&&(i=this.gestureSettingsByDeviceType(e.pointerType)).scrollToZoom&&(n=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(n,i.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),i&&i.scrollToZoom)return!1}else if((i=this.gestureSettingsByDeviceType(e.pointerType))&&i.scrollToZoom)return!1}function P(t){e[this.hash].mouseInside=!0,h(this),this.raiseEvent("container-enter",{tracker:t.eventSource,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function C(t){t.pointers<1&&(e[this.hash].mouseInside=!1,e[this.hash].animating||l(this)),this.raiseEvent("container-exit",{tracker:t.eventSource,position:t.position,buttons:t.buttons,pointers:t.pointers,insideElementPressed:t.insideElementPressed,buttonDownAny:t.buttonDownAny,originalEvent:t.originalEvent})}function L(t){!function(t){if(t._opening)return;if(t.autoResize){var i=n(t.container),r=e[t.hash].prevContainerSize;if(!i.equals(r)){var o=t.viewport;if(t.preserveImageSizeOnResize){var s=r.x/i.x,a=o.getZoom()*s,c=o.getCenter();o.resize(i,!1),o.zoomTo(a,null,!0),o.panTo(c,!0)}else{var u=o.getBounds();o.resize(i,!0),o.fitBoundsWithConstraints(u,!0)}e[t.hash].prevContainerSize=i,e[t.hash].forceRedraw=!0}}var d=t.viewport.update(),p=t.world.update()||d;d&&t.raiseEvent("viewport-change");t.referenceStrip&&(p=t.referenceStrip.update(t.viewport)||p);!e[t.hash].animating&&p&&(t.raiseEvent("animation-start"),h(t));(p||e[t.hash].forceRedraw||t.world.needsDraw())&&(!function(t){t.imageLoader.clear(),t.drawer.clear(),t.world.draw(),t.raiseEvent("update-viewport",{})}(t),t._drawOverlays(),t.navigator&&t.navigator.update(t.viewport),e[t.hash].forceRedraw=!1,p&&t.raiseEvent("animation"));e[t.hash].animating&&!p&&(t.raiseEvent("animation-finish"),e[t.hash].mouseInside||l(t));e[t.hash].animating=p}(t),t.isOpen()?t._updateRequestId=s(t,L):t._updateRequestId=!1}function k(t,e){return t?t+e:e}function A(){e[this.hash].lastZoomTime=t.now(),e[this.hash].zoomFactor=this.zoomPerSecond,e[this.hash].zooming=!0,O(this)}function R(){e[this.hash].lastZoomTime=t.now(),e[this.hash].zoomFactor=1/this.zoomPerSecond,e[this.hash].zooming=!0,O(this)}function I(){e[this.hash].zooming=!1}function O(e){t.requestAnimationFrame(t.delegate(e,M))}function M(){var i,n,r;e[this.hash].zooming&&this.viewport&&(n=(i=t.now())-e[this.hash].lastZoomTime,r=Math.pow(e[this.hash].zoomFactor,n/1e3),this.viewport.zoomBy(r),this.viewport.applyConstraints(),e[this.hash].lastZoomTime=i,O(this))}function D(){this.viewport&&(e[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function z(){this.viewport&&(e[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function F(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function N(){this.viewport&&this.viewport.goHome()}function B(){this.isFullPage()&&!t.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function j(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?t.positiveModulo(e+90,360):t.positiveModulo(e-90,360),this.viewport.setRotation(e)}}function H(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?t.positiveModulo(e-90,360):t.positiveModulo(e+90,360),this.viewport.setRotation(e)}}function U(){this.viewport.toggleFlip()}function q(){var t=this._sequenceIndex-1;this.navPrevNextWrap&&t<0&&(t+=this.tileSources.length),this.goToPage(t)}function W(){var t=this._sequenceIndex+1;this.navPrevNextWrap&&t>=this.tileSources.length&&(t=0),this.goToPage(t)}t.Viewer=function(r){var o,a,h=arguments,c=this;if(t.isPlainObject(r)||(r={id:h[0],xmlPath:h.length>1?h[1]:void 0,prefixUrl:h.length>2?h[2]:void 0,controls:h.length>3?h[3]:void 0,overlays:h.length>4?h[4]:void 0}),r.config&&(t.extend(!0,r,r.config),delete r.config),t.extend(!0,this,{id:r.id,hash:r.hash||i++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},t.DEFAULT_SETTINGS,r),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==e[this.hash]&&t.console.warn("Hash "+this.hash+" has already been used."),e[this.hash]={fsBoundsDelta:new t.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=t.now(),t.EventSource.call(this),this.addHandler("open-failed",function(e){var i=t.getString("Errors.OpenFailed",e.eventSource,e.message);c._showMessage(i)}),t.ControlDock.call(this,r),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=t.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(a=this.canvas.style).width="100%",a.height="100%",a.overflow="hidden",a.position="absolute",a.top="0px",a.left="0px",t.setElementTouchActionNone(this.canvas),""!==r.tabIndex&&(this.canvas.tabIndex=void 0===r.tabIndex?0:r.tabIndex),this.container.className="openseadragon-container",function(t){t.width="100%",t.height="100%",t.position="relative",t.overflow="hidden",t.left="0px",t.top="0px",t.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new t.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:t.delegate(this,d),keyHandler:t.delegate(this,p),clickHandler:t.delegate(this,f),dblClickHandler:t.delegate(this,m),dragHandler:t.delegate(this,g),dragEndHandler:t.delegate(this,v),enterHandler:t.delegate(this,_),exitHandler:t.delegate(this,y),pressHandler:t.delegate(this,b),releaseHandler:t.delegate(this,w),nonPrimaryPressHandler:t.delegate(this,S),nonPrimaryReleaseHandler:t.delegate(this,x),scrollHandler:t.delegate(this,E),pinchHandler:t.delegate(this,T)}),this.outerTracker=new t.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:t.delegate(this,P),exitHandler:t.delegate(this,C)}),this.toolbar&&(this.toolbar=new t.ControlDock({element:this.toolbar})),this.bindStandardControls(),e[this.hash].prevContainerSize=n(this.container),this.world=new t.World({viewer:this}),this.world.addHandler("add-item",function(t){c.source=c.world.getItemAt(0).source,e[c.hash].forceRedraw=!0,c._updateRequestId||(c._updateRequestId=s(c,L))}),this.world.addHandler("remove-item",function(t){c.world.getItemCount()?c.source=c.world.getItemAt(0).source:c.source=null,e[c.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(t){c.viewport&&c.viewport._setContentBounds(c.world.getHomeBounds(),c.world.getContentFactor())}),this.world.addHandler("item-index-change",function(t){c.source=c.world.getItemAt(0).source}),this.viewport=new t.Viewport({containerSize:e[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new t.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:r.timeout}),this.tileCache=new t.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new t.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=t.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(o=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(o,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(o=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(o,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new t.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),o=0;o<this.customControls.length;o++)this.addControl(this.customControls[o].id,{anchor:this.customControls[o].anchor});t.requestAnimationFrame(function(){l(c)})},t.extend(t.Viewer.prototype,t.EventSource.prototype,t.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(e){return t.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(e)},openTileSource:function(e){return t.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(e)},open:function(e,i){var n=this;if(this.close(),e){if(this.sequenceMode&&t.isArray(e))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===i||isNaN(i)||(this.initialPage=i),this.tileSources=e,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(t.isArray(e)||(e=[e]),e.length){this._opening=!0;for(var o,s=e.length,a=0,l=0,h=function(){if(a+l===s)if(a){!n._firstOpen&&n.preserveViewport||(n.viewport.goHome(!0),n.viewport.update()),n._firstOpen=!1;var t=e[0];if(t.tileSource&&(t=t.tileSource),n.overlays&&!n.preserveOverlays)for(var i=0;i<n.overlays.length;i++)n.currentOverlays[i]=r(n,n.overlays[i]);n._drawOverlays(),n._opening=!1,n.raiseEvent("open",{source:t})}else n._opening=!1,n.raiseEvent("open-failed",o)},c=function(e){t.isPlainObject(e)&&e.tileSource||(e={tileSource:e}),void 0!==e.index&&(t.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete e.index),void 0===e.collectionImmediately&&(e.collectionImmediately=!0);var i=e.success;e.success=function(t){if(a++,e.tileSource.overlays)for(var r=0;r<e.tileSource.overlays.length;r++)n.addOverlay(e.tileSource.overlays[r]);i&&i(t),h()};var r=e.error;e.error=function(t){l++,o||(o=t),r&&r(t),h()},n.addTiledImage(e)},u=0;u<e.length;u++)c(e[u]);return this}}},close:function(){return e[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),e[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(e[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(t.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),e[this.hash]=null,delete e[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(t){return this.innerTracker.setTracking(t),this.outerTracker.setTracking(t),this.raiseEvent("mouse-enabled",{enabled:t}),this},areControlsEnabled:function(){var t,e=this.controls.length;for(t=0;t<this.controls.length;t++)e=e&&this.controls[t].isVisibile();return e},setControlsEnabled:function(t){return t?h(this):l(this),this.raiseEvent("controls-enabled",{enabled:t}),this},setDebugMode:function(t){for(var e=0;e<this.world.getItemCount();e++)this.world.getItemAt(e).debugMode=t;this.debugMode=t,this.forceRedraw()},isFullPage:function(){return e[this.hash].fullPage},setFullPage:function(i){var n,r,o=document.body,s=o.style,a=document.documentElement.style,l=this;if(i==this.isFullPage())return this;var h={fullPage:i,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",h),h.preventDefaultAction)return this;if(i){for(this.elementSize=t.getElementSize(this.element),this.pageScroll=t.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=s.margin,this.docMargin=a.margin,s.margin="0",a.margin="0",this.bodyPadding=s.padding,this.docPadding=a.padding,s.padding="0",a.padding="0",this.bodyWidth=s.width,this.docWidth=a.width,s.width="100%",a.width="100%",this.bodyHeight=s.height,this.docHeight=a.height,s.height="100%",a.height="100%",this.previousBody=[],e[this.hash].prevElementParent=this.element.parentNode,e[this.hash].prevNextSibling=this.element.nextSibling,e[this.hash].prevElementWidth=this.element.style.width,e[this.hash].prevElementHeight=this.element.style.height,n=o.childNodes.length,r=0;r<n;r++)this.previousBody.push(o.childNodes[0]),o.removeChild(o.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,o.appendChild(this.toolbar.element),t.addClass(this.toolbar.element,"fullpage")),t.addClass(this.element,"fullpage"),o.appendChild(this.element),this.element.style.height=t.getWindowSize().y+"px",this.element.style.width=t.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=t.getElementSize(this.element).y-t.getElementSize(this.toolbar.element).y+"px"),e[this.hash].fullPage=!0,t.delegate(this,P)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,s.margin=this.bodyMargin,a.margin=this.docMargin,s.padding=this.bodyPadding,a.padding=this.docPadding,s.width=this.bodyWidth,a.width=this.docWidth,s.height=this.bodyHeight,a.height=this.docHeight,o.removeChild(this.element),n=this.previousBody.length,r=0;r<n;r++)o.appendChild(this.previousBody.shift());t.removeClass(this.element,"fullpage"),e[this.hash].prevElementParent.insertBefore(this.element,e[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(o.removeChild(this.toolbar.element),t.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=e[this.hash].prevElementWidth,this.element.style.height=e[this.hash].prevElementHeight;var c=0,u=function(){t.setPageScroll(l.pageScroll);var e=t.getPageScroll();++c<10&&(e.x!==l.pageScroll.x||e.y!==l.pageScroll.y)&&t.requestAnimationFrame(u)};t.requestAnimationFrame(u),e[this.hash].fullPage=!1,t.delegate(this,C)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:i}),this},setFullScreen:function(e){var i=this;if(!t.supportsFullScreen)return this.setFullPage(e);if(t.isFullScreen()===e)return this;var n={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",n),n.preventDefaultAction)return this;if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var r=function(){var e=t.isFullScreen();e||(t.removeEvent(document,t.fullScreenEventName,r),t.removeEvent(document,t.fullScreenErrorEventName,r),i.setFullPage(!1),i.isFullPage()&&(i.element.style.width=i.fullPageStyleWidth,i.element.style.height=i.fullPageStyleHeight)),i.navigator&&i.viewport&&i.navigator.update(i.viewport),i.raiseEvent("full-screen",{fullScreen:e})};t.addEvent(document,t.fullScreenEventName,r),t.addEvent(document,t.fullScreenErrorEventName,r),t.requestFullScreen(document.body)}else t.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(t){return this.container.style.visibility=t?"":"hidden",this.raiseEvent("visible",{visible:t}),this},addTiledImage:function(e){t.console.assert(e,"[Viewer.addTiledImage] options is required"),t.console.assert(e.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),t.console.assert(!e.replace||e.index>-1&&e.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var i=this;e.replace&&(e.replaceItem=i.world.getItemAt(e.index)),this._hideMessage(),void 0===e.placeholderFillStyle&&(e.placeholderFillStyle=this.placeholderFillStyle),void 0===e.opacity&&(e.opacity=this.opacity),void 0===e.preload&&(e.preload=this.preload),void 0===e.compositeOperation&&(e.compositeOperation=this.compositeOperation),void 0===e.crossOriginPolicy&&(e.crossOriginPolicy=void 0!==e.tileSource.crossOriginPolicy?e.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===e.ajaxWithCredentials&&(e.ajaxWithCredentials=this.ajaxWithCredentials),void 0===e.loadTilesWithAjax&&(e.loadTilesWithAjax=this.loadTilesWithAjax),void 0===e.ajaxHeaders||null===e.ajaxHeaders?e.ajaxHeaders=this.ajaxHeaders:t.isPlainObject(e.ajaxHeaders)&&t.isPlainObject(this.ajaxHeaders)&&(e.ajaxHeaders=t.extend({},this.ajaxHeaders,e.ajaxHeaders));var n={options:e};function r(t){for(var r=0;r<i._loadQueue.length;r++)if(i._loadQueue[r]===n){i._loadQueue.splice(r,1);break}0===i._loadQueue.length&&o(n),i.raiseEvent("add-item-failed",t),e.error&&e.error(t)}function o(t){i.collectionMode&&(i.world.arrange({immediately:t.options.collectionImmediately,rows:i.collectionRows,columns:i.collectionColumns,layout:i.collectionLayout,tileSize:i.collectionTileSize,tileMargin:i.collectionTileMargin}),i.world.setAutoRefigureSizes(!0))}function s(){for(var e,n,r;i._loadQueue.length&&(e=i._loadQueue[0]).tileSource;){if(i._loadQueue.splice(0,1),e.options.replace){var s=i.world.getIndexOfItem(e.options.replaceItem);-1!=s&&(e.options.index=s),i.world.removeItem(e.options.replaceItem)}n=new t.TiledImage({viewer:i,source:e.tileSource,viewport:i.viewport,drawer:i.drawer,tileCache:i.tileCache,imageLoader:i.imageLoader,x:e.options.x,y:e.options.y,width:e.options.width,height:e.options.height,fitBounds:e.options.fitBounds,fitBoundsPlacement:e.options.fitBoundsPlacement,clip:e.options.clip,placeholderFillStyle:e.options.placeholderFillStyle,opacity:e.options.opacity,preload:e.options.preload,degrees:e.options.degrees,compositeOperation:e.options.compositeOperation,springStiffness:i.springStiffness,animationTime:i.animationTime,minZoomImageRatio:i.minZoomImageRatio,wrapHorizontal:i.wrapHorizontal,wrapVertical:i.wrapVertical,immediateRender:i.immediateRender,blendTime:i.blendTime,alwaysBlend:i.alwaysBlend,minPixelRatio:i.minPixelRatio,smoothTileEdgesMinZoom:i.smoothTileEdgesMinZoom,iOSDevice:i.iOSDevice,crossOriginPolicy:e.options.crossOriginPolicy,ajaxWithCredentials:e.options.ajaxWithCredentials,loadTilesWithAjax:e.options.loadTilesWithAjax,ajaxHeaders:e.options.ajaxHeaders,debugMode:i.debugMode}),i.collectionMode&&i.world.setAutoRefigureSizes(!1),i.world.addItem(n,{index:e.options.index}),0===i._loadQueue.length&&o(e),1!==i.world.getItemCount()||i.preserveViewport||i.viewport.goHome(!0),i.navigator&&(r=t.extend({},e.options,{replace:!1,originalTiledImage:n,tileSource:e.tileSource}),i.navigator.addTiledImage(r)),e.options.success&&e.options.success({item:n})}}t.isArray(e.tileSource)?setTimeout(function(){r({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:e.tileSource,options:e})}):(this._loadQueue.push(n),function(e,i,n,r,o){var s=e;if("string"==t.type(i))if(i.match(/^\s*<.*>\s*$/))i=t.parseXml(i);else if(i.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var a=t.parseJSON(i);i=a}catch(t){}function l(t,e){t.ready?r(t):(t.addHandler("ready",function(){r(t)}),t.addHandler("open-failed",function(t){o({message:t.message,source:e})}))}setTimeout(function(){if("string"==t.type(i))(i=new t.TileSource({url:i,crossOriginPolicy:void 0!==n.crossOriginPolicy?n.crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,ajaxHeaders:e.ajaxHeaders,useCanvas:e.useCanvas,success:function(t){r(t.tileSource)}})).addHandler("open-failed",function(t){o(t)});else if(t.isPlainObject(i)||i.nodeType)if(void 0!==i.crossOriginPolicy||void 0===n.crossOriginPolicy&&void 0===e.crossOriginPolicy||(i.crossOriginPolicy=void 0!==n.crossOriginPolicy?n.crossOriginPolicy:e.crossOriginPolicy),void 0===i.ajaxWithCredentials&&(i.ajaxWithCredentials=e.ajaxWithCredentials),void 0===i.useCanvas&&(i.useCanvas=e.useCanvas),t.isFunction(i.getTileUrl)){var a=new t.TileSource(i);a.getTileUrl=i.getTileUrl,r(a)}else{var h=t.TileSource.determineType(s,i);if(!h)return void o({message:"Unable to load TileSource",source:i});var c=h.prototype.configure.apply(s,[i]);l(new h(c),i)}else l(i,i)})}(this,e.tileSource,e,function(t){n.tileSource=t,s()},function(t){t.options=e,r(t),s()}))},addSimpleImage:function(e){t.console.assert(e,"[Viewer.addSimpleImage] options is required"),t.console.assert(e.url,"[Viewer.addSimpleImage] options.url is required");var i=t.extend({},e,{tileSource:{type:"image",url:e.url}});delete i.url,this.addTiledImage(i)},addLayer:function(e){var i=this;t.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var n=t.extend({},e,{success:function(t){i.raiseEvent("add-layer",{options:e,drawer:t.item})},error:function(t){i.raiseEvent("add-layer-failed",t)}});return this.addTiledImage(n),this},getLayerAtLevel:function(e){return t.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(e)},getLevelOfLayer:function(e){return t.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(e)},getLayersCount:function(){return t.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(e,i){return t.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(e,i)},removeLayer:function(e){return t.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(e)},forceRedraw:function(){return e[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var e=t.delegate(this,c),i=t.delegate(this,u),n=t.delegate(this,W),r=t.delegate(this,q),o=this.navImages,s=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(s=!1),this.previousButton=new t.Button({element:this.previousButton?t.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.PreviousPage"),srcRest:k(this.prefixUrl,o.previous.REST),srcGroup:k(this.prefixUrl,o.previous.GROUP),srcHover:k(this.prefixUrl,o.previous.HOVER),srcDown:k(this.prefixUrl,o.previous.DOWN),onRelease:r,onFocus:e,onBlur:i}),this.nextButton=new t.Button({element:this.nextButton?t.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.NextPage"),srcRest:k(this.prefixUrl,o.next.REST),srcGroup:k(this.prefixUrl,o.next.GROUP),srcHover:k(this.prefixUrl,o.next.HOVER),srcDown:k(this.prefixUrl,o.next.DOWN),onRelease:n,onFocus:e,onBlur:i}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),s&&(this.paging=new t.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:t.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var e=t.delegate(this,A),i=t.delegate(this,I),n=t.delegate(this,D),r=t.delegate(this,R),o=t.delegate(this,z),s=t.delegate(this,N),a=t.delegate(this,B),l=t.delegate(this,j),h=t.delegate(this,H),d=t.delegate(this,U),p=t.delegate(this,c),f=t.delegate(this,u),m=this.navImages,g=[],v=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(v=!1),this.showZoomControl&&(g.push(this.zoomInButton=new t.Button({element:this.zoomInButton?t.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomIn"),srcRest:k(this.prefixUrl,m.zoomIn.REST),srcGroup:k(this.prefixUrl,m.zoomIn.GROUP),srcHover:k(this.prefixUrl,m.zoomIn.HOVER),srcDown:k(this.prefixUrl,m.zoomIn.DOWN),onPress:e,onRelease:i,onClick:n,onEnter:e,onExit:i,onFocus:p,onBlur:f})),g.push(this.zoomOutButton=new t.Button({element:this.zoomOutButton?t.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.ZoomOut"),srcRest:k(this.prefixUrl,m.zoomOut.REST),srcGroup:k(this.prefixUrl,m.zoomOut.GROUP),srcHover:k(this.prefixUrl,m.zoomOut.HOVER),srcDown:k(this.prefixUrl,m.zoomOut.DOWN),onPress:r,onRelease:i,onClick:o,onEnter:r,onExit:i,onFocus:p,onBlur:f}))),this.showHomeControl&&g.push(this.homeButton=new t.Button({element:this.homeButton?t.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Home"),srcRest:k(this.prefixUrl,m.home.REST),srcGroup:k(this.prefixUrl,m.home.GROUP),srcHover:k(this.prefixUrl,m.home.HOVER),srcDown:k(this.prefixUrl,m.home.DOWN),onRelease:s,onFocus:p,onBlur:f})),this.showFullPageControl&&g.push(this.fullPageButton=new t.Button({element:this.fullPageButton?t.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.FullPage"),srcRest:k(this.prefixUrl,m.fullpage.REST),srcGroup:k(this.prefixUrl,m.fullpage.GROUP),srcHover:k(this.prefixUrl,m.fullpage.HOVER),srcDown:k(this.prefixUrl,m.fullpage.DOWN),onRelease:a,onFocus:p,onBlur:f})),this.showRotationControl&&(g.push(this.rotateLeftButton=new t.Button({element:this.rotateLeftButton?t.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateLeft"),srcRest:k(this.prefixUrl,m.rotateleft.REST),srcGroup:k(this.prefixUrl,m.rotateleft.GROUP),srcHover:k(this.prefixUrl,m.rotateleft.HOVER),srcDown:k(this.prefixUrl,m.rotateleft.DOWN),onRelease:l,onFocus:p,onBlur:f})),g.push(this.rotateRightButton=new t.Button({element:this.rotateRightButton?t.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.RotateRight"),srcRest:k(this.prefixUrl,m.rotateright.REST),srcGroup:k(this.prefixUrl,m.rotateright.GROUP),srcHover:k(this.prefixUrl,m.rotateright.HOVER),srcDown:k(this.prefixUrl,m.rotateright.DOWN),onRelease:h,onFocus:p,onBlur:f}))),this.showFlipControl&&g.push(this.flipButton=new t.Button({element:this.flipButton?t.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:t.getString("Tooltips.Flip"),srcRest:k(this.prefixUrl,m.flip.REST),srcGroup:k(this.prefixUrl,m.flip.GROUP),srcHover:k(this.prefixUrl,m.flip.HOVER),srcDown:k(this.prefixUrl,m.flip.DOWN),onRelease:d,onFocus:p,onBlur:f})),v&&(this.buttons=new t.ButtonGroup({buttons:g,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",t.delegate(this,F)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||t.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(t){return this.tileSources&&t>=0&&t<this.tileSources.length&&(this._sequenceIndex=t,this._updateSequenceButtons(t),this.open(this.tileSources[t]),this.referenceStrip&&this.referenceStrip.setFocus(t),this.raiseEvent("page",{page:t})),this},addOverlay:function(e,i,n,s){var a;if(a=t.isPlainObject(e)?e:{element:e,location:i,placement:n,onDraw:s},e=t.getElement(a.element),o(this.currentOverlays,e)>=0)return this;var l=r(this,a);return this.currentOverlays.push(l),l.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:e,location:a.location,placement:a.placement}),this},updateOverlay:function(i,n,r){var s;return i=t.getElement(i),(s=o(this.currentOverlays,i))>=0&&(this.currentOverlays[s].update(n,r),e[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:i,location:n,placement:r})),this},removeOverlay:function(i){var n;return i=t.getElement(i),(n=o(this.currentOverlays,i))>=0&&(this.currentOverlays[n].destroy(),this.currentOverlays.splice(n,1),e[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:i})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return e[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(e){var i;return e=t.getElement(e),(i=o(this.currentOverlays,e))>=0?this.currentOverlays[i]:null},_updateSequenceButtons:function(t){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==t?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(t>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var i=t.makeNeutralElement("div");i.appendChild(document.createTextNode(e)),this.messageDiv=t.makeCenteredNode(i),t.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var t=this.messageDiv;t&&(t.parentNode.removeChild(t),delete this.messageDiv)},gestureSettingsByDeviceType:function(t){switch(t){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var t,e=this.currentOverlays.length;for(t=0;t<e;t++)this.currentOverlays[t].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new t.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else t.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(t){function e(t){var e={tracker:t.eventSource,position:t.position,quick:t.quick,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",e),!e.preventDefaultAction&&t.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(t.position.x=this.viewport.getContainerSize().x-t.position.x);var i=this.viewport.pointFromPixel(t.position);this.panVertical?this.panHorizontal||(i.x=this.viewer.viewport.getCenter(!0).x):i.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(i),this.viewer.viewport.applyConstraints()}}function i(t){var e={tracker:t.eventSource,position:t.position,delta:t.delta,speed:t.speed,direction:t.direction,shift:t.shift,originalEvent:t.originalEvent,preventDefaultAction:t.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",e),!e.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(t.delta.x=0),this.panVertical||(t.delta.y=0),this.viewer.viewport.flipped&&(t.delta.x=-t.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(t.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function n(t){t.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function r(t){return this.viewer.raiseEvent("navigator-scroll",{tracker:t.eventSource,position:t.position,scroll:t.scroll,shift:t.shift,originalEvent:t.originalEvent}),!1}function o(t,e){s(t,"rotate("+e+"deg)")}function s(t,e){t.style.webkitTransform=e,t.style.mozTransform=e,t.style.msTransform=e,t.style.oTransform=e,t.style.transform=e}t.Navigator=function(s){var a,l,h,c,u=s.viewer,d=this;function p(t){o(d.displayRegionContainer,t),o(d.displayRegion,-t),d.viewport.setRotation(t)}(s.id?(this.element=document.getElementById(s.id),s.controlOptions={anchor:t.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(s.id="navigator-"+t.now(),this.element=t.makeNeutralElement("div"),s.controlOptions={anchor:t.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:s.autoFade},s.position&&("BOTTOM_RIGHT"==s.position?s.controlOptions.anchor=t.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==s.position?s.controlOptions.anchor=t.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==s.position?s.controlOptions.anchor=t.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==s.position?s.controlOptions.anchor=t.ControlAnchor.TOP_LEFT:"ABSOLUTE"==s.position&&(s.controlOptions.anchor=t.ControlAnchor.ABSOLUTE,s.controlOptions.top=s.top,s.controlOptions.left=s.left,s.controlOptions.height=s.height,s.controlOptions.width=s.width))),this.element.id=s.id,this.element.className+=" navigator",(s=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.navigatorSizeRatio},s,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:s.autoResize,minZoomImageRatio:1,background:s.background,opacity:s.opacity,borderColor:s.borderColor,displayRegionColor:s.displayRegionColor})).minPixelRatio=this.minPixelRatio=u.minPixelRatio,t.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new t.Point(1,1),this.totalBorderWidths=new t.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),s.controlOptions.anchor!=t.ControlAnchor.NONE&&(h=this.element.style,c=this.borderWidth,h.margin="0px",h.border=c+"px solid "+s.borderColor,h.padding="0px",h.background=s.background,h.opacity=s.opacity,h.overflow="hidden"),this.displayRegion=t.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(t,e){t.position="relative",t.top="0px",t.left="0px",t.fontSize="0px",t.overflow="hidden",t.border=e+"px solid "+s.displayRegionColor,t.margin="0px",t.padding="0px",t.background="transparent",t.float="left",t.cssFloat="left",t.styleFloat="left",t.zIndex=999999999,t.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=t.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",u.addControl(this.element,s.controlOptions),this._resizeWithViewer=s.controlOptions.anchor!=t.ControlAnchor.ABSOLUTE&&s.controlOptions.anchor!=t.ControlAnchor.NONE,this._resizeWithViewer&&(s.width&&s.height?(this.element.style.height="number"==typeof s.height?s.height+"px":s.height,this.element.style.width="number"==typeof s.width?s.width+"px":s.width):(a=t.getElementSize(u.element),this.element.style.height=Math.round(a.y*s.sizeRatio)+"px",this.element.style.width=Math.round(a.x*s.sizeRatio)+"px",this.oldViewerSize=a),l=t.getElementSize(this.element),this.elementArea=l.x*l.y),this.oldContainerSize=new t.Point(0,0),t.Viewer.apply(this,[s]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),s.navigatorRotate)&&(p(s.viewer.viewport?s.viewer.viewport.getRotation():s.viewer.degrees||0),s.viewer.addHandler("rotate",function(t){p(t.degrees)}));this.innerTracker.destroy(),this.innerTracker=new t.MouseTracker({element:this.element,dragHandler:t.delegate(this,i),clickHandler:t.delegate(this,e),releaseHandler:t.delegate(this,n),scrollHandler:t.delegate(this,r)}),this.addHandler("reset-size",function(){d.viewport&&d.viewport.goHome(!0)}),u.world.addHandler("item-index-change",function(t){window.setTimeout(function(){var e=d.world.getItemAt(t.previousIndex);d.world.setItemIndex(e,t.newIndex)},1)}),u.world.addHandler("remove-item",function(t){var e=t.item,i=d._getMatchingItem(e);i&&d.world.removeItem(i)}),this.update(u.viewport)},t.extend(t.Navigator.prototype,t.EventSource.prototype,t.Viewer.prototype,{updateSize:function(){if(this.viewport){var e=new t.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);e.equals(this.oldContainerSize)||(this.viewport.resize(e,!0),this.viewport.goHome(!0),this.oldContainerSize=e,this.drawer.clear(),this.world.draw())}},setFlip:function(t){return this.viewport.setFlip(t),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(t){s(this.displayRegion,t),s(this.canvas,t),s(this.element,t)},update:function(e){var i,n,r,o,s,a;if(i=t.getElementSize(this.viewer.element),this._resizeWithViewer&&i.x&&i.y&&!i.equals(this.oldViewerSize)&&(this.oldViewerSize=i,this.maintainSizeRatio||!this.elementArea?(n=i.x*this.sizeRatio,r=i.y*this.sizeRatio):(n=Math.sqrt(this.elementArea*(i.x/i.y)),r=this.elementArea/n),this.element.style.width=Math.round(n)+"px",this.element.style.height=Math.round(r)+"px",this.elementArea||(this.elementArea=n*r),this.updateSize()),e&&this.viewport){o=e.getBoundsNoRotate(!0),s=this.viewport.pixelFromPointNoRotate(o.getTopLeft(),!1),a=this.viewport.pixelFromPointNoRotate(o.getBottomRight(),!1).minus(this.totalBorderWidths);var l=this.displayRegion.style;l.display=this.world.getItemCount()?"block":"none",l.top=Math.round(s.y)+"px",l.left=Math.round(s.x)+"px";var h=Math.abs(s.x-a.x),c=Math.abs(s.y-a.y);l.width=Math.round(Math.max(h,0))+"px",l.height=Math.round(Math.max(c,0))+"px"}},addTiledImage:function(e){var i=this,n=e.originalTiledImage;delete e.original;var r=t.extend({},e,{success:function(t){var e=t.item;function r(){i._matchBounds(e,n)}e._originalForNavigator=n,i._matchBounds(e,n,!0),n.addHandler("bounds-change",r),n.addHandler("clip-change",r),n.addHandler("opacity-change",function(){i._matchOpacity(e,n)}),n.addHandler("composite-operation-change",function(){i._matchCompositeOperation(e,n)})}});return t.Viewer.prototype.addTiledImage.apply(this,[r])},_getMatchingItem:function(t){for(var e,i=this.world.getItemCount(),n=0;n<i;n++)if((e=this.world.getItemAt(n))._originalForNavigator===t)return e;return null},_matchBounds:function(t,e,i){var n=e.getBoundsNoRotate();t.setPosition(n.getTopLeft(),i),t.setWidth(n.width,i),t.setRotation(e.getRotation(),i),t.setClip(e.getClip())},_matchOpacity:function(t,e){t.setOpacity(e.opacity)},_matchCompositeOperation:function(t,e){t.setCompositeOperation(e.compositeOperation)}})}(OpenSeadragon),function(t){var e={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};t.extend(t,{getString:function(i){var n,r=i.split("."),o=null,s=arguments,a=e;for(n=0;n<r.length-1;n++)a=a[r[n]]||{};return"string"!=typeof(o=a[r[n]])&&(t.console.log("Untranslated source string:",i),o=""),o.replace(/\{\d+\}/g,function(t){var e=parseInt(t.match(/\d+/),10)+1;return e<s.length?s[e]:""})},setString:function(t,i){var n,r=t.split("."),o=e;for(n=0;n<r.length-1;n++)o[r[n]]||(o[r[n]]={}),o=o[r[n]];o[r[n]]=i}})}(OpenSeadragon),function(t){t.Point=function(t,e){this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},plus:function(e){return new t.Point(this.x+e.x,this.y+e.y)},minus:function(e){return new t.Point(this.x-e.x,this.y-e.y)},times:function(e){return new t.Point(this.x*e,this.y*e)},divide:function(e){return new t.Point(this.x/e,this.y/e)},negate:function(){return new t.Point(-this.x,-this.y)},distanceTo:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},squaredDistanceTo:function(t){return Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)},apply:function(e){return new t.Point(e(this.x),e(this.y))},equals:function(e){return e instanceof t.Point&&this.x===e.x&&this.y===e.y},rotate:function(e,i){var n,r;if(i=i||new t.Point(0,0),e%90==0){switch(t.positiveModulo(e,360)){case 0:n=1,r=0;break;case 90:n=0,r=1;break;case 180:n=-1,r=0;break;case 270:n=0,r=-1}}else{var o=e*Math.PI/180;n=Math.cos(o),r=Math.sin(o)}var s=n*(this.x-i.x)-r*(this.y-i.y)+i.x,a=r*(this.x-i.x)+n*(this.y-i.y)+i.y;return new t.Point(s,a)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(t){t.TileSource=function(e,i,n,r,o,s){var a,l,h=this,c=arguments;if(a=t.isPlainObject(e)?e:{width:c[0],height:c[1],tileSize:c[2],tileOverlap:c[3],minLevel:c[4],maxLevel:c[5]},t.EventSource.call(this),t.extend(!0,this,a),!this.success)for(l=0;l<arguments.length;l++)if(t.isFunction(arguments[l])){this.success=arguments[l];break}this.success&&this.addHandler("ready",function(t){h.success(t)}),"string"==t.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new t.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=a.width&&a.height?a.width/a.height:1,this.dimensions=new t.Point(a.width,a.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=a.tileOverlap?a.tileOverlap:0,this.minLevel=a.minLevel?a.minLevel:0,this.maxLevel=void 0!==a.maxLevel&&null!==a.maxLevel?a.maxLevel:a.width&&a.height?Math.ceil(Math.log(Math.max(a.width,a.height))/Math.log(2)):0,this.success&&t.isFunction(this.success)&&this.success(this))},t.TileSource.prototype={getTileSize:function(e){return t.console.error("[TileSource.getTileSize] is deprecated.Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(t){return this._tileWidth?this._tileWidth:this.getTileSize(t)},getTileHeight:function(t){return this._tileHeight?this._tileHeight:this.getTileSize(t)},getLevelScale:function(t){var e,i={};for(e=0;e<=this.maxLevel;e++)i[e]=1/Math.pow(2,this.maxLevel-e);return this.getLevelScale=function(t){return i[t]},this.getLevelScale(t)},getNumTiles:function(e){var i=this.getLevelScale(e),n=Math.ceil(i*this.dimensions.x/this.getTileWidth(e)),r=Math.ceil(i*this.dimensions.y/this.getTileHeight(e));return new t.Point(n,r)},getPixelRatio:function(e){var i=this.dimensions.times(this.getLevelScale(e)),n=1/i.x,r=1/i.y;return new t.Point(n,r)},getClosestLevel:function(){var t,e;for(t=this.minLevel+1;t<=this.maxLevel&&!((e=this.getNumTiles(t)).x>1||e.y>1);t++);return t-1},getTileAtPoint:function(e,i){var n=i.x>=0&&i.x<=1&&i.y>=0&&i.y<=1/this.aspectRatio;t.console.assert(n,"[TileSource.getTileAtPoint] must be called with a valid point.");var r=this.dimensions.x*this.getLevelScale(e),o=i.x*r,s=i.y*r,a=Math.floor(o/this.getTileWidth(e)),l=Math.floor(s/this.getTileHeight(e));i.x>=1&&(a=this.getNumTiles(e).x-1);return i.y>=1/this.aspectRatio-1e-15&&(l=this.getNumTiles(e).y-1),new t.Point(a,l)},getTileBounds:function(e,i,n,r){var o=this.dimensions.times(this.getLevelScale(e)),s=this.getTileWidth(e),a=this.getTileHeight(e),l=0===i?0:s*i-this.tileOverlap,h=0===n?0:a*n-this.tileOverlap,c=s+(0===i?1:2)*this.tileOverlap,u=a+(0===n?1:2)*this.tileOverlap,d=1/o.x;return c=Math.min(c,o.x-l),u=Math.min(u,o.y-h),r?new t.Rect(0,0,c,u):new t.Rect(l*d,h*d,c*d,u*d)},getImageInfo:function(e){var i,n,r,o,s,a,l,h=this;e&&(l=(a=(s=e.split("/"))[s.length-1]).lastIndexOf("."))>-1&&(s[s.length-1]=a.slice(0,l)),n=function(i){"string"==typeof i&&(i=t.parseXml(i));var n=t.TileSource.determineType(h,i,e);n?(void 0===(o=n.prototype.configure.apply(h,[i,e])).ajaxWithCredentials&&(o.ajaxWithCredentials=h.ajaxWithCredentials),r=new n(o),h.ready=!0,h.raiseEvent("ready",{tileSource:r})):h.raiseEvent("open-failed",{message:"Unable to load TileSource",source:e})},e.match(/\.js$/)?(i=e.split("/").pop().replace(".js",""),t.jsonp({url:e,async:!1,callbackName:i,callback:n})):t.makeAjaxRequest({url:e,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var i=function(e){var i,n,r=e.responseText,o=e.status;if(!e)throw new Error(t.getString("Errors.Security"));if(200!==e.status&&0!==e.status)throw o=e.status,i=404==o?"Not Found":e.statusText,new Error(t.getString("Errors.Status",o,i));if(r.match(/\s*<.*/))try{n=e.responseXML&&e.responseXML.documentElement?e.responseXML:t.parseXml(r)}catch(t){n=e.responseText}else if(r.match(/\s*[\{\[].*/))try{n=t.parseJSON(r)}catch(t){n=r}else n=r;return n}(e);n(i)},error:function(t,i){var n;try{n="HTTP "+t.status+" attempting to load TileSource"}catch(t){n=(void 0!==i&&i.toString?i.toString():"Unknown error")+" attempting to load TileSource"}h.raiseEvent("open-failed",{message:n,source:e})}})},supports:function(t,e){return!1},configure:function(t,e){throw new Error("Method not implemented.")},getTileUrl:function(t,e,i){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(t,e,i){return{}},tileExists:function(t,e,i){var n=this.getNumTiles(t);return t>=this.minLevel&&t<=this.maxLevel&&e>=0&&i>=0&&e<n.x&&i<n.y}},t.extend(!0,t.TileSource.prototype,t.EventSource.prototype),t.TileSource.determineType=function(e,i,n){var r;for(r in OpenSeadragon)if(r.match(/.+TileSource$/)&&t.isFunction(OpenSeadragon[r])&&t.isFunction(OpenSeadragon[r].prototype.supports)&&OpenSeadragon[r].prototype.supports.call(e,i,n))return OpenSeadragon[r];t.console.error("No TileSource was able to open %s %s",n,i)}}(OpenSeadragon),function(t){function e(e,i){var n,r,o=i.Image,s=o.Url,a=o.Format,l=o.Size,h=o.DisplayRect||[],c=parseInt(l.Width,10),u=parseInt(l.Height,10),d=parseInt(o.TileSize,10),p=parseInt(o.Overlap,10),f=[];for(r=0;r<h.length;r++)n=h[r].Rect,f.push(new t.DisplayRect(parseInt(n.X,10),parseInt(n.Y,10),parseInt(n.Width,10),parseInt(n.Height,10),parseInt(n.MinLevel,10),parseInt(n.MaxLevel,10)));return t.extend(!0,{width:c,height:u,tileSize:d,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:s,fileFormat:a,displayRects:f},i)}t.DziTileSource=function(e,i,n,r,o,s,a,l,h){var c,u,d,p;if(p=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=p.tilesUrl,this.fileFormat=p.fileFormat,this.displayRects=p.displayRects,this.displayRects)for(c=this.displayRects.length-1;c>=0;c--)for(d=(u=this.displayRects[c]).minLevel;d<=u.maxLevel;d++)this._levelRects[d]||(this._levelRects[d]=[]),this._levelRects[d].push(u);t.TileSource.apply(this,[p])},t.extend(t.DziTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){var i;return t.Image?i=t.Image.xmlns:t.documentElement&&("Image"!=t.documentElement.localName&&"Image"!=t.documentElement.tagName||(i=t.documentElement.namespaceURI)),-1!==(i=(i||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==i.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(i,n){var r;return r=t.isPlainObject(i)?e(this,i):function(i,n){if(!n||!n.documentElement)throw new Error(t.getString("Errors.Xml"));var r,o,s,a,l,h=n.documentElement,c=h.localName||h.tagName,u=n.documentElement.namespaceURI,d=null,p=[];if("Image"==c)try{if(void 0===(a=h.getElementsByTagName("Size")[0])&&(a=h.getElementsByTagNameNS(u,"Size")[0]),d={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:h.getAttribute("Url"),Format:h.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(h.getAttribute("Overlap"),10),TileSize:parseInt(h.getAttribute("TileSize"),10),Size:{Height:parseInt(a.getAttribute("Height"),10),Width:parseInt(a.getAttribute("Width"),10)}}},!t.imageFormatSupported(d.Image.Format))throw new Error(t.getString("Errors.ImageFormat",d.Image.Format.toUpperCase()));for(void 0===(r=h.getElementsByTagName("DisplayRect"))&&(r=h.getElementsByTagNameNS(u,"DisplayRect")[0]),l=0;l<r.length;l++)o=r[l],void 0===(s=o.getElementsByTagName("Rect")[0])&&(s=o.getElementsByTagNameNS(u,"Rect")[0]),p.push({Rect:{X:parseInt(s.getAttribute("X"),10),Y:parseInt(s.getAttribute("Y"),10),Width:parseInt(s.getAttribute("Width"),10),Height:parseInt(s.getAttribute("Height"),10),MinLevel:parseInt(o.getAttribute("MinLevel"),10),MaxLevel:parseInt(o.getAttribute("MaxLevel"),10)}});return p.length&&(d.Image.DisplayRect=p),e(i,d)}catch(e){throw e instanceof Error?e:new Error(t.getString("Errors.Dzi"))}else{if("Collection"==c)throw new Error(t.getString("Errors.Dzc"));if("Error"==c){var f=h.getElementsByTagName("Message")[0],m=f.firstChild.nodeValue;throw new Error(m)}}throw new Error(t.getString("Errors.Dzi"))}(this,i),n&&!r.tilesUrl&&(r.tilesUrl=n.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=n.search(/\.(dzi|xml|js)\?/)?r.queryParams=n.match(/\?.*/):r.queryParams=""),r},getTileUrl:function(t,e,i){return[this.tilesUrl,t,"/",e,"_",i,".",this.fileFormat,this.queryParams].join("")},tileExists:function(t,e,i){var n,r,o,s,a,l,h,c=this._levelRects[t];if(this.minLevel&&t<this.minLevel||this.maxLevel&&t>this.maxLevel)return!1;if(!c||!c.length)return!0;for(h=c.length-1;h>=0;h--)if(!(t<(n=c[h]).minLevel||t>n.maxLevel)&&(r=this.getLevelScale(t),o=n.x*r,s=n.y*r,a=o+n.width*r,l=s+n.height*r,o=Math.floor(o/this._tileWidth),s=Math.floor(s/this._tileWidth),a=Math.ceil(a/this._tileWidth),l=Math.ceil(l/this._tileWidth),o<=e&&e<a&&s<=i&&i<l))return!0;return!1}})}(OpenSeadragon),function(t){t.IIIFTileSource=function(e){if(t.extend(!0,this,e),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(e.tileSizePerScaleFactor={},this.tile_width&&this.tile_height)e.tileWidth=this.tile_width,e.tileHeight=this.tile_height;else if(this.tile_width)e.tileSize=this.tile_width;else if(this.tile_height)e.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)e.tileWidth=this.tiles[0].width,e.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var i=0;i<this.tiles.length;i++)for(var n=0;n<this.tiles[i].scaleFactors.length;n++){var r=this.tiles[i].scaleFactors[n];this.scale_factors.push(r),e.tileSizePerScaleFactor[r]={width:this.tiles[i].width,height:this.tiles[i].height||this.tiles[i].width}}}else if(h=e.profile,-1==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"].indexOf(h[0])||-1!=h.indexOf("sizeByW")){for(var o=Math.min(this.height,this.width),s=[256,512,1024],a=[],l=0;l<s.length;l++)s[l]<=o&&a.push(s[l]);a.length>0?e.tileSize=Math.max.apply(null,a):e.tileSize=o}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,e.levels=function(t){for(var e=[],i=0;i<t.sizes.length;i++)e.push({url:t["@id"]+"/full/"+t.sizes[i].width+",/0/default.jpg",width:t.sizes[i].width,height:t.sizes[i].height});return e.sort(function(t,e){return t.width-e.width})}(this),t.extend(!0,e,{width:e.levels[e.levels.length-1].width,height:e.levels[e.levels.length-1].height,tileSize:Math.max(e.height,e.width),tileOverlap:0,minLevel:0,maxLevel:e.levels.length-1}),this.levels=e.levels):t.console.error("Nothing in the info.json to construct image pyramids from");var h;if(!e.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var c=Math.max.apply(null,this.scale_factors);e.maxLevel=Math.round(Math.log(c)*Math.LOG2E)}else e.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));t.TileSource.apply(this,[e])},t.extend(t.IIIFTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){return!(!t.protocol||"http://iiif.io/api/image"!=t.protocol)||(!(!t["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=t["@context"]&&"http://iiif.io/api/image/1/context.json"!=t["@context"])||(!(!t.profile||0!==t.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(t.identifier&&t.width&&t.height)||!(!t.documentElement||"info"!=t.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=t.documentElement.namespaceURI))))},configure:function(e,i){if(t.isPlainObject(e))return e["@context"]?e:(e["@context"]="http://iiif.io/api/image/1.0/context.json",e["@id"]=i.replace("/info.json",""),e);var n=function(e){if(!e||!e.documentElement)throw new Error(t.getString("Errors.Xml"));var i=e.documentElement,n=null;if("info"==i.tagName)try{return function e(i,n,r){var o,s;if(3==i.nodeType&&r)(s=i.nodeValue.trim()).match(/^\d*$/)&&(s=Number(s)),n[r]?(t.isArray(n[r])||(n[r]=[n[r]]),n[r].push(s)):n[r]=s;else if(1==i.nodeType)for(o=0;o<i.childNodes.length;o++)e(i.childNodes[o],n,i.nodeName)}(i,n={}),n}catch(e){throw e instanceof Error?e:new Error(t.getString("Errors.IIIF"))}throw new Error(t.getString("Errors.IIIF"))}(e);return n["@context"]="http://iiif.io/api/image/1.0/context.json",n["@id"]=i.replace("/info.xml",""),n},getTileWidth:function(e){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileWidth.call(this,e);var i=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[i]?this.tileSizePerScaleFactor[i].width:this._tileWidth},getTileHeight:function(e){if(this.emulateLegacyImagePyramid)return t.TileSource.prototype.getTileHeight.call(this,e);var i=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[i]?this.tileSizePerScaleFactor[i].height:this._tileHeight},getLevelScale:function(e){if(this.emulateLegacyImagePyramid){var i=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].width/this.levels[this.maxLevel].width),i}return t.TileSource.prototype.getLevelScale.call(this,e)},getNumTiles:function(e){return this.emulateLegacyImagePyramid?this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0):t.TileSource.prototype.getNumTiles.call(this,e)},getTileAtPoint:function(e,i){return this.emulateLegacyImagePyramid?new t.Point(0,0):t.TileSource.prototype.getTileAtPoint.call(this,e,i)},getTileUrl:function(t,e,i){if(this.emulateLegacyImagePyramid){var n=null;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].url),n}var r,o,s,a,l,h,c,u,d,p,f,m=Math.pow(.5,this.maxLevel-t),g=Math.ceil(this.width*m),v=Math.ceil(this.height*m);return r=this.getTileWidth(t),o=this.getTileHeight(t),s=Math.ceil(r/m),a=Math.ceil(o/m),f=this["@context"].indexOf("/1.0/context.json")>-1||this["@context"].indexOf("/1.1/context.json")>-1||this["@context"].indexOf("/1/context.json")>-1?"native.jpg":"default.jpg",g<r&&v<o?(p=g+",",l="full"):(h=e*s,c=i*a,u=Math.min(s,this.width-h),d=Math.min(a,this.height-c),p=Math.ceil(u*m)+",",l=[h,c,u,d].join(",")),[this["@id"],l,p,"0",f].join("/")}})}(OpenSeadragon),function(t){t.OsmTileSource=function(e,i,n,r,o){var s;(s=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]}).width&&s.height||(s.width=65572864,s.height=65572864),s.tileSize||(s.tileSize=256,s.tileOverlap=0),s.tilesUrl||(s.tilesUrl="http://tile.openstreetmap.org/"),s.minLevel=8,t.TileSource.apply(this,[s])},t.extend(t.OsmTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){return t.type&&"openstreetmaps"==t.type},configure:function(t,e){return t},getTileUrl:function(t,e,i){return this.tilesUrl+(t-8)+"/"+e+"/"+i+".png"}})}(OpenSeadragon),function(t){t.TmsTileSource=function(e,i,n,r,o){var s;s=t.isPlainObject(e)?e:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var a,l=256*Math.ceil(s.width/256),h=256*Math.ceil(s.height/256);a=l>h?l/256:h/256,s.maxLevel=Math.ceil(Math.log(a)/Math.log(2))-1,s.tileSize=256,s.width=l,s.height=h,t.TileSource.apply(this,[s])},t.extend(t.TmsTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){return t.type&&"tiledmapservice"==t.type},configure:function(t,e){return t},getTileUrl:function(t,e,i){var n=this.getNumTiles(t).y-1;return this.tilesUrl+t+"/"+e+"/"+(n-i)+".png"}})}(OpenSeadragon),function(t){t.ZoomifyTileSource=function(t){t.tileSize=256;var e={x:t.width,y:t.height};for(t.imageSizes=[{x:t.width,y:t.height}],t.gridSize=[this._getGridSize(t.width,t.height,t.tileSize)];parseInt(e.x,10)>t.tileSize||parseInt(e.y,10)>t.tileSize;)e.x=Math.floor(e.x/2),e.y=Math.floor(e.y/2),t.imageSizes.push({x:e.x,y:e.y}),t.gridSize.push(this._getGridSize(e.x,e.y,t.tileSize));t.imageSizes.reverse(),t.gridSize.reverse(),t.minLevel=0,t.maxLevel=t.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[t])},t.extend(t.ZoomifyTileSource.prototype,t.TileSource.prototype,{_getGridSize:function(t,e,i){return{x:Math.ceil(t/i),y:Math.ceil(e/i)}},_calculateAbsoluteTileNumber:function(t,e,i){for(var n=0,r={},o=0;o<t;o++)n+=(r=this.gridSize[o]).x*r.y;return n+=(r=this.gridSize[t]).x*i+e},supports:function(t,e){return t.type&&"zoomifytileservice"==t.type},configure:function(t,e){return t},getTileUrl:function(t,e,i){var n,r=this._calculateAbsoluteTileNumber(t,e,i);return n=Math.floor(r/256),this.tilesUrl+"TileGroup"+n+"/"+t+"-"+e+"-"+i+".jpg"}})}(OpenSeadragon),function(t){function e(t,e){return e.levels}t.LegacyTileSource=function(e){var i,n,r;t.isArray(e)&&(i={type:"legacy-image-pyramid",levels:e}),i.levels=function(e){var i,n,r=[];for(n=0;n<e.length;n++)(i=e[n]).height&&i.width&&i.url?r.push({url:i.url,width:Number(i.width),height:Number(i.height)}):t.console.error("Unsupported image format: %s",i.url?i.url:"<no URL>");return r.sort(function(t,e){return t.height-e.height})}(i.levels),i.levels.length>0?(n=i.levels[i.levels.length-1].width,r=i.levels[i.levels.length-1].height):(n=0,r=0,t.console.error("No supported image formats found")),t.extend(!0,i,{width:n,height:r,tileSize:Math.max(r,n),tileOverlap:0,minLevel:0,maxLevel:i.levels.length>0?i.levels.length-1:0}),t.TileSource.apply(this,[i]),this.levels=i.levels},t.extend(t.LegacyTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){return t.type&&"legacy-image-pyramid"==t.type||t.documentElement&&"legacy-image-pyramid"==t.documentElement.getAttribute("type")},configure:function(i,n){return t.isPlainObject(i)?e(this,i):function(i,n){if(!n||!n.documentElement)throw new Error(t.getString("Errors.Xml"));var r,o,s=n.documentElement,a=s.tagName,l=null,h=[];if("image"==a)try{for(l={type:s.getAttribute("type"),levels:[]},h=s.getElementsByTagName("level"),o=0;o<h.length;o++)r=h[o],l.levels.push({url:r.getAttribute("url"),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10)});return e(i,l)}catch(t){throw t instanceof Error?t:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==a)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==a)throw new Error("Error: "+n)}throw new Error("Unknown element "+a)}(this,i)},getLevelScale:function(t){var e=NaN;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].width/this.levels[this.maxLevel].width),e},getNumTiles:function(e){return this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(t,e,i){var n=null;return this.levels.length>0&&t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].url),n}})}(OpenSeadragon),function(t){t.ImageTileSource=function(e){e=t.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},e),t.TileSource.apply(this,[e])},t.extend(t.ImageTileSource.prototype,t.TileSource.prototype,{supports:function(t,e){return t.type&&"image"===t.type},configure:function(t,e){return t},getImageInfo:function(e){var i=this._image=new Image,n=this;this.crossOriginPolicy&&(i.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(i.useCredentials=this.ajaxWithCredentials),t.addEvent(i,"load",function(){n.width=Object.prototype.hasOwnProperty.call(i,"naturalWidth")?i.naturalWidth:i.width,n.height=Object.prototype.hasOwnProperty.call(i,"naturalHeight")?i.naturalHeight:i.height,n.aspectRatio=n.width/n.height,n.dimensions=new t.Point(n.width,n.height),n._tileWidth=n.width,n._tileHeight=n.height,n.tileOverlap=0,n.minLevel=0,n.levels=n._buildLevels(),n.maxLevel=n.levels.length-1,n.ready=!0,n.raiseEvent("ready",{tileSource:n})}),t.addEvent(i,"error",function(){n.raiseEvent("open-failed",{message:"Error loading image at "+e,source:e})}),i.src=e},getLevelScale:function(t){var e=NaN;return t>=this.minLevel&&t<=this.maxLevel&&(e=this.levels[t].width/this.levels[this.maxLevel].width),e},getNumTiles:function(e){return this.getLevelScale(e)?new t.Point(1,1):new t.Point(0,0)},getTileUrl:function(t,e,i){var n=null;return t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].url),n},getContext2D:function(t,e,i){var n=null;return t>=this.minLevel&&t<=this.maxLevel&&(n=this.levels[t].context2D),n},_buildLevels:function(){var e=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!t.supportsCanvas||!this.useCanvas)return delete this._image,e;var i=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,n=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,r=document.createElement("canvas"),o=r.getContext("2d");if(r.width=i,r.height=n,o.drawImage(this._image,0,0,i,n),e[0].context2D=o,delete this._image,t.isCanvasTainted(r))return e;for(;i>=2&&n>=2;){i=Math.floor(i/2),n=Math.floor(n/2);var s=document.createElement("canvas"),a=s.getContext("2d");s.width=i,s.height=n,a.drawImage(r,0,0,i,n),e.splice(0,0,{context2D:a,width:i,height:n}),r=s,o=a}return e}})}(OpenSeadragon),function(t){t.TileSourceCollection=function(e,i,n,r){t.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(t){function e(i){t.requestAnimationFrame(function(){!function(i){var n,r,o;i.shouldFade&&(n=t.now(),r=n-i.fadeBeginTime,o=1-r/i.fadeLength,o=Math.min(1,o),o=Math.max(0,o),i.imgGroup&&t.setElementOpacity(i.imgGroup,o,!0),o>0&&e(i))}(i)})}function i(e,i){e.element.disabled||(i>=t.ButtonState.GROUP&&e.currentState==t.ButtonState.REST&&(!function(e){e.shouldFade=!1,e.imgGroup&&t.setElementOpacity(e.imgGroup,1,!0)}(e),e.currentState=t.ButtonState.GROUP),i>=t.ButtonState.HOVER&&e.currentState==t.ButtonState.GROUP&&(e.imgHover&&(e.imgHover.style.visibility=""),e.currentState=t.ButtonState.HOVER),i>=t.ButtonState.DOWN&&e.currentState==t.ButtonState.HOVER&&(e.imgDown&&(e.imgDown.style.visibility=""),e.currentState=t.ButtonState.DOWN))}function n(i,n){i.element.disabled||(n<=t.ButtonState.HOVER&&i.currentState==t.ButtonState.DOWN&&(i.imgDown&&(i.imgDown.style.visibility="hidden"),i.currentState=t.ButtonState.HOVER),n<=t.ButtonState.GROUP&&i.currentState==t.ButtonState.HOVER&&(i.imgHover&&(i.imgHover.style.visibility="hidden"),i.currentState=t.ButtonState.GROUP),n<=t.ButtonState.REST&&i.currentState==t.ButtonState.GROUP&&(!function(i){i.shouldFade=!0,i.fadeBeginTime=t.now()+i.fadeDelay,window.setTimeout(function(){e(i)},i.fadeDelay)}(i),i.currentState=t.ButtonState.REST))}t.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},t.Button=function(e){var r=this;t.EventSource.call(this),t.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},e),this.element=e.element||t.makeNeutralElement("div"),e.element||(this.imgRest=t.makeTransparentImage(this.srcRest),this.imgGroup=t.makeTransparentImage(this.srcGroup),this.imgHover=t.makeTransparentImage(this.srcHover),this.imgDown=t.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",t.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",t.Browser.vendor==t.BROWSERS.FIREFOX&&t.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=t.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new t.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){e.insideElementPressed?(i(r,t.ButtonState.DOWN),r.raiseEvent("enter",{originalEvent:e.originalEvent})):e.buttonDownAny||i(r,t.ButtonState.HOVER)},focusHandler:function(t){this.enterHandler(t),r.raiseEvent("focus",{originalEvent:t.originalEvent})},exitHandler:function(e){n(r,t.ButtonState.GROUP),e.insideElementPressed&&r.raiseEvent("exit",{originalEvent:e.originalEvent})},blurHandler:function(t){this.exitHandler(t),r.raiseEvent("blur",{originalEvent:t.originalEvent})},pressHandler:function(e){i(r,t.ButtonState.DOWN),r.raiseEvent("press",{originalEvent:e.originalEvent})},releaseHandler:function(e){e.insideElementPressed&&e.insideElementReleased?(n(r,t.ButtonState.HOVER),r.raiseEvent("release",{originalEvent:e.originalEvent})):e.insideElementPressed?n(r,t.ButtonState.GROUP):i(r,t.ButtonState.HOVER)},clickHandler:function(t){t.quick&&r.raiseEvent("click",{originalEvent:t.originalEvent})},keyHandler:function(t){return 13!==t.keyCode||(r.raiseEvent("click",{originalEvent:t.originalEvent}),r.raiseEvent("release",{originalEvent:t.originalEvent}),!1)}}),n(this,t.ButtonState.REST)},t.extend(t.Button.prototype,t.EventSource.prototype,{notifyGroupEnter:function(){i(this,t.ButtonState.GROUP)},notifyGroupExit:function(){n(this,t.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,t.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,t.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(t){t.ButtonGroup=function(e){t.extend(!0,this,{buttons:[],clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:t.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},e);var i,n=this.buttons.concat([]),r=this;if(this.element=e.element||t.makeNeutralElement("div"),!e.group)for(this.label=t.makeNeutralElement("label"),this.element.style.display="inline-block",this.element.appendChild(this.label),i=0;i<n.length;i++)this.element.appendChild(n[i].element);t.setElementTouchActionNone(this.element),this.tracker=new t.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(t){var e;for(e=0;e<r.buttons.length;e++)r.buttons[e].notifyGroupEnter()},exitHandler:function(t){var e;if(!t.insideElementPressed)for(e=0;e<r.buttons.length;e++)r.buttons[e].notifyGroupExit()}})},t.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(t){t.Rect=function(e,i,n,r,o){var s,a;this.x="number"==typeof e?e:0,this.y="number"==typeof i?i:0,this.width="number"==typeof n?n:0,this.height="number"==typeof r?r:0,this.degrees="number"==typeof o?o:0,this.degrees=t.positiveModulo(this.degrees,360),this.degrees>=270?(s=this.getTopRight(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=270):this.degrees>=180?(s=this.getBottomRight(),this.x=s.x,this.y=s.y,this.degrees-=180):this.degrees>=90&&(s=this.getBottomLeft(),this.x=s.x,this.y=s.y,a=this.height,this.height=this.width,this.width=a,this.degrees-=90)},t.Rect.fromSummits=function(e,i,n){var r=e.distanceTo(i),o=e.distanceTo(n),s=i.minus(e),a=Math.atan(s.y/s.x);return s.x<0?a+=Math.PI:s.y<0&&(a+=2*Math.PI),new t.Rect(e.x,e.y,r,o,a/Math.PI*180)},t.Rect.prototype={clone:function(){return new t.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new t.Point(this.x,this.y)},getBottomRight:function(){return new t.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new t.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new t.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new t.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new t.Point(this.width,this.height)},equals:function(e){return e instanceof t.Rect&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height&&this.degrees===e.degrees},times:function(e){return new t.Rect(this.x*e,this.y*e,this.width*e,this.height*e,this.degrees)},translate:function(e){return new t.Rect(this.x+e.x,this.y+e.y,this.width,this.height,this.degrees)},union:function(e){var i=this.getBoundingBox(),n=e.getBoundingBox(),r=Math.min(i.x,n.x),o=Math.min(i.y,n.y),s=Math.max(i.x+i.width,n.x+n.width),a=Math.max(i.y+i.height,n.y+n.height);return new t.Rect(r,o,s-r,a-o)},intersection:function(e){var i=1e-10,n=[],r=this.getTopLeft();e.containsPoint(r,i)&&n.push(r);var o=this.getTopRight();e.containsPoint(o,i)&&n.push(o);var s=this.getBottomLeft();e.containsPoint(s,i)&&n.push(s);var a=this.getBottomRight();e.containsPoint(a,i)&&n.push(a);var l=e.getTopLeft();this.containsPoint(l,i)&&n.push(l);var h=e.getTopRight();this.containsPoint(h,i)&&n.push(h);var c=e.getBottomLeft();this.containsPoint(c,i)&&n.push(c);var u=e.getBottomRight();this.containsPoint(u,i)&&n.push(u);for(var d=this._getSegments(),p=e._getSegments(),f=0;f<d.length;f++)for(var m=d[f],g=0;g<p.length;g++){var v=p[g],_=y(m[0],m[1],v[0],v[1]);_&&n.push(_)}function y(e,n,r,o){var s=n.minus(e),a=o.minus(r),l=-a.x*s.y+s.x*a.y;if(0===l)return null;var h=(s.x*(e.y-r.y)-s.y*(e.x-r.x))/l,c=(a.x*(e.y-r.y)-a.y*(e.x-r.x))/l;return-i<=h&&h<=1-i&&-i<=c&&c<=1-i?new t.Point(e.x+c*s.x,e.y+c*s.y):null}if(0===n.length)return null;for(var b=n[0].x,w=n[0].x,S=n[0].y,x=n[0].y,T=1;T<n.length;T++){var E=n[T];E.x<b&&(b=E.x),E.x>w&&(w=E.x),E.y<S&&(S=E.y),E.y>x&&(x=E.y)}return new t.Rect(b,S,w-b,x-S)},_getSegments:function(){var t=this.getTopLeft(),e=this.getTopRight(),i=this.getBottomLeft(),n=this.getBottomRight();return[[t,e],[e,n],[n,i],[i,t]]},rotate:function(e,i){if(0===(e=t.positiveModulo(e,360)))return this.clone();i=i||this.getCenter();var n=this.getTopLeft().rotate(e,i),r=this.getTopRight().rotate(e,i).minus(n);r=r.apply(function(t){return Math.abs(t)<1e-15?0:t});var o=Math.atan(r.y/r.x);return r.x<0?o+=Math.PI:r.y<0&&(o+=2*Math.PI),new t.Rect(n.x,n.y,this.width,this.height,o/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var e=this.getTopLeft(),i=this.getTopRight(),n=this.getBottomLeft(),r=this.getBottomRight(),o=Math.min(e.x,i.x,n.x,r.x),s=Math.max(e.x,i.x,n.x,r.x),a=Math.min(e.y,i.y,n.y,r.y),l=Math.max(e.y,i.y,n.y,r.y);return new t.Rect(o,a,s-o,l-a)},getIntegerBoundingBox:function(){var e=this.getBoundingBox(),i=Math.floor(e.x),n=Math.floor(e.y),r=Math.ceil(e.width+e.x-i),o=Math.ceil(e.height+e.y-n);return new t.Rect(i,n,r,o)},containsPoint:function(t,e){e=e||0;var i=this.getTopLeft(),n=this.getTopRight(),r=this.getBottomLeft(),o=n.minus(i),s=r.minus(i);return(t.x-i.x)*o.x+(t.y-i.y)*o.y>=-e&&(t.x-n.x)*o.x+(t.y-n.y)*o.y<=e&&(t.x-i.x)*s.x+(t.y-i.y)*s.y>=-e&&(t.x-r.x)*s.x+(t.y-r.y)*s.y<=e},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(t){var e={};function i(e){var i=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=t.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-e.delta.x>0?i>-(o-a.x)&&(this.element.style.marginLeft=i+2*e.delta.x+"px",r(this,a.x,i+2*e.delta.x)):-e.delta.x<0&&i<0&&(this.element.style.marginLeft=i+2*e.delta.x+"px",r(this,a.x,i+2*e.delta.x)):-e.delta.y>0?n>-(s-a.y)&&(this.element.style.marginTop=n+2*e.delta.y+"px",r(this,a.y,n+2*e.delta.y)):-e.delta.y<0&&n<0&&(this.element.style.marginTop=n+2*e.delta.y+"px",r(this,a.y,n+2*e.delta.y))),!1}function n(e){var i=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),o=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=t.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?e.scroll>0?i>-(o-a.x)&&(this.element.style.marginLeft=i-60*e.scroll+"px",r(this,a.x,i-60*e.scroll)):e.scroll<0&&i<0&&(this.element.style.marginLeft=i-60*e.scroll+"px",r(this,a.x,i-60*e.scroll)):e.scroll<0?n>a.y-s&&(this.element.style.marginTop=n+60*e.scroll+"px",r(this,a.y,n+60*e.scroll)):e.scroll>0&&n<0&&(this.element.style.marginTop=n+60*e.scroll+"px",r(this,a.y,n+60*e.scroll))),!1}function r(e,i,n){var r,o,s,a,l,h,c;for(r="horizontal"==e.scroll?e.panelWidth:e.panelHeight,o=Math.ceil(i/r)+5,h=o=(o=(s=Math.ceil((Math.abs(n)+i)/r)+1)-o)<0?0:o;h<s&&h<e.panels.length;h++)if(!(c=e.panels[h]).activePanel){var u,d=e.viewer.tileSources[h];u=d.referenceStripThumbnailUrl?{type:"image",url:d.referenceStripThumbnailUrl}:d,(a=new t.Viewer({id:c.id,tileSources:[u],element:c,navigatorSizeRatio:e.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0})).displayRegion=t.makeNeutralElement("div"),a.displayRegion.id=c.id+"-displayregion",a.displayRegion.className="displayregion",(l=a.displayRegion.style).position="relative",l.top="0px",l.left="0px",l.fontSize="0px",l.overflow="hidden",l.float="left",l.cssFloat="left",l.styleFloat="left",l.zIndex=999999999,l.cursor="default",l.width=e.panelWidth-4+"px",l.height=e.panelHeight-4+"px",a.displayRegion.innerTracker=new t.MouseTracker({element:a.displayRegion,startDisabled:!0}),c.getElementsByTagName("div")[0].appendChild(a.displayRegion),e.miniViewers[c.id]=a,c.activePanel=!0}}function o(t){var e=t.eventSource.element;return"horizontal"==this.scroll?e.style.marginBottom="0px":e.style.marginLeft="0px",!1}function s(e){var i=e.eventSource.element;return"horizontal"==this.scroll?i.style.marginBottom="-"+t.getElementSize(i).y/2+"px":i.style.marginLeft="-"+t.getElementSize(i).x/2+"px",!1}function a(t){if(t.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 38:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function l(t){if(t.preventDefaultAction||t.ctrl||t.alt||t.meta)return!0;switch(t.keyCode){case 61:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return n.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return n.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}t.ReferenceStrip=function(h){var c,u,d,p=h.viewer,f=t.getElementSize(p.element);for(h.id||(h.id="referencestrip-"+t.now(),this.element=t.makeNeutralElement("div"),this.element.id=h.id,this.element.className="referencestrip"),h=t.extend(!0,{sizeRatio:t.DEFAULT_SETTINGS.referenceStripSizeRatio,position:t.DEFAULT_SETTINGS.referenceStripPosition,scroll:t.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:t.DEFAULT_SETTINGS.clickTimeThreshold},h,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),t.extend(this,h),e[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(u=this.element.style).marginTop="0px",u.marginRight="0px",u.marginBottom="0px",u.marginLeft="0px",u.left="0px",u.bottom="0px",u.border="0px",u.background="#000",u.position="relative",t.setElementTouchActionNone(this.element),t.setElementOpacity(this.element,.8),this.viewer=p,this.innerTracker=new t.MouseTracker({element:this.element,dragHandler:t.delegate(this,i),scrollHandler:t.delegate(this,n),enterHandler:t.delegate(this,o),exitHandler:t.delegate(this,s),keyDownHandler:t.delegate(this,a),keyHandler:t.delegate(this,l)}),h.width&&h.height?(this.element.style.width=h.width+"px",this.element.style.height=h.height+"px",p.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):"horizontal"==h.scroll?(this.element.style.width=f.x*h.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.height=f.y*h.sizeRatio+"px",p.addControl(this.element,{anchor:t.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=f.y*h.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.width=f.x*h.sizeRatio+"px",p.addControl(this.element,{anchor:t.ControlAnchor.TOP_LEFT})),this.panelWidth=f.x*this.sizeRatio+8,this.panelHeight=f.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},d=0;d<p.tileSources.length;d++)(c=t.makeNeutralElement("div")).id=this.element.id+"-"+d,c.style.width=this.panelWidth+"px",c.style.height=this.panelHeight+"px",c.style.display="inline",c.style.float="left",c.style.cssFloat="left",c.style.styleFloat="left",c.style.padding="2px",t.setElementTouchActionNone(c),c.innerTracker=new t.MouseTracker({element:c,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(e){e.eventSource.dragging=t.now()},releaseHandler:function(e){var i=e.eventSource,n=i.element.id,r=Number(n.split("-")[2]),o=t.now();e.insideElementPressed&&e.insideElementReleased&&i.dragging&&o-i.dragging<i.clickTimeThreshold&&(i.dragging=null,p.goToPage(r))}}),this.element.appendChild(c),c.activePanel=!1,this.panels.push(c);r(this,"vertical"==this.scroll?f.y:f.x,0),this.setFocus(0)},t.extend(t.ReferenceStrip.prototype,t.EventSource.prototype,t.Viewer.prototype,{setFocus:function(e){var i,n=t.getElement(this.element.id+"-"+e),s=t.getElementSize(this.viewer.canvas),a=Number(this.element.style.width.replace("px","")),l=Number(this.element.style.height.replace("px","")),h=-Number(this.element.style.marginLeft.replace("px","")),c=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==n&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=n,this.currentSelected.style.background="#999","horizontal"==this.scroll?(i=Number(e)*(this.panelWidth+3))>h+s.x-this.panelWidth?(i=Math.min(i,a-s.x),this.element.style.marginLeft=-i+"px",r(this,s.x,-i)):i<h&&(i=Math.max(0,i-s.x/2),this.element.style.marginLeft=-i+"px",r(this,s.x,-i)):(i=Number(e)*(this.panelHeight+3))>c+s.y-this.panelHeight?(i=Math.min(i,l-s.y),this.element.style.marginTop=-i+"px",r(this,s.y,-i)):i<c&&(i=Math.max(0,i-s.y/2),this.element.style.marginTop=-i+"px",r(this,s.y,-i)),this.currentPage=e,o.call(this,{eventSource:this.innerTracker}))},update:function(){return!!e[this.id].animating&&(t.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var t in this.miniViewers)this.miniViewers[t].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(t){t.DisplayRect=function(e,i,n,r,o,s){t.Rect.apply(this,[e,i,n,r]),this.minLevel=o,this.maxLevel=s},t.extend(t.DisplayRect.prototype,t.Rect.prototype)}(OpenSeadragon),function(t){t.Spring=function(e){var i=arguments;"object"!=typeof e&&(e={initial:i.length&&"number"==typeof i[0]?i[0]:void 0,springStiffness:i.length>1?i[1].springStiffness:5,animationTime:i.length>1?i[1].animationTime:1.5}),t.console.assert("number"==typeof e.springStiffness&&0!==e.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),t.console.assert("number"==typeof e.animationTime&&e.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),e.exponential&&(this._exponential=!0,delete e.exponential),t.extend(!0,this,e),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:t.now()},t.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},t.Spring.prototype={resetTo:function(e){t.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=e,this.start.time=this.target.time=this.current.time=t.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(e){t.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(e){this.start.value+=e,this.target.value+=e,this._exponential&&(t.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(e){this._exponential=e,this._exponential&&(t.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var e,i;this.current.time=t.now(),this._exponential?(e=this.start._logValue,i=this.target._logValue):(e=this.start.value,i=this.target.value);var n,r,o=this.current.time>=this.target.time?i:e+(i-e)*(n=this.springStiffness,r=(this.current.time-this.start.time)/(this.target.time-this.start.time),(1-Math.exp(n*-r))/(1-Math.exp(-n))),s=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,s!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(t){function e(e){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null},e),this.image=null}e.prototype={errorMsg:null,start:function(){var e=this,i=this.abort;this.image=new Image,this.image.onload=function(){e.finish(!0)},this.image.onabort=this.image.onerror=function(){e.errorMsg="Image load aborted",e.finish(!1)},this.jobId=window.setTimeout(function(){e.errorMsg="Image load exceeded timeout",e.finish(!1)},this.timeout),this.loadWithAjax?(this.request=t.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(t){var i;try{i=new window.Blob([t.response])}catch(e){var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===e.name&&n){var r=new n;r.append(t.response),i=r.getBlob()}}0===i.size&&(e.errorMsg="Empty image response.",e.finish(!1));var o=(window.URL||window.webkitURL).createObjectURL(i);e.image.src=o},error:function(t){e.errorMsg="Image load aborted - XHR error",e.finish(!1)}}),this.abort=function(){e.request.abort(),"function"==typeof i&&i()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(t){this.image.onload=this.image.onerror=this.image.onabort=null,t||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(e){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},e)},t.ImageLoader.prototype={addJob:function(t){var i=this,n=new e({src:t.src,loadWithAjax:t.loadWithAjax,ajaxHeaders:t.loadWithAjax?t.ajaxHeaders:null,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:function(e){!function(t,e,i){t.jobsInProgress--,(!t.jobLimit||t.jobsInProgress<t.jobLimit)&&t.jobQueue.length>0&&(t.jobQueue.shift().start(),t.jobsInProgress++),i(e.image,e.errorMsg,e.request)}(i,e,t.callback)},abort:t.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(n.start(),this.jobsInProgress++):this.jobQueue.push(n)},clear:function(){for(var t=0;t<this.jobQueue.length;t++){var e=this.jobQueue[t];"function"==typeof e.abort&&e.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(t){t.Tile=function(t,e,i,n,r,o,s,a,l,h){this.level=t,this.x=e,this.y=i,this.bounds=n,this.sourceBounds=h,this.exists=r,this.url=o,this.context2D=s,this.loadWithAjax=a,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},t.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(e){this.cacheImageRecord?this.loaded?(this.element||(this.element=t.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=e&&e.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",t.setElementOpacity(this.element,this.opacity)):t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):t.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(e,i,n,r){var o,s,a,l=this.position.times(t.pixelDensityRatio),h=this.size.times(t.pixelDensityRatio);this.context2D||this.cacheImageRecord?(o=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&o?(e.save(),e.globalAlpha=this.opacity,"number"==typeof n&&1!==n&&(l=l.times(n),h=h.times(n)),r instanceof t.Point&&(l=l.plus(r)),1===e.globalAlpha&&this._hasTransparencyChannel()&&e.clearRect(l.x,l.y,h.x,h.y),i({context:e,tile:this,rendered:o}),this.sourceBounds?(s=Math.min(this.sourceBounds.width,o.canvas.width),a=Math.min(this.sourceBounds.height,o.canvas.height)):(s=o.canvas.width,a=o.canvas.height),e.drawImage(o.canvas,0,0,s,a,l.x,l.y,h.x,h.y),e.restore()):t.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):t.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var e;if(this.cacheImageRecord)e=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return t.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;e=this.context2D}return e.canvas.width/(this.size.x*t.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(e,i,n){var r=Math.max(1,Math.ceil((n.x-i.x)/2)),o=Math.max(1,Math.ceil((n.y-i.y)/2));return new t.Point(r,o).minus(this.position.times(t.pixelDensityRatio).times(e||1).apply(function(t){return t%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(t){t.OverlayPlacement=t.Placement,t.OverlayRotationMode=t.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),t.Overlay=function(e,i,n){var r;r=t.isPlainObject(e)?e:{element:e,location:i,placement:n},this.element=r.element,this.style=r.element.style,this._init(r)},t.Overlay.prototype={_init:function(e){this.location=e.location,this.placement=void 0===e.placement?t.Placement.TOP_LEFT:e.placement,this.onDraw=e.onDraw,this.checkResize=void 0===e.checkResize||e.checkResize,this.width=void 0===e.width?null:e.width,this.height=void 0===e.height?null:e.height,this.rotationMode=e.rotationMode||t.OverlayRotationMode.EXACT,this.location instanceof t.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=t.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new t.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(e,i){var n=t.Placement.properties[this.placement];n&&(n.isHorizontallyCentered?e.x-=i.x/2:n.isRight&&(e.x-=i.x),n.isVerticallyCentered?e.y-=i.y/2:n.isBottom&&(e.y-=i.y))},destroy:function(){var e=this.element,i=this.style;e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent&&(i.display="none",document.body.appendChild(e))),this.onDraw=null,i.top="",i.left="",i.position="",null!==this.width&&(i.width=""),null!==this.height&&(i.height="");var n=t.getCssPropertyWithVendorPrefix("transformOrigin"),r=t.getCssPropertyWithVendorPrefix("transform");n&&r&&(i[n]="",i[r]="")},drawHTML:function(e,i){var n=this.element;n.parentNode!==e&&(n.prevElementParent=n.parentNode,n.prevNextSibling=n.nextSibling,e.appendChild(n),this.style.position="absolute",this.size=t.getElementSize(n));var r=this._getOverlayPositionAndSize(i),o=r.position,s=this.size=r.size,a=r.rotate;if(this.onDraw)this.onDraw(o,s,this.element);else{var l=this.style;l.left=o.x+"px",l.top=o.y+"px",null!==this.width&&(l.width=s.x+"px"),null!==this.height&&(l.height=s.y+"px");var h=t.getCssPropertyWithVendorPrefix("transformOrigin"),c=t.getCssPropertyWithVendorPrefix("transform");h&&c&&(a?(l[h]=this._getTransformOrigin(),l[c]="rotate("+a+"deg)"):(l[h]="",l[c]="")),"none"!==l.display&&(l.display="block")}},_getOverlayPositionAndSize:function(e){var i=e.pixelFromPoint(this.location,!0),n=this._getSizeInPixels(e);this.adjust(i,n);var r=0;if(e.degrees&&this.rotationMode!==t.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var o=new t.Rect(i.x,i.y,n.x,n.y),s=this._getBoundingBox(o,e.degrees);i=s.getTopLeft(),n=s.getSize()}else r=e.degrees;return{position:i,size:n,rotate:r}},_getSizeInPixels:function(e){var i=this.size.x,n=this.size.y;if(null!==this.width||null!==this.height){var r=e.deltaPixelsFromPointsNoRotate(new t.Point(this.width||0,this.height||0),!0);null!==this.width&&(i=r.x),null!==this.height&&(n=r.y)}if(this.checkResize&&(null===this.width||null===this.height)){var o=this.size=t.getElementSize(this.element);null===this.width&&(i=o.x),null===this.height&&(n=o.y)}return new t.Point(i,n)},_getBoundingBox:function(t,e){var i=this._getPlacementPoint(t);return t.rotate(e,i).getBoundingBox()},_getPlacementPoint:function(e){var i=new t.Point(e.x,e.y),n=t.Placement.properties[this.placement];return n&&(n.isHorizontallyCentered?i.x+=e.width/2:n.isRight&&(i.x+=e.width),n.isVerticallyCentered?i.y+=e.height/2:n.isBottom&&(i.y+=e.height)),i},_getTransformOrigin:function(){var e="",i=t.Placement.properties[this.placement];return i?(i.isLeft?e="left":i.isRight&&(e="right"),i.isTop?e+=" top":i.isBottom&&(e+=" bottom"),e):e},update:function(e,i){var n=t.isPlainObject(e)?e:{location:e,placement:i};this._init({location:n.location||this.location,placement:void 0!==n.placement?n.placement:this.placement,onDraw:n.onDraw||this.onDraw,checkResize:n.checkResize||this.checkResize,width:void 0!==n.width?n.width:this.width,height:void 0!==n.height?n.height:this.height,rotationMode:n.rotationMode||this.rotationMode})},getBounds:function(e){t.console.assert(e,"A viewport must now be passed to Overlay.getBounds.");var i=this.width,n=this.height;if(null===i||null===n){var r=e.deltaPointsFromPixelsNoRotate(this.size,!0);null===i&&(i=r.x),null===n&&(n=r.y)}var o=this.location.clone();return this.adjust(o,new t.Point(i,n)),this._adjustBoundsForRotation(e,new t.Rect(o.x,o.y,i,n))},_adjustBoundsForRotation:function(e,i){if(!e||0===e.degrees||this.rotationMode===t.OverlayRotationMode.EXACT)return i;if(this.rotationMode===t.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return i;var n=this._getOverlayPositionAndSize(e);return e.viewerElementToViewportRectangle(new t.Rect(n.position.x,n.position.y,n.size.x,n.size.y))}return i.rotate(-e.degrees,this._getPlacementPoint(i))}}}(OpenSeadragon),function(t){t.Drawer=function(e){t.console.assert(e.viewer,"[Drawer] options.viewer is required");var i=arguments;if(t.isPlainObject(e)||(e={source:i[0],viewport:i[1],element:i[2]}),t.console.assert(e.viewport,"[Drawer] options.viewport is required"),t.console.assert(e.element,"[Drawer] options.element is required"),e.source&&t.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=e.viewer,this.viewport=e.viewport,this.debugGridColor="string"==typeof e.debugGridColor?[e.debugGridColor]:e.debugGridColor||t.DEFAULT_SETTINGS.debugGridColor,e.opacity&&t.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=t.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=t.getElement(e.element),this.canvas=t.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var n=this._calculateCanvasSize();this.canvas.width=n.x,this.canvas.height=n.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",t.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas)},t.Drawer.prototype={addOverlay:function(e,i,n,r){return t.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(e,i,n,r),this},updateOverlay:function(e,i,n){return t.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(e,i,n),this},removeOverlay:function(e){return t.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(e),this},clearOverlays:function(){return t.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(e){t.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var i=this.viewer.world,n=0;n<i.getItemCount();n++)i.getItemAt(n).setOpacity(e);return this},getOpacity:function(){t.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var e=this.viewer.world,i=0,n=0;n<e.getItemCount();n++){var r=e.getItemAt(n).getOpacity();r>i&&(i=r)}return i},needsUpdate:function(){return t.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return t.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return t.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return t.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var t=this._calculateCanvasSize();if((this.canvas.width!=t.x||this.canvas.height!=t.y)&&(this.canvas.width=t.x,this.canvas.height=t.y,null!==this.sketchCanvas)){var e=this._calculateSketchCanvasSize();this.sketchCanvas.width=e.x,this.sketchCanvas.height=e.y}this._clear()}},_clear:function(t,e){if(this.useCanvas){var i=this._getContext(t);if(e)i.clearRect(e.x,e.y,e.width,e.height);else{var n=i.canvas;i.clearRect(0,0,n.width,n.height)}}},viewportToDrawerRectangle:function(e){var i=this.viewport.pixelFromPointNoRotate(e.getTopLeft(),!0),n=this.viewport.deltaPixelsFromPointsNoRotate(e.getSize(),!0);return new t.Rect(i.x*t.pixelDensityRatio,i.y*t.pixelDensityRatio,n.x*t.pixelDensityRatio,n.y*t.pixelDensityRatio)},drawTile:function(e,i,n,r,o){if(t.console.assert(e,"[Drawer.drawTile] tile is required"),t.console.assert(i,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var s=this._getContext(n);r=r||1,e.drawCanvas(s,i,r,o)}else e.drawHTML(this.canvas)},_getContext:function(t){var e=this.context;if(t){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var i=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=i.x,this.sketchCanvas.height=i.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var n=this;this.viewer.addHandler("rotate",function t(){if(0!==n.viewport.getRotation()){n.viewer.removeHandler("rotate",t);var e=n._calculateSketchCanvasSize();n.sketchCanvas.width=e.x,n.sketchCanvas.height=e.y}})}}e=this.sketchContext}return e},saveContext:function(t){this.useCanvas&&this._getContext(t).save()},restoreContext:function(t){this.useCanvas&&this._getContext(t).restore()},setClip:function(t,e){if(this.useCanvas){var i=this._getContext(e);i.beginPath(),i.rect(t.x,t.y,t.width,t.height),i.clip()}},drawRectangle:function(t,e,i){if(this.useCanvas){var n=this._getContext(i);n.save(),n.fillStyle=e,n.fillRect(t.x,t.y,t.width,t.height),n.restore()}},blendSketch:function(e,i,n,r){var o=e;if(t.isPlainObject(o)||(o={opacity:e,scale:i,translate:n,compositeOperation:r}),this.useCanvas&&this.sketchCanvas){e=o.opacity,r=o.compositeOperation;var s=o.bounds;if(this.context.save(),this.context.globalAlpha=e,r&&(this.context.globalCompositeOperation=r),s)s.x<0&&(s.width+=s.x,s.x=0),s.x+s.width>this.canvas.width&&(s.width=this.canvas.width-s.x),s.y<0&&(s.height+=s.y,s.y=0),s.y+s.height>this.canvas.height&&(s.height=this.canvas.height-s.y),this.context.drawImage(this.sketchCanvas,s.x,s.y,s.width,s.height,s.x,s.y,s.width,s.height);else{i=o.scale||1;var a=(n=o.translate)instanceof t.Point?n:new t.Point(0,0),l=0,h=0;if(n){var c=this.sketchCanvas.width-this.canvas.width,u=this.sketchCanvas.height-this.canvas.height;l=Math.round(c/2),h=Math.round(u/2)}this.context.drawImage(this.sketchCanvas,a.x-l*i,a.y-h*i,(this.canvas.width+2*l)*i,(this.canvas.height+2*h)*i,-l,-h,this.canvas.width+2*l,this.canvas.height+2*h)}this.context.restore()}},drawDebugInfo:function(e,i,n,r){if(this.useCanvas){var o=this.viewer.world.getIndexOfItem(r)%this.debugGridColor.length,s=this.context;s.save(),s.lineWidth=2*t.pixelDensityRatio,s.font="small-caps bold "+13*t.pixelDensityRatio+"px arial",s.strokeStyle=this.debugGridColor[o],s.fillStyle=this.debugGridColor[o],0!==this.viewport.degrees?this._offsetForRotation({degrees:this.viewport.degrees}):this.viewer.viewport.flipped&&this._flip(),r.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:r.getRotation(!0),point:r.viewport.pixelFromPointNoRotate(r._getRotationPoint(!0),!0)}),s.strokeRect(e.position.x*t.pixelDensityRatio,e.position.y*t.pixelDensityRatio,e.size.x*t.pixelDensityRatio,e.size.y*t.pixelDensityRatio);var a=(e.position.x+e.size.x/2)*t.pixelDensityRatio,l=(e.position.y+e.size.y/2)*t.pixelDensityRatio;s.translate(a,l),s.rotate(Math.PI/180*-this.viewport.degrees),s.translate(-a,-l),0===e.x&&0===e.y&&(s.fillText("Zoom: "+this.viewport.getZoom(),e.position.x*t.pixelDensityRatio,(e.position.y-30)*t.pixelDensityRatio),s.fillText("Pan: "+this.viewport.getBounds().toString(),e.position.x*t.pixelDensityRatio,(e.position.y-20)*t.pixelDensityRatio)),s.fillText("Level: "+e.level,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+20)*t.pixelDensityRatio),s.fillText("Column: "+e.x,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+30)*t.pixelDensityRatio),s.fillText("Row: "+e.y,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+40)*t.pixelDensityRatio),s.fillText("Order: "+n+" of "+i,(e.position.x+10)*t.pixelDensityRatio,(e.position.y+50)*t.pixelDensityRatio),s.fillText("Size: "+e.size.toString(),(e.position.x+10)*t.pixelDensityRatio,(e.position.y+60)*t.pixelDensityRatio),s.fillText("Position: "+e.position.toString(),(e.position.x+10)*t.pixelDensityRatio,(e.position.y+70)*t.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),r.getRotation(!0)%360!=0&&this._restoreRotationChanges(),s.restore()}},debugRect:function(e){if(this.useCanvas){var i=this.context;i.save(),i.lineWidth=2*t.pixelDensityRatio,i.strokeStyle=this.debugGridColor[0],i.fillStyle=this.debugGridColor[0],i.strokeRect(e.x*t.pixelDensityRatio,e.y*t.pixelDensityRatio,e.width*t.pixelDensityRatio,e.height*t.pixelDensityRatio),i.restore()}},getCanvasSize:function(e){var i=this._getContext(e).canvas;return new t.Point(i.width,i.height)},getCanvasCenter:function(){return new t.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(e){var i=e.point?e.point.times(t.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(e.useSketch);n.save(),n.translate(i.x,i.y),this.viewer.viewport.flipped?(n.rotate(Math.PI/180*-e.degrees),n.scale(-1,1)):n.rotate(Math.PI/180*e.degrees),n.translate(-i.x,-i.y)},_flip:function(e){var i=(e=e||{}).point?e.point.times(t.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(e.useSketch);n.translate(i.x,0),n.scale(-1,1),n.translate(-i.x,0)},_restoreRotationChanges:function(t){this._getContext(t).restore()},_calculateCanvasSize:function(){var e=t.pixelDensityRatio,i=this.viewport.getContainerSize();return{x:i.x*e,y:i.y*e}},_calculateSketchCanvasSize:function(){var t=this._calculateCanvasSize();if(0===this.viewport.getRotation())return t;var e=Math.ceil(Math.sqrt(t.x*t.x+t.y*t.y));return{x:e,y:e}}}}(OpenSeadragon),function(t){t.Viewport=function(e){var i=arguments;i.length&&i[0]instanceof t.Point&&(e={containerSize:i[0],contentSize:i[1],config:i[2]}),e.config&&(t.extend(!0,e,e.config),delete e.config),this._margins=t.extend({left:0,top:0,right:0,bottom:0},e.margins||{}),delete e.margins,t.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:t.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:t.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:t.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:t.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:t.DEFAULT_SETTINGS.maxZoomLevel,degrees:t.DEFAULT_SETTINGS.degrees,flipped:t.DEFAULT_SETTINGS.flipped,homeFillsViewer:t.DEFAULT_SETTINGS.homeFillsViewer},e),this._updateContainerInnerSize(),this.centerSpringX=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new t.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new t.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new t.Rect(0,0,1,1),1),this.goHome(!0),this.update()},t.Viewport.prototype={resetContentSize:function(e){return t.console.assert(e,"[Viewport.resetContentSize] contentSize is required"),t.console.assert(e instanceof t.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),t.console.assert(e.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),t.console.assert(e.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new t.Rect(0,0,1,e.y/e.x),e.x),this},setHomeBounds:function(e,i){t.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(e,i)},_setContentBounds:function(e,i){t.console.assert(e,"[Viewport._setContentBounds] bounds is required"),t.console.assert(e instanceof t.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),t.console.assert(e.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),t.console.assert(e.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=e.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(i),this._contentBounds=e.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(i),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:i,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var t=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?t>=1?t:1:t>=1?1:t)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var e=this._contentBounds.getCenter(),i=1/this.getHomeZoom(),n=i/this.getAspectRatio();return new t.Rect(e.x-i/2,e.y-n/2,i,n)},goHome:function(t){return this.viewer&&this.viewer.raiseEvent("home",{immediately:t}),this.fitBounds(this.getHomeBounds(),t)},getMinZoom:function(){var t=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*t},getMaxZoom:function(){var t=this.maxZoomLevel;return t||(t=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,t/=this._contentBounds.width),Math.max(t,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new t.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return t.extend({},this._margins)},setMargins:function(e){t.console.assert("object"===t.type(e),"[Viewport.setMargins] margins must be an object"),this._margins=t.extend({left:0,top:0,right:0,bottom:0},e),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(t){return this.getBoundsNoRotate(t).rotate(-this.getRotation())},getBoundsNoRotate:function(e){var i=this.getCenter(e),n=1/this.getZoom(e),r=n/this.getAspectRatio();return new t.Rect(i.x-n/2,i.y-r/2,n,r)},getBoundsWithMargins:function(t){return this.getBoundsNoRotateWithMargins(t).rotate(-this.getRotation(),this.getCenter(t))},getBoundsNoRotateWithMargins:function(t){var e=this.getBoundsNoRotate(t),i=this._containerInnerSize.x*this.getZoom(t);return e.x-=this._margins.left/i,e.y-=this._margins.top/i,e.width+=(this._margins.left+this._margins.right)/i,e.height+=(this._margins.top+this._margins.bottom)/i,e},getCenter:function(e){var i,n,r,o,s,a,l=new t.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),h=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return e?l:this.zoomPoint?(i=this.pixelFromPoint(this.zoomPoint,!0),o=(r=1/(n=this.getZoom()))/this.getAspectRatio(),s=new t.Rect(l.x-r/2,l.y-o/2,r,o),a=this._pixelFromPoint(this.zoomPoint,s).minus(i).divide(this._containerInnerSize.x*n),h.plus(a)):h},getZoom:function(t){return t?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(t){return Math.max(Math.min(t,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var i=new t.Rect(e.x,e.y,e.width,e.height);if(this.wrapHorizontal);else{var n=this.visibilityRatio*i.width,r=i.x+i.width,o=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,s=this._contentBoundsNoRotate.x-r+n,a=o-i.x-n;n>this._contentBoundsNoRotate.width?i.x+=(s+a)/2:a<0?i.x+=a:s>0&&(i.x+=s)}if(this.wrapVertical);else{var l=this.visibilityRatio*i.height,h=i.y+i.height,c=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,u=this._contentBoundsNoRotate.y-h+l,d=c-i.y-l;l>this._contentBoundsNoRotate.height?i.y+=(u+d)/2:d<0?i.y+=d:u>0&&(i.y+=u)}return i},_raiseConstraintsEvent:function(t){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:t})},applyConstraints:function(t){var e=this.getZoom(),i=this._applyZoomConstraints(e);e!==i&&this.zoomTo(i,this.zoomPoint,t);var n=this.getBoundsNoRotate(),r=this._applyBoundaryConstraints(n);return this._raiseConstraintsEvent(t),(n.x!==r.x||n.y!==r.y||t)&&this.fitBounds(r.rotate(-this.getRotation()),t),this},ensureVisible:function(t){return this.applyConstraints(t)},_fitBounds:function(e,i){var n=(i=i||{}).immediately||!1,r=i.constraints||!1,o=this.getAspectRatio(),s=e.getCenter(),a=new t.Rect(e.x,e.y,e.width,e.height,e.degrees+this.getRotation()).getBoundingBox();a.getAspectRatio()>=o?a.height=a.width/o:a.width=a.height*o,a.x=s.x-a.width/2,a.y=s.y-a.height/2;var l=1/a.width;if(r){var h=a.getAspectRatio(),c=this._applyZoomConstraints(l);l!==c&&(l=c,a.width=1/l,a.x=s.x-a.width/2,a.height=a.width/h,a.y=s.y-a.height/2),s=(a=this._applyBoundaryConstraints(a)).getCenter(),this._raiseConstraintsEvent(n)}if(n)return this.panTo(s,!0),this.zoomTo(l,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var u=this.getBounds(),d=this.getZoom();if(0===d||Math.abs(l/d-1)<1e-8)return this.zoomTo(l,!0),this.panTo(s,n);var p=(a=a.rotate(-this.getRotation())).getTopLeft().times(l).minus(u.getTopLeft().times(d)).divide(l-d);return this.zoomTo(l,p,n)},fitBounds:function(t,e){return this._fitBounds(t,{immediately:e,constraints:!1})},fitBoundsWithConstraints:function(t,e){return this._fitBounds(t,{immediately:e,constraints:!0})},fitVertically:function(e){var i=new t.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(i,e)},fitHorizontally:function(e){var i=new t.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(i,e)},getConstrainedBounds:function(t){var e;return e=this.getBounds(t),this._applyBoundaryConstraints(e)},panBy:function(e,i){var n=new t.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(n.plus(e),i)},panTo:function(t,e){return e?(this.centerSpringX.resetTo(t.x),this.centerSpringY.resetTo(t.y)):(this.centerSpringX.springTo(t.x),this.centerSpringY.springTo(t.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:t,immediately:e}),this},zoomBy:function(t,e,i){return this.zoomTo(this.zoomSpring.target.value*t,e,i)},zoomTo:function(e,i,n){var r=this;return this.zoomPoint=i instanceof t.Point&&!isNaN(i.x)&&!isNaN(i.y)?i:null,n?this._adjustCenterSpringsForZoomPoint(function(){r.zoomSpring.resetTo(e)}):this.zoomSpring.springTo(e),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:e,refPoint:i,immediately:n}),this},setRotation:function(e){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=t.positiveModulo(e,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:e}),this):this},getRotation:function(){return this.degrees},resize:function(t,e){var i,n=this.getBoundsNoRotate(),r=n;return this.containerSize.x=t.x,this.containerSize.y=t.y,this._updateContainerInnerSize(),e&&(i=t.x/this.containerSize.x,r.width=n.width*i,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:t,maintain:e}),this.fitBounds(r,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new t.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var t=this;this._adjustCenterSpringsForZoomPoint(function(){t.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var e=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,e},_adjustCenterSpringsForZoomPoint:function(t){if(this.zoomPoint){var e=this.pixelFromPoint(this.zoomPoint,!0);t();var i=this.pixelFromPoint(this.zoomPoint,!0).minus(e),n=this.deltaPointsFromPixels(i,!0);this.centerSpringX.shiftBy(n.x),this.centerSpringY.shiftBy(n.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else t()},deltaPixelsFromPointsNoRotate:function(t,e){return t.times(this._containerInnerSize.x*this.getZoom(e))},deltaPixelsFromPoints:function(t,e){return this.deltaPixelsFromPointsNoRotate(t.rotate(this.getRotation()),e)},deltaPointsFromPixelsNoRotate:function(t,e){return t.divide(this._containerInnerSize.x*this.getZoom(e))},deltaPointsFromPixels:function(t,e){return this.deltaPointsFromPixelsNoRotate(t,e).rotate(-this.getRotation())},pixelFromPointNoRotate:function(t,e){return this._pixelFromPointNoRotate(t,this.getBoundsNoRotate(e))},pixelFromPoint:function(t,e){return this._pixelFromPoint(t,this.getBoundsNoRotate(e))},_pixelFromPointNoRotate:function(e,i){return e.minus(i.getTopLeft()).times(this._containerInnerSize.x/i.width).plus(new t.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(t,e){return this._pixelFromPointNoRotate(t.rotate(this.getRotation(),this.getCenter(!0)),e)},pointFromPixelNoRotate:function(e,i){var n=this.getBoundsNoRotate(i);return e.minus(new t.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/n.width).plus(n.getTopLeft())},pointFromPixel:function(t,e){return this.pointFromPixelNoRotate(t,e).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(e,i){var n=this._contentBoundsNoRotate.width;return new t.Point(e*this._contentSizeNoRotate.x/n,i*this._contentSizeNoRotate.x/n)},viewportToImageCoordinates:function(e,i){if(e instanceof t.Point)return this.viewportToImageCoordinates(e.x,e.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)t.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===n){return this.viewer.world.getItemAt(0).viewportToImageCoordinates(e,i,!0)}}return this._viewportToImageDelta(e-this._contentBoundsNoRotate.x,i-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(e,i){var n=this._contentBoundsNoRotate.width;return new t.Point(e/this._contentSizeNoRotate.x*n,i/this._contentSizeNoRotate.x*n)},imageToViewportCoordinates:function(e,i){if(e instanceof t.Point)return this.imageToViewportCoordinates(e.x,e.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(n>1)t.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===n){return this.viewer.world.getItemAt(0).imageToViewportCoordinates(e,i,!0)}}var r=this._imageToViewportDelta(e,i);return r.x+=this._contentBoundsNoRotate.x,r.y+=this._contentBoundsNoRotate.y,r},imageToViewportRectangle:function(e,i,n,r){var o=e;if(o instanceof t.Rect||(o=new t.Rect(e,i,n,r)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)t.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===s){return this.viewer.world.getItemAt(0).imageToViewportRectangle(e,i,n,r,!0)}}var a=this.imageToViewportCoordinates(o.x,o.y),l=this._imageToViewportDelta(o.width,o.height);return new t.Rect(a.x,a.y,l.x,l.y,o.degrees)},viewportToImageRectangle:function(e,i,n,r){var o=e;if(o instanceof t.Rect||(o=new t.Rect(e,i,n,r)),this.viewer){var s=this.viewer.world.getItemCount();if(s>1)t.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===s){return this.viewer.world.getItemAt(0).viewportToImageRectangle(e,i,n,r,!0)}}var a=this.viewportToImageCoordinates(o.x,o.y),l=this._viewportToImageDelta(o.width,o.height);return new t.Rect(a.x,a.y,l.x,l.y,o.degrees)},viewerElementToImageCoordinates:function(t){var e=this.pointFromPixel(t,!0);return this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(t){var e=this.imageToViewportCoordinates(t);return this.pixelFromPoint(e,!0)},windowToImageCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var i=e.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(i)},imageToWindowCoordinates:function(e){return t.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(e).plus(t.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(t){return this.pointFromPixel(t,!0)},viewportToViewerElementCoordinates:function(t){return this.pixelFromPoint(t,!0)},viewerElementToViewportRectangle:function(e){return t.Rect.fromSummits(this.pointFromPixel(e.getTopLeft(),!0),this.pointFromPixel(e.getTopRight(),!0),this.pointFromPixel(e.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(e){return t.Rect.fromSummits(this.pixelFromPoint(e.getTopLeft(),!0),this.pixelFromPoint(e.getTopRight(),!0),this.pixelFromPoint(e.getBottomLeft(),!0))},windowToViewportCoordinates:function(e){t.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var i=e.minus(t.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(i)},viewportToWindowCoordinates:function(e){return t.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(e).plus(t.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)t.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===i){return this.viewer.world.getItemAt(0).viewportToImageZoom(e)}}var n=this._contentSizeNoRotate.x;return e*(this._containerInnerSize.x/n*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(e){if(this.viewer){var i=this.viewer.world.getItemCount();if(i>1)t.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===i){return this.viewer.world.getItemAt(0).imageToViewportZoom(e)}}return e*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(t){return this.flipped===t?this:(this.flipped=t,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:t}),this)}}}(OpenSeadragon),function(t){function e(t,e,n,r,o,s,l,h,c){var u=l.getBoundingBox().getTopLeft(),d=l.getBoundingBox().getBottomRight();t.viewer&&t.viewer.raiseEvent("update-level",{tiledImage:t,havedrawn:e,level:r,opacity:o,visibility:s,drawArea:l,topleft:u,bottomright:d,currenttime:h,best:c}),a(t.coverage,r),a(t.loadingCoverage,r);for(var p=t._getCornerTiles(r,u,d),f=p.topLeft,m=p.bottomRight,g=t.source.getNumTiles(r),v=t.viewport.pixelFromPoint(t.viewport.getCenter()),_=f.x;_<=m.x;_++)for(var y=f.y;y<=m.y;y++){if(!t.wrapHorizontal&&!t.wrapVertical){var b=t.source.getTileBounds(r,_,y);if(null===l.intersection(b))continue}c=i(t,n,e,_,y,r,o,s,v,g,h,c)}return c}function i(e,i,r,a,l,h,c,u,d,p,f,m){var g=function(e,i,n,r,o,s,a,l,h,c){var u,d,p,f,m,g,v,_,y;s[n]||(s[n]={});s[n][e]||(s[n][e]={});s[n][e][i]||(u=(l.x+e%l.x)%l.x,d=(l.y+i%l.y)%l.y,p=o.getTileBounds(n,u,d),f=o.getTileBounds(n,u,d,!0),m=o.tileExists(n,u,d),g=o.getTileUrl(n,u,d),r.loadTilesWithAjax?(v=o.getTileAjaxHeaders(n,u,d),t.isPlainObject(r.ajaxHeaders)&&(v=t.extend({},r.ajaxHeaders,v))):v=null,_=o.getContext2D?o.getContext2D(n,u,d):void 0,p.x+=(e-u)/l.x,p.y+=c/h*((i-d)/l.y),y=new t.Tile(n,e,i,p,m,g,_,r.loadTilesWithAjax,v,f),u===l.x-1&&(y.isRightMost=!0),d===l.y-1&&(y.isBottomMost=!0),s[n][e][i]=y);return(y=s[n][e][i]).lastTouchTime=a,y}(a,l,h,e,e.source,e.tilesMatrix,f,p,e._worldWidthCurrent,e._worldHeightCurrent),v=r;e.viewer&&e.viewer.raiseEvent("update-tile",{tiledImage:e,tile:g}),s(e.coverage,h,a,l,!1);var _=g.loaded||g.loading||o(e.loadingCoverage,h,a,l);if(s(e.loadingCoverage,h,a,l,_),!g.exists)return m;if(i&&!v&&(o(e.coverage,h,a,l)?s(e.coverage,h,a,l,!0):v=!0),!v)return m;if(function(e,i,n,r,o,s){var a=e.bounds.getTopLeft();a.x*=s._scaleSpring.current.value,a.y*=s._scaleSpring.current.value,a.x+=s._xSpring.current.value,a.y+=s._ySpring.current.value;var l=e.bounds.getSize();l.x*=s._scaleSpring.current.value,l.y*=s._scaleSpring.current.value;var h=n.pixelFromPointNoRotate(a,!0),c=n.pixelFromPointNoRotate(a,!1),u=n.deltaPixelsFromPointsNoRotate(l,!0),d=n.deltaPixelsFromPointsNoRotate(l,!1),p=c.plus(d.divide(2)),f=r.squaredDistanceTo(p);i||(u=u.plus(new t.Point(1,1)));e.isRightMost&&s.wrapHorizontal&&(u.x+=.75);e.isBottomMost&&s.wrapVertical&&(u.y+=.75);e.position=h,e.size=u,e.squaredDistance=f,e.visibility=o}(g,e.source.tileOverlap,e.viewport,d,u,e),!g.loaded)if(g.context2D)n(e,g);else{var y=e._tileCache.getImageRecord(g.cacheKey);if(y)n(e,g,y.getImage())}g.loaded?function(t,e,i,n,r,o,a){var l,h,c=1e3*t.blendTime;e.blendStart||(e.blendStart=a);l=a-e.blendStart,h=c?Math.min(1,l/c):1,t.alwaysBlend&&(h*=o);if(e.opacity=h,t.lastDrawn.push(e),1==h)s(t.coverage,r,i,n,!0),t._hasOpaqueTile=!0;else if(l<c)return!0;return!1}(e,g,a,l,h,c,f)&&(e._needsDraw=!0):g.loading?e._tilesLoading++:_||(m=function(t,e){if(!t)return e;if(e.visibility>t.visibility)return e;if(e.visibility==t.visibility&&e.squaredDistance<t.squaredDistance)return e;return t}(m,g));return m}function n(t,e,i,n,r){var o=0;function s(){return o++,a}function a(){0===--o&&(e.loading=!1,e.loaded=!0,e.context2D||t._tileCache.cacheTile({image:i,tile:e,cutoff:n,tiledImage:t}),t._needsDraw=!0)}t.viewer.raiseEvent("tile-loaded",{tile:e,tiledImage:t,tileRequest:r,image:i,getCompletionCallback:s}),s()()}function r(t,e,i,n){var r,o,s,a;if(!t[e])return!1;if(void 0===i||void 0===n){for(s in r=t[e])if(r.hasOwnProperty(s))for(a in o=r[s])if(o.hasOwnProperty(a)&&!o[a])return!1;return!0}return void 0===t[e][i]||void 0===t[e][i][n]||!0===t[e][i][n]}function o(t,e,i,n){return void 0===i||void 0===n?r(t,e+1):r(t,e+1,2*i,2*n)&&r(t,e+1,2*i,2*n+1)&&r(t,e+1,2*i+1,2*n)&&r(t,e+1,2*i+1,2*n+1)}function s(e,i,n,r,o){e[i]?(e[i][n]||(e[i][n]={}),e[i][n][r]=o):t.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",i)}function a(t,e){t[e]={}}t.TiledImage=function(e){var i=this;t.console.assert(e.tileCache,"[TiledImage] options.tileCache is required"),t.console.assert(e.drawer,"[TiledImage] options.drawer is required"),t.console.assert(e.viewer,"[TiledImage] options.viewer is required"),t.console.assert(e.imageLoader,"[TiledImage] options.imageLoader is required"),t.console.assert(e.source,"[TiledImage] options.source is required"),t.console.assert(!e.clip||e.clip instanceof t.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),t.EventSource.call(this),this._tileCache=e.tileCache,delete e.tileCache,this._drawer=e.drawer,delete e.drawer,this._imageLoader=e.imageLoader,delete e.imageLoader,e.clip instanceof t.Rect&&(this._clip=e.clip.clone()),delete e.clip;var n=e.x||0;delete e.x;var r=e.y||0;delete e.y,this.normHeight=e.source.dimensions.y/e.source.dimensions.x,this.contentAspectX=e.source.dimensions.x/e.source.dimensions.y;var o=1;e.width?(o=e.width,delete e.width,e.height&&(t.console.error("specifying both width and height to a tiledImage is not supported"),delete e.height)):e.height&&(o=e.height/this.normHeight,delete e.height);var s=e.fitBounds;delete e.fitBounds;var a=e.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete e.fitBoundsPlacement;var l=e.degrees||0;delete e.degrees,t.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:t.DEFAULT_SETTINGS.springStiffness,animationTime:t.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:t.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:t.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:t.DEFAULT_SETTINGS.wrapVertical,immediateRender:t.DEFAULT_SETTINGS.immediateRender,blendTime:t.DEFAULT_SETTINGS.blendTime,alwaysBlend:t.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:t.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:t.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:t.DEFAULT_SETTINGS.iOSDevice,debugMode:t.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:t.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:t.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:t.DEFAULT_SETTINGS.placeholderFillStyle,opacity:t.DEFAULT_SETTINGS.opacity,preload:t.DEFAULT_SETTINGS.preload,compositeOperation:t.DEFAULT_SETTINGS.compositeOperation},e),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new t.Spring({initial:n,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new t.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new t.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new t.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),s&&this.fitBounds(s,a,!0),this._drawingHandler=function(e){i.viewer.raiseEvent("tile-drawing",t.extend({tiledImage:i},e))}},t.extend(t.TiledImage.prototype,t.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(t){t!==this._fullyLoaded&&(this._fullyLoaded=t,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=t.now(),this._needsDraw=!0},update:function(){var t=this._xSpring.update(),e=this._ySpring.update(),i=this._scaleSpring.update(),n=this._degreesSpring.update();return!!(t||e||i||n)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(t){return this.getBoundsNoRotate(t).rotate(this.getRotation(t),this._getRotationPoint(t))},getBoundsNoRotate:function(e){return e?new t.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new t.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return t.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(e){var i=this.getBoundsNoRotate(e);if(this._clip){var n=(e?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,r=this._clip.times(n);i=new t.Rect(i.x+r.x,i.y+r.y,r.width,r.height)}return i.rotate(this.getRotation(e),this._getRotationPoint(e))},getContentSize:function(){return new t.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(e,i,n){var r=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(e*(this.source.dimensions.x/r),i*(this.source.dimensions.y*this.contentAspectX/r))},viewportToImageCoordinates:function(e,i,n){var r;return e instanceof t.Point?(n=i,r=e):r=new t.Point(e,i),r=r.rotate(-this.getRotation(n),this._getRotationPoint(n)),n?this._viewportToImageDelta(r.x-this._xSpring.current.value,r.y-this._ySpring.current.value):this._viewportToImageDelta(r.x-this._xSpring.target.value,r.y-this._ySpring.target.value)},_imageToViewportDelta:function(e,i,n){var r=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new t.Point(e/this.source.dimensions.x*r,i/this.source.dimensions.y/this.contentAspectX*r)},imageToViewportCoordinates:function(e,i,n){e instanceof t.Point&&(n=i,i=e.y,e=e.x);var r=this._imageToViewportDelta(e,i);return n?(r.x+=this._xSpring.current.value,r.y+=this._ySpring.current.value):(r.x+=this._xSpring.target.value,r.y+=this._ySpring.target.value),r.rotate(this.getRotation(n),this._getRotationPoint(n))},imageToViewportRectangle:function(e,i,n,r,o){var s=e;s instanceof t.Rect?o=i:s=new t.Rect(e,i,n,r);var a=this.imageToViewportCoordinates(s.getTopLeft(),o),l=this._imageToViewportDelta(s.width,s.height,o);return new t.Rect(a.x,a.y,l.x,l.y,s.degrees+this.getRotation(o))},viewportToImageRectangle:function(e,i,n,r,o){var s=e;e instanceof t.Rect?o=i:s=new t.Rect(e,i,n,r);var a=this.viewportToImageCoordinates(s.getTopLeft(),o),l=this._viewportToImageDelta(s.width,s.height,o);return new t.Rect(a.x,a.y,l.x,l.y,s.degrees-this.getRotation(o))},viewerElementToImageCoordinates:function(t){var e=this.viewport.pointFromPixel(t,!0);return this.viewportToImageCoordinates(e)},imageToViewerElementCoordinates:function(t){var e=this.imageToViewportCoordinates(t);return this.viewport.pixelFromPoint(e,!0)},windowToImageCoordinates:function(t){var e=t.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(e)},imageToWindowCoordinates:function(t){return this.imageToViewerElementCoordinates(t).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(e){var i=this._scaleSpring.current.value;return e=e.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new t.Rect((e.x-this._xSpring.current.value)/i,(e.y-this._ySpring.current.value)/i,e.width/i,e.height/i,e.degrees)},viewportToImageZoom:function(t){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*t},imageToViewportZoom:function(t){return t/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(t,e){var i=this._xSpring.target.value===t.x&&this._ySpring.target.value===t.y;if(e){if(i&&this._xSpring.current.value===t.x&&this._ySpring.current.value===t.y)return;this._xSpring.resetTo(t.x),this._ySpring.resetTo(t.y),this._needsDraw=!0}else{if(i)return;this._xSpring.springTo(t.x),this._ySpring.springTo(t.y),this._needsDraw=!0}i||this._raiseBoundsChange()},setWidth:function(t,e){this._setScale(t,e)},setHeight:function(t,e){this._setScale(t/this.normHeight,e)},fitBounds:function(e,i,n){i=i||t.Placement.CENTER;var r=t.Placement.properties[i],o=this.contentAspectX,s=0,a=0,l=1,h=1;if(this._clip&&(o=this._clip.getAspectRatio(),l=this._clip.width/this.source.dimensions.x,h=this._clip.height/this.source.dimensions.y,e.getAspectRatio()>o?(s=this._clip.x/this._clip.height*e.height,a=this._clip.y/this._clip.height*e.height):(s=this._clip.x/this._clip.width*e.width,a=this._clip.y/this._clip.width*e.width)),e.getAspectRatio()>o){var c=e.height/h,u=0;r.isHorizontallyCentered?u=(e.width-e.height*o)/2:r.isRight&&(u=e.width-e.height*o),this.setPosition(new t.Point(e.x-s+u,e.y-a),n),this.setHeight(c,n)}else{var d=e.width/l,p=0;r.isVerticallyCentered?p=(e.height-e.width/o)/2:r.isBottom&&(p=e.height-e.width/o),this.setPosition(new t.Point(e.x-s,e.y-a+p),n),this.setWidth(d,n)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(e){t.console.assert(!e||e instanceof t.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),e instanceof t.Rect?this._clip=e.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(t){t!==this.opacity&&(this.opacity=t,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(t){this._preload=!!t,this._needsDraw=!0},getRotation:function(t){return t?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(t,e){this._degreesSpring.target.value===t&&this._degreesSpring.isAtTargetValue()||(e?this._degreesSpring.resetTo(t):this._degreesSpring.springTo(t),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(t){return this.getBoundsNoRotate(t).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(t){t!==this.compositeOperation&&(this.compositeOperation=t,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(t,e){var i=this._scaleSpring.target.value===t;if(e){if(i&&this._scaleSpring.current.value===t)return;this._scaleSpring.resetTo(t),this._updateForScale(),this._needsDraw=!0}else{if(i)return;this._scaleSpring.springTo(t),this._updateForScale(),this._needsDraw=!0}i||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var t=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),e=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,i=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(e/this.minPixelRatio)/Math.log(2))));return i=Math.max(i,this.source.minLevel||0),{lowestLevel:t=Math.min(t,i),highestLevel:i}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){this.lastDrawn.pop().beingDrawn=!1}var i=this.viewport,o=this._viewportToTiledImageRectangle(i.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var s=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(o=o.intersection(s)))return}for(var a=this._getLevelsInterval(),l=a.lowestLevel,h=a.highestLevel,c=null,u=!1,d=t.now(),p=h;p>=l;p--){var f=!1,m=i.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!0).x*this._scaleSpring.current.value;if(p===l||!u&&m>=this.minPixelRatio)f=!0,u=!0;else if(!u)continue;var g=i.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(p),!1).x*this._scaleSpring.current.value,v=i.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,_=this.immediateRender?1:v;if(c=e(this,u,f,p,Math.min(1,(m-.5)/.5),_/Math.abs(_-g),o,d,c),r(this.coverage,p))break}!function(e,i){if(0===e.opacity||0===i.length&&!e.placeholderFillStyle)return;var n,r,o,s=i[0];s&&(n=e.opacity<1||e.compositeOperation&&"source-over"!==e.compositeOperation||!e._isBottomItem()&&s._hasTransparencyChannel());var a,l=e.viewport.getZoom(!0),h=e.viewportToImageZoom(l);i.length>1&&h>e.smoothTileEdgesMinZoom&&!e.iOSDevice&&e.getRotation(!0)%360==0&&t.supportsCanvas&&(n=!0,r=s.getScaleForEdgeSmoothing(),o=s.getTranslationForEdgeSmoothing(r,e._drawer.getCanvasSize(!1),e._drawer.getCanvasSize(!0)));n&&(r||(a=e.viewport.viewportToViewerElementRectangle(e.getClippedBounds(!0)).getIntegerBoundingBox().times(t.pixelDensityRatio)),e._drawer._clear(!0,a));r||(0!==e.viewport.degrees?e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:n}):e._drawer.viewer.viewport.flipped&&e._drawer._flip({}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:n}));var c=!1;if(e._clip){e._drawer.saveContext(n);var u=e.imageToViewportRectangle(e._clip,!0);u=u.rotate(-e.getRotation(!0),e._getRotationPoint(!0));var d=e._drawer.viewportToDrawerRectangle(u);r&&(d=d.times(r)),o&&(d=d.translate(o)),e._drawer.setClip(d,n),c=!0}if(e.placeholderFillStyle&&!1===e._hasOpaqueTile){var p=e._drawer.viewportToDrawerRectangle(e.getBounds(!0));r&&(p=p.times(r)),o&&(p=p.translate(o));var f=null;f="function"==typeof e.placeholderFillStyle?e.placeholderFillStyle(e,e._drawer.context):e.placeholderFillStyle,e._drawer.drawRectangle(p,f,n)}for(var m=i.length-1;m>=0;m--)s=i[m],e._drawer.drawTile(s,e._drawingHandler,n,r,o),s.beingDrawn=!0,e.viewer&&e.viewer.raiseEvent("tile-drawn",{tiledImage:e,tile:s});c&&e._drawer.restoreContext(n);r||(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(n),0!==e.viewport.degrees?e._drawer._restoreRotationChanges(n):e._drawer.viewer.viewport.flipped&&e._drawer._flip({}));n&&(r&&(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:!1}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:!1})),e._drawer.blendSketch({opacity:e.opacity,scale:r,translate:o,compositeOperation:e.compositeOperation,bounds:a}),r&&(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(!1),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(!1)));!function(e,i){if(e.debugMode)for(var n=i.length-1;n>=0;n--){var r=i[n];try{e._drawer.drawDebugInfo(r,i.length,n,e)}catch(e){t.console.error(e)}}}(e,i)}(this,this.lastDrawn),c&&!c.context2D?(!function(e,i,r){i.loading=!0,e._imageLoader.addJob({src:i.url,loadWithAjax:i.loadWithAjax,ajaxHeaders:i.ajaxHeaders,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:function(o,s,a){!function(e,i,r,o,s,a){if(!o)return t.console.log("Tile %s failed to load: %s - error: %s",i,i.url,s),e.viewer.raiseEvent("tile-load-failed",{tile:i,tiledImage:e,time:r,message:s,tileRequest:a}),i.loading=!1,void(i.exists=!1);if(r<e.lastResetTime)return t.console.log("Ignoring tile %s loaded before reset: %s",i,i.url),void(i.loading=!1);var l=function(){var t=e.source.getClosestLevel();n(e,i,o,t,a)};e._midDraw?window.setTimeout(l,1):l()}(e,i,r,o,s,a)},abort:function(){i.loading=!1}})}(this,c,d),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(e,i,n){var r,o,s,a;this.wrapHorizontal?(r=t.positiveModulo(i.x,1),o=t.positiveModulo(n.x,1)):(r=Math.max(0,i.x),o=Math.min(1,n.x));var l=1/this.source.aspectRatio;this.wrapVertical?(s=t.positiveModulo(i.y,l),a=t.positiveModulo(n.y,l)):(s=Math.max(0,i.y),a=Math.min(l,n.y));var h=this.source.getTileAtPoint(e,new t.Point(r,s)),c=this.source.getTileAtPoint(e,new t.Point(o,a)),u=this.source.getNumTiles(e);return this.wrapHorizontal&&(h.x+=u.x*Math.floor(i.x),c.x+=u.x*Math.floor(n.x)),this.wrapVertical&&(h.y+=u.y*Math.floor(i.y/l),c.y+=u.y*Math.floor(n.y/l)),{topLeft:h,bottomRight:c}}})}(OpenSeadragon),function(t){var e=function(e){t.console.assert(e,"[ImageRecord] options is required"),t.console.assert(e.image,"[ImageRecord] options.image is required"),this._image=e.image,this._tiles=[]};e.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var t=document.createElement("canvas");t.width=this._image.width,t.height=this._image.height,this._renderedContext=t.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(e){t.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=e},addTile:function(e){t.console.assert(e,"[ImageRecord.addTile] tile is required"),this._tiles.push(e)},removeTile:function(e){for(var i=0;i<this._tiles.length;i++)if(this._tiles[i]===e)return void this._tiles.splice(i,1);t.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",e)},getTileCount:function(){return this._tiles.length}},t.TileCache=function(e){e=e||{},this._maxImageCacheCount=e.maxImageCacheCount||t.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},t.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(i){t.console.assert(i,"[TileCache.cacheTile] options is required"),t.console.assert(i.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(i.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),t.console.assert(i.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var n=i.cutoff||0,r=this._tilesLoaded.length,o=this._imagesLoaded[i.tile.cacheKey];if(o||(t.console.assert(i.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),o=this._imagesLoaded[i.tile.cacheKey]=new e({image:i.image}),this._imagesLoadedCount++),o.addTile(i.tile),i.tile.cacheImageRecord=o,this._imagesLoadedCount>this._maxImageCacheCount){for(var s,a,l,h,c,u,d=null,p=-1,f=null,m=this._tilesLoaded.length-1;m>=0;m--)(s=(u=this._tilesLoaded[m]).tile).level<=n||s.beingDrawn||(d?(h=s.lastTouchTime,a=d.lastTouchTime,c=s.level,l=d.level,(h<a||h==a&&c>l)&&(d=s,p=m,f=u)):(d=s,p=m,f=u));d&&p>=0&&(this._unloadTile(f),r=p)}this._tilesLoaded[r]=new function(e){t.console.assert(e,"[TileCache.cacheTile] options is required"),t.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),t.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=e.tile,this.tiledImage=e.tiledImage}({tile:i.tile,tiledImage:i.tiledImage})},clearTilesFor:function(e){var i;t.console.assert(e,"[TileCache.clearTilesFor] tiledImage is required");for(var n=0;n<this._tilesLoaded.length;++n)(i=this._tilesLoaded[n]).tiledImage===e&&(this._unloadTile(i),this._tilesLoaded.splice(n,1),n--)},getImageRecord:function(e){return t.console.assert(e,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[e]},_unloadTile:function(e){t.console.assert(e,"[TileCache._unloadTile] tileRecord is required");var i=e.tile,n=e.tiledImage;i.unload(),i.cacheImageRecord=null;var r=this._imagesLoaded[i.cacheKey];r.removeTile(i),r.getTileCount()||(r.destroy(),delete this._imagesLoaded[i.cacheKey],this._imagesLoadedCount--),n.viewer.raiseEvent("tile-unloaded",{tile:i,tiledImage:n})}}}(OpenSeadragon),function(t){t.World=function(e){var i=this;t.console.assert(e.viewer,"[World] options.viewer is required"),t.EventSource.call(this),this.viewer=e.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(t){i._autoRefigureSizes?i._figureSizes():i._needsSizesFigured=!0},this._figureSizes()},t.extend(t.World.prototype,t.EventSource.prototype,{addItem:function(e,i){if(t.console.assert(e,"[World.addItem] item is required"),t.console.assert(e instanceof t.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(i=i||{}).index){var n=Math.max(0,Math.min(this._items.length,i.index));this._items.splice(n,0,e)}else this._items.push(e);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,e.addHandler("bounds-change",this._delegatedFigureSizes),e.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:e})},getItemAt:function(e){return t.console.assert(void 0!==e,"[World.getItemAt] index is required"),this._items[e]},getIndexOfItem:function(e){return t.console.assert(e,"[World.getIndexOfItem] item is required"),t.indexOf(this._items,e)},getItemCount:function(){return this._items.length},setItemIndex:function(e,i){t.console.assert(e,"[World.setItemIndex] item is required"),t.console.assert(void 0!==i,"[World.setItemIndex] index is required");var n=this.getIndexOfItem(e);if(i>=this._items.length)throw new Error("Index bigger than number of layers.");i!==n&&-1!==n&&(this._items.splice(n,1),this._items.splice(i,0,e),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:e,previousIndex:n,newIndex:i}))},removeItem:function(e){t.console.assert(e,"[World.removeItem] item is required");var i=t.indexOf(this._items,e);-1!==i&&(e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy(),this._items.splice(i,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(e))},removeAll:function(){var t,e;for(this.viewer._cancelPendingImages(),e=0;e<this._items.length;e++)(t=this._items[e]).removeHandler("bounds-change",this._delegatedFigureSizes),t.removeHandler("clip-change",this._delegatedFigureSizes),t.destroy();var i=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,e=0;e<i.length;e++)t=i[e],this._raiseRemoveItem(t)},resetItems:function(){for(var t=0;t<this._items.length;t++)this._items[t].reset()},update:function(){for(var t=!1,e=0;e<this._items.length;e++)t=this._items[e].update()||t;return t},draw:function(){for(var t=0;t<this._items.length;t++)this._items[t].draw();this._needsDraw=!1},needsDraw:function(){for(var t=0;t<this._items.length;t++)if(this._items[t].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(t){this._autoRefigureSizes=t,t&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(e){var i,n=(e=e||{}).immediately||!1,r=e.layout||t.DEFAULT_SETTINGS.collectionLayout,o=e.rows||t.DEFAULT_SETTINGS.collectionRows,s=e.columns||t.DEFAULT_SETTINGS.collectionColumns,a=e.tileSize||t.DEFAULT_SETTINGS.collectionTileSize,l=a+(e.tileMargin||t.DEFAULT_SETTINGS.collectionTileMargin);i=!e.rows&&s?s:Math.ceil(this._items.length/o);var h,c,u,d,p,f=0,m=0;this.setAutoRefigureSizes(!1);for(var g=0;g<this._items.length;g++)g&&g%i==0&&("horizontal"===r?(m+=l,f=0):(f+=l,m=0)),d=(u=(c=(h=this._items[g]).getBounds()).width>c.height?a:a*(c.width/c.height))*(c.height/c.width),p=new t.Point(f+(a-u)/2,m+(a-d)/2),h.setPosition(p,n),h.setWidth(u,n),"horizontal"===r?f+=l:m+=l;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var e=this._homeBounds?this._homeBounds.clone():null,i=this._contentSize?this._contentSize.clone():null,n=this._contentFactor||0;if(this._items.length){var r=this._items[0],o=r.getBounds();this._contentFactor=r.getContentSize().x/o.width;for(var s=r.getClippedBounds().getBoundingBox(),a=s.x,l=s.y,h=s.x+s.width,c=s.y+s.height,u=1;u<this._items.length;u++)o=(r=this._items[u]).getBounds(),this._contentFactor=Math.max(this._contentFactor,r.getContentSize().x/o.width),s=r.getClippedBounds().getBoundingBox(),a=Math.min(a,s.x),l=Math.min(l,s.y),h=Math.max(h,s.x+s.width),c=Math.max(c,s.y+s.height);this._homeBounds=new t.Rect(a,l,h-a,c-l),this._contentSize=new t.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new t.Rect(0,0,1,1),this._contentSize=new t.Point(1,1),this._contentFactor=1;this._contentFactor===n&&this._homeBounds.equals(e)&&this._contentSize.equals(i)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(t){this.raiseEvent("remove-item",{item:t})}})}(OpenSeadragon),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("pdfjs-dist/build/pdf",[],e):"object"==typeof exports?exports["pdfjs-dist/build/pdf"]=e():t["pdfjs-dist/build/pdf"]=t.pdfjsLib=e()}(this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";var n=i(1),r=i(129),o=i(145),s=i(146),a=i(130),l=i(147),h=i(135),c=i(132);if(i(4)()){var u=i(148).PDFNodeStream;r.setPDFNetworkStreamFactory(function(t){return new u(t)})}else if("undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream){var d=i(151).PDFFetchStream;r.setPDFNetworkStreamFactory(function(t){return new d(t)})}else{var p=i(152).PDFNetworkStream;r.setPDFNetworkStreamFactory(function(t){return new p(t)})}e.build=r.build,e.version=r.version,e.getDocument=r.getDocument,e.LoopbackPort=r.LoopbackPort,e.PDFDataRangeTransport=r.PDFDataRangeTransport,e.PDFWorker=r.PDFWorker,e.renderTextLayer=o.renderTextLayer,e.AnnotationLayer=s.AnnotationLayer,e.createPromiseCapability=n.createPromiseCapability,e.PasswordResponses=n.PasswordResponses,e.InvalidPDFException=n.InvalidPDFException,e.MissingPDFException=n.MissingPDFException,e.SVGGraphics=l.SVGGraphics,e.NativeImageDecoding=n.NativeImageDecoding,e.CMapCompressionType=n.CMapCompressionType,e.PermissionFlag=n.PermissionFlag,e.UnexpectedResponseException=n.UnexpectedResponseException,e.OPS=n.OPS,e.VerbosityLevel=n.VerbosityLevel,e.UNSUPPORTED_FEATURES=n.UNSUPPORTED_FEATURES,e.createValidAbsoluteUrl=n.createValidAbsoluteUrl,e.createObjectURL=n.createObjectURL,e.removeNullCharacters=n.removeNullCharacters,e.shadow=n.shadow,e.Util=n.Util,e.ReadableStream=n.ReadableStream,e.URL=n.URL,e.RenderingCancelledException=a.RenderingCancelledException,e.getFilenameFromUrl=a.getFilenameFromUrl,e.LinkTarget=a.LinkTarget,e.addLinkAttributes=a.addLinkAttributes,e.loadScript=a.loadScript,e.GlobalWorkerOptions=h.GlobalWorkerOptions,e.apiCompatibilityParams=c.apiCompatibilityParams},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unreachable=e.warn=e.utf8StringToString=e.stringToUTF8String=e.stringToPDFString=e.stringToBytes=e.string32=e.shadow=e.setVerbosityLevel=e.URL=e.ReadableStream=e.removeNullCharacters=e.readUint32=e.readUint16=e.readInt8=e.log2=e.isEvalSupported=e.isLittleEndian=e.createValidAbsoluteUrl=e.isSameOrigin=e.isSpace=e.isString=e.isNum=e.isEmptyObj=e.isBool=e.isArrayBuffer=e.info=e.getVerbosityLevel=e.getLookupTableFactory=e.getInheritableProperty=e.deprecated=e.createObjectURL=e.createPromiseCapability=e.bytesToString=e.assert=e.arraysToBytes=e.arrayByteLength=e.FormatError=e.XRefParseException=e.toRomanNumerals=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.StreamType=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.NativeImageDecoding=e.MissingPDFException=e.MissingDataException=e.InvalidPDFException=e.AbortException=e.CMapCompressionType=e.ImageKind=e.FontType=e.AnnotationType=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationBorderStyleType=e.UNSUPPORTED_FEATURES=e.VerbosityLevel=e.OPS=e.IDENTITY_MATRIX=e.FONT_IDENTITY_MATRIX=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};i(2);var r=i(125),o=i(127),s={ERRORS:0,WARNINGS:1,INFOS:5},a=s.WARNINGS;function l(t){a>=s.WARNINGS&&console.log("Warning: "+t)}function h(t){throw new Error(t)}function c(t,e){t||h(e)}var u=function(){function t(t,e){this.name="PasswordException",this.message=t,this.code=e}return t.prototype=new Error,t.constructor=t,t}(),d=function(){function t(t,e){this.name="UnknownErrorException",this.message=t,this.details=e}return t.prototype=new Error,t.constructor=t,t}(),p=function(){function t(t){this.name="InvalidPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}(),f=function(){function t(t){this.name="MissingPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}(),m=function(){function t(t,e){this.name="UnexpectedResponseException",this.message=t,this.status=e}return t.prototype=new Error,t.constructor=t,t}(),g=function(){function t(t,e){this.begin=t,this.end=e,this.message="Missing data ["+t+", "+e+")"}return t.prototype=new Error,t.prototype.name="MissingDataException",t.constructor=t,t}(),v=function(){function t(t){this.message=t}return t.prototype=new Error,t.prototype.name="XRefParseException",t.constructor=t,t}(),_=function(){function t(t){this.message=t}return t.prototype=new Error,t.prototype.name="FormatError",t.constructor=t,t}(),y=function(){function t(t){this.name="AbortException",this.message=t}return t.prototype=new Error,t.constructor=t,t}(),b=/\x00/g;function w(t){c("string"==typeof t,"Invalid argument for stringToBytes");for(var e=t.length,i=new Uint8Array(e),n=0;n<e;++n)i[n]=255&t.charCodeAt(n);return i}function S(t){return void 0!==t.length?t.length:(c(void 0!==t.byteLength),t.byteLength)}var x=function(){function t(){}var e=["rgb(",0,",",0,",",0,")"];return t.makeCssRgb=function(t,i,n){return e[1]=t,e[3]=i,e[5]=n,e.join("")},t.transform=function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},t.applyTransform=function(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]},t.applyInverseTransform=function(t,e){var i=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i]},t.getAxialAlignedBoundingBox=function(e,i){var n=t.applyTransform(e,i),r=t.applyTransform(e.slice(2,4),i),o=t.applyTransform([e[0],e[3]],i),s=t.applyTransform([e[2],e[1]],i);return[Math.min(n[0],r[0],o[0],s[0]),Math.min(n[1],r[1],o[1],s[1]),Math.max(n[0],r[0],o[0],s[0]),Math.max(n[1],r[1],o[1],s[1])]},t.inverseTransform=function(t){var e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]},t.apply3dTransform=function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]},t.singularValueDecompose2dScale=function(t){var e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],s=(i+o)/2,a=Math.sqrt((i+o)*(i+o)-4*(i*o-r*n))/2,l=s+a||1,h=s-a||1;return[Math.sqrt(l),Math.sqrt(h)]},t.normalizeRect=function(t){var e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e},t.intersect=function(e,i){function n(t,e){return t-e}var r=[e[0],e[2],i[0],i[2]].sort(n),o=[e[1],e[3],i[1],i[3]].sort(n),s=[];return e=t.normalizeRect(e),i=t.normalizeRect(i),(r[0]===e[0]&&r[1]===i[0]||r[0]===i[0]&&r[1]===e[0])&&(s[0]=r[1],s[2]=r[2],(o[0]===e[1]&&o[1]===i[1]||o[0]===i[1]&&o[1]===e[1])&&(s[1]=o[1],s[3]=o[2],s))},t}(),T=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];var E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];var P,C=(P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(t,e){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&o.URL.createObjectURL){var i=new Blob([t],{type:e});return o.URL.createObjectURL(i)}for(var n="data:"+e+";base64,",r=0,s=t.length;r<s;r+=3){var a=255&t[r],l=255&t[r+1],h=255&t[r+2];n+=P[a>>2]+P[(3&a)<<4|l>>4]+P[r+1<s?(15&l)<<2|h>>6:64]+P[r+2<s?63&h:64]}return n});e.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],e.IDENTITY_MATRIX=[1,0,0,1,0,0],e.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},e.VerbosityLevel=s,e.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},e.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},e.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},e.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},e.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},e.FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10},e.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},e.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},e.AbortException=y,e.InvalidPDFException=p,e.MissingDataException=g,e.MissingPDFException=f,e.NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"},e.PasswordException=u,e.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},e.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},e.StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},e.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},e.UnexpectedResponseException=m,e.UnknownErrorException=d,e.Util=x,e.toRomanNumerals=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];c(Number.isInteger(t)&&t>0,"The number should be a positive integer.");for(var i=void 0,n=[];t>=1e3;)t-=1e3,n.push("M");i=t/100|0,t%=100,n.push(T[i]),i=t/10|0,t%=10,n.push(T[10+i]),n.push(T[20+t]);var r=n.join("");return e?r.toLowerCase():r},e.XRefParseException=v,e.FormatError=_,e.arrayByteLength=S,e.arraysToBytes=function(t){if(1===t.length&&t[0]instanceof Uint8Array)return t[0];var e,i,n,r=0,o=t.length;for(e=0;e<o;e++)r+=n=S(i=t[e]);var s=0,a=new Uint8Array(r);for(e=0;e<o;e++)(i=t[e])instanceof Uint8Array||(i="string"==typeof i?w(i):new Uint8Array(i)),n=i.byteLength,a.set(i,s),s+=n;return a},e.assert=c,e.bytesToString=function(t){c(null!==t&&"object"===(void 0===t?"undefined":n(t))&&void 0!==t.length,"Invalid argument for bytesToString");var e=t.length;if(e<8192)return String.fromCharCode.apply(null,t);for(var i=[],r=0;r<e;r+=8192){var o=Math.min(r+8192,e),s=t.subarray(r,o);i.push(String.fromCharCode.apply(null,s))}return i.join("")},e.createPromiseCapability=function(){var t={};return t.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),t},e.createObjectURL=C,e.deprecated=function(t){console.log("Deprecated API usage: "+t)},e.getInheritableProperty=function(t){for(var e=t.dict,i=t.key,n=t.getArray,r=void 0!==n&&n,o=t.stopWhenFound,s=void 0===o||o,a=0,h=void 0;e;){var c=r?e.getArray(i):e.get(i);if(void 0!==c){if(s)return c;h||(h=[]),h.push(c)}if(++a>100){l('getInheritableProperty: maximum loop count exceeded for "'+i+'"');break}e=e.get("Parent")}return h},e.getLookupTableFactory=function(t){var e;return function(){return t&&(e=Object.create(null),t(e),t=null),e}},e.getVerbosityLevel=function(){return a},e.info=function(t){a>=s.INFOS&&console.log("Info: "+t)},e.isArrayBuffer=function(t){return"object"===(void 0===t?"undefined":n(t))&&null!==t&&void 0!==t.byteLength},e.isBool=function(t){return"boolean"==typeof t},e.isEmptyObj=function(t){for(var e in t)return!1;return!0},e.isNum=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSpace=function(t){return 32===t||9===t||13===t||10===t},e.isSameOrigin=function(t,e){try{var i=new o.URL(t);if(!i.origin||"null"===i.origin)return!1}catch(t){return!1}var n=new o.URL(e,i);return i.origin===n.origin},e.createValidAbsoluteUrl=function(t,e){if(!t)return null;try{var i=e?new o.URL(t,e):new o.URL(t);if(function(t){if(!t)return!1;switch(t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch(t){}return null},e.isLittleEndian=function(){var t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]},e.isEvalSupported=function(){try{return new Function(""),!0}catch(t){return!1}},e.log2=function(t){return t<=0?0:Math.ceil(Math.log2(t))},e.readInt8=function(t,e){return t[e]<<24>>24},e.readUint16=function(t,e){return t[e]<<8|t[e+1]},e.readUint32=function(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0},e.removeNullCharacters=function(t){return"string"!=typeof t?(l("The argument for removeNullCharacters must be a string."),t):t.replace(b,"")},e.ReadableStream=r.ReadableStream,e.URL=o.URL,e.setVerbosityLevel=function(t){Number.isInteger(t)&&(a=t)},e.shadow=function(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!1}),i},e.string32=function(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)},e.stringToBytes=w,e.stringToPDFString=function(t){var e,i=t.length,n=[];if("þ"===t[0]&&"ÿ"===t[1])for(e=2;e<i;e+=2)n.push(String.fromCharCode(t.charCodeAt(e)<<8|t.charCodeAt(e+1)));else for(e=0;e<i;++e){var r=E[t.charCodeAt(e)];n.push(r?String.fromCharCode(r):t.charAt(e))}return n.join("")},e.stringToUTF8String=function(t){return decodeURIComponent(escape(t))},e.utf8StringToString=function(t){return unescape(encodeURIComponent(t))},e.warn=l,e.unreachable=h},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(3);if(!r._pdfjsCompatibilityChecked){r._pdfjsCompatibilityChecked=!0;var o=i(4),s="object"===("undefined"==typeof window?"undefined":n(window))&&"object"===("undefined"==typeof document?"undefined":n(document));!r.btoa&&o()&&(r.btoa=function(t){return Buffer.from(t,"binary").toString("base64")}),!r.atob&&o()&&(r.atob=function(t){return Buffer.from(t,"base64").toString("binary")}),s&&("currentScript"in document||Object.defineProperty(document,"currentScript",{get:function(){var t=document.getElementsByTagName("script");return t[t.length-1]},enumerable:!0,configurable:!0})),s&&void 0===Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){if(s&&!o()&&!1!==document.createElement("div").classList.toggle("test",0)){var t=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e){if(arguments.length>1){var i=!!arguments[1];return this[i?"add":"remove"](e),i}return t(e)}}}(),String.prototype.includes||i(5),Array.prototype.includes||i(33),Object.assign||i(42),Math.log2||(Math.log2=i(52)),Number.isNaN||(Number.isNaN=i(54)),Number.isInteger||(Number.isInteger=i(56)),r.Promise||(r.Promise=i(59)),r.WeakMap||(r.WeakMap=i(94)),String.codePointAt||(String.codePointAt=i(111)),String.fromCodePoint||(String.fromCodePoint=i(113)),r.Symbol||i(115),Object.values||(Object.values=i(122))}},function(t,e,i){"use strict";t.exports="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:{}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(){return"object"===("undefined"==typeof process?"undefined":n(process))&&process+""=="[object process]"}},function(t,e,i){"use strict";i(6),t.exports=i(9).String.includes},function(t,e,i){"use strict";var n=i(7),r=i(25);n(n.P+n.F*i(32)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,i){"use strict";var n=i(8),r=i(9),o=i(10),s=i(20),a=i(23),l=function t(e,i,l){var h,c,u,d,p=e&t.F,f=e&t.G,m=e&t.P,g=e&t.B,v=f?n:e&t.S?n[i]||(n[i]={}):(n[i]||{}).prototype,_=f?r:r[i]||(r[i]={}),y=_.prototype||(_.prototype={});for(h in f&&(l=i),l)u=((c=!p&&v&&void 0!==v[h])?v:l)[h],d=g&&c?a(u,n):m&&"function"==typeof u?a(Function.call,u):u,v&&s(v,h,u,e&t.U),_[h]!=u&&o(_,h,d),m&&y[h]!=u&&(y[h]=u)};n.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,i){"use strict";var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,i){"use strict";var n=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(t,e,i){"use strict";var n=i(11),r=i(19);t.exports=i(15)?function(t,e,i){return n.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){"use strict";var n=i(12),r=i(14),o=i(18),s=Object.defineProperty;e.f=i(15)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),r)try{return s(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){"use strict";var n=i(13);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};t.exports=function(t){return"object"===(void 0===t?"undefined":n(t))?null!==t:"function"==typeof t}},function(t,e,i){"use strict";t.exports=!i(15)&&!i(16)(function(){return 7!=Object.defineProperty(i(17)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){"use strict";t.exports=!i(16)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){"use strict";var n=i(13),r=i(8).document,o=n(r)&&n(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,i){"use strict";var n=i(13);t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,i){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,i){"use strict";var n=i(8),r=i(10),o=i(21),s=i(22)("src"),a=Function.toString,l=(""+a).split("toString");i(9).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var h="function"==typeof i;h&&(o(i,"name")||r(i,"name",e)),t[e]!==i&&(h&&(o(i,s)||r(i,s,t[e]?""+t[e]:l.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:r(t,e,i):(delete t[e],r(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(t,e,i){"use strict";var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,i){"use strict";var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,i){"use strict";var n=i(24);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e,i){"use strict";t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,i){"use strict";var n=i(26),r=i(31);t.exports=function(t,e,i){if(n(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(r(t))}},function(t,e,i){"use strict";var n=i(13),r=i(27),o=i(28)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,i){"use strict";var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,i){"use strict";var n=i(29)("wks"),r=i(22),o=i(8).Symbol,s="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=n},function(t,e,i){"use strict";var n=i(9),r=i(8),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(30)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,i){"use strict";t.exports=!1},function(t,e,i){"use strict";t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,i){"use strict";var n=i(28)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,i){"use strict";i(34),t.exports=i(9).Array.includes},function(t,e,i){"use strict";var n=i(7),r=i(35)(!0);n(n.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(41)("includes")},function(t,e,i){"use strict";var n=i(36),r=i(38),o=i(40);t.exports=function(t){return function(e,i,s){var a,l=n(e),h=r(l.length),c=o(s,h);if(t&&i!=i){for(;h>c;)if((a=l[c++])!=a)return!0}else for(;h>c;c++)if((t||c in l)&&l[c]===i)return t||c||0;return!t&&-1}}},function(t,e,i){"use strict";var n=i(37),r=i(31);t.exports=function(t){return n(r(t))}},function(t,e,i){"use strict";var n=i(27);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){"use strict";var n=i(39),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},function(t,e,i){"use strict";var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,i){"use strict";var n=i(39),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?r(t+e,0):o(t,e)}},function(t,e,i){"use strict";var n=i(28)("unscopables"),r=Array.prototype;void 0==r[n]&&i(10)(r,n,{}),t.exports=function(t){r[n][t]=!0}},function(t,e,i){"use strict";i(43),t.exports=i(9).Object.assign},function(t,e,i){"use strict";var n=i(7);n(n.S+n.F,"Object",{assign:i(44)})},function(t,e,i){"use strict";var n=i(45),r=i(49),o=i(50),s=i(51),a=i(37),l=Object.assign;t.exports=!l||i(16)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=l({},t)[i]||Object.keys(l({},e)).join("")!=n})?function(t,e){for(var i=s(t),l=arguments.length,h=1,c=r.f,u=o.f;l>h;)for(var d,p=a(arguments[h++]),f=c?n(p).concat(c(p)):n(p),m=f.length,g=0;m>g;)u.call(p,d=f[g++])&&(i[d]=p[d]);return i}:l},function(t,e,i){"use strict";var n=i(46),r=i(48);t.exports=Object.keys||function(t){return n(t,r)}},function(t,e,i){"use strict";var n=i(21),r=i(36),o=i(35)(!1),s=i(47)("IE_PROTO");t.exports=function(t,e){var i,a=r(t),l=0,h=[];for(i in a)i!=s&&n(a,i)&&h.push(i);for(;e.length>l;)n(a,i=e[l++])&&(~o(h,i)||h.push(i));return h}},function(t,e,i){"use strict";var n=i(29)("keys"),r=i(22);t.exports=function(t){return n[t]||(n[t]=r(t))}},function(t,e,i){"use strict";t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){"use strict";e.f=Object.getOwnPropertySymbols},function(t,e,i){"use strict";e.f={}.propertyIsEnumerable},function(t,e,i){"use strict";var n=i(31);t.exports=function(t){return Object(n(t))}},function(t,e,i){"use strict";i(53),t.exports=i(9).Math.log2},function(t,e,i){"use strict";var n=i(7);n(n.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,i){"use strict";i(55),t.exports=i(9).Number.isNaN},function(t,e,i){"use strict";var n=i(7);n(n.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,i){"use strict";i(57),t.exports=i(9).Number.isInteger},function(t,e,i){"use strict";var n=i(7);n(n.S,"Number",{isInteger:i(58)})},function(t,e,i){"use strict";var n=i(13),r=Math.floor;t.exports=function(t){return!n(t)&&isFinite(t)&&r(t)===t}},function(t,e,i){"use strict";i(60),i(62),i(72),i(75),i(92),i(93),t.exports=i(9).Promise},function(t,e,i){"use strict";var n=i(61),r={};r[i(28)("toStringTag")]="z",r+""!="[object z]"&&i(20)(Object.prototype,"toString",function(){return"[object "+n(this)+"]"},!0)},function(t,e,i){"use strict";var n=i(27),r=i(28)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,i,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?i:o?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,i){"use strict";var n=i(63)(!0);i(64)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){"use strict";var n=i(39),r=i(31);t.exports=function(t){return function(e,i){var o,s,a=String(r(e)),l=n(i),h=a.length;return l<0||l>=h?t?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===h||(s=a.charCodeAt(l+1))<56320||s>57343?t?a.charAt(l):o:t?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},function(t,e,i){"use strict";var n=i(30),r=i(7),o=i(20),s=i(10),a=i(65),l=i(66),h=i(70),c=i(71),u=i(28)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,i,f,m,g,v){l(i,e,f);var _,y,b,w=function(t){if(!d&&t in E)return E[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},S=e+" Iterator",x="values"==m,T=!1,E=t.prototype,P=E[u]||E["@@iterator"]||m&&E[m],C=P||w(m),L=m?x?w("entries"):C:void 0,k="Array"==e&&E.entries||P;if(k&&(b=c(k.call(new t)))!==Object.prototype&&b.next&&(h(b,S,!0),n||"function"==typeof b[u]||s(b,u,p)),x&&P&&"values"!==P.name&&(T=!0,C=function(){return P.call(this)}),n&&!v||!d&&!T&&E[u]||s(E,u,C),a[e]=C,a[S]=p,m)if(_={values:x?C:w("values"),keys:g?C:w("keys"),entries:L},v)for(y in _)y in E||o(E,y,_[y]);else r(r.P+r.F*(d||T),e,_);return _}},function(t,e,i){"use strict";t.exports={}},function(t,e,i){"use strict";var n=i(67),r=i(19),o=i(70),s={};i(10)(s,i(28)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(s,{next:r(1,i)}),o(t,e+" Iterator")}},function(t,e,i){"use strict";var n=i(12),r=i(68),o=i(48),s=i(47)("IE_PROTO"),a=function(){},l=function(){var t,e=i(17)("iframe"),n=o.length;for(e.style.display="none",i(69).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;n--;)delete l.prototype[o[n]];return l()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=n(t),i=new a,a.prototype=null,i[s]=t):i=l(),void 0===e?i:r(i,e)}},function(t,e,i){"use strict";var n=i(11),r=i(12),o=i(45);t.exports=i(15)?Object.defineProperties:function(t,e){r(t);for(var i,s=o(e),a=s.length,l=0;a>l;)n.f(t,i=s[l++],e[i]);return t}},function(t,e,i){"use strict";var n=i(8).document;t.exports=n&&n.documentElement},function(t,e,i){"use strict";var n=i(11).f,r=i(21),o=i(28)("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,i){"use strict";var n=i(21),r=i(51),o=i(47)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,i){"use strict";for(var n=i(73),r=i(45),o=i(20),s=i(8),a=i(10),l=i(65),h=i(28),c=h("iterator"),u=h("toStringTag"),d=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(p),m=0;m<f.length;m++){var g,v=f[m],_=p[v],y=s[v],b=y&&y.prototype;if(b&&(b[c]||a(b,c,d),b[u]||a(b,u,v),l[v]=d,_))for(g in n)b[g]||o(b,g,n[g],!0)}},function(t,e,i){"use strict";var n=i(41),r=i(74),o=i(65),s=i(36);t.exports=i(64)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,i){"use strict";t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){"use strict";var n,r,o,s,a=i(30),l=i(8),h=i(23),c=i(61),u=i(7),d=i(13),p=i(24),f=i(76),m=i(77),g=i(81),v=i(82).set,_=i(84)(),y=i(85),b=i(86),w=i(87),S=i(88),x=l.TypeError,T=l.process,E=T&&T.versions,P=E&&E.v8||"",C=l.Promise,L="process"==c(T),k=function(){},A=r=y.f,R=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[i(28)("species")]=function(t){t(k,k)};return(L||"function"==typeof PromiseRejectionEvent)&&t.then(k)instanceof e&&0!==P.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),I=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},O=function(t,e){if(!t._n){t._n=!0;var i=t._c;_(function(){for(var n=t._v,r=1==t._s,o=0,s=function(e){var i,o,s,a=r?e.ok:e.fail,l=e.resolve,h=e.reject,c=e.domain;try{a?(r||(2==t._h&&z(t),t._h=1),!0===a?i=n:(c&&c.enter(),i=a(n),c&&(c.exit(),s=!0)),i===e.promise?h(x("Promise-chain cycle")):(o=I(i))?o.call(i,l,h):l(i)):h(n)}catch(t){c&&!s&&c.exit(),h(t)}};i.length>o;)s(i[o++]);t._c=[],t._n=!1,e&&!t._h&&M(t)})}},M=function(t){v.call(l,function(){var e,i,n,r=t._v,o=D(t);if(o&&(e=b(function(){L?T.emit("unhandledRejection",r,t):(i=l.onunhandledrejection)?i({promise:t,reason:r}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",r)}),t._h=L||D(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},z=function(t){v.call(l,function(){var e;L?T.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},F=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),O(e,!0))},N=function t(e){var i,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw x("Promise can't be resolved itself");(i=I(e))?_(function(){var r={_w:n,_d:!1};try{i.call(e,h(t,r,1),h(F,r,1))}catch(t){F.call(r,t)}}):(n._v=e,n._s=1,O(n,!1))}catch(t){F.call({_w:n,_d:!1},t)}}};R||(C=function(t){f(this,C,"Promise","_h"),p(t),n.call(this);try{t(h(N,this,1),h(F,this,1))}catch(t){F.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(89)(C.prototype,{then:function(t,e){var i=A(g(this,C));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=L?T.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&O(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=h(N,t,1),this.reject=h(F,t,1)},y.f=A=function(t){return t===C||t===s?new o(t):r(t)}),u(u.G+u.W+u.F*!R,{Promise:C}),i(70)(C,"Promise"),i(90)("Promise"),s=i(9).Promise,u(u.S+u.F*!R,"Promise",{reject:function(t){var e=A(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(a||!R),"Promise",{resolve:function(t){return S(a&&this===s?C:this,t)}}),u(u.S+u.F*!(R&&i(91)(function(t){C.all(t).catch(k)})),"Promise",{all:function(t){var e=this,i=A(e),n=i.resolve,r=i.reject,o=b(function(){var i=[],o=0,s=1;m(t,!1,function(t){var a=o++,l=!1;i.push(void 0),s++,e.resolve(t).then(function(t){l||(l=!0,i[a]=t,--s||n(i))},r)}),--s||n(i)});return o.e&&r(o.v),i.promise},race:function(t){var e=this,i=A(e),n=i.reject,r=b(function(){m(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return r.e&&n(r.v),i.promise}})},function(t,e,i){"use strict";t.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},function(t,e,i){"use strict";var n=i(23),r=i(78),o=i(79),s=i(12),a=i(38),l=i(80),h={},c={},u=t.exports=function(t,e,i,u,d){var p,f,m,g,v=d?function(){return t}:l(t),_=n(i,u,e?2:1),y=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(o(v)){for(p=a(t.length);p>y;y++)if((g=e?_(s(f=t[y])[0],f[1]):_(t[y]))===h||g===c)return g}else for(m=v.call(t);!(f=m.next()).done;)if((g=r(m,_,f.value,e))===h||g===c)return g};u.BREAK=h,u.RETURN=c},function(t,e,i){"use strict";var n=i(12);t.exports=function(t,e,i,r){try{return r?e(n(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,i){"use strict";var n=i(65),r=i(28)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[r]===t)}},function(t,e,i){"use strict";var n=i(61),r=i(28)("iterator"),o=i(65);t.exports=i(9).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||o[n(t)]}},function(t,e,i){"use strict";var n=i(12),r=i(24),o=i(28)("species");t.exports=function(t,e){var i,s=n(t).constructor;return void 0===s||void 0==(i=n(s)[o])?e:r(i)}},function(t,e,i){"use strict";var n,r,o,s=i(23),a=i(83),l=i(69),h=i(17),c=i(8),u=c.process,d=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,m=c.Dispatch,g=0,v={},_=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},y=function(t){_.call(t.data)};d&&p||(d=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return v[++g]=function(){a("function"==typeof t?t:Function(t),e)},n(g),g},p=function(t){delete v[t]},"process"==i(27)(u)?n=function(t){u.nextTick(s(_,t,1))}:m&&m.now?n=function(t){m.now(s(_,t,1))}:f?(o=(r=new f).port2,r.port1.onmessage=y,n=s(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",y,!1)):n="onreadystatechange"in h("script")?function(t){l.appendChild(h("script")).onreadystatechange=function(){l.removeChild(this),_.call(t)}}:function(t){setTimeout(s(_,t,1),0)}),t.exports={set:d,clear:p}},function(t,e,i){"use strict";t.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){"use strict";var n=i(8),r=i(82).set,o=n.MutationObserver||n.WebKitMutationObserver,s=n.process,a=n.Promise,l="process"==i(27)(s);t.exports=function(){var t,e,i,h=function(){var n,r;for(l&&(n=s.domain)&&n.exit();t;){r=t.fn,t=t.next;try{r()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(l)i=function(){s.nextTick(h)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var c=a.resolve(void 0);i=function(){c.then(h)}}else i=function(){r.call(n,h)};else{var u=!0,d=document.createTextNode("");new o(h).observe(d,{characterData:!0}),i=function(){d.data=u=!u}}return function(n){var r={fn:n,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}},function(t,e,i){"use strict";var n=i(24);t.exports.f=function(t){return new function(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n}),this.resolve=n(e),this.reject=n(i)}(t)}},function(t,e,i){"use strict";t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,i){"use strict";var n=i(8).navigator;t.exports=n&&n.userAgent||""},function(t,e,i){"use strict";var n=i(12),r=i(13),o=i(85);t.exports=function(t,e){if(n(t),r(e)&&e.constructor===t)return e;var i=o.f(t);return(0,i.resolve)(e),i.promise}},function(t,e,i){"use strict";var n=i(20);t.exports=function(t,e,i){for(var r in e)n(t,r,e[r],i);return t}},function(t,e,i){"use strict";var n=i(8),r=i(11),o=i(15),s=i(28)("species");t.exports=function(t){var e=n[t];o&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,i){"use strict";var n=i(28)("iterator"),r=!1;try{var o=[7][n]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var i=!1;try{var o=[7],s=o[n]();s.next=function(){return{done:i=!0}},o[n]=function(){return s},t(o)}catch(t){}return i}},function(t,e,i){"use strict";var n=i(7),r=i(9),o=i(8),s=i(81),a=i(88);n(n.P+n.R,"Promise",{finally:function(t){var e=s(this,r.Promise||o.Promise),i="function"==typeof t;return this.then(i?function(i){return a(e,t()).then(function(){return i})}:t,i?function(i){return a(e,t()).then(function(){throw i})}:t)}})},function(t,e,i){"use strict";var n=i(7),r=i(85),o=i(86);n(n.S,"Promise",{try:function(t){var e=r.f(this),i=o(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},function(t,e,i){"use strict";i(60),i(72),i(95),i(107),i(109),t.exports=i(9).WeakMap},function(t,e,i){"use strict";var n,r=i(96)(0),o=i(20),s=i(100),a=i(44),l=i(101),h=i(13),c=i(16),u=i(102),d=s.getWeak,p=Object.isExtensible,f=l.ufstore,m={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(h(t)){var e=d(t);return!0===e?f(u(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(u(this,"WeakMap"),t,e)}},_=t.exports=i(103)("WeakMap",g,v,l,!0,!0);c(function(){return 7!=(new _).set((Object.freeze||Object)(m),7).get(m)})&&(a((n=l.getConstructor(g,"WeakMap")).prototype,v),s.NEED=!0,r(["delete","has","get","set"],function(t){var e=_.prototype,i=e[t];o(e,t,function(e,r){if(h(e)&&!p(e)){this._f||(this._f=new n);var o=this._f[t](e,r);return"set"==t?this:o}return i.call(this,e,r)})}))},function(t,e,i){"use strict";var n=i(23),r=i(37),o=i(51),s=i(38),a=i(97);t.exports=function(t,e){var i=1==t,l=2==t,h=3==t,c=4==t,u=6==t,d=5==t||u,p=e||a;return function(e,a,f){for(var m,g,v=o(e),_=r(v),y=n(a,f,3),b=s(_.length),w=0,S=i?p(e,b):l?p(e,0):void 0;b>w;w++)if((d||w in _)&&(g=y(m=_[w],w,v),t))if(i)S[w]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return w;case 2:S.push(m)}else if(c)return!1;return u?-1:h||c?c:S}}},function(t,e,i){"use strict";var n=i(98);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,i){"use strict";var n=i(13),r=i(99),o=i(28)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),n(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,i){"use strict";var n=i(27);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(22)("meta"),o=i(13),s=i(21),a=i(11).f,l=0,h=Object.isExtensible||function(){return!0},c=!i(16)(function(){return h(Object.preventExtensions({}))}),u=function(t){a(t,r,{value:{i:"O"+ ++l,w:{}}})},d=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==(void 0===t?"undefined":n(t))?t:("string"==typeof t?"S":"P")+t;if(!s(t,r)){if(!h(t))return"F";if(!e)return"E";u(t)}return t[r].i},getWeak:function(t,e){if(!s(t,r)){if(!h(t))return!0;if(!e)return!1;u(t)}return t[r].w},onFreeze:function(t){return c&&d.NEED&&h(t)&&!s(t,r)&&u(t),t}}},function(t,e,i){"use strict";var n=i(89),r=i(100).getWeak,o=i(12),s=i(13),a=i(76),l=i(77),h=i(96),c=i(21),u=i(102),d=h(5),p=h(6),f=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var i=v(this,t);i?i[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,i,o){var h=t(function(t,n){a(t,h,e,"_i"),t._t=e,t._i=f++,t._l=void 0,void 0!=n&&l(n,i,t[o],t)});return n(h.prototype,{delete:function(t){if(!s(t))return!1;var i=r(t);return!0===i?m(u(this,e)).delete(t):i&&c(i,this._i)&&delete i[this._i]},has:function(t){if(!s(t))return!1;var i=r(t);return!0===i?m(u(this,e)).has(t):i&&c(i,this._i)}}),h},def:function(t,e,i){var n=r(o(e),!0);return!0===n?m(t).set(e,i):n[t._i]=i,t},ufstore:m}},function(t,e,i){"use strict";var n=i(13);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,i){"use strict";var n=i(8),r=i(7),o=i(20),s=i(89),a=i(100),l=i(77),h=i(76),c=i(13),u=i(16),d=i(91),p=i(70),f=i(104);t.exports=function(t,e,i,m,g,v){var _=n[t],y=_,b=g?"set":"add",w=y&&y.prototype,S={},x=function(t){var e=w[t];o(w,t,"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof y&&(v||w.forEach&&!u(function(){(new y).entries().next()}))){var T=new y,E=T[b](v?{}:-0,1)!=T,P=u(function(){T.has(1)}),C=d(function(t){new y(t)}),L=!v&&u(function(){for(var t=new y,e=5;e--;)t[b](e,e);return!t.has(-0)});C||((y=e(function(e,i){h(e,y,t);var n=f(new _,e,y);return void 0!=i&&l(i,g,n[b],n),n})).prototype=w,w.constructor=y),(P||L)&&(x("delete"),x("has"),g&&x("get")),(L||E)&&x(b),v&&w.clear&&delete w.clear}else y=m.getConstructor(e,t,g,b),s(y.prototype,i),a.NEED=!0;return p(y,t),S[t]=y,r(r.G+r.W+r.F*(y!=_),S),v||m.setStrong(y,t,g),y}},function(t,e,i){"use strict";var n=i(13),r=i(105).set;t.exports=function(t,e,i){var o,s=e.constructor;return s!==i&&"function"==typeof s&&(o=s.prototype)!==i.prototype&&n(o)&&r&&r(t,o),t}},function(t,e,i){"use strict";var n=i(13),r=i(12),o=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=i(23)(Function.call,i(106).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return o(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:o}},function(t,e,i){"use strict";var n=i(50),r=i(19),o=i(36),s=i(18),a=i(21),l=i(14),h=Object.getOwnPropertyDescriptor;e.f=i(15)?h:function(t,e){if(t=o(t),e=s(e,!0),l)try{return h(t,e)}catch(t){}if(a(t,e))return r(!n.f.call(t,e),t[e])}},function(t,e,i){"use strict";i(108)("WeakMap")},function(t,e,i){"use strict";var n=i(7);t.exports=function(t){n(n.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,i){"use strict";i(110)("WeakMap")},function(t,e,i){"use strict";var n=i(7),r=i(24),o=i(23),s=i(77);t.exports=function(t){n(n.S,t,{from:function(t){var e,i,n,a,l=arguments[1];return r(this),(e=void 0!==l)&&r(l),void 0==t?new this:(i=[],e?(n=0,a=o(l,arguments[2],2),s(t,!1,function(t){i.push(a(t,n++))})):s(t,!1,i.push,i),new this(i))}})}},function(t,e,i){"use strict";i(112),t.exports=i(9).String.codePointAt},function(t,e,i){"use strict";var n=i(7),r=i(63)(!1);n(n.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,i){"use strict";i(114),t.exports=i(9).String.fromCodePoint},function(t,e,i){"use strict";var n=i(7),r=i(40),o=String.fromCharCode,s=String.fromCodePoint;n(n.S+n.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,i=[],n=arguments.length,s=0;n>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");i.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return i.join("")}})},function(t,e,i){"use strict";i(116),i(60),t.exports=i(9).Symbol},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(8),o=i(21),s=i(15),a=i(7),l=i(20),h=i(100).KEY,c=i(16),u=i(29),d=i(70),p=i(22),f=i(28),m=i(117),g=i(118),v=i(119),_=i(99),y=i(12),b=i(13),w=i(36),S=i(18),x=i(19),T=i(67),E=i(120),P=i(106),C=i(11),L=i(45),k=P.f,A=C.f,R=E.f,I=r.Symbol,O=r.JSON,M=O&&O.stringify,D=f("_hidden"),z=f("toPrimitive"),F={}.propertyIsEnumerable,N=u("symbol-registry"),B=u("symbols"),j=u("op-symbols"),H=Object.prototype,U="function"==typeof I,q=r.QObject,W=!q||!q.prototype||!q.prototype.findChild,G=s&&c(function(){return 7!=T(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=k(H,e);n&&delete H[e],A(t,e,i),n&&t!==H&&A(H,e,n)}:A,V=function(t){var e=B[t]=T(I.prototype);return e._k=t,e},Z=U&&"symbol"==n(I.iterator)?function(t){return"symbol"==(void 0===t?"undefined":n(t))}:function(t){return t instanceof I},X=function(t,e,i){return t===H&&X(j,e,i),y(t),e=S(e,!0),y(i),o(B,e)?(i.enumerable?(o(t,D)&&t[D][e]&&(t[D][e]=!1),i=T(i,{enumerable:x(0,!1)})):(o(t,D)||A(t,D,x(1,{})),t[D][e]=!0),G(t,e,i)):A(t,e,i)},Y=function(t,e){y(t);for(var i,n=v(e=w(e)),r=0,o=n.length;o>r;)X(t,i=n[r++],e[i]);return t},$=function(t){var e=F.call(this,t=S(t,!0));return!(this===H&&o(B,t)&&!o(j,t))&&(!(e||!o(this,t)||!o(B,t)||o(this,D)&&this[D][t])||e)},K=function(t,e){if(t=w(t),e=S(e,!0),t!==H||!o(B,e)||o(j,e)){var i=k(t,e);return!i||!o(B,e)||o(t,D)&&t[D][e]||(i.enumerable=!0),i}},Q=function(t){for(var e,i=R(w(t)),n=[],r=0;i.length>r;)o(B,e=i[r++])||e==D||e==h||n.push(e);return n},J=function(t){for(var e,i=t===H,n=R(i?j:w(t)),r=[],s=0;n.length>s;)!o(B,e=n[s++])||i&&!o(H,e)||r.push(B[e]);return r};U||(l((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0);return s&&W&&G(H,t,{configurable:!0,set:function e(i){this===H&&e.call(j,i),o(this,D)&&o(this[D],t)&&(this[D][t]=!1),G(this,t,x(1,i))}}),V(t)}).prototype,"toString",function(){return this._k}),P.f=K,C.f=X,i(121).f=E.f=Q,i(50).f=$,i(49).f=J,s&&!i(30)&&l(H,"propertyIsEnumerable",$,!0),m.f=function(t){return V(f(t))}),a(a.G+a.W+a.F*!U,{Symbol:I});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;tt.length>et;)f(tt[et++]);for(var it=L(f.store),nt=0;it.length>nt;)g(it[nt++]);a(a.S+a.F*!U,"Symbol",{for:function(t){return o(N,t+="")?N[t]:N[t]=I(t)},keyFor:function(t){if(!Z(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),a(a.S+a.F*!U,"Object",{create:function(t,e){return void 0===e?T(t):Y(T(t),e)},defineProperty:X,defineProperties:Y,getOwnPropertyDescriptor:K,getOwnPropertyNames:Q,getOwnPropertySymbols:J}),O&&a(a.S+a.F*(!U||c(function(){var t=I();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],r=1;arguments.length>r;)n.push(arguments[r++]);if(i=e=n[1],(b(e)||void 0!==t)&&!Z(t))return _(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Z(e))return e}),n[1]=e,M.apply(O,n)}}),I.prototype[z]||i(10)(I.prototype,z,I.prototype.valueOf),d(I,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(t,e,i){"use strict";e.f=i(28)},function(t,e,i){"use strict";var n=i(8),r=i(9),o=i(30),s=i(117),a=i(11).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,i){"use strict";var n=i(45),r=i(49),o=i(50);t.exports=function(t){var e=n(t),i=r.f;if(i)for(var s,a=i(t),l=o.f,h=0;a.length>h;)l.call(t,s=a[h++])&&e.push(s);return e}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(36),o=i(121).f,s={}.toString,a="object"==("undefined"==typeof window?"undefined":n(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==s.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(r(t))}},function(t,e,i){"use strict";var n=i(46),r=i(48).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},function(t,e,i){"use strict";i(123),t.exports=i(9).Object.values},function(t,e,i){"use strict";var n=i(7),r=i(124)(!1);n(n.S,"Object",{values:function(t){return r(t)}})},function(t,e,i){"use strict";var n=i(45),r=i(36),o=i(50).f;t.exports=function(t){return function(e){for(var i,s=r(e),a=n(s),l=a.length,h=0,c=[];l>h;)o.call(s,i=a[h++])&&c.push(t?[i,s[i]]:s[i]);return c}}},function(t,e,i){"use strict";var n=!1;if("undefined"!=typeof ReadableStream)try{new ReadableStream({start:function(t){t.close()}}),n=!0}catch(t){}e.ReadableStream=n?ReadableStream:i(126).ReadableStream},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){for(var i in e)t[i]=e[i]}(e,function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e,i){var r="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(t){return void 0===t?"undefined":n(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":n(t)},o=i(1).assert;function s(t){return"string"==typeof t||"symbol"===(void 0===t?"undefined":r(t))}function a(t,e,i){if("function"!=typeof t)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(t,e,i)}e.typeIsObject=function(t){return"object"===(void 0===t?"undefined":r(t))&&null!==t||"function"==typeof t},e.createDataProperty=function(t,i,n){o(e.typeIsObject(t)),Object.defineProperty(t,i,{value:n,writable:!0,enumerable:!0,configurable:!0})},e.createArrayFromList=function(t){return t.slice()},e.ArrayBufferCopy=function(t,e,i,n,r){new Uint8Array(t).set(new Uint8Array(i,n,r),e)},e.CreateIterResultObject=function(t,e){o("boolean"==typeof e);var i={};return Object.defineProperty(i,"value",{value:t,enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(i,"done",{value:e,enumerable:!0,writable:!0,configurable:!0}),i},e.IsFiniteNonNegativeNumber=function(t){return!Number.isNaN(t)&&(t!==1/0&&!(t<0))},e.InvokeOrNoop=function(t,e,i){o(void 0!==t),o(s(e)),o(Array.isArray(i));var n=t[e];if(void 0!==n)return a(n,t,i)},e.PromiseInvokeOrNoop=function(t,i,n){o(void 0!==t),o(s(i)),o(Array.isArray(n));try{return Promise.resolve(e.InvokeOrNoop(t,i,n))}catch(t){return Promise.reject(t)}},e.PromiseInvokeOrPerformFallback=function(t,e,i,n,r){o(void 0!==t),o(s(e)),o(Array.isArray(i)),o(Array.isArray(r));var l=void 0;try{l=t[e]}catch(t){return Promise.reject(t)}if(void 0===l)return n.apply(null,r);try{return Promise.resolve(a(l,t,i))}catch(t){return Promise.reject(t)}},e.TransferArrayBuffer=function(t){return t.slice()},e.ValidateAndNormalizeHighWaterMark=function(t){if(t=Number(t),Number.isNaN(t)||t<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return t},e.ValidateAndNormalizeQueuingStrategy=function(t,i){if(void 0!==t&&"function"!=typeof t)throw new TypeError("size property of a queuing strategy must be a function");return{size:t,highWaterMark:i=e.ValidateAndNormalizeHighWaterMark(i)}}},function(t,e,i){function n(t){this.name="AssertionError",this.message=t||"",this.stack=(new Error).stack}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports={rethrowAssertionErrorRejection:function(t){t&&t.constructor===n&&setTimeout(function(){throw t},0)},AssertionError:n,assert:function(t,e){if(!t)throw new n(e)}}},function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=i(0),s=o.InvokeOrNoop,a=o.PromiseInvokeOrNoop,l=o.ValidateAndNormalizeQueuingStrategy,h=o.typeIsObject,c=i(1),u=c.assert,d=c.rethrowAssertionErrorRejection,p=i(3),f=p.DequeueValue,m=p.EnqueueValueWithSize,g=p.PeekQueueValue,v=p.ResetQueue,_=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.size,o=i.highWaterMark,s=void 0===o?1:o;if(r(this,t),this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=[],this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1,void 0!==e.type)throw new RangeError("Invalid type is specified");this._writableStreamController=new N(this,e,n,s),this._writableStreamController.__startSteps()}return n(t,[{key:"abort",value:function(t){return!1===b(this)?Promise.reject(W("abort")):!0===w(this)?Promise.reject(new TypeError("Cannot abort a stream that already has a writer")):S(this,t)}},{key:"getWriter",value:function(){if(!1===b(this))throw W("getWriter");return y(this)}},{key:"locked",get:function(){if(!1===b(this))throw W("locked");return w(this)}}]),t}();function y(t){return new R(t)}function b(t){return!!h(t)&&!!Object.prototype.hasOwnProperty.call(t,"_writableStreamController")}function w(t){return u(!0===b(t),"IsWritableStreamLocked should only be used on known writable streams"),void 0!==t._writer}function S(t,e){var i=t._state;if("closed"===i)return Promise.resolve(void 0);if("errored"===i)return Promise.reject(t._storedError);var n=new TypeError("Requested to abort");if(void 0!==t._pendingAbortRequest)return Promise.reject(n);u("writable"===i||"erroring"===i,"state must be writable or erroring");var r=!1;"erroring"===i&&(r=!0,e=void 0);var o=new Promise(function(i,n){t._pendingAbortRequest={_resolve:i,_reject:n,_reason:e,_wasAlreadyErroring:r}});return!1===r&&T(t,n),o}function x(t,e){var i=t._state;"writable"!==i?(u("erroring"===i),E(t)):T(t,e)}function T(t,e){u(void 0===t._storedError,"stream._storedError === undefined"),u("writable"===t._state,"state must be writable");var i=t._writableStreamController;u(void 0!==i,"controller must not be undefined"),t._state="erroring",t._storedError=e;var n=t._writer;void 0!==n&&D(n,e),!1===L(t)&&!0===i._started&&E(t)}function E(t){u("erroring"===t._state,"stream._state === erroring"),u(!1===L(t),"WritableStreamHasOperationMarkedInFlight(stream) === false"),t._state="errored",t._writableStreamController.__errorSteps();for(var e=t._storedError,i=0;i<t._writeRequests.length;i++){t._writeRequests[i]._reject(e)}if(t._writeRequests=[],void 0!==t._pendingAbortRequest){var n=t._pendingAbortRequest;if(t._pendingAbortRequest=void 0,!0===n._wasAlreadyErroring)return n._reject(e),void k(t);t._writableStreamController.__abortSteps(n._reason).then(function(){n._resolve(),k(t)},function(e){n._reject(e),k(t)})}else k(t)}function P(t){u(void 0!==t._inFlightCloseRequest),t._inFlightCloseRequest._resolve(void 0),t._inFlightCloseRequest=void 0;var e=t._state;u("writable"===e||"erroring"===e),"erroring"===e&&(t._storedError=void 0,void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._resolve(),t._pendingAbortRequest=void 0)),t._state="closed";var i=t._writer;void 0!==i&&function(t){u(void 0!==t._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==t._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===t._closedPromiseState,"writer._closedPromiseState is pending"),t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="resolved"}(i),u(void 0===t._pendingAbortRequest,"stream._pendingAbortRequest === undefined"),u(void 0===t._storedError,"stream._storedError === undefined")}function C(t){return void 0!==t._closeRequest||void 0!==t._inFlightCloseRequest}function L(t){return void 0!==t._inFlightWriteRequest||void 0!==t._inFlightCloseRequest}function k(t){u("errored"===t._state,'_stream_.[[state]] is `"errored"`'),void 0!==t._closeRequest&&(u(void 0===t._inFlightCloseRequest),t._closeRequest._reject(t._storedError),t._closeRequest=void 0);var e=t._writer;void 0!==e&&(X(e,t._storedError),e._closedPromise.catch(function(){}))}function A(t,e){u("writable"===t._state),u(!1===C(t));var i=t._writer;void 0!==i&&e!==t._backpressure&&(!0===e?function(t){u(void 0===t._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===t._readyPromise_reject,"writer._readyPromise_reject === undefined"),t._readyPromise=new Promise(function(e,i){t._readyPromise_resolve=e,t._readyPromise_reject=i}),t._readyPromiseState="pending"}(i):(u(!1===e),K(i))),t._backpressure=e}t.exports={AcquireWritableStreamDefaultWriter:y,IsWritableStream:b,IsWritableStreamLocked:w,WritableStream:_,WritableStreamAbort:S,WritableStreamDefaultControllerError:q,WritableStreamDefaultWriterCloseWithErrorPropagation:function(t){var e=t._ownerWritableStream;u(void 0!==e);var i=e._state;if(!0===C(e)||"closed"===i)return Promise.resolve();if("errored"===i)return Promise.reject(e._storedError);return u("writable"===i||"erroring"===i),O(t)},WritableStreamDefaultWriterRelease:z,WritableStreamDefaultWriterWrite:F,WritableStreamCloseQueuedOrInFlight:C};var R=function(){function t(e){if(r(this,t),!1===b(e))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===w(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;var i,n=e._state;if("writable"===n)!1===C(e)&&!0===e._backpressure?((i=this)._readyPromise=new Promise(function(t,e){i._readyPromise_resolve=t,i._readyPromise_reject=e}),i._readyPromiseState="pending"):$(this),Z(this);else if("erroring"===n)Y(this,e._storedError),this._readyPromise.catch(function(){}),Z(this);else if("closed"===n)$(this),function(t){t._closedPromise=Promise.resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="resolved"}(this);else{u("errored"===n,"state must be errored");var o=e._storedError;Y(this,o),this._readyPromise.catch(function(){}),function(t,e){t._closedPromise=Promise.reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="rejected"}(this,o),this._closedPromise.catch(function(){})}}return n(t,[{key:"abort",value:function(t){return!1===I(this)?Promise.reject(G("abort")):void 0===this._ownerWritableStream?Promise.reject(V("abort")):function(t,e){var i=t._ownerWritableStream;return u(void 0!==i),S(i,e)}(this,t)}},{key:"close",value:function(){if(!1===I(this))return Promise.reject(G("close"));var t=this._ownerWritableStream;return void 0===t?Promise.reject(V("close")):!0===C(t)?Promise.reject(new TypeError("cannot close an already-closing stream")):O(this)}},{key:"releaseLock",value:function(){if(!1===I(this))throw G("releaseLock");var t=this._ownerWritableStream;void 0!==t&&(u(void 0!==t._writer),z(this))}},{key:"write",value:function(t){return!1===I(this)?Promise.reject(G("write")):void 0===this._ownerWritableStream?Promise.reject(V("write to")):F(this,t)}},{key:"closed",get:function(){return!1===I(this)?Promise.reject(G("closed")):this._closedPromise}},{key:"desiredSize",get:function(){if(!1===I(this))throw G("desiredSize");if(void 0===this._ownerWritableStream)throw V("desiredSize");return function(t){var e=t._ownerWritableStream,i=e._state;if("errored"===i||"erroring"===i)return null;if("closed"===i)return 0;return B(e._writableStreamController)}(this)}},{key:"ready",get:function(){return!1===I(this)?Promise.reject(G("ready")):this._readyPromise}}]),t}();function I(t){return!!h(t)&&!!Object.prototype.hasOwnProperty.call(t,"_ownerWritableStream")}function O(t){var e=t._ownerWritableStream;u(void 0!==e);var i=e._state;if("closed"===i||"errored"===i)return Promise.reject(new TypeError("The stream (in "+i+" state) is not in the writable state and cannot be closed"));u("writable"===i||"erroring"===i),u(!1===C(e));var n,r=new Promise(function(t,i){var n={_resolve:t,_reject:i};e._closeRequest=n});return!0===e._backpressure&&"writable"===i&&K(t),n=e._writableStreamController,m(n,"close",0),j(n),r}function M(t,e){"pending"===t._closedPromiseState?X(t,e):function(t,e){u(void 0===t._closedPromise_resolve,"writer._closedPromise_resolve === undefined"),u(void 0===t._closedPromise_reject,"writer._closedPromise_reject === undefined"),u("pending"!==t._closedPromiseState,"writer._closedPromiseState is not pending"),t._closedPromise=Promise.reject(e),t._closedPromiseState="rejected"}(t,e),t._closedPromise.catch(function(){})}function D(t,e){"pending"===t._readyPromiseState?function(t,e){u(void 0!==t._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==t._readyPromise_reject,"writer._readyPromise_reject !== undefined"),t._readyPromise_reject(e),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="rejected"}(t,e):function(t,e){u(void 0===t._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===t._readyPromise_reject,"writer._readyPromise_reject === undefined"),t._readyPromise=Promise.reject(e),t._readyPromiseState="rejected"}(t,e),t._readyPromise.catch(function(){})}function z(t){var e=t._ownerWritableStream;u(void 0!==e),u(e._writer===t);var i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");D(t,i),M(t,i),e._writer=void 0,t._ownerWritableStream=void 0}function F(t,e){var i=t._ownerWritableStream;u(void 0!==i);var n=i._writableStreamController,r=function(t,e){var i=t._strategySize;if(void 0===i)return 1;try{return i(e)}catch(e){return H(t,e),1}}(n,e);if(i!==t._ownerWritableStream)return Promise.reject(V("write to"));var o=i._state;if("errored"===o)return Promise.reject(i._storedError);if(!0===C(i)||"closed"===o)return Promise.reject(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return Promise.reject(i._storedError);u("writable"===o);var s=function(t){return u(!0===w(t)),u("writable"===t._state),new Promise(function(e,i){var n={_resolve:e,_reject:i};t._writeRequests.push(n)})}(i);return function(t,e,i){var n={chunk:e};try{m(t,n,i)}catch(e){return void H(t,e)}var r=t._controlledWritableStream;if(!1===C(r)&&"writable"===r._state){var o=U(t);A(r,o)}j(t)}(n,e,r),s}var N=function(){function t(e,i,n,o){if(r(this,t),!1===b(e))throw new TypeError("WritableStreamDefaultController can only be constructed with a WritableStream instance");if(void 0!==e._writableStreamController)throw new TypeError("WritableStreamDefaultController instances can only be created by the WritableStream constructor");this._controlledWritableStream=e,this._underlyingSink=i,this._queue=void 0,this._queueTotalSize=void 0,v(this),this._started=!1;var s=l(n,o);this._strategySize=s.size,this._strategyHWM=s.highWaterMark,A(e,U(this))}return n(t,[{key:"error",value:function(t){if(!1===function(t){if(!h(t))return!1;if(!Object.prototype.hasOwnProperty.call(t,"_underlyingSink"))return!1;return!0}(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");"writable"===this._controlledWritableStream._state&&q(this,t)}},{key:"__abortSteps",value:function(t){return a(this._underlyingSink,"abort",[t])}},{key:"__errorSteps",value:function(){v(this)}},{key:"__startSteps",value:function(){var t=this,e=s(this._underlyingSink,"start",[this]),i=this._controlledWritableStream;Promise.resolve(e).then(function(){u("writable"===i._state||"erroring"===i._state),t._started=!0,j(t)},function(e){u("writable"===i._state||"erroring"===i._state),t._started=!0,x(i,e)}).catch(d)}}]),t}();function B(t){return t._strategyHWM-t._queueTotalSize}function j(t){var e=t._controlledWritableStream;if(!1!==t._started&&void 0===e._inFlightWriteRequest){var i=e._state;if("closed"!==i&&"errored"!==i)if("erroring"!==i){if(0!==t._queue.length){var n=g(t);"close"===n?function(t){var e=t._controlledWritableStream;(function(t){u(void 0===t._inFlightCloseRequest),u(void 0!==t._closeRequest),t._inFlightCloseRequest=t._closeRequest,t._closeRequest=void 0})(e),f(t),u(0===t._queue.length,"queue must be empty once the final write record is dequeued"),a(t._underlyingSink,"close",[]).then(function(){P(e)},function(t){!function(t,e){u(void 0!==t._inFlightCloseRequest),t._inFlightCloseRequest._reject(e),t._inFlightCloseRequest=void 0,u("writable"===t._state||"erroring"===t._state),void 0!==t._pendingAbortRequest&&(t._pendingAbortRequest._reject(e),t._pendingAbortRequest=void 0),x(t,e)}(e,t)}).catch(d)}(t):function(t,e){var i=t._controlledWritableStream;(function(t){u(void 0===t._inFlightWriteRequest,"there must be no pending write request"),u(0!==t._writeRequests.length,"writeRequests must not be empty"),t._inFlightWriteRequest=t._writeRequests.shift()})(i),a(t._underlyingSink,"write",[e,t]).then(function(){!function(t){u(void 0!==t._inFlightWriteRequest),t._inFlightWriteRequest._resolve(void 0),t._inFlightWriteRequest=void 0}(i);var e=i._state;if(u("writable"===e||"erroring"===e),f(t),!1===C(i)&&"writable"===e){var n=U(t);A(i,n)}j(t)},function(t){!function(t,e){u(void 0!==t._inFlightWriteRequest),t._inFlightWriteRequest._reject(e),t._inFlightWriteRequest=void 0,u("writable"===t._state||"erroring"===t._state),x(t,e)}(i,t)}).catch(d)}(t,n.chunk)}}else E(e)}}function H(t,e){"writable"===t._controlledWritableStream._state&&q(t,e)}function U(t){return B(t)<=0}function q(t,e){var i=t._controlledWritableStream;u("writable"===i._state),T(i,e)}function W(t){return new TypeError("WritableStream.prototype."+t+" can only be used on a WritableStream")}function G(t){return new TypeError("WritableStreamDefaultWriter.prototype."+t+" can only be used on a WritableStreamDefaultWriter")}function V(t){return new TypeError("Cannot "+t+" a stream using a released writer")}function Z(t){t._closedPromise=new Promise(function(e,i){t._closedPromise_resolve=e,t._closedPromise_reject=i,t._closedPromiseState="pending"})}function X(t,e){u(void 0!==t._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==t._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===t._closedPromiseState,"writer._closedPromiseState is pending"),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="rejected"}function Y(t,e){t._readyPromise=Promise.reject(e),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="rejected"}function $(t){t._readyPromise=Promise.resolve(void 0),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="fulfilled"}function K(t){u(void 0!==t._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==t._readyPromise_reject,"writer._readyPromise_reject !== undefined"),t._readyPromise_resolve(void 0),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="fulfilled"}},function(t,e,i){var n=i(0).IsFiniteNonNegativeNumber,r=i(1).assert;e.DequeueValue=function(t){r("_queue"in t&&"_queueTotalSize"in t,"Spec-level failure: DequeueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),r(t._queue.length>0,"Spec-level failure: should never dequeue from an empty queue.");var e=t._queue.shift();return t._queueTotalSize-=e.size,t._queueTotalSize<0&&(t._queueTotalSize=0),e.value},e.EnqueueValueWithSize=function(t,e,i){if(r("_queue"in t&&"_queueTotalSize"in t,"Spec-level failure: EnqueueValueWithSize should only be used on containers with [[queue]] and [[queueTotalSize]]."),i=Number(i),!n(i))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");t._queue.push({value:e,size:i}),t._queueTotalSize+=i},e.PeekQueueValue=function(t){return r("_queue"in t&&"_queueTotalSize"in t,"Spec-level failure: PeekQueueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),r(t._queue.length>0,"Spec-level failure: should never peek at an empty queue."),t._queue[0].value},e.ResetQueue=function(t){r("_queue"in t&&"_queueTotalSize"in t,"Spec-level failure: ResetQueue should only be used on containers with [[queue]] and [[queueTotalSize]]."),t._queue=[],t._queueTotalSize=0}},function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=i(0),s=o.ArrayBufferCopy,a=o.CreateIterResultObject,l=o.IsFiniteNonNegativeNumber,h=o.InvokeOrNoop,c=o.PromiseInvokeOrNoop,u=o.TransferArrayBuffer,d=o.ValidateAndNormalizeQueuingStrategy,p=o.ValidateAndNormalizeHighWaterMark,f=i(0),m=f.createArrayFromList,g=f.createDataProperty,v=f.typeIsObject,_=i(1),y=_.assert,b=_.rethrowAssertionErrorRejection,w=i(3),S=w.DequeueValue,x=w.EnqueueValueWithSize,T=w.ResetQueue,E=i(2),P=E.AcquireWritableStreamDefaultWriter,C=E.IsWritableStream,L=E.IsWritableStreamLocked,k=E.WritableStreamAbort,A=E.WritableStreamDefaultWriterCloseWithErrorPropagation,R=E.WritableStreamDefaultWriterRelease,I=E.WritableStreamDefaultWriterWrite,O=E.WritableStreamCloseQueuedOrInFlight,M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.size,o=i.highWaterMark;r(this,t),this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,this._readableStreamController=void 0;var s=e.type;if("bytes"===String(s))void 0===o&&(o=0),this._readableStreamController=new dt(this,e,o);else{if(void 0!==s)throw new RangeError("Invalid type is specified");void 0===o&&(o=1),this._readableStreamController=new nt(this,e,n,o)}}return n(t,[{key:"cancel",value:function(t){return!1===z(this)?Promise.reject(kt("cancel")):!0===F(this)?Promise.reject(new TypeError("Cannot cancel a stream that already has a reader")):H(this,t)}},{key:"getReader",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mode;if(!1===z(this))throw kt("getReader");if(void 0===t)return D(this);if("byob"===(t=String(t)))return new $(this);throw new RangeError("Invalid mode is specified")}},{key:"pipeThrough",value:function(t,e){var i=t.writable,n=t.readable;return function(t){try{Promise.prototype.then.call(t,void 0,function(){})}catch(t){}}(this.pipeTo(i,e)),n}},{key:"pipeTo",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.preventClose,r=i.preventAbort,o=i.preventCancel;if(!1===z(this))return Promise.reject(kt("pipeTo"));if(!1===C(t))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));if(n=Boolean(n),r=Boolean(r),o=Boolean(o),!0===F(this))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"));if(!0===L(t))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"));var s=D(this),a=P(t),l=!1,h=Promise.resolve();return new Promise(function(i,c){var u,d,p;if(g(e,s._closedPromise,function(e){!1===r?v(function(){return k(t,e)},!0,e):_(!0,e)}),g(t,a._closedPromise,function(t){!1===o?v(function(){return H(e,t)},!0,t):_(!0,t)}),u=e,d=s._closedPromise,p=function(){!1===n?v(function(){return A(a)}):_()},"closed"===u._state?p():d.then(p).catch(b),!0===O(t)||"closed"===t._state){var f=new TypeError("the destination writable stream closed before all data could be piped to it");!1===o?v(function(){return H(e,f)},!0,f):_(!0,f)}function m(){var t=h;return h.then(function(){return t!==h?m():void 0})}function g(t,e,i){"errored"===t._state?i(t._storedError):e.catch(i).catch(b)}function v(e,i,n){function r(){e().then(function(){return y(i,n)},function(t){return y(!0,t)}).catch(b)}!0!==l&&(l=!0,"writable"===t._state&&!1===O(t)?m().then(r):r())}function _(e,i){!0!==l&&(l=!0,"writable"===t._state&&!1===O(t)?m().then(function(){return y(e,i)}).catch(b):y(e,i))}function y(t,e){R(a),et(s),t?c(e):i(void 0)}(function t(){return h=Promise.resolve(),!0===l?Promise.resolve():a._readyPromise.then(function(){return it(s).then(function(t){var e=t.value;!0!==t.done&&(h=I(a,e).catch(function(){}))})}).then(t)})().catch(function(t){h=Promise.resolve(),b(t)})})}},{key:"tee",value:function(){if(!1===z(this))throw kt("tee");var t=N(this,!1);return m(t)}},{key:"locked",get:function(){if(!1===z(this))throw kt("locked");return F(this)}}]),t}();function D(t){return new Y(t)}function z(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readableStreamController")}function F(t){return y(!0===z(t),"IsReadableStreamLocked should only be used on known readable streams"),void 0!==t._reader}function N(t,e){y(!0===z(t)),y("boolean"==typeof e);var i=D(t),n={closedOrErrored:!1,canceled1:!1,canceled2:!1,reason1:void 0,reason2:void 0};n.promise=new Promise(function(t){n._resolve=t});var r=function(){return function t(){var e=t._reader,i=t._branch1,n=t._branch2,r=t._teeState;return it(e).then(function(t){y(v(t));var e=t.value,o=t.done;if(y("boolean"==typeof o),!0===o&&!1===r.closedOrErrored&&(!1===r.canceled1&&st(i),!1===r.canceled2&&st(n),r.closedOrErrored=!0),!0!==r.closedOrErrored){var s=e,a=e;!1===r.canceled1&&at(i,s),!1===r.canceled2&&at(n,a)}})}}();r._reader=i,r._teeState=n,r._cloneForBranch2=e;var o=function(){return function t(e){var i=t._stream,n=t._teeState;n.canceled1=!0;n.reason1=e;if(!0===n.canceled2){var r=m([n.reason1,n.reason2]),o=H(i,r);n._resolve(o)}return n.promise}}();o._stream=t,o._teeState=n;var s=function(){return function t(e){var i=t._stream,n=t._teeState;n.canceled2=!0;n.reason2=e;if(!0===n.canceled1){var r=m([n.reason1,n.reason2]),o=H(i,r);n._resolve(o)}return n.promise}}();s._stream=t,s._teeState=n;var a=Object.create(Object.prototype);g(a,"pull",r),g(a,"cancel",o);var l=new M(a),h=Object.create(Object.prototype);g(h,"pull",r),g(h,"cancel",s);var c=new M(h);return r._branch1=l._readableStreamController,r._branch2=c._readableStreamController,i._closedPromise.catch(function(t){!0!==n.closedOrErrored&&(lt(r._branch1,t),lt(r._branch2,t),n.closedOrErrored=!0)}),[l,c]}function B(t){return y(!0===K(t._reader)),y("readable"===t._state||"closed"===t._state),new Promise(function(e,i){var n={_resolve:e,_reject:i};t._reader._readIntoRequests.push(n)})}function j(t){return y(!0===Q(t._reader)),y("readable"===t._state),new Promise(function(e,i){var n={_resolve:e,_reject:i};t._reader._readRequests.push(n)})}function H(t,e){return t._disturbed=!0,"closed"===t._state?Promise.resolve(void 0):"errored"===t._state?Promise.reject(t._storedError):(U(t),t._readableStreamController.__cancelSteps(e).then(function(){}))}function U(t){y("readable"===t._state),t._state="closed";var e=t._reader;if(void 0!==e){if(!0===Q(e)){for(var i=0;i<e._readRequests.length;i++){(0,e._readRequests[i]._resolve)(a(void 0,!0))}e._readRequests=[]}!function(t){y(void 0!==t._closedPromise_resolve),y(void 0!==t._closedPromise_reject),t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0}(e)}}function q(t,e){y(!0===z(t),"stream must be ReadableStream"),y("readable"===t._state,"state must be readable"),t._state="errored",t._storedError=e;var i=t._reader;if(void 0!==i){if(!0===Q(i)){for(var n=0;n<i._readRequests.length;n++){i._readRequests[n]._reject(e)}i._readRequests=[]}else{y(K(i),"reader must be ReadableStreamBYOBReader");for(var r=0;r<i._readIntoRequests.length;r++){i._readIntoRequests[r]._reject(e)}i._readIntoRequests=[]}It(i,e),i._closedPromise.catch(function(){})}}function W(t,e,i){var n=t._reader;y(n._readRequests.length>0),n._readRequests.shift()._resolve(a(e,i))}function G(t){return t._reader._readIntoRequests.length}function V(t){return t._reader._readRequests.length}function Z(t){var e=t._reader;return void 0!==e&&!1!==K(e)}function X(t){var e=t._reader;return void 0!==e&&!1!==Q(e)}t.exports={ReadableStream:M,IsReadableStreamDisturbed:function(t){return y(!0===z(t),"IsReadableStreamDisturbed should only be used on known readable streams"),t._disturbed},ReadableStreamDefaultControllerClose:st,ReadableStreamDefaultControllerEnqueue:at,ReadableStreamDefaultControllerError:lt,ReadableStreamDefaultControllerGetDesiredSize:ct};var Y=function(){function t(e){if(r(this,t),!1===z(e))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===F(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");J(this,e),this._readRequests=[]}return n(t,[{key:"cancel",value:function(t){return!1===Q(this)?Promise.reject(Rt("cancel")):void 0===this._ownerReadableStream?Promise.reject(At("cancel")):tt(this,t)}},{key:"read",value:function(){return!1===Q(this)?Promise.reject(Rt("read")):void 0===this._ownerReadableStream?Promise.reject(At("read from")):it(this)}},{key:"releaseLock",value:function(){if(!1===Q(this))throw Rt("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");et(this)}}},{key:"closed",get:function(){return!1===Q(this)?Promise.reject(Rt("closed")):this._closedPromise}}]),t}(),$=function(){function t(e){if(r(this,t),!z(e))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===pt(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(F(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");J(this,e),this._readIntoRequests=[]}return n(t,[{key:"cancel",value:function(t){return K(this)?void 0===this._ownerReadableStream?Promise.reject(At("cancel")):tt(this,t):Promise.reject(Ot("cancel"))}},{key:"read",value:function(t){return K(this)?void 0===this._ownerReadableStream?Promise.reject(At("read from")):ArrayBuffer.isView(t)?0===t.byteLength?Promise.reject(new TypeError("view must have non-zero byteLength")):function(t,e){var i=t._ownerReadableStream;if(y(void 0!==i),i._disturbed=!0,"errored"===i._state)return Promise.reject(i._storedError);return function(t,e){var i=t._controlledReadableStream,n=1;e.constructor!==DataView&&(n=e.constructor.BYTES_PER_ELEMENT);var r=e.constructor,o={buffer:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength,bytesFilled:0,elementSize:n,ctor:r,readerType:"byob"};if(t._pendingPullIntos.length>0)return o.buffer=u(o.buffer),t._pendingPullIntos.push(o),B(i);if("closed"===i._state){var s=new e.constructor(o.buffer,o.byteOffset,0);return Promise.resolve(a(s,!0))}if(t._queueTotalSize>0){if(!0===bt(t,o)){var l=_t(o);return St(t),Promise.resolve(a(l,!1))}if(!0===t._closeRequested){var h=new TypeError("Insufficient bytes to fill elements in the given buffer");return Ct(t,h),Promise.reject(h)}}o.buffer=u(o.buffer),t._pendingPullIntos.push(o);var c=B(i);return mt(t),c}(i._readableStreamController,e)}(this,t):Promise.reject(new TypeError("view must be an array buffer view")):Promise.reject(Ot("read"))}},{key:"releaseLock",value:function(){if(!K(this))throw Ot("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");et(this)}}},{key:"closed",get:function(){return K(this)?this._closedPromise:Promise.reject(Ot("closed"))}}]),t}();function K(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readIntoRequests")}function Q(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readRequests")}function J(t,e){t._ownerReadableStream=e,e._reader=t,"readable"===e._state?function(t){t._closedPromise=new Promise(function(e,i){t._closedPromise_resolve=e,t._closedPromise_reject=i})}(t):"closed"===e._state?function(t){t._closedPromise=Promise.resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0}(t):(y("errored"===e._state,"state must be errored"),function(t,e){t._closedPromise=Promise.reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0}(t,e._storedError),t._closedPromise.catch(function(){}))}function tt(t,e){var i=t._ownerReadableStream;return y(void 0!==i),H(i,e)}function et(t){y(void 0!==t._ownerReadableStream),y(t._ownerReadableStream._reader===t),"readable"===t._ownerReadableStream._state?It(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(t,e){y(void 0===t._closedPromise_resolve),y(void 0===t._closedPromise_reject),t._closedPromise=Promise.reject(e)}(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._closedPromise.catch(function(){}),t._ownerReadableStream._reader=void 0,t._ownerReadableStream=void 0}function it(t){var e=t._ownerReadableStream;return y(void 0!==e),e._disturbed=!0,"closed"===e._state?Promise.resolve(a(void 0,!0)):"errored"===e._state?Promise.reject(e._storedError):(y("readable"===e._state),e._readableStreamController.__pullSteps())}var nt=function(){function t(e,i,n,o){if(r(this,t),!1===z(e))throw new TypeError("ReadableStreamDefaultController can only be constructed with a ReadableStream instance");if(void 0!==e._readableStreamController)throw new TypeError("ReadableStreamDefaultController instances can only be created by the ReadableStream constructor");this._controlledReadableStream=e,this._underlyingSource=i,this._queue=void 0,this._queueTotalSize=void 0,T(this),this._started=!1,this._closeRequested=!1,this._pullAgain=!1,this._pulling=!1;var s=d(n,o);this._strategySize=s.size,this._strategyHWM=s.highWaterMark;var a=this,l=h(i,"start",[this]);Promise.resolve(l).then(function(){a._started=!0,y(!1===a._pulling),y(!1===a._pullAgain),ot(a)},function(t){ht(a,t)}).catch(b)}return n(t,[{key:"close",value:function(){if(!1===rt(this))throw Mt("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be closed");st(this)}},{key:"enqueue",value:function(t){if(!1===rt(this))throw Mt("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be enqueued to");return at(this,t)}},{key:"error",value:function(t){if(!1===rt(this))throw Mt("error");var e=this._controlledReadableStream;if("readable"!==e._state)throw new TypeError("The stream is "+e._state+" and so cannot be errored");lt(this,t)}},{key:"__cancelSteps",value:function(t){return T(this),c(this._underlyingSource,"cancel",[t])}},{key:"__pullSteps",value:function(){var t=this._controlledReadableStream;if(this._queue.length>0){var e=S(this);return!0===this._closeRequested&&0===this._queue.length?U(t):ot(this),Promise.resolve(a(e,!1))}var i=j(t);return ot(this),i}},{key:"desiredSize",get:function(){if(!1===rt(this))throw Mt("desiredSize");return ct(this)}}]),t}();function rt(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_underlyingSource")}function ot(t){!1!==function(t){var e=t._controlledReadableStream;if("closed"===e._state||"errored"===e._state)return!1;if(!0===t._closeRequested)return!1;if(!1===t._started)return!1;if(!0===F(e)&&V(e)>0)return!0;if(ct(t)>0)return!0;return!1}(t)&&(!0!==t._pulling?(y(!1===t._pullAgain),t._pulling=!0,c(t._underlyingSource,"pull",[t]).then(function(){if(t._pulling=!1,!0===t._pullAgain)return t._pullAgain=!1,ot(t)},function(e){ht(t,e)}).catch(b)):t._pullAgain=!0)}function st(t){var e=t._controlledReadableStream;y(!1===t._closeRequested),y("readable"===e._state),t._closeRequested=!0,0===t._queue.length&&U(e)}function at(t,e){var i=t._controlledReadableStream;if(y(!1===t._closeRequested),y("readable"===i._state),!0===F(i)&&V(i)>0)W(i,e,!1);else{var n=1;if(void 0!==t._strategySize){var r=t._strategySize;try{n=r(e)}catch(e){throw ht(t,e),e}}try{x(t,e,n)}catch(e){throw ht(t,e),e}}ot(t)}function lt(t,e){var i=t._controlledReadableStream;y("readable"===i._state),T(t),q(i,e)}function ht(t,e){"readable"===t._controlledReadableStream._state&&lt(t,e)}function ct(t){var e=t._controlledReadableStream._state;return"errored"===e?null:"closed"===e?0:t._strategyHWM-t._queueTotalSize}var ut=function(){function t(e,i){r(this,t),this._associatedReadableByteStreamController=e,this._view=i}return n(t,[{key:"respond",value:function(t){if(!1===ft(this))throw Dt("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");!function(t,e){if(e=Number(e),!1===l(e))throw new RangeError("bytesWritten must be a finite");y(t._pendingPullIntos.length>0),Et(t,e)}(this._associatedReadableByteStreamController,t)}},{key:"respondWithNewView",value:function(t){if(!1===ft(this))throw Dt("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");!function(t,e){y(t._pendingPullIntos.length>0);var i=t._pendingPullIntos[0];if(i.byteOffset+i.bytesFilled!==e.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.byteLength!==e.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");i.buffer=e.buffer,Et(t,e.byteLength)}(this._associatedReadableByteStreamController,t)}},{key:"view",get:function(){return this._view}}]),t}(),dt=function(){function t(e,i,n){if(r(this,t),!1===z(e))throw new TypeError("ReadableByteStreamController can only be constructed with a ReadableStream instance given a byte source");if(void 0!==e._readableStreamController)throw new TypeError("ReadableByteStreamController instances can only be created by the ReadableStream constructor given a byte source");this._controlledReadableStream=e,this._underlyingByteSource=i,this._pullAgain=!1,this._pulling=!1,gt(this),this._queue=this._queueTotalSize=void 0,T(this),this._closeRequested=!1,this._started=!1,this._strategyHWM=p(n);var o=i.autoAllocateChunkSize;if(void 0!==o&&(!1===Number.isInteger(o)||o<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");this._autoAllocateChunkSize=o,this._pendingPullIntos=[];var s=this,a=h(i,"start",[this]);Promise.resolve(a).then(function(){s._started=!0,y(!1===s._pulling),y(!1===s._pullAgain),mt(s)},function(t){"readable"===e._state&&Ct(s,t)}).catch(b)}return n(t,[{key:"close",value:function(){if(!1===pt(this))throw zt("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be closed");!function(t){var e=t._controlledReadableStream;if(y(!1===t._closeRequested),y("readable"===e._state),t._queueTotalSize>0)return void(t._closeRequested=!0);if(t._pendingPullIntos.length>0){var i=t._pendingPullIntos[0];if(i.bytesFilled>0){var n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Ct(t,n),n}}U(e)}(this)}},{key:"enqueue",value:function(t){if(!1===pt(this))throw zt("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(t))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");!function(t,e){var i=t._controlledReadableStream;y(!1===t._closeRequested),y("readable"===i._state);var n=e.buffer,r=e.byteOffset,o=e.byteLength,s=u(n);if(!0===X(i))if(0===V(i))yt(t,s,r,o);else{y(0===t._queue.length);var a=new Uint8Array(s,r,o);W(i,a,!1)}else!0===Z(i)?(yt(t,s,r,o),Tt(t)):(y(!1===F(i),"stream must not be locked"),yt(t,s,r,o))}(this,t)}},{key:"error",value:function(t){if(!1===pt(this))throw zt("error");var e=this._controlledReadableStream;if("readable"!==e._state)throw new TypeError("The stream is "+e._state+" and so cannot be errored");Ct(this,t)}},{key:"__cancelSteps",value:function(t){this._pendingPullIntos.length>0&&(this._pendingPullIntos[0].bytesFilled=0);return T(this),c(this._underlyingByteSource,"cancel",[t])}},{key:"__pullSteps",value:function(){var t=this._controlledReadableStream;if(y(!0===X(t)),this._queueTotalSize>0){y(0===V(t));var e=this._queue.shift();this._queueTotalSize-=e.byteLength,St(this);var i=void 0;try{i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}catch(t){return Promise.reject(t)}return Promise.resolve(a(i,!1))}var n=this._autoAllocateChunkSize;if(void 0!==n){var r=void 0;try{r=new ArrayBuffer(n)}catch(t){return Promise.reject(t)}var o={buffer:r,byteOffset:0,byteLength:n,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}var s=j(t);return mt(this),s}},{key:"byobRequest",get:function(){if(!1===pt(this))throw zt("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){var t=this._pendingPullIntos[0],e=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled);this._byobRequest=new ut(this,e)}return this._byobRequest}},{key:"desiredSize",get:function(){if(!1===pt(this))throw zt("desiredSize");return Lt(this)}}]),t}();function pt(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_underlyingByteSource")}function ft(t){return!!v(t)&&!!Object.prototype.hasOwnProperty.call(t,"_associatedReadableByteStreamController")}function mt(t){!1!==function(t){var e=t._controlledReadableStream;if("readable"!==e._state)return!1;if(!0===t._closeRequested)return!1;if(!1===t._started)return!1;if(!0===X(e)&&V(e)>0)return!0;if(!0===Z(e)&&G(e)>0)return!0;if(Lt(t)>0)return!0;return!1}(t)&&(!0!==t._pulling?(y(!1===t._pullAgain),t._pulling=!0,c(t._underlyingByteSource,"pull",[t]).then(function(){t._pulling=!1,!0===t._pullAgain&&(t._pullAgain=!1,mt(t))},function(e){"readable"===t._controlledReadableStream._state&&Ct(t,e)}).catch(b)):t._pullAgain=!0)}function gt(t){xt(t),t._pendingPullIntos=[]}function vt(t,e){y("errored"!==t._state,"state must not be errored");var i=!1;"closed"===t._state&&(y(0===e.bytesFilled),i=!0);var n=_t(e);"default"===e.readerType?W(t,n,i):(y("byob"===e.readerType),function(t,e,i){var n=t._reader;y(n._readIntoRequests.length>0),n._readIntoRequests.shift()._resolve(a(e,i))}(t,n,i))}function _t(t){var e=t.bytesFilled,i=t.elementSize;return y(e<=t.byteLength),y(e%i==0),new t.ctor(t.buffer,t.byteOffset,e/i)}function yt(t,e,i,n){t._queue.push({buffer:e,byteOffset:i,byteLength:n}),t._queueTotalSize+=n}function bt(t,e){var i=e.elementSize,n=e.bytesFilled-e.bytesFilled%i,r=Math.min(t._queueTotalSize,e.byteLength-e.bytesFilled),o=e.bytesFilled+r,a=o-o%i,l=r,h=!1;a>n&&(l=a-e.bytesFilled,h=!0);for(var c=t._queue;l>0;){var u=c[0],d=Math.min(l,u.byteLength),p=e.byteOffset+e.bytesFilled;s(e.buffer,p,u.buffer,u.byteOffset,d),u.byteLength===d?c.shift():(u.byteOffset+=d,u.byteLength-=d),t._queueTotalSize-=d,wt(t,d,e),l-=d}return!1===h&&(y(0===t._queueTotalSize,"queue must be empty"),y(e.bytesFilled>0),y(e.bytesFilled<e.elementSize)),h}function wt(t,e,i){y(0===t._pendingPullIntos.length||t._pendingPullIntos[0]===i),xt(t),i.bytesFilled+=e}function St(t){y("readable"===t._controlledReadableStream._state),0===t._queueTotalSize&&!0===t._closeRequested?U(t._controlledReadableStream):mt(t)}function xt(t){void 0!==t._byobRequest&&(t._byobRequest._associatedReadableByteStreamController=void 0,t._byobRequest._view=void 0,t._byobRequest=void 0)}function Tt(t){for(y(!1===t._closeRequested);t._pendingPullIntos.length>0;){if(0===t._queueTotalSize)return;var e=t._pendingPullIntos[0];!0===bt(t,e)&&(Pt(t),vt(t._controlledReadableStream,e))}}function Et(t,e){var i=t._pendingPullIntos[0],n=t._controlledReadableStream;if("closed"===n._state){if(0!==e)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(t,e){e.buffer=u(e.buffer),y(0===e.bytesFilled,"bytesFilled must be 0");var i=t._controlledReadableStream;if(!0===Z(i))for(;G(i)>0;)vt(i,Pt(t))}(t,i)}else y("readable"===n._state),function(t,e,i){if(i.bytesFilled+e>i.byteLength)throw new RangeError("bytesWritten out of range");if(wt(t,e,i),!(i.bytesFilled<i.elementSize)){Pt(t);var n=i.bytesFilled%i.elementSize;if(n>0){var r=i.byteOffset+i.bytesFilled,o=i.buffer.slice(r-n,r);yt(t,o,0,o.byteLength)}i.buffer=u(i.buffer),i.bytesFilled-=n,vt(t._controlledReadableStream,i),Tt(t)}}(t,e,i)}function Pt(t){var e=t._pendingPullIntos.shift();return xt(t),e}function Ct(t,e){var i=t._controlledReadableStream;y("readable"===i._state),gt(t),T(t),q(i,e)}function Lt(t){var e=t._controlledReadableStream._state;return"errored"===e?null:"closed"===e?0:t._strategyHWM-t._queueTotalSize}function kt(t){return new TypeError("ReadableStream.prototype."+t+" can only be used on a ReadableStream")}function At(t){return new TypeError("Cannot "+t+" a stream using a released reader")}function Rt(t){return new TypeError("ReadableStreamDefaultReader.prototype."+t+" can only be used on a ReadableStreamDefaultReader")}function It(t,e){y(void 0!==t._closedPromise_resolve),y(void 0!==t._closedPromise_reject),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0}function Ot(t){return new TypeError("ReadableStreamBYOBReader.prototype."+t+" can only be used on a ReadableStreamBYOBReader")}function Mt(t){return new TypeError("ReadableStreamDefaultController.prototype."+t+" can only be used on a ReadableStreamDefaultController")}function Dt(t){return new TypeError("ReadableStreamBYOBRequest.prototype."+t+" can only be used on a ReadableStreamBYOBRequest")}function zt(t){return new TypeError("ReadableByteStreamController.prototype."+t+" can only be used on a ReadableByteStreamController")}},function(t,e,i){var n=i(6),r=i(4),o=i(2);e.TransformStream=n.TransformStream,e.ReadableStream=r.ReadableStream,e.IsReadableStreamDisturbed=r.IsReadableStreamDisturbed,e.ReadableStreamDefaultControllerClose=r.ReadableStreamDefaultControllerClose,e.ReadableStreamDefaultControllerEnqueue=r.ReadableStreamDefaultControllerEnqueue,e.ReadableStreamDefaultControllerError=r.ReadableStreamDefaultControllerError,e.ReadableStreamDefaultControllerGetDesiredSize=r.ReadableStreamDefaultControllerGetDesiredSize,e.AcquireWritableStreamDefaultWriter=o.AcquireWritableStreamDefaultWriter,e.IsWritableStream=o.IsWritableStream,e.IsWritableStreamLocked=o.IsWritableStreamLocked,e.WritableStream=o.WritableStream,e.WritableStreamAbort=o.WritableStreamAbort,e.WritableStreamDefaultControllerError=o.WritableStreamDefaultControllerError,e.WritableStreamDefaultWriterCloseWithErrorPropagation=o.WritableStreamDefaultWriterCloseWithErrorPropagation,e.WritableStreamDefaultWriterRelease=o.WritableStreamDefaultWriterRelease,e.WritableStreamDefaultWriterWrite=o.WritableStreamDefaultWriterWrite},function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=i(1).assert,s=i(0),a=s.InvokeOrNoop,l=s.PromiseInvokeOrPerformFallback,h=s.PromiseInvokeOrNoop,c=s.typeIsObject,u=i(4),d=u.ReadableStream,p=u.ReadableStreamDefaultControllerClose,f=u.ReadableStreamDefaultControllerEnqueue,m=u.ReadableStreamDefaultControllerError,g=u.ReadableStreamDefaultControllerGetDesiredSize,v=i(2),_=v.WritableStream,y=v.WritableStreamDefaultControllerError;function b(t,e){if(!0===t._errored)throw new TypeError("TransformStream is already errored");if(!0===t._readableClosed)throw new TypeError("Readable side is already closed");var i=t._readableController;try{f(i,e)}catch(e){throw t._readableClosed=!0,S(t,e),t._storedError}!0===g(i)<=0&&!1===t._backpressure&&E(t,!0)}function w(t){o(!1===t._errored),o(!1===t._readableClosed);try{p(t._readableController)}catch(t){o(!1)}t._readableClosed=!0}function S(t,e){!1===t._errored&&x(t,e)}function x(t,e){o(!1===t._errored),t._errored=!0,t._storedError=e,!1===t._writableDone&&y(t._writableController,e),!1===t._readableClosed&&m(t._readableController,e)}function T(t){return o(void 0!==t._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!1===t._backpressure?Promise.resolve():(o(!0===t._backpressure,"_backpressure should have been initialized"),t._backpressureChangePromise)}function E(t,e){o(t._backpressure!==e,"TransformStreamSetBackpressure() should be called only when backpressure is changed"),void 0!==t._backpressureChangePromise&&t._backpressureChangePromise_resolve(e),t._backpressureChangePromise=new Promise(function(e){t._backpressureChangePromise_resolve=e}),t._backpressureChangePromise.then(function(t){o(t!==e,"_backpressureChangePromise should be fulfilled only when backpressure is changed")}),t._backpressure=e}function P(t,e){return b(e._controlledTransformStream,t),Promise.resolve()}function C(t){return!!c(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledTransformStream")}function L(t){return!!c(t)&&!!Object.prototype.hasOwnProperty.call(t,"_transformStreamController")}var k=function(){function t(e,i){r(this,t),this._transformStream=e,this._startPromise=i}return n(t,[{key:"start",value:function(t){var e=this._transformStream;return e._writableController=t,this._startPromise.then(function(){return T(e)})}},{key:"write",value:function(t){return function(t,e){o(!1===t._errored),o(!1===t._transforming),o(!1===t._backpressure),t._transforming=!0;var i=t._transformer,n=t._transformStreamController;return l(i,"transform",[e,n],P,[e,n]).then(function(){return t._transforming=!1,T(t)},function(e){return S(t,e),Promise.reject(e)})}(this._transformStream,t)}},{key:"abort",value:function(){var t=this._transformStream;t._writableDone=!0,x(t,new TypeError("Writable side aborted"))}},{key:"close",value:function(){var t=this._transformStream;return o(!1===t._transforming),t._writableDone=!0,h(t._transformer,"flush",[t._transformStreamController]).then(function(){return!0===t._errored?Promise.reject(t._storedError):(!1===t._readableClosed&&w(t),Promise.resolve())}).catch(function(e){return S(t,e),Promise.reject(t._storedError)})}}]),t}(),A=function(){function t(e,i){r(this,t),this._transformStream=e,this._startPromise=i}return n(t,[{key:"start",value:function(t){var e=this._transformStream;return e._readableController=t,this._startPromise.then(function(){return o(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!0===e._backpressure?Promise.resolve():(o(!1===e._backpressure,"_backpressure should have been initialized"),e._backpressureChangePromise)})}},{key:"pull",value:function(){var t=this._transformStream;return o(!0===t._backpressure,"pull() should be never called while _backpressure is false"),o(void 0!==t._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),E(t,!1),t._backpressureChangePromise}},{key:"cancel",value:function(){var t=this._transformStream;t._readableClosed=!0,x(t,new TypeError("Readable side canceled"))}}]),t}(),R=function(){function t(e){if(r(this,t),!1===L(e))throw new TypeError("TransformStreamDefaultController can only be constructed with a TransformStream instance");if(void 0!==e._transformStreamController)throw new TypeError("TransformStreamDefaultController instances can only be created by the TransformStream constructor");this._controlledTransformStream=e}return n(t,[{key:"enqueue",value:function(t){if(!1===C(this))throw O("enqueue");b(this._controlledTransformStream,t)}},{key:"close",value:function(){if(!1===C(this))throw O("close");!function(t){if(!0===t._errored)throw new TypeError("TransformStream is already errored");if(!0===t._readableClosed)throw new TypeError("Readable side is already closed");w(t)}(this._controlledTransformStream)}},{key:"error",value:function(t){if(!1===C(this))throw O("error");!function(t,e){if(!0===t._errored)throw new TypeError("TransformStream is already errored");x(t,e)}(this._controlledTransformStream,t)}},{key:"desiredSize",get:function(){if(!1===C(this))throw O("desiredSize");var t=this._controlledTransformStream._readableController;return g(t)}}]),t}(),I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this._transformer=e;var i=e.readableStrategy,n=e.writableStrategy;this._transforming=!1,this._errored=!1,this._storedError=void 0,this._writableController=void 0,this._readableController=void 0,this._transformStreamController=void 0,this._writableDone=!1,this._readableClosed=!1,this._backpressure=void 0,this._backpressureChangePromise=void 0,this._backpressureChangePromise_resolve=void 0,this._transformStreamController=new R(this);var s=void 0,l=new Promise(function(t){s=t}),h=new A(this,l);this._readable=new d(h,i);var c=new k(this,l);this._writable=new _(c,n),o(void 0!==this._writableController),o(void 0!==this._readableController),E(this,g(this._readableController)<=0);var u=this,p=a(e,"start",[u._transformStreamController]);s(p),l.catch(function(t){!1===u._errored&&(u._errored=!0,u._storedError=t)})}return n(t,[{key:"readable",get:function(){if(!1===L(this))throw M("readable");return this._readable}},{key:"writable",get:function(){if(!1===L(this))throw M("writable");return this._writable}}]),t}();function O(t){return new TypeError("TransformStreamDefaultController.prototype."+t+" can only be used on a TransformStreamDefaultController")}function M(t){return new TypeError("TransformStream.prototype."+t+" can only be used on a TransformStream")}t.exports={TransformStream:I}},function(t,e,i){t.exports=i(5)}]))},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=!1;try{if("function"==typeof URL&&"object"===n(URL.prototype)&&"origin"in URL.prototype){var o=new URL("b","http://a");o.pathname="c%20d",r="http://a/c%20d"===o.href}}catch(t){}if(r)e.URL=URL;else{var s=i(128).URL,a=i(3).URL;a&&(s.createObjectURL=function(t){return a.createObjectURL.apply(a,arguments)},s.revokeObjectURL=function(t){a.revokeObjectURL(t)}),e.URL=s}},function(t,e,i){"use strict";!function(){var t=Object.create(null);t.ftp=21,t.file=0,t.gopher=70,t.http=80,t.https=443,t.ws=80,t.wss=443;var i=Object.create(null);function n(e){return void 0!==t[e]}function r(){d.call(this),this._isInvalid=!0}function o(t){return""===t&&r.call(this),t.toLowerCase()}function s(t){var e=t.charCodeAt(0);return e>32&&e<127&&-1===[34,35,60,62,63,96].indexOf(e)?t:encodeURIComponent(t)}function a(t){var e=t.charCodeAt(0);return e>32&&e<127&&-1===[34,35,60,62,96].indexOf(e)?t:encodeURIComponent(t)}i["%2e"]=".",i[".%2e"]="..",i["%2e."]="..",i["%2e%2e"]="..";var l,h=/[a-zA-Z]/,c=/[a-zA-Z0-9\+\-\.]/;function u(e,u,d){function p(t){y.push(t)}var f=u||"scheme start",m=0,g="",v=!1,_=!1,y=[];t:for(;(e[m-1]!==l||0===m)&&!this._isInvalid;){var b=e[m];switch(f){case"scheme start":if(!b||!h.test(b)){if(u){p("Invalid scheme.");break t}g="",f="no scheme";continue}g+=b.toLowerCase(),f="scheme";break;case"scheme":if(b&&c.test(b))g+=b.toLowerCase();else{if(":"!==b){if(u){if(b===l)break t;p("Code point not allowed in scheme: "+b);break t}g="",m=0,f="no scheme";continue}if(this._scheme=g,g="",u)break t;n(this._scheme)&&(this._isRelative=!0),f="file"===this._scheme?"relative":this._isRelative&&d&&d._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"===b?(this._query="?",f="query"):"#"===b?(this._fragment="#",f="fragment"):b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._schemeData+=s(b));break;case"no scheme":if(d&&n(d._scheme)){f="relative";continue}p("Missing scheme."),r.call(this);break;case"relative or authority":if("/"!==b||"/"!==e[m+1]){p("Expected /, got: "+b),f="relative";continue}f="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!==this._scheme&&(this._scheme=d._scheme),b===l){this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._username=d._username,this._password=d._password;break t}if("/"===b||"\\"===b)"\\"===b&&p("\\ is an invalid code point."),f="relative slash";else if("?"===b)this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query="?",this._username=d._username,this._password=d._password,f="query";else{if("#"!==b){var w=e[m+1],S=e[m+2];("file"!==this._scheme||!h.test(b)||":"!==w&&"|"!==w||S!==l&&"/"!==S&&"\\"!==S&&"?"!==S&&"#"!==S)&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password,this._path=d._path.slice(),this._path.pop()),f="relative path";continue}this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._fragment="#",this._username=d._username,this._password=d._password,f="fragment"}break;case"relative slash":if("/"!==b&&"\\"!==b){"file"!==this._scheme&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password),f="relative path";continue}"\\"===b&&p("\\ is an invalid code point."),f="file"===this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!==b){p("Expected '/', got: "+b),f="authority ignore slashes";continue}f="authority second slash";break;case"authority second slash":if(f="authority ignore slashes","/"!==b){p("Expected '/', got: "+b);continue}break;case"authority ignore slashes":if("/"!==b&&"\\"!==b){f="authority";continue}p("Expected authority, got: "+b);break;case"authority":if("@"===b){v&&(p("@ already seen."),g+="%40"),v=!0;for(var x=0;x<g.length;x++){var T=g[x];if("\t"!==T&&"\n"!==T&&"\r"!==T)if(":"!==T||null!==this._password){var E=s(T);null!==this._password?this._password+=E:this._username+=E}else this._password="";else p("Invalid whitespace in authority.")}g=""}else{if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){m-=g.length,g="",f="host";continue}g+=b}break;case"file host":if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){2!==g.length||!h.test(g[0])||":"!==g[1]&&"|"!==g[1]?0===g.length?f="relative path start":(this._host=o.call(this,g),g="",f="relative path start"):f="relative path";continue}"\t"===b||"\n"===b||"\r"===b?p("Invalid whitespace in file host."):g+=b;break;case"host":case"hostname":if(":"!==b||_){if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){if(this._host=o.call(this,g),g="",f="relative path start",u)break t;continue}"\t"!==b&&"\n"!==b&&"\r"!==b?("["===b?_=!0:"]"===b&&(_=!1),g+=b):p("Invalid code point in host/hostname: "+b)}else if(this._host=o.call(this,g),g="",f="port","hostname"===u)break t;break;case"port":if(/[0-9]/.test(b))g+=b;else{if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b||u){if(""!==g){var P=parseInt(g,10);P!==t[this._scheme]&&(this._port=P+""),g=""}if(u)break t;f="relative path start";continue}"\t"===b||"\n"===b||"\r"===b?p("Invalid code point in port: "+b):r.call(this)}break;case"relative path start":if("\\"===b&&p("'\\' not allowed in path."),f="relative path","/"!==b&&"\\"!==b)continue;break;case"relative path":var C;if(b!==l&&"/"!==b&&"\\"!==b&&(u||"?"!==b&&"#"!==b))"\t"!==b&&"\n"!==b&&"\r"!==b&&(g+=s(b));else"\\"===b&&p("\\ not allowed in relative path."),(C=i[g.toLowerCase()])&&(g=C),".."===g?(this._path.pop(),"/"!==b&&"\\"!==b&&this._path.push("")):"."===g&&"/"!==b&&"\\"!==b?this._path.push(""):"."!==g&&("file"===this._scheme&&0===this._path.length&&2===g.length&&h.test(g[0])&&"|"===g[1]&&(g=g[0]+":"),this._path.push(g)),g="","?"===b?(this._query="?",f="query"):"#"===b&&(this._fragment="#",f="fragment");break;case"query":u||"#"!==b?b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._query+=a(b)):(this._fragment="#",f="fragment");break;case"fragment":b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._fragment+=b)}m++}}function d(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function p(t,e){void 0===e||e instanceof p||(e=new p(String(e))),this._url=t,d.call(this);var i=t.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");u.call(this,i,null,e)}p.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var t="";return""===this._username&&null===this._password||(t=this._username+(null!==this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+t+this.host:"")+this.pathname+this._query+this._fragment},set href(t){d.call(this),u.call(this,t)},get protocol(){return this._scheme+":"},set protocol(t){this._isInvalid||u.call(this,t+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(t){!this._isInvalid&&this._isRelative&&u.call(this,t,"host")},get hostname(){return this._host},set hostname(t){!this._isInvalid&&this._isRelative&&u.call(this,t,"hostname")},get port(){return this._port},set port(t){!this._isInvalid&&this._isRelative&&u.call(this,t,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(t){!this._isInvalid&&this._isRelative&&(this._path=[],u.call(this,t,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"===this._query?"":this._query},set search(t){!this._isInvalid&&this._isRelative&&(this._query="?","?"===t[0]&&(t=t.slice(1)),u.call(this,t,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"===this._fragment?"":this._fragment},set hash(t){this._isInvalid||(this._fragment="#","#"===t[0]&&(t=t.slice(1)),u.call(this,t,"fragment"))},get origin(){var t;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null";case"blob":try{return new p(this._schemeData).origin||"null"}catch(t){}return"null"}return(t=this.host)?this._scheme+"://"+t:""}},e.URL=p}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.build=e.version=e.setPDFNetworkStreamFactory=e.PDFPageProxy=e.PDFDocumentProxy=e.PDFWorker=e.PDFDataRangeTransport=e.LoopbackPort=e.getDocument=void 0;var n,r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(1),l=i(130),h=i(131),c=i(132),u=i(133),d=i(3),p=(n=d)&&n.__esModule?n:{default:n},f=i(135),m=i(136),g=i(141),v=i(143),_=i(144);function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var b=65536,w=!1,S=void 0,x=null,T=!1;"undefined"==typeof window?(w=!0,void 0===require.ensure&&(require.ensure=require("node-ensure")),T=!0):"undefined"!=typeof require&&"function"==typeof require.ensure&&(T=!0),"undefined"!=typeof requirejs&&requirejs.toUrl&&(S=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var E,P="undefined"!=typeof requirejs&&requirejs.load;if(x=T?function(){return new Promise(function(t,e){require.ensure([],function(){try{var i;i=require("./pdf.worker.js"),t(i.WorkerMessageHandler)}catch(t){e(t)}},e,"pdfjsWorker")})}:P?function(){return new Promise(function(t,e){requirejs(["pdfjs-dist/build/pdf.worker"],function(i){try{t(i.WorkerMessageHandler)}catch(t){e(t)}},e)})}:null,!S&&"undefined"!=typeof document){var C=document.currentScript&&document.currentScript.src;C&&(S=C.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}var L=function(){var t=0;function e(){this._capability=(0,a.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return e.prototype={get promise(){return this._capability.promise},destroy:function(){var t=this;return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(function(){t._transport=null,t._worker&&(t._worker.destroy(),t._worker=null)})},then:function(t,e){return this.promise.then.apply(this.promise,arguments)}},e}(),k=function(){function t(e,i){y(this,t),this.length=e,this.initialData=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=(0,a.createPromiseCapability)()}return o(t,[{key:"addRangeListener",value:function(t){this._rangeListeners.push(t)}},{key:"addProgressListener",value:function(t){this._progressListeners.push(t)}},{key:"addProgressiveReadListener",value:function(t){this._progressiveReadListeners.push(t)}},{key:"onDataRange",value:function(t,e){var i=!0,n=!1,r=void 0;try{for(var o,s=this._rangeListeners[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){(0,o.value)(t,e)}}catch(t){n=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}}},{key:"onDataProgress",value:function(t){var e=this;this._readyCapability.promise.then(function(){var i=!0,n=!1,r=void 0;try{for(var o,s=e._progressListeners[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){(0,o.value)(t)}}catch(t){n=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}})}},{key:"onDataProgressiveRead",value:function(t){var e=this;this._readyCapability.promise.then(function(){var i=!0,n=!1,r=void 0;try{for(var o,s=e._progressiveReadListeners[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){(0,o.value)(t)}}catch(t){n=!0,r=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}})}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(t,e){(0,a.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),t}(),A=function(){function t(e,i,n){y(this,t),this.loadingTask=n,this._pdfInfo=e,this._transport=i}return o(t,[{key:"getPage",value:function(t){return this._transport.getPage(t)}},{key:"getPageIndex",value:function(t){return this._transport.getPageIndex(t)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(t){return this._transport.getDestination(t)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"getStats",value:function(){return this._transport.getStats()}},{key:"cleanup",value:function(){this._transport.startCleanup()}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprint",get:function(){return this._pdfInfo.fingerprint}},{key:"loadingParams",get:function(){return this._transport.loadingParams}}]),t}(),R=function(){function t(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.pageIndex=t,this._pageInfo=e,this.transport=i,this._stats=n?new l.StatTimer:l.DummyStatTimer,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new D,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return t.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this._pageInfo.rotate},get ref(){return this._pageInfo.ref},get userUnit(){return this._pageInfo.userUnit},get view(){return this._pageInfo.view},getViewport:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new l.PageViewport({viewBox:this.view,scale:t,rotation:e,dontFlip:i})},getAnnotations:function(t){var e=t&&t.intent||null;return this.annotationsPromise&&this.annotationsIntent===e||(this.annotationsPromise=this.transport.getAnnotations(this.pageIndex,e),this.annotationsIntent=e),this.annotationsPromise},render:function(t){var e=this,i=this._stats;i.time("Overall"),this.pendingCleanup=!1;var n="print"===t.intent?"print":"display",r=t.canvasFactory||new l.DOMCanvasFactory,o=new _.WebGLContext({enable:t.enableWebGL});this.intentStates[n]||(this.intentStates[n]=Object.create(null));var s=this.intentStates[n];s.displayReadyCapability||(s.receivingOperatorList=!0,s.displayReadyCapability=(0,a.createPromiseCapability)(),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1},i.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:n,renderInteractiveForms:!0===t.renderInteractiveForms}));var h=function(t){var n=s.renderTasks.indexOf(c);n>=0&&s.renderTasks.splice(n,1),e.cleanupAfterRender&&(e.pendingCleanup=!0),e._tryCleanup(),t?c.capability.reject(t):c.capability.resolve(),i.timeEnd("Rendering"),i.timeEnd("Overall")},c=new F(h,t,this.objs,this.commonObjs,s.operatorList,this.pageNumber,r,o,this._pdfBug);c.useRequestAnimationFrame="print"!==n,s.renderTasks||(s.renderTasks=[]),s.renderTasks.push(c);var u=c.task;return s.displayReadyCapability.promise.then(function(t){e.pendingCleanup?h():(i.time("Rendering"),c.initializeGraphics(t),c.operatorListChanged())}).catch(h),u},getOperatorList:function(){this.intentStates.oplist||(this.intentStates.oplist=Object.create(null));var t,e=this.intentStates.oplist;return e.opListReadCapability||((t={}).operatorListChanged=function(){if(e.operatorList.lastChunk){e.opListReadCapability.resolve(e.operatorList);var i=e.renderTasks.indexOf(t);i>=0&&e.renderTasks.splice(i,1)}},e.receivingOperatorList=!0,e.opListReadCapability=(0,a.createPromiseCapability)(),e.renderTasks=[],e.renderTasks.push(t),e.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:"oplist"})),e.opListReadCapability.promise},streamTextContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:!0===t.normalizeWhitespace,combineTextItems:!0!==t.disableCombineTextItems},{highWaterMark:100,size:function(t){return t.items.length}})},getTextContent:function(t){t=t||{};var e=this.streamTextContent(t);return new Promise(function(t,i){var n=e.getReader(),r={items:[],styles:Object.create(null)};!function e(){n.read().then(function(i){var n,o=i.value;i.done?t(r):(Object.assign(r.styles,o.styles),(n=r.items).push.apply(n,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(o.items)),e())},i)}()})},_destroy:function(){this.destroyed=!0,this.transport.pageCache[this.pageIndex]=null;var t=[];return Object.keys(this.intentStates).forEach(function(e){"oplist"!==e&&this.intentStates[e].renderTasks.forEach(function(e){var i=e.capability.promise.catch(function(){});t.push(i),e.cancel()})},this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(t)},cleanup:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup=!0,this._tryCleanup(t)},_tryCleanup:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup&&!Object.keys(this.intentStates).some(function(t){var e=this.intentStates[t];return 0!==e.renderTasks.length||e.receivingOperatorList},this)&&(Object.keys(this.intentStates).forEach(function(t){delete this.intentStates[t]},this),this.objs.clear(),this.annotationsPromise=null,t&&this._stats instanceof l.StatTimer&&(this._stats=new l.StatTimer),this.pendingCleanup=!1)},_startRenderPage:function(t,e){var i=this.intentStates[e];i.displayReadyCapability&&i.displayReadyCapability.resolve(t)},_renderPageChunk:function(t,e){var i,n,r=this.intentStates[e];for(i=0,n=t.length;i<n;i++)r.operatorList.fnArray.push(t.fnArray[i]),r.operatorList.argsArray.push(t.argsArray[i]);for(r.operatorList.lastChunk=t.lastChunk,i=0;i<r.renderTasks.length;i++)r.renderTasks[i].operatorListChanged();t.lastChunk&&(r.receivingOperatorList=!1,this._tryCleanup())},get stats(){return this._stats instanceof l.StatTimer?this._stats:null}},t}(),I=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];y(this,t),this._listeners=[],this._defer=e,this._deferred=Promise.resolve(void 0)}return o(t,[{key:"postMessage",value:function(t,e){var i=this;if(this._defer){var n=new WeakMap,r={data:function t(i){if("object"!==(void 0===i?"undefined":s(i))||null===i)return i;if(n.has(i))return n.get(i);var r,o;if((o=i.buffer)&&(0,a.isArrayBuffer)(o)){var l=e&&e.includes(o);return r=i===o?i:l?new i.constructor(o,i.byteOffset,i.byteLength):new i.constructor(i),n.set(i,r),r}for(var h in r=Array.isArray(i)?[]:{},n.set(i,r),i){for(var c,u=i;!(c=Object.getOwnPropertyDescriptor(u,h));)u=Object.getPrototypeOf(u);void 0!==c.value&&"function"!=typeof c.value&&(r[h]=t(c.value))}return r}(t)};this._deferred.then(function(){i._listeners.forEach(function(t){t.call(this,r)},i)})}else this._listeners.forEach(function(e){e.call(this,{data:t})},this)}},{key:"addEventListener",value:function(t,e){this._listeners.push(e)}},{key:"removeEventListener",value:function(t,e){var i=this._listeners.indexOf(e);this._listeners.splice(i,1)}},{key:"terminate",value:function(){this._listeners=[]}}]),t}(),O=function(){var t=0;function e(){if(f.GlobalWorkerOptions.workerSrc)return f.GlobalWorkerOptions.workerSrc;if(void 0!==S)return S;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function i(){try{if("undefined"!=typeof window)return window.pdfjsWorker&&window.pdfjsWorker.WorkerMessageHandler}catch(t){}return null}var n=void 0;var r=new WeakMap;function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name,i=void 0===e?null:e,n=t.port,o=void 0===n?null:n,s=t.postMessageTransfers,l=void 0===s||s,h=t.verbosity,c=void 0===h?(0,a.getVerbosityLevel)():h;if(o&&r.has(o))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=i,this.destroyed=!1,this.postMessageTransfers=!1!==l,this.verbosity=c,this._readyCapability=(0,a.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,o)return r.set(o,this),void this._initializeFromPort(o);this._initialize()}return o.prototype={get promise(){return this._readyCapability.promise},get port(){return this._port},get messageHandler(){return this._messageHandler},_initializeFromPort:function(t){this._port=t,this._messageHandler=new m.MessageHandler("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()},_initialize:function(){var t,n,r=this;if("undefined"!=typeof Worker&&!w&&!i()){var o=e();try{(0,a.isSameOrigin)(window.location.href,o)||(t=new a.URL(o,window.location).href,n="importScripts('"+t+"');",o=a.URL.createObjectURL(new Blob([n])));var s=new Worker(o),l=new m.MessageHandler("main","worker",s),h=function(){s.removeEventListener("error",c),l.destroy(),s.terminate(),r.destroyed?r._readyCapability.reject(new Error("Worker was destroyed")):r._setupFakeWorker()},c=function(){r._webWorker||h()};s.addEventListener("error",c),l.on("test",function(t){s.removeEventListener("error",c),r.destroyed?h():t&&t.supportTypedArray?(r._messageHandler=l,r._port=s,r._webWorker=s,t.supportTransfers||(r.postMessageTransfers=!1),r._readyCapability.resolve(),l.send("configure",{verbosity:r.verbosity})):(r._setupFakeWorker(),l.destroy(),s.terminate())}),l.on("ready",function(t){if(s.removeEventListener("error",c),r.destroyed)h();else try{u()}catch(t){r._setupFakeWorker()}});var u=function(){var t=new Uint8Array([r.postMessageTransfers?255:0]);try{l.send("test",t,[t.buffer])}catch(e){(0,a.info)("Cannot use postMessage transfers"),t[0]=0,l.send("test",t)}};return void u()}catch(t){(0,a.info)("The worker has been disabled.")}}this._setupFakeWorker()},_setupFakeWorker:function(){var r=this;w||((0,a.warn)("Setting up fake worker."),w=!0),function(){if(n)return n.promise;n=(0,a.createPromiseCapability)();var t=i();return t?(n.resolve(t),n.promise):((x||function(){return(0,l.loadScript)(e()).then(function(){return window.pdfjsWorker.WorkerMessageHandler})})().then(n.resolve,n.reject),n.promise)}().then(function(e){if(r.destroyed)r._readyCapability.reject(new Error("Worker was destroyed"));else{var i=new I;r._port=i;var n="fake"+t++,o=new m.MessageHandler(n+"_worker",n,i);e.setup(o,i);var s=new m.MessageHandler(n,n+"_worker",i);r._messageHandler=s,r._readyCapability.resolve()}}).catch(function(t){r._readyCapability.reject(new Error('Setting up fake worker failed: "'+t.message+'".'))})},destroy:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),r.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},o.fromPort=function(t){if(!t||!t.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return r.has(t.port)?r.get(t.port):new o(t)},o.getWorkerSrc=function(){return e()},o}(),M=function(){function t(e,i,n,r){y(this,t),this.messageHandler=e,this.loadingTask=i,this.commonObjs=new D,this.fontLoader=new h.FontLoader(i.docId),this._params=r,this.CMapReaderFactory=new r.CMapReaderFactory({baseUrl:r.cMapUrl,isCompressed:r.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,a.createPromiseCapability)(),this.setupMessageHandler()}return o(t,[{key:"destroy",value:function(){var t=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,a.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var e=[];this.pageCache.forEach(function(t){t&&e.push(t._destroy())}),this.pageCache=[],this.pagePromises=[];var i=this.messageHandler.sendWithPromise("Terminate",null);return e.push(i),Promise.all(e).then(function(){t.fontLoader.clear(),t._networkStream&&t._networkStream.cancelAllRequests(),t.messageHandler&&(t.messageHandler.destroy(),t.messageHandler=null),t.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var t=this.messageHandler,e=this.loadingTask;t.on("GetReader",function(t,e){var i=this;(0,a.assert)(this._networkStream),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=function(t){i._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=function(){i._fullReader.read().then(function(t){var i=t.value;t.done?e.close():((0,a.assert)((0,a.isArrayBuffer)(i)),e.enqueue(new Uint8Array(i),1,[i]))}).catch(function(t){e.error(t)})},e.onCancel=function(t){i._fullReader.cancel(t)}},this),t.on("ReaderHeadersReady",function(t){var i=this,n=(0,a.createPromiseCapability)(),r=this._fullReader;return r.headersReady.then(function(){r.isStreamingSupported&&r.isRangeSupported||(i._lastProgress&&e.onProgress&&e.onProgress(i._lastProgress),r.onProgress=function(t){e.onProgress&&e.onProgress({loaded:t.loaded,total:t.total})}),n.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},n.reject),n.promise},this),t.on("GetRangeReader",function(t,e){(0,a.assert)(this._networkStream);var i=this._networkStream.getRangeReader(t.begin,t.end);e.onPull=function(){i.read().then(function(t){var i=t.value;t.done?e.close():((0,a.assert)((0,a.isArrayBuffer)(i)),e.enqueue(new Uint8Array(i),1,[i]))}).catch(function(t){e.error(t)})},e.onCancel=function(t){i.cancel(t)}},this),t.on("GetDoc",function(t){var i=t.pdfInfo;this.numPages=i.numPages,this.pdfDocument=new A(i,this,e),e._capability.resolve(this.pdfDocument)},this),t.on("PasswordRequest",function(t){var i=this;if(this._passwordCapability=(0,a.createPromiseCapability)(),e.onPassword){try{e.onPassword(function(t){i._passwordCapability.resolve({password:t})},t.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new a.PasswordException(t.message,t.code));return this._passwordCapability.promise},this),t.on("PasswordException",function(t){e._capability.reject(new a.PasswordException(t.message,t.code))},this),t.on("InvalidPDF",function(t){e._capability.reject(new a.InvalidPDFException(t.message))},this),t.on("MissingPDF",function(t){e._capability.reject(new a.MissingPDFException(t.message))},this),t.on("UnexpectedResponse",function(t){e._capability.reject(new a.UnexpectedResponseException(t.message,t.status))},this),t.on("UnknownError",function(t){e._capability.reject(new a.UnknownErrorException(t.message,t.details))},this),t.on("DataLoaded",function(t){e.onProgress&&e.onProgress({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)},this),t.on("StartRenderPage",function(t){if(!this.destroyed){var e=this.pageCache[t.pageIndex];e._stats.timeEnd("Page Request"),e._startRenderPage(t.transparency,t.intent)}},this),t.on("RenderPageChunk",function(t){this.destroyed||this.pageCache[t.pageIndex]._renderPageChunk(t.operatorList,t.intent)},this),t.on("commonobj",function(t){var e=this;if(!this.destroyed){var i=r(t,3),n=i[0],o=i[1],s=i[2];if(!this.commonObjs.hasData(n))switch(o){case"Font":var l=this._params;if("error"in s){var c=s.error;(0,a.warn)("Error during font loading: "+c),this.commonObjs.resolve(n,c);break}var u=null;l.pdfBug&&p.default.FontInspector&&p.default.FontInspector.enabled&&(u={registerFont:function(t,e){p.default.FontInspector.fontAdded(t,e)}});var d=new h.FontFaceObject(s,{isEvalSupported:l.isEvalSupported,disableFontFace:l.disableFontFace,ignoreErrors:l.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:u});this.fontLoader.bind([d],function(t){e.commonObjs.resolve(n,d)});break;case"FontPath":this.commonObjs.resolve(n,s);break;default:throw new Error("Got unknown common object type "+o)}}},this),t.on("obj",function(t){if(!this.destroyed){var e=r(t,4),i=e[0],n=e[1],o=e[2],s=e[3],a=this.pageCache[n];if(!a.objs.hasData(i))switch(o){case"JpegStream":return new Promise(function(t,e){var i=new Image;i.onload=function(){t(i)},i.onerror=function(){e(new Error("Error during JPEG image loading"))},i.src=s}).then(function(t){a.objs.resolve(i,t)});case"Image":a.objs.resolve(i,s);s&&"data"in s&&s.data.length>8e6&&(a.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type "+o)}}},this),t.on("DocProgress",function(t){this.destroyed||e.onProgress&&e.onProgress({loaded:t.loaded,total:t.total})},this),t.on("PageError",function(t){if(!this.destroyed){var e=this.pageCache[t.pageNum-1].intentStates[t.intent];if(!e.displayReadyCapability)throw new Error(t.error);if(e.displayReadyCapability.reject(t.error),e.operatorList){e.operatorList.lastChunk=!0;for(var i=0;i<e.renderTasks.length;i++)e.renderTasks[i].operatorListChanged()}}},this),t.on("UnsupportedFeature",this._onUnsupportedFeature,this),t.on("JpegDecode",function(t){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));if("undefined"==typeof document)return Promise.reject(new Error('"document" is not defined.'));var e=r(t,2),i=e[0],n=e[1];return 3!==n&&1!==n?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise(function(t,e){var r=new Image;r.onload=function(){var e=r.width,i=r.height,o=e*i,s=4*o,a=new Uint8ClampedArray(o*n),l=document.createElement("canvas");l.width=e,l.height=i;var h=l.getContext("2d");h.drawImage(r,0,0);var c=h.getImageData(0,0,e,i).data;if(3===n)for(var u=0,d=0;u<s;u+=4,d+=3)a[d]=c[u],a[d+1]=c[u+1],a[d+2]=c[u+2];else if(1===n)for(var p=0,f=0;p<s;p+=4,f++)a[f]=c[p];t({data:a,width:e,height:i})},r.onerror=function(){e(new Error("JpegDecode failed to load image"))},r.src=i})},this),t.on("FetchBuiltInCMap",function(t){return this.destroyed?Promise.reject(new Error("Worker was destroyed")):this.CMapReaderFactory.fetch({name:t.name})},this)}},{key:"_onUnsupportedFeature",value:function(t){var e=t.featureId;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(e)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(t){var e=this;if(!Number.isInteger(t)||t<=0||t>this.numPages)return Promise.reject(new Error("Invalid page request"));var i=t-1;if(i in this.pagePromises)return this.pagePromises[i];var n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(function(t){if(e.destroyed)throw new Error("Transport destroyed");var n=new R(i,t,e,e._params.pdfBug);return e.pageCache[i]=n,n});return this.pagePromises[i]=n,n}},{key:"getPageIndex",value:function(t){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:t}).catch(function(t){return Promise.reject(new Error(t))})}},{key:"getAnnotations",value:function(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var t=this;return this.messageHandler.sendWithPromise("GetMetadata",null).then(function(e){return{info:e[0],metadata:e[1]?new g.Metadata(e[1]):null,contentDispositionFilename:t._fullReader?t._fullReader.filename:null}})}},{key:"getStats",value:function(){return this.messageHandler.sendWithPromise("GetStats",null)}},{key:"startCleanup",value:function(){var t=this;this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var e=0,i=t.pageCache.length;e<i;e++){var n=t.pageCache[e];n&&n.cleanup()}t.commonObjs.clear(),t.fontLoader.clear()})}},{key:"loadingParams",get:function(){var t=this._params;return(0,a.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,disableCreateObjectURL:t.disableCreateObjectURL,disableFontFace:t.disableFontFace,nativeImageDecoderSupport:t.nativeImageDecoderSupport})}}]),t}(),D=function(){function t(){this.objs=Object.create(null)}return t.prototype={ensureObj:function(t){if(this.objs[t])return this.objs[t];var e={capability:(0,a.createPromiseCapability)(),data:null,resolved:!1};return this.objs[t]=e,e},get:function(t,e){if(e)return this.ensureObj(t).capability.promise.then(e),null;var i=this.objs[t];if(!i||!i.resolved)throw new Error("Requesting object that isn't resolved yet "+t);return i.data},resolve:function(t,e){var i=this.ensureObj(t);i.resolved=!0,i.data=e,i.capability.resolve(e)},isResolved:function(t){var e=this.objs;return!!e[t]&&e[t].resolved},hasData:function(t){return this.isResolved(t)},getData:function(t){var e=this.objs;return e[t]&&e[t].resolved?e[t].data:null},clear:function(){this.objs=Object.create(null)}},t}(),z=function(){function t(t){this._internalRenderTask=t,this.onContinue=null}return t.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(t,e){return this.promise.then.apply(this.promise,arguments)}},t}(),F=function(){var t=new WeakMap;function e(t,e,i,n,r,o,s,l){var h=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.operatorListIdx=null,this.operatorList=r,this.pageNumber=o,this.canvasFactory=s,this.webGLContext=l,this._pdfBug=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=(0,a.createPromiseCapability)(),this.task=new z(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}return e.prototype={initializeGraphics:function(e){if(!this.cancelled){if(this._canvas){if(t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t.set(this._canvas,this)}this._pdfBug&&p.default.StepperManager&&p.default.StepperManager.enabled&&(this.stepper=p.default.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var i=this.params;this.gfx=new u.CanvasGraphics(i.canvasContext,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,i.imageLayer),this.gfx.beginDrawing({transform:i.transform,viewport:i.viewport,transparency:e,background:i.background}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}},cancel:function(){this.running=!1,this.cancelled=!0,this._canvas&&t.delete(this._canvas),this.callback(new l.RenderingCancelledException("Rendering cancelled, page "+this.pageNumber,"canvas"))},operatorListChanged:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)},_continue:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())},_scheduleNext:function(){var t=this;this.useRequestAnimationFrame&&"undefined"!=typeof window?window.requestAnimationFrame(function(){t._nextBound().catch(t.callback)}):Promise.resolve().then(this._nextBound).catch(this.callback)},_next:function(){var e=this;return new Promise(function(){e.cancelled||(e.operatorListIdx=e.gfx.executeOperatorList(e.operatorList,e.operatorListIdx,e._continueBound,e.stepper),e.operatorListIdx===e.operatorList.argsArray.length&&(e.running=!1,e.operatorList.lastChunk&&(e.gfx.endDrawing(),e._canvas&&t.delete(e._canvas),e.callback())))})}},e}();e.version="2.0.943",e.build="dc98bf76",e.getDocument=function(t){var e,i=new L;if("string"==typeof t)e={url:t};else if((0,a.isArrayBuffer)(t))e={data:t};else if(t instanceof k)e={range:t};else{if("object"!==(void 0===t?"undefined":s(t)))throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");e=t}var n=Object.create(null),r=null,o=null;for(var h in e)if("url"!==h||"undefined"==typeof window)if("range"!==h)if("worker"!==h)if("data"!==h||e[h]instanceof Uint8Array)n[h]=e[h];else{var u=e[h];if("string"==typeof u)n[h]=(0,a.stringToBytes)(u);else if("object"!==(void 0===u?"undefined":s(u))||null===u||isNaN(u.length)){if(!(0,a.isArrayBuffer)(u))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");n[h]=new Uint8Array(u)}else n[h]=new Uint8Array(u)}else o=e[h];else r=e[h];else n[h]=new a.URL(e[h],window.location).href;n.rangeChunkSize=n.rangeChunkSize||b,n.CMapReaderFactory=n.CMapReaderFactory||l.DOMCMapReaderFactory,n.ignoreErrors=!0!==n.stopAtErrors,n.pdfBug=!0===n.pdfBug;var d=Object.values(a.NativeImageDecoding);if(void 0!==n.nativeImageDecoderSupport&&d.includes(n.nativeImageDecoderSupport)||(n.nativeImageDecoderSupport=c.apiCompatibilityParams.nativeImageDecoderSupport||a.NativeImageDecoding.DECODE),Number.isInteger(n.maxImageSize)||(n.maxImageSize=-1),"boolean"!=typeof n.isEvalSupported&&(n.isEvalSupported=!0),"boolean"!=typeof n.disableFontFace&&(n.disableFontFace=c.apiCompatibilityParams.disableFontFace||!1),"boolean"!=typeof n.disableRange&&(n.disableRange=!1),"boolean"!=typeof n.disableStream&&(n.disableStream=!1),"boolean"!=typeof n.disableAutoFetch&&(n.disableAutoFetch=!1),"boolean"!=typeof n.disableCreateObjectURL&&(n.disableCreateObjectURL=c.apiCompatibilityParams.disableCreateObjectURL||!1),(0,a.setVerbosityLevel)(n.verbosity),!o){var p={postMessageTransfers:n.postMessageTransfers,verbosity:n.verbosity},g=f.GlobalWorkerOptions.workerPort;g?(p.port=g,o=O.fromPort(p)):o=new O(p),i._worker=o}var _=i.docId;return o.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");return function(t,e,i,n){return t.destroyed?Promise.reject(new Error("Worker was destroyed")):(i&&(e.length=i.length,e.initialData=i.initialData),t.messageHandler.sendWithPromise("GetDocRequest",{docId:n,apiVersion:"2.0.943",source:{data:e.data,url:e.url,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length},maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,disableCreateObjectURL:e.disableCreateObjectURL,postMessageTransfers:t.postMessageTransfers,docBaseUrl:e.docBaseUrl,nativeImageDecoderSupport:e.nativeImageDecoderSupport,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported}).then(function(e){if(t.destroyed)throw new Error("Worker was destroyed");return e}))}(o,n,r,_).then(function(t){if(i.destroyed)throw new Error("Loading aborted");var e=void 0;r?e=new v.PDFDataTransportStream({length:n.length,initialData:n.initialData,disableRange:n.disableRange,disableStream:n.disableStream},r):n.data||(e=E({url:n.url,length:n.length,httpHeaders:n.httpHeaders,withCredentials:n.withCredentials,rangeChunkSize:n.rangeChunkSize,disableRange:n.disableRange,disableStream:n.disableStream}));var s=new m.MessageHandler(_,t,o.port);s.postMessageTransfers=o.postMessageTransfers;var a=new M(s,i,e,n);i._transport=a,s.send("Ready",null)})}).catch(i._capability.reject),i},e.LoopbackPort=I,e.PDFDataRangeTransport=k,e.PDFWorker=O,e.PDFDocumentProxy=A,e.PDFPageProxy=R,e.setPDFNetworkStreamFactory=function(t){E=t},e.version="2.0.943",e.build="dc98bf76"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.loadScript=e.DummyStatTimer=e.StatTimer=e.DOMSVGFactory=e.DOMCMapReaderFactory=e.DOMCanvasFactory=e.DEFAULT_LINK_REL=e.LinkTarget=e.getFilenameFromUrl=e.addLinkAttributes=e.RenderingCancelledException=e.PageViewport=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s="noopener noreferrer nofollow",a="http://www.w3.org/2000/svg",l=function(){function t(){o(this,t)}return n(t,[{key:"create",value:function(t,e){if(t<=0||e<=0)throw new Error("invalid canvas size");var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=t,i.height=e,{canvas:i,context:n}}},{key:"reset",value:function(t,e,i){if(!t.canvas)throw new Error("canvas is not specified");if(e<=0||i<=0)throw new Error("invalid canvas size");t.canvas.width=e,t.canvas.height=i}},{key:"destroy",value:function(t){if(!t.canvas)throw new Error("canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}}]),t}(),h=function(){function t(e){var i=e.baseUrl,n=void 0===i?null:i,r=e.isCompressed,s=void 0!==r&&r;o(this,t),this.baseUrl=n,this.isCompressed=s}return n(t,[{key:"fetch",value:function(t){var e=this,i=t.name;return this.baseUrl?i?new Promise(function(t,n){var o=e.baseUrl+i+(e.isCompressed?".bcmap":""),s=new XMLHttpRequest;s.open("GET",o,!0),e.isCompressed&&(s.responseType="arraybuffer"),s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE){if(200===s.status||0===s.status){var i=void 0;if(e.isCompressed&&s.response?i=new Uint8Array(s.response):!e.isCompressed&&s.responseText&&(i=(0,r.stringToBytes)(s.responseText)),i)return void t({cMapData:i,compressionType:e.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE})}n(new Error("Unable to load "+(e.isCompressed?"binary ":"")+"CMap at: "+o))}},s.send(null)}):Promise.reject(new Error("CMap name must be specified.")):Promise.reject(new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.'))}}]),t}(),c=function(){function t(){o(this,t)}return n(t,[{key:"create",value:function(t,e){(0,r.assert)(t>0&&e>0,"Invalid SVG dimensions");var i=document.createElementNS(a,"svg:svg");return i.setAttribute("version","1.1"),i.setAttribute("width",t+"px"),i.setAttribute("height",e+"px"),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox","0 0 "+t+" "+e),i}},{key:"createElement",value:function(t){return(0,r.assert)("string"==typeof t,"Invalid SVG element type"),document.createElementNS(a,t)}}]),t}(),u=function(){function t(e){var i=e.viewBox,n=e.scale,r=e.rotation,s=e.offsetX,a=void 0===s?0:s,l=e.offsetY,h=void 0===l?0:l,c=e.dontFlip,u=void 0!==c&&c;o(this,t),this.viewBox=i,this.scale=n,this.rotation=r,this.offsetX=a,this.offsetY=h;var d=(i[2]+i[0])/2,p=(i[3]+i[1])/2,f=void 0,m=void 0,g=void 0,v=void 0;switch(r=(r%=360)<0?r+360:r){case 180:f=-1,m=0,g=0,v=1;break;case 90:f=0,m=1,g=1,v=0;break;case 270:f=0,m=-1,g=-1,v=0;break;default:f=1,m=0,g=0,v=-1}u&&(g=-g,v=-v);var _=void 0,y=void 0,b=void 0,w=void 0;0===f?(_=Math.abs(p-i[1])*n+a,y=Math.abs(d-i[0])*n+h,b=Math.abs(i[3]-i[1])*n,w=Math.abs(i[2]-i[0])*n):(_=Math.abs(d-i[0])*n+a,y=Math.abs(p-i[1])*n+h,b=Math.abs(i[2]-i[0])*n,w=Math.abs(i[3]-i[1])*n),this.transform=[f*n,m*n,g*n,v*n,_-f*n*d-g*n*p,y-m*n*d-v*n*p],this.width=b,this.height=w}return n(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.scale,n=void 0===i?this.scale:i,r=e.rotation,o=void 0===r?this.rotation:r,s=e.dontFlip,a=void 0!==s&&s;return new t({viewBox:this.viewBox.slice(),scale:n,rotation:o,offsetX:this.offsetX,offsetY:this.offsetY,dontFlip:a})}},{key:"convertToViewportPoint",value:function(t,e){return r.Util.applyTransform([t,e],this.transform)}},{key:"convertToViewportRectangle",value:function(t){var e=r.Util.applyTransform([t[0],t[1]],this.transform),i=r.Util.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}},{key:"convertToPdfPoint",value:function(t,e){return r.Util.applyInverseTransform([t,e],this.transform)}}]),t}(),d=function(){function t(t,e){this.message=t,this.type=e}return t.prototype=new Error,t.prototype.name="RenderingCancelledException",t.constructor=t,t}(),p={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},f=["","_self","_blank","_parent","_top"];var m=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o(this,t),this.enabled=!!e,this.started=Object.create(null),this.times=[]}return n(t,[{key:"time",value:function(t){this.enabled&&(t in this.started&&(0,r.warn)("Timer is already running for "+t),this.started[t]=Date.now())}},{key:"timeEnd",value:function(t){this.enabled&&(t in this.started||(0,r.warn)("Timer has not been started for "+t),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t])}},{key:"toString",value:function(){for(var t=this.times,e="",i=0,n=0,r=t.length;n<r;++n){var o=t[n].name;o.length>i&&(i=o.length)}for(var s=0,a=t.length;s<a;++s){var l=t[s],h=l.end-l.start;e+=l.name.padEnd(i)+" "+h+"ms\n"}return e}}]),t}(),g=function(){function t(){o(this,t),(0,r.unreachable)("Cannot initialize DummyStatTimer.")}return n(t,null,[{key:"time",value:function(t){}},{key:"timeEnd",value:function(t){}},{key:"toString",value:function(){return""}}]),t}();e.PageViewport=u,e.RenderingCancelledException=d,e.addLinkAttributes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.url,n=e.target,o=e.rel;if(t.href=t.title=i?(0,r.removeNullCharacters)(i):"",i){var a=Object.values(p).includes(n)?n:p.NONE;t.target=f[a],t.rel="string"==typeof o?o:s}},e.getFilenameFromUrl=function(t){var e=t.indexOf("#"),i=t.indexOf("?"),n=Math.min(e>0?e:t.length,i>0?i:t.length);return t.substring(t.lastIndexOf("/",n)+1,n)},e.LinkTarget=p,e.DEFAULT_LINK_REL=s,e.DOMCanvasFactory=l,e.DOMCMapReaderFactory=h,e.DOMSVGFactory=c,e.StatTimer=m,e.DummyStatTimer=g,e.loadScript=function(t){return new Promise(function(e,i){var n=document.createElement("script");n.src=t,n.onload=e,n.onerror=function(){i(new Error("Cannot load script at: "+n.src))},(document.head||document.documentElement).appendChild(n)})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s,a=function(){function t(e){o(this,t),this.constructor===t&&(0,r.unreachable)("Cannot initialize BaseFontLoader."),this.docId=e,this.nativeFontFaces=[],this.styleElement=null,this.loadingContext={requests:[],nextRequestId:0}}return n(t,[{key:"addNativeFontFace",value:function(t){this.nativeFontFaces.push(t),document.fonts.add(t)}},{key:"insertRule",value:function(t){var e=this.styleElement;e||((e=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_"+this.docId,document.documentElement.getElementsByTagName("head")[0].appendChild(e));var i=e.sheet;i.insertRule(t,i.cssRules.length)}},{key:"clear",value:function(){this.nativeFontFaces.forEach(function(t){document.fonts.delete(t)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:function(t,e){var i=[],n=[],o=[],s=function(t){return t.loaded.catch(function(e){(0,r.warn)('Failed to load font "'+t.family+'": '+e)})},a=!0,l=!1,h=void 0;try{for(var c,u=t[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;if(!d.attached&&!d.missingFile)if(d.attached=!0,this.isFontLoadingAPISupported){var p=d.createNativeFontFace();p&&(this.addNativeFontFace(p),o.push(s(p)))}else{var f=d.createFontFaceRule();f&&(this.insertRule(f),i.push(f),n.push(d))}}}catch(t){l=!0,h=t}finally{try{!a&&u.return&&u.return()}finally{if(l)throw h}}var m=this._queueLoadingCallback(e);this.isFontLoadingAPISupported?Promise.all(o).then(m.complete):i.length>0&&!this.isSyncFontLoadingSupported?this._prepareFontLoadEvent(i,n,m):m.complete()}},{key:"_queueLoadingCallback",value:function(t){var e=this.loadingContext,i={id:"pdfjs-font-loading-"+e.nextRequestId++,done:!1,complete:function(){for((0,r.assert)(!i.done,"completeRequest() cannot be called twice."),i.done=!0;e.requests.length>0&&e.requests[0].done;){var t=e.requests.shift();setTimeout(t.callback,0)}},callback:t};return e.requests.push(i),i}},{key:"_prepareFontLoadEvent",value:function(t,e,i){(0,r.unreachable)("Abstract method `_prepareFontLoadEvent`.")}},{key:"isFontLoadingAPISupported",get:function(){(0,r.unreachable)("Abstract method `isFontLoadingAPISupported`.")}},{key:"isSyncFontLoadingSupported",get:function(){(0,r.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,r.unreachable)("Abstract method `_loadTestFont`.")}}]),t}();e.FontLoader=s=function(t){function e(t){o(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.loadTestFontId=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),n(e,[{key:"_prepareFontLoadEvent",value:function(t,e,i){function n(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function o(t,e,i,n){return t.substring(0,e)+n+t.substring(e+i)}var s=void 0,a=void 0,l=document.createElement("canvas");l.width=1,l.height=1;var h=l.getContext("2d"),c=0;var u="lt"+Date.now()+this.loadTestFontId++,d=this._loadTestFont,p=n(d=o(d,976,u.length,u),16);for(s=0,a=u.length-3;s<a;s+=4)p=p-1482184792+n(u,s)|0;s<u.length&&(p=p-1482184792+n(u+"XXX",s)|0),d=o(d,16,4,(0,r.string32)(p));var f='@font-face {font-family:"'+u+'";src:'+("url(data:font/opentype;base64,"+btoa(d)+");")+"}";this.insertRule(f);var m=[];for(s=0,a=e.length;s<a;s++)m.push(e[s].loadedName);m.push(u);var g=document.createElement("div");for(g.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),s=0,a=m.length;s<a;++s){var v=document.createElement("span");v.textContent="Hi",v.style.fontFamily=m[s],g.appendChild(v)}document.body.appendChild(g),function t(e,i){if(++c>30)return(0,r.warn)("Load test font never loaded."),void i();h.font="30px "+e,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0?i():setTimeout(t.bind(null,e,i))}(u,function(){document.body.removeChild(g),i.complete()})}},{key:"isFontLoadingAPISupported",get:function(){var t="undefined"!=typeof document&&!!document.fonts;if(t&&"undefined"!=typeof navigator){var e=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);e&&e[1]<63&&(t=!1)}return(0,r.shadow)(this,"isFontLoadingAPISupported",t)}},{key:"isSyncFontLoadingSupported",get:function(){var t=!1;if("undefined"==typeof navigator)t=!0;else{var e=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);e&&e[1]>=14&&(t=!0)}return(0,r.shadow)(this,"isSyncFontLoadingSupported",t)}},{key:"_loadTestFont",get:function(){return(0,r.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}}]),e}();var l={get value(){return(0,r.shadow)(this,"value",(0,r.isEvalSupported)())}},h=function(){function t(e,i){var n=i.isEvalSupported,r=void 0===n||n,s=i.disableFontFace,a=void 0!==s&&s,l=i.ignoreErrors,h=void 0!==l&&l,c=i.onUnsupportedFeature,u=void 0===c?null:c,d=i.fontRegistry,p=void 0===d?null:d;for(var f in o(this,t),this.compiledGlyphs=Object.create(null),e)this[f]=e[f];this.isEvalSupported=!1!==r,this.disableFontFace=!0===a,this.ignoreErrors=!0===h,this._onUnsupportedFeature=u,this.fontRegistry=p}return n(t,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var t=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),t}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var t=(0,r.bytesToString)(new Uint8Array(this.data)),e="url(data:"+this.mimetype+";base64,"+btoa(t)+");",i='@font-face {font-family:"'+this.loadedName+'";src:'+e+"}";return this.fontRegistry&&this.fontRegistry.registerFont(this,e),i}},{key:"getPathGenerator",value:function(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];var i=void 0,n=void 0;try{i=t.get(this.loadedName+"_path_"+e)}catch(t){if(!this.ignoreErrors)throw t;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:r.UNSUPPORTED_FEATURES.font}),(0,r.warn)('getPathGenerator - ignoring character: "'+t+'".'),this.compiledGlyphs[e]=function(t,e){}}if(this.isEvalSupported&&l.value){for(var o=void 0,s="",a=0,h=i.length;a<h;a++)o=void 0!==(n=i[a]).args?n.args.join(","):"",s+="c."+n.cmd+"("+o+");\n";return this.compiledGlyphs[e]=new Function("c","size",s)}return this.compiledGlyphs[e]=function(t,e){for(var r=0,o=i.length;r<o;r++)"scale"===(n=i[r]).cmd&&(n.args=[e,-e]),t[n.cmd].apply(t,n.args)}}}]),t}();e.FontFaceObject=h,e.FontLoader=s},function(t,e,i){"use strict";var n=Object.create(null),r=i(4),o="undefined"!=typeof navigator&&navigator.userAgent||"",s=/Trident/.test(o),a=/CriOS/.test(o);(s||a)&&(n.disableCreateObjectURL=!0),r()&&(n.disableFontFace=!0,n.nativeImageDecoderSupport="none"),e.apiCompatibilityParams=Object.freeze(n)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=i(1),r=i(134),o=16,s={get value(){return(0,n.shadow)(s,"value",(0,n.isLittleEndian)())}};function a(t){t.mozCurrentTransform||(t._originalSave=t.save,t._originalRestore=t.restore,t._originalRotate=t.rotate,t._originalScale=t.scale,t._originalTranslate=t.translate,t._originalTransform=t.transform,t._originalSetTransform=t.setTransform,t._transformMatrix=t._transformMatrix||[1,0,0,1,0,0],t._transformStack=[],Object.defineProperty(t,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(t,"mozCurrentTransformInverse",{get:function(){var t=this._transformMatrix,e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=e*r-i*n,l=i*n-e*r;return[r/a,i/l,n/l,e/a,(r*o-n*s)/l,(i*o-e*s)/a]}}),t.save=function(){var t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},t.restore=function(){var t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},t.translate=function(t,e){var i=this._transformMatrix;i[4]=i[0]*t+i[2]*e+i[4],i[5]=i[1]*t+i[3]*e+i[5],this._originalTranslate(t,e)},t.scale=function(t,e){var i=this._transformMatrix;i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*e,i[3]=i[3]*e,this._originalScale(t,e)},t.transform=function(e,i,n,r,o,s){var a=this._transformMatrix;this._transformMatrix=[a[0]*e+a[2]*i,a[1]*e+a[3]*i,a[0]*n+a[2]*r,a[1]*n+a[3]*r,a[0]*o+a[2]*s+a[4],a[1]*o+a[3]*s+a[5]],t._originalTransform(e,i,n,r,o,s)},t.setTransform=function(e,i,n,r,o,s){this._transformMatrix=[e,i,n,r,o,s],t._originalSetTransform(e,i,n,r,o,s)},t.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this._transformMatrix;this._transformMatrix=[n[0]*e+n[2]*i,n[1]*e+n[3]*i,n[0]*-i+n[2]*e,n[1]*-i+n[3]*e,n[4],n[5]],this._originalRotate(t)})}var l=function(){function t(t){this.canvasFactory=t,this.cache=Object.create(null)}return t.prototype={getCanvas:function(t,e,i,n){var r;return void 0!==this.cache[t]?(r=this.cache[t],this.canvasFactory.reset(r,e,i),r.context.setTransform(1,0,0,1,0,0)):(r=this.canvasFactory.create(e,i),this.cache[t]=r),n&&a(r.context),r},clear:function(){for(var t in this.cache){var e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}},t}();var h=function(){function t(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,e){this.x=t,this.y=e}},t}(),c=function(){function t(t,e,i,n,r,o){this.ctx=t,this.current=new h,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.webGLContext=r,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new l(this.canvasFactory),t&&a(t),this._cachedGetSinglePixelWidth=null}function e(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData)t.putImageData(e,0,0);else{var i,r,a,l,h,c=e.height,u=e.width,d=c%o,p=(c-d)/o,f=0===d?p:p+1,m=t.createImageData(u,o),g=0,v=e.data,_=m.data;if(e.kind===n.ImageKind.GRAYSCALE_1BPP){var y=v.byteLength,b=new Uint32Array(_.buffer,0,_.byteLength>>2),w=b.length,S=u+7>>3,x=4294967295,T=s.value?4278190080:255;for(r=0;r<f;r++){for(l=r<p?o:d,i=0,a=0;a<l;a++){for(var E=y-g,P=0,C=E>S?u:8*E-7,L=-8&C,k=0,A=0;P<L;P+=8)A=v[g++],b[i++]=128&A?x:T,b[i++]=64&A?x:T,b[i++]=32&A?x:T,b[i++]=16&A?x:T,b[i++]=8&A?x:T,b[i++]=4&A?x:T,b[i++]=2&A?x:T,b[i++]=1&A?x:T;for(;P<C;P++)0===k&&(A=v[g++],k=128),b[i++]=A&k?x:T,k>>=1}for(;i<w;)b[i++]=0;t.putImageData(m,0,r*o)}}else if(e.kind===n.ImageKind.RGBA_32BPP){for(a=0,h=u*o*4,r=0;r<p;r++)_.set(v.subarray(g,g+h)),g+=h,t.putImageData(m,0,a),a+=o;r<f&&(h=u*d*4,_.set(v.subarray(g,g+h)),t.putImageData(m,0,a))}else{if(e.kind!==n.ImageKind.RGB_24BPP)throw new Error("bad image kind: "+e.kind);for(h=u*(l=o),r=0;r<f;r++){for(r>=p&&(h=u*(l=d)),i=0,a=h;a--;)_[i++]=v[g++],_[i++]=v[g++],_[i++]=v[g++],_[i++]=255;t.putImageData(m,0,r*o)}}}}function i(t,e){for(var i=e.height,n=e.width,r=i%o,s=(i-r)/o,a=0===r?s:s+1,l=t.createImageData(n,o),h=0,c=e.data,u=l.data,d=0;d<a;d++){for(var p=d<s?o:r,f=3,m=0;m<p;m++)for(var g=0,v=0;v<n;v++){if(!g){var _=c[h++];g=128}u[f]=_&g?0:255,f+=4,g>>=1}t.putImageData(l,0,d*o)}}function c(t,e){for(var i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],n=0,r=i.length;n<r;n++){var o=i[n];void 0!==t[o]&&(e[o]=t[o])}void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function u(t){t.strokeStyle="#000000",t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0)}function d(t,e,i,n){for(var r=t.length,o=3;o<r;o+=4){var s=t[o];if(0===s)t[o-3]=e,t[o-2]=i,t[o-1]=n;else if(s<255){var a=255-s;t[o-3]=t[o-3]*s+e*a>>8,t[o-2]=t[o-2]*s+i*a>>8,t[o-1]=t[o-1]*s+n*a>>8}}}function p(t,e,i){for(var n=t.length,r=3;r<n;r+=4){var o=i?i[t[r]]:t[r];e[r]=e[r]*o*(1/255)|0}}function f(t,e,i){for(var n=t.length,r=3;r<n;r+=4){var o=77*t[r-3]+152*t[r-2]+28*t[r-1];e[r]=i?e[r]*i[o>>8]>>8:e[r]*o>>16}}function m(t,e,i,n){var r=e.canvas,o=e.context;t.setTransform(e.scaleX,0,0,e.scaleY,e.offsetX,e.offsetY);var s=e.backdrop||null;if(!e.transferMap&&n.isEnabled){var a=n.composeSMask({layer:i.canvas,mask:r,properties:{subtype:e.subtype,backdrop:s}});return t.setTransform(1,0,0,1,0,0),void t.drawImage(a,e.offsetX,e.offsetY)}!function(t,e,i,n,r,o,s){var a,l=!!o,h=l?o[0]:0,c=l?o[1]:0,u=l?o[2]:0;a="Luminosity"===r?f:p;for(var m=Math.min(n,Math.ceil(1048576/i)),g=0;g<n;g+=m){var v=Math.min(m,n-g),_=t.getImageData(0,g,i,v),y=e.getImageData(0,g,i,v);l&&d(_.data,h,c,u),a(_.data,y.data,s),t.putImageData(y,0,g)}}(o,i,r.width,r.height,e.subtype,s,e.transferMap),t.drawImage(r,0,0)}var g=["butt","round","square"],v=["miter","round","bevel"],_={},y={};for(var b in t.prototype={beginDrawing:function(t){var e=t.transform,i=t.viewport,n=t.transparency,r=t.background,o=void 0===r?null:r,s=this.ctx.canvas.width,a=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=o||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,s,a),this.ctx.restore(),n){var l=this.cachedCanvases.getCanvas("transparent",s,a,!0);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),u(this.ctx),e&&this.ctx.transform.apply(this.ctx,e),this.ctx.transform.apply(this.ctx,i.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(t,e,i,r){var o=t.argsArray,s=t.fnArray,a=e||0,l=o.length;if(l===a)return a;for(var h,c=l-a>10&&"function"==typeof i,u=c?Date.now()+15:0,d=0,p=this.commonObjs,f=this.objs;;){if(void 0!==r&&a===r.nextBreakPoint)return r.breakIt(a,i),a;if((h=s[a])!==n.OPS.dependency)this[h].apply(this,o[a]);else for(var m=o[a],g=0,v=m.length;g<v;g++){var _=m[g],y="g"===_[0]&&"_"===_[1]?p:f;if(!y.isResolved(_))return y.get(_,i),a}if(++a===l)return a;if(c&&++d>10){if(Date.now()>u)return i(),a;d=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(t){this.current.lineWidth=t,this.ctx.lineWidth=t},setLineCap:function(t){this.ctx.lineCap=g[t]},setLineJoin:function(t){this.ctx.lineJoin=v[t]},setMiterLimit:function(t){this.ctx.miterLimit=t},setDash:function(t,e){var i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)},setRenderingIntent:function(t){},setFlatness:function(t){},setGState:function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e],r=n[0],o=n[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=n[1];break;case"ca":this.current.fillAlpha=n[1],this.ctx.globalAlpha=n[1];break;case"BM":this.ctx.globalCompositeOperation=o;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var t=this.current.activeSMask,e=t.canvas.width,i=t.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,i,!0),o=this.ctx,s=o.mozCurrentTransform;this.ctx.save();var a=r.context;a.scale(1/t.scaleX,1/t.scaleY),a.translate(-t.offsetX,-t.offsetY),a.transform.apply(a,s),t.startTransformInverse=a.mozCurrentTransformInverse,c(o,a),this.ctx=a,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,t,this.webGLContext),this.ctx.restore(),this.ctx.save(),c(t,this.ctx),this.current.resumeSMaskCtx=t;var e=n.Util.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e),t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()},resumeSMaskGroup:function(){var t=this.current.resumeSMaskCtx,e=this.ctx;this.ctx=t,this.groupStack.push(e),this.groupLevel++},endSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,t,this.webGLContext),this.ctx.restore(),c(t,this.ctx);var e=n.Util.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e)},save:function(){this.ctx.save();var t=this.current;this.stateStack.push(t),this.current=t.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(t,e,i,n,r,o){this.ctx.transform(t,e,i,n,r,o),this._cachedGetSinglePixelWidth=null},constructPath:function(t,e){for(var i=this.ctx,r=this.current,o=r.x,s=r.y,a=0,l=0,h=t.length;a<h;a++)switch(0|t[a]){case n.OPS.rectangle:o=e[l++],s=e[l++];var c=e[l++],u=e[l++];0===c&&(c=this.getSinglePixelWidth()),0===u&&(u=this.getSinglePixelWidth());var d=o+c,p=s+u;this.ctx.moveTo(o,s),this.ctx.lineTo(d,s),this.ctx.lineTo(d,p),this.ctx.lineTo(o,p),this.ctx.lineTo(o,s),this.ctx.closePath();break;case n.OPS.moveTo:o=e[l++],s=e[l++],i.moveTo(o,s);break;case n.OPS.lineTo:o=e[l++],s=e[l++],i.lineTo(o,s);break;case n.OPS.curveTo:o=e[l+4],s=e[l+5],i.bezierCurveTo(e[l],e[l+1],e[l+2],e[l+3],o,s),l+=6;break;case n.OPS.curveTo2:i.bezierCurveTo(o,s,e[l],e[l+1],e[l+2],e[l+3]),o=e[l+2],s=e[l+3],l+=4;break;case n.OPS.curveTo3:o=e[l+2],s=e[l+3],i.bezierCurveTo(e[l],e[l+1],o,s,o,s),l+=4;break;case n.OPS.closePath:i.closePath()}r.setCurrentPoint(o,s)},closePath:function(){this.ctx.closePath()},stroke:function(t){t=void 0===t||t;var e=this.ctx,i=this.current.strokeColor;e.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth),e.globalAlpha=this.current.strokeAlpha,i&&i.hasOwnProperty("type")&&"Pattern"===i.type?(e.save(),e.strokeStyle=i.getPattern(e,this),e.stroke(),e.restore()):e.stroke(),t&&this.consumePath(),e.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(t){t=void 0===t||t;var e=this.ctx,i=this.current.fillColor,n=!1;this.current.patternFill&&(e.save(),this.baseTransform&&e.setTransform.apply(e,this.baseTransform),e.fillStyle=i.getPattern(e,this),n=!0),this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill(),n&&e.restore(),t&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=_},eoClip:function(){this.pendingClip=y},beginText:function(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(var i=0;i<t.length;i++){var n=t[i];e.setTransform.apply(e,n.transform),e.translate(n.x,n.y),n.addToPath(e,n.fontSize)}e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()},setCharSpacing:function(t){this.current.charSpacing=t},setWordSpacing:function(t){this.current.wordSpacing=t},setHScale:function(t){this.current.textHScale=t/100},setLeading:function(t){this.current.leading=-t},setFont:function(t,e){var i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error("Can't find font for "+t);if(r.fontMatrix=i.fontMatrix?i.fontMatrix:n.FONT_IDENTITY_MATRIX,0!==r.fontMatrix[0]&&0!==r.fontMatrix[3]||(0,n.warn)("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=e,!i.isType3Font){var o=i.loadedName||"sans-serif",s=i.black?"900":i.bold?"bold":"normal",a=i.italic?"italic":"normal",l='"'+o+'", '+i.fallbackName,h=e<16?16:e>100?100:e;this.current.fontSizeScale=e/h;var c=a+" "+s+" "+h+"px "+l;this.ctx.font=c}},setTextRenderingMode:function(t){this.current.textRenderingMode=t},setTextRise:function(t){this.current.textRise=t},moveText:function(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e},setLeadingMoveText:function(t,e){this.setLeading(-e),this.moveText(t,e)},setTextMatrix:function(t,e,i,n,r,o){this.current.textMatrix=[t,e,i,n,r,o],this.current.textMatrixScale=Math.sqrt(t*t+e*e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(t,e,i,r){var o,s=this.ctx,a=this.current,l=a.font,h=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,u=h&n.TextRenderingMode.FILL_STROKE_MASK,d=!!(h&n.TextRenderingMode.ADD_TO_PATH_FLAG),p=a.patternFill&&l.data;((l.disableFontFace||d||p)&&(o=l.getPathGenerator(this.commonObjs,t)),l.disableFontFace||p?(s.save(),s.translate(e,i),s.beginPath(),o(s,c),r&&s.setTransform.apply(s,r),u!==n.TextRenderingMode.FILL&&u!==n.TextRenderingMode.FILL_STROKE||s.fill(),u!==n.TextRenderingMode.STROKE&&u!==n.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(u!==n.TextRenderingMode.FILL&&u!==n.TextRenderingMode.FILL_STROKE||s.fillText(t,e,i),u!==n.TextRenderingMode.STROKE&&u!==n.TextRenderingMode.FILL_STROKE||s.strokeText(t,e,i)),d)&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:s.mozCurrentTransform,x:e,y:i,fontSize:c,addToPath:o})},get isFontSubpixelAAEnabled(){var t=this.canvasFactory.create(10,10).context;t.scale(1.5,1),t.fillText("I",0,10);for(var e=t.getImageData(0,0,10,10).data,i=!1,r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",i)},showText:function(t){var e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);var r=e.fontSize;if(0!==r){var o=this.ctx,s=e.fontSizeScale,a=e.charSpacing,l=e.wordSpacing,h=e.fontDirection,c=e.textHScale*h,u=t.length,d=i.vertical,p=d?1:-1,f=i.defaultVMetrics,m=r*e.fontMatrix[0],g=e.textRenderingMode===n.TextRenderingMode.FILL&&!i.disableFontFace&&!e.patternFill;o.save();var v=void 0;if(e.patternFill){o.save();var _=e.fillColor.getPattern(o,this);v=o.mozCurrentTransform,o.restore(),o.fillStyle=_}o.transform.apply(o,e.textMatrix),o.translate(e.x,e.y+e.textRise),h>0?o.scale(c,-1):o.scale(c,1);var y=e.lineWidth,b=e.textMatrixScale;if(0===b||0===y){var w=e.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;w!==n.TextRenderingMode.STROKE&&w!==n.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,y=.65*this.getSinglePixelWidth())}else y/=b;1!==s&&(o.scale(s,s),y/=s),o.lineWidth=y;var S,x=0;for(S=0;S<u;++S){var T=t[S];if((0,n.isNum)(T))x+=p*T*r/1e3;else{var E,P,C,L,k,A,R,I=!1,O=(T.isSpace?l:0)+a,M=T.fontChar,D=T.accent,z=T.width;if(d)k=T.vmetric||f,A=-(A=T.vmetric?k[1]:.5*z)*m,R=k[2]*m,z=k?-k[0]:z,E=A/s,P=(x+R)/s;else E=x/s,P=0;if(i.remeasure&&z>0){var F=1e3*o.measureText(M).width/r*s;if(z<F&&this.isFontSubpixelAAEnabled){var N=z/F;I=!0,o.save(),o.scale(N,1),E/=N}else z!==F&&(E+=(z-F)/2e3*r/s)}(T.isInFont||i.missingFile)&&(g&&!D?o.fillText(M,E,P):(this.paintChar(M,E,P,v),D&&(C=E+D.offset.x/s,L=P-D.offset.y/s,this.paintChar(D.fontChar,C,L,v)))),x+=z*m+O*h,I&&o.restore()}}d?e.y-=x*c:e.x+=x*c,o.restore()}},showType3Text:function(t){var e,i,r,o,s=this.ctx,a=this.current,l=a.font,h=a.fontSize,c=a.fontDirection,u=l.vertical?1:-1,d=a.charSpacing,p=a.wordSpacing,f=a.textHScale*c,m=a.fontMatrix||n.FONT_IDENTITY_MATRIX,g=t.length;if(!(a.textRenderingMode===n.TextRenderingMode.INVISIBLE)&&0!==h){for(this._cachedGetSinglePixelWidth=null,s.save(),s.transform.apply(s,a.textMatrix),s.translate(a.x,a.y),s.scale(f,c),e=0;e<g;++e)if(i=t[e],(0,n.isNum)(i))o=u*i*h/1e3,this.ctx.translate(o,0),a.x+=o*f;else{var v=(i.isSpace?p:0)+d,_=l.charProcOperatorList[i.operatorListId];if(_)this.processingType3=i,this.save(),s.scale(h,h),s.transform.apply(s,m),this.executeOperatorList(_),this.restore(),r=n.Util.applyTransform([i.width,0],m)[0]*h+v,s.translate(r,0),a.x+=r*f;else(0,n.warn)('Type3 character "'+i.operatorListId+'" is not available.')}s.restore(),this.processingType3=null}},setCharWidth:function(t,e){},setCharWidthAndBounds:function(t,e,i,n,r,o){this.ctx.rect(i,n,r-i,o-n),this.clip(),this.endPath()},getColorN_Pattern:function(e){var i,n=this;if("TilingPattern"===e[0]){var o=e[1],s=this.baseTransform||this.ctx.mozCurrentTransform.slice(),a={createCanvasGraphics:function(e){return new t(e,n.commonObjs,n.objs,n.canvasFactory,n.webGLContext)}};i=new r.TilingPattern(e,o,this.ctx,a,s)}else i=(0,r.getShadingPatternFromIR)(e);return i},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(t,e,i){var r=n.Util.makeCssRgb(t,e,i);this.ctx.strokeStyle=r,this.current.strokeColor=r},setFillRGBColor:function(t,e,i){var r=n.Util.makeCssRgb(t,e,i);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1},shadingFill:function(t){var e=this.ctx;this.save();var i=(0,r.getShadingPatternFromIR)(t);e.fillStyle=i.getPattern(e,this,!0);var o=e.mozCurrentTransformInverse;if(o){var s=e.canvas,a=s.width,l=s.height,h=n.Util.applyTransform([0,0],o),c=n.Util.applyTransform([0,l],o),u=n.Util.applyTransform([a,0],o),d=n.Util.applyTransform([a,l],o),p=Math.min(h[0],c[0],u[0],d[0]),f=Math.min(h[1],c[1],u[1],d[1]),m=Math.max(h[0],c[0],u[0],d[0]),g=Math.max(h[1],c[1],u[1],d[1]);this.ctx.fillRect(p,f,m-p,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,n.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,n.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(t,e){if(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(t)&&6===t.length&&this.transform.apply(this,t),this.baseTransform=this.ctx.mozCurrentTransform,Array.isArray(e)&&4===e.length){var i=e[2]-e[0],n=e[3]-e[1];this.ctx.rect(e[0],e[1],i,n),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(t){this.save();var e=this.ctx;t.isolated||(0,n.info)("TODO: Support non-isolated groups."),t.knockout&&(0,n.warn)("Knockout groups not supported.");var i=e.mozCurrentTransform;if(t.matrix&&e.transform.apply(e,t.matrix),!t.bbox)throw new Error("Bounding box is required.");var r=n.Util.getAxialAlignedBoundingBox(t.bbox,e.mozCurrentTransform),o=[0,0,e.canvas.width,e.canvas.height];r=n.Util.intersect(r,o)||[0,0,0,0];var s=Math.floor(r[0]),a=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-s,1),h=Math.max(Math.ceil(r[3])-a,1),u=1,d=1;l>4096&&(u=l/4096,l=4096),h>4096&&(d=h/4096,h=4096);var p="groupAt"+this.groupLevel;t.smask&&(p+="_smask_"+this.smaskCounter++%2);var f=this.cachedCanvases.getCanvas(p,l,h,!0),m=f.context;m.scale(1/u,1/d),m.translate(-s,-a),m.transform.apply(m,i),t.smask?this.smaskStack.push({canvas:f.canvas,context:m,offsetX:s,offsetY:a,scaleX:u,scaleY:d,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(s,a),e.scale(u,d)),c(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++,this.current.activeSMask=null},endGroup:function(t){this.groupLevel--;var e=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,t.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(e.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(t,e,i){if(this.save(),u(this.ctx),this.current=new h,Array.isArray(t)&&4===t.length){var n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.clip(),this.endPath()}this.transform.apply(this,e),this.transform.apply(this,i)},endAnnotation:function(){this.restore()},paintJpegXObject:function(t,e,i){var r=this.objs.get(t);if(r){this.save();var o=this.ctx;if(o.scale(1/e,-1/i),o.drawImage(r,0,0,r.width,r.height,0,-i,e,i),this.imageLayer){var s=o.mozCurrentTransformInverse,a=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:t,left:a[0],top:a[1],width:e/s[0],height:i/s[3]})}this.restore()}else(0,n.warn)("Dependent image isn't ready yet")},paintImageMaskXObject:function(t){var e=this.ctx,n=t.width,r=t.height,o=this.current.fillColor,s=this.current.patternFill,a=this.processingType3;if(a&&void 0===a.compiled&&(a.compiled=n<=1e3&&r<=1e3?function(t){var e,i,n,r,o=t.width,s=t.height,a=o+1,l=new Uint8Array(a*(s+1)),h=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),c=o+7&-8,u=t.data,d=new Uint8Array(c*s),p=0;for(e=0,r=u.length;e<r;e++)for(var f=128,m=u[e];f>0;)d[p++]=m&f?0:255,f>>=1;var g=0;for(0!==d[p=0]&&(l[0]=1,++g),i=1;i<o;i++)d[p]!==d[p+1]&&(l[i]=d[p]?2:1,++g),p++;for(0!==d[p]&&(l[i]=2,++g),e=1;e<s;e++){n=e*a,d[(p=e*c)-c]!==d[p]&&(l[n]=d[p]?1:8,++g);var v=(d[p]?4:0)+(d[p-c]?8:0);for(i=1;i<o;i++)h[v=(v>>2)+(d[p+1]?4:0)+(d[p-c+1]?8:0)]&&(l[n+i]=h[v],++g),p++;if(d[p-c]!==d[p]&&(l[n+i]=d[p]?2:4,++g),g>1e3)return null}for(n=e*a,0!==d[p=c*(s-1)]&&(l[n]=8,++g),i=1;i<o;i++)d[p]!==d[p+1]&&(l[n+i]=d[p]?4:8,++g),p++;if(0!==d[p]&&(l[n+i]=4,++g),g>1e3)return null;var _=new Int32Array([0,a,-1,0,-a,0,0,0,1]),y=[];for(e=0;g&&e<=s;e++){for(var b=e*a,w=b+o;b<w&&!l[b];)b++;if(b!==w){var S,x=[b%a,e],T=l[b],E=b;do{var P=_[T];do{b+=P}while(!l[b]);5!==(S=l[b])&&10!==S?(T=S,l[b]=0):(T=S&51*T>>4,l[b]&=T>>2|T<<2),x.push(b%a),x.push(b/a|0),--g}while(E!==b);y.push(x),--e}}return function(t){t.save(),t.scale(1/o,-1/s),t.translate(0,-s),t.beginPath();for(var e=0,i=y.length;e<i;e++){var n=y[e];t.moveTo(n[0],n[1]);for(var r=2,a=n.length;r<a;r+=2)t.lineTo(n[r],n[r+1])}t.fill(),t.beginPath(),t.restore()}}({data:t.data,width:n,height:r}):null),a&&a.compiled)a.compiled(e);else{var l=this.cachedCanvases.getCanvas("maskCanvas",n,r),h=l.context;h.save(),i(h,t),h.globalCompositeOperation="source-in",h.fillStyle=s?o.getPattern(h,this):o,h.fillRect(0,0,n,r),h.restore(),this.paintInlineImageXObject(l.canvas)}},paintImageMaskXObjectRepeat:function(t,e,n,r){var o=t.width,s=t.height,a=this.current.fillColor,l=this.current.patternFill,h=this.cachedCanvases.getCanvas("maskCanvas",o,s),c=h.context;c.save(),i(c,t),c.globalCompositeOperation="source-in",c.fillStyle=l?a.getPattern(c,this):a,c.fillRect(0,0,o,s),c.restore();for(var u=this.ctx,d=0,p=r.length;d<p;d+=2)u.save(),u.transform(e,0,0,n,r[d],r[d+1]),u.scale(1,-1),u.drawImage(h.canvas,0,0,o,s,0,-1,1,1),u.restore()},paintImageMaskXObjectGroup:function(t){for(var e=this.ctx,n=this.current.fillColor,r=this.current.patternFill,o=0,s=t.length;o<s;o++){var a=t[o],l=a.width,h=a.height,c=this.cachedCanvases.getCanvas("maskCanvas",l,h),u=c.context;u.save(),i(u,a),u.globalCompositeOperation="source-in",u.fillStyle=r?n.getPattern(u,this):n,u.fillRect(0,0,l,h),u.restore(),e.save(),e.transform.apply(e,a.transform),e.scale(1,-1),e.drawImage(c.canvas,0,0,l,h,0,-1,1,1),e.restore()}},paintImageXObject:function(t){var e=this.objs.get(t);e?this.paintInlineImageXObject(e):(0,n.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(t,e,i,r){var o=this.objs.get(t);if(o){for(var s=o.width,a=o.height,l=[],h=0,c=r.length;h<c;h+=2)l.push({transform:[e,0,0,i,r[h],r[h+1]],x:0,y:0,w:s,h:a});this.paintInlineImageXObjectGroup(o,l)}else(0,n.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(t){var i=t.width,n=t.height,r=this.ctx;this.save(),r.scale(1/i,-1/n);var o,s,a=r.mozCurrentTransformInverse,l=a[0],h=a[1],c=Math.max(Math.sqrt(l*l+h*h),1),u=a[2],d=a[3],p=Math.max(Math.sqrt(u*u+d*d),1);if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)o=t;else{var f=(s=this.cachedCanvases.getCanvas("inlineImage",i,n)).context;e(f,t),o=s.canvas}for(var m=i,g=n,v="prescale1";c>2&&m>1||p>2&&g>1;){var _=m,y=g;c>2&&m>1&&(c/=m/(_=Math.ceil(m/2))),p>2&&g>1&&(p/=g/(y=Math.ceil(g/2))),(f=(s=this.cachedCanvases.getCanvas(v,_,y)).context).clearRect(0,0,_,y),f.drawImage(o,0,0,m,g,0,0,_,y),o=s.canvas,m=_,g=y,v="prescale1"===v?"prescale2":"prescale1"}if(r.drawImage(o,0,0,m,g,0,-n,i,n),this.imageLayer){var b=this.getCanvasPosition(0,-n);this.imageLayer.appendImage({imgData:t,left:b[0],top:b[1],width:i/a[0],height:n/a[3]})}this.restore()},paintInlineImageXObjectGroup:function(t,i){var n=this.ctx,r=t.width,o=t.height,s=this.cachedCanvases.getCanvas("inlineImage",r,o);e(s.context,t);for(var a=0,l=i.length;a<l;a++){var h=i[a];if(n.save(),n.transform.apply(n,h.transform),n.scale(1,-1),n.drawImage(s.canvas,h.x,h.y,h.w,h.h,0,-1,1,1),this.imageLayer){var c=this.getCanvasPosition(h.x,h.y);this.imageLayer.appendImage({imgData:t,left:c[0],top:c[1],width:r,height:o})}n.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){(0,n.warn)("Unsupported 'paintXObject' command.")},markPoint:function(t){},markPointProps:function(t,e){},beginMarkedContent:function(t){},beginMarkedContentProps:function(t,e){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var t=this.ctx;this.pendingClip&&(this.pendingClip===y?t.clip("evenodd"):t.clip(),this.pendingClip=null),t.beginPath()},getSinglePixelWidth:function(t){if(null===this._cachedGetSinglePixelWidth){var e=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1],e[2]*e[2]+e[3]*e[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(t,e){var i=this.ctx.mozCurrentTransform;return[i[0]*t+i[2]*e+i[4],i[1]*t+i[3]*e+i[5]]}},n.OPS)t.prototype[n.OPS[b]]=t.prototype[b];return t}();e.CanvasGraphics=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.getShadingPatternFromIR=void 0;var n=i(1),r={RadialAxial:{fromIR:function(t){var e=t[1],i=t[2],n=t[3],r=t[4],o=t[5],s=t[6];return{type:"Pattern",getPattern:function(t){var a;"axial"===e?a=t.createLinearGradient(n[0],n[1],r[0],r[1]):"radial"===e&&(a=t.createRadialGradient(n[0],n[1],o,r[0],r[1],s));for(var l=0,h=i.length;l<h;++l){var c=i[l];a.addColorStop(c[0],c[1])}return a}}}}},o=function(){function t(t,e,i,n,r,o,s,a){var l,h=e.coords,c=e.colors,u=t.data,d=4*t.width;h[i+1]>h[n+1]&&(l=i,i=n,n=l,l=o,o=s,s=l),h[n+1]>h[r+1]&&(l=n,n=r,r=l,l=s,s=a,a=l),h[i+1]>h[n+1]&&(l=i,i=n,n=l,l=o,o=s,s=l);var p=(h[i]+e.offsetX)*e.scaleX,f=(h[i+1]+e.offsetY)*e.scaleY,m=(h[n]+e.offsetX)*e.scaleX,g=(h[n+1]+e.offsetY)*e.scaleY,v=(h[r]+e.offsetX)*e.scaleX,_=(h[r+1]+e.offsetY)*e.scaleY;if(!(f>=_))for(var y,b,w,S,x,T,E,P,C,L=c[o],k=c[o+1],A=c[o+2],R=c[s],I=c[s+1],O=c[s+2],M=c[a],D=c[a+1],z=c[a+2],F=Math.round(f),N=Math.round(_),B=F;B<=N;B++){B<g?(y=p-(p-m)*(C=B<f?0:f===g?1:(f-B)/(f-g)),b=L-(L-R)*C,w=k-(k-I)*C,S=A-(A-O)*C):(y=m-(m-v)*(C=B>_?1:g===_?0:(g-B)/(g-_)),b=R-(R-M)*C,w=I-(I-D)*C,S=O-(O-z)*C),x=p-(p-v)*(C=B<f?0:B>_?1:(f-B)/(f-_)),T=L-(L-M)*C,E=k-(k-D)*C,P=A-(A-z)*C;for(var j=Math.round(Math.min(y,x)),H=Math.round(Math.max(y,x)),U=d*B+4*j,q=j;q<=H;q++)C=(C=(y-q)/(y-x))<0?0:C>1?1:C,u[U++]=b-(b-T)*C|0,u[U++]=w-(w-E)*C|0,u[U++]=S-(S-P)*C|0,u[U++]=255}}function e(e,i,n){var r,o,s=i.coords,a=i.colors;switch(i.type){case"lattice":var l=i.verticesPerRow,h=Math.floor(s.length/l)-1,c=l-1;for(r=0;r<h;r++)for(var u=r*l,d=0;d<c;d++,u++)t(e,n,s[u],s[u+1],s[u+l],a[u],a[u+1],a[u+l]),t(e,n,s[u+l+1],s[u+1],s[u+l],a[u+l+1],a[u+1],a[u+l]);break;case"triangles":for(r=0,o=s.length;r<o;r+=3)t(e,n,s[r],s[r+1],s[r+2],a[r],a[r+1],a[r+2]);break;default:throw new Error("illegal figure")}}return function(t,i,n,r,o,s,a,l){var h,c,u,d,p=Math.floor(t[0]),f=Math.floor(t[1]),m=Math.ceil(t[2])-p,g=Math.ceil(t[3])-f,v=Math.min(Math.ceil(Math.abs(m*i[0]*1.1)),3e3),_=Math.min(Math.ceil(Math.abs(g*i[1]*1.1)),3e3),y=m/v,b=g/_,w={coords:n,colors:r,offsetX:-p,offsetY:-f,scaleX:1/y,scaleY:1/b},S=v+4,x=_+4;if(l.isEnabled)h=l.drawFigures({width:v,height:_,backgroundColor:s,figures:o,context:w}),(c=a.getCanvas("mesh",S,x,!1)).context.drawImage(h,2,2),h=c.canvas;else{var T=(c=a.getCanvas("mesh",S,x,!1)).context,E=T.createImageData(v,_);if(s){var P=E.data;for(u=0,d=P.length;u<d;u+=4)P[u]=s[0],P[u+1]=s[1],P[u+2]=s[2],P[u+3]=255}for(u=0;u<o.length;u++)e(E,o[u],w);T.putImageData(E,2,2),h=c.canvas}return{canvas:h,offsetX:p-2*y,offsetY:f-2*b,scaleX:y,scaleY:b}}}();r.Mesh={fromIR:function(t){var e=t[2],i=t[3],r=t[4],s=t[5],a=t[6],l=t[8];return{type:"Pattern",getPattern:function(t,h,c){var u;if(c)u=n.Util.singularValueDecompose2dScale(t.mozCurrentTransform);else if(u=n.Util.singularValueDecompose2dScale(h.baseTransform),a){var d=n.Util.singularValueDecompose2dScale(a);u=[u[0]*d[0],u[1]*d[1]]}var p=o(s,u,e,i,r,c?null:l,h.cachedCanvases,h.webGLContext);return c||(t.setTransform.apply(t,h.baseTransform),a&&t.transform.apply(t,a)),t.translate(p.offsetX,p.offsetY),t.scale(p.scaleX,p.scaleY),t.createPattern(p.canvas,"no-repeat")}}}},r.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var s=function(){var t=1,e=2;function i(t,e,i,n,r){this.operatorList=t[2],this.matrix=t[3]||[1,0,0,1,0,0],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.canvasGraphicsFactory=n,this.baseTransform=r,this.type="Pattern",this.ctx=i}return i.prototype={createPatternCanvas:function(t){var e=this.operatorList,i=this.bbox,r=this.xstep,o=this.ystep,s=this.paintType,a=this.tilingType,l=this.color,h=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+a);var c=i[0],u=i[1],d=i[2],p=i[3],f=[c,u],m=[c+r,u+o],g=m[0]-f[0],v=m[1]-f[1],_=n.Util.singularValueDecompose2dScale(this.matrix),y=n.Util.singularValueDecompose2dScale(this.baseTransform),b=[_[0]*y[0],_[1]*y[1]];g=Math.min(Math.ceil(Math.abs(g*b[0])),3e3),v=Math.min(Math.ceil(Math.abs(v*b[1])),3e3);var w=t.cachedCanvases.getCanvas("pattern",g,v,!0),S=w.context,x=h.createCanvasGraphics(S);x.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(x,s,l),this.setScale(g,v,r,o),this.transformToScale(x);var T=[1,0,0,1,-f[0],-f[1]];return x.transform.apply(x,T),this.clipBbox(x,i,c,u,d,p),x.executeOperatorList(e),w.canvas},setScale:function(t,e,i,n){this.scale=[t/i,e/n]},transformToScale:function(t){var e=this.scale,i=[e[0],0,0,e[1],0,0];t.transform.apply(t,i)},scaleToContext:function(){var t=this.scale;this.ctx.scale(1/t[0],1/t[1])},clipBbox:function(t,e,i,n,r,o){if(Array.isArray(e)&&4===e.length){var s=r-i,a=o-n;t.ctx.rect(i,n,s,a),t.clip(),t.endPath()}},setFillAndStrokeStyleToContext:function(i,r,o){var s=i.ctx,a=i.current;switch(r){case t:var l=this.ctx;s.fillStyle=l.fillStyle,s.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case e:var h=n.Util.makeCssRgb(o[0],o[1],o[2]);s.fillStyle=h,s.strokeStyle=h,a.fillColor=h,a.strokeColor=h;break;default:throw new n.FormatError("Unsupported paint type: "+r)}},getPattern:function(t,e){var i=this.createPatternCanvas(e);return(t=this.ctx).setTransform.apply(t,this.baseTransform),t.transform.apply(t,this.matrix),this.scaleToContext(),t.createPattern(i,"repeat")}},i}();e.getShadingPatternFromIR=function(t){var e=r[t[0]];if(!e)throw new Error("Unknown IR type: "+t[0]);return e.fromIR(t)},e.TilingPattern=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.create(null);n.workerPort=void 0===n.workerPort?null:n.workerPort,n.workerSrc=void 0===n.workerSrc?"":n.workerSrc,e.GlobalWorkerOptions=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n,r,o,s=i(137),a=(n=s)&&n.__esModule?n:{default:n},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=(r=a.default.mark(function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",e.apply(n,i));case 3:case"end":return t.stop()}},t,this)}),o=function(){var t=r.apply(this,arguments);return new Promise(function(e,i){return function n(r,o){try{var s=t[r](o),a=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});e(a)}("next")})},function(t,e){return o.apply(this,arguments)}),c=i(1);function u(t){if("object"!==(void 0===t?"undefined":l(t)))return t;switch(t.name){case"AbortException":return new c.AbortException(t.message);case"MissingPDFException":return new c.MissingPDFException(t.message);case"UnexpectedResponseException":return new c.UnexpectedResponseException(t.message,t.status);default:return new c.UnknownErrorException(t.message,t.details)}}function d(t,e,i){e?t.resolve():t.reject(i)}function p(t,e,i){var n=this;this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null);var r=this.callbacksCapabilities=Object.create(null),o=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(t){var e=t.data;if(e.targetName===n.sourceName)if(e.stream)n._processStreamMessage(e);else if(e.isReply){var s=e.callbackId;if(!(e.callbackId in r))throw new Error("Cannot resolve callback "+s);var a=r[s];delete r[s],"error"in e?a.reject(u(e.error)):a.resolve(e.data)}else{if(!(e.action in o))throw new Error("Unknown action from worker: "+e.action);var l=o[e.action];if(e.callbackId){var h=n.sourceName,d=e.sourceName;Promise.resolve().then(function(){return l[0].call(l[1],e.data)}).then(function(t){i.postMessage({sourceName:h,targetName:d,isReply:!0,callbackId:e.callbackId,data:t})},function(t){i.postMessage({sourceName:h,targetName:d,isReply:!0,callbackId:e.callbackId,error:function(t){return!(t instanceof Error)||t instanceof c.AbortException||t instanceof c.MissingPDFException||t instanceof c.UnexpectedResponseException||t instanceof c.UnknownErrorException?t:new c.UnknownErrorException(t.message,t.toString())}(t)})})}else e.streamId?n._createStreamSink(e):l[0].call(l[1],e.data)}},i.addEventListener("message",this._onComObjOnMessage)}p.prototype={on:function(t,e,i){var n=this.actionHandler;if(n[t])throw new Error('There is already an actionName called "'+t+'"');n[t]=[e,i]},send:function(t,e,i){var n={sourceName:this.sourceName,targetName:this.targetName,action:t,data:e};this.postMessage(n,i)},sendWithPromise:function(t,e,i){var n=this.callbackId++,r={sourceName:this.sourceName,targetName:this.targetName,action:t,data:e,callbackId:n},o=(0,c.createPromiseCapability)();this.callbacksCapabilities[n]=o;try{this.postMessage(r,i)}catch(t){o.reject(t)}return o.promise},sendWithStream:function(t,e,i,n){var r=this,o=this.streamId++,s=this.sourceName,a=this.targetName;return new c.ReadableStream({start:function(i){var n=(0,c.createPromiseCapability)();return r.streamControllers[o]={controller:i,startCall:n,isClosed:!1},r.postMessage({sourceName:s,targetName:a,action:t,streamId:o,data:e,desiredSize:i.desiredSize}),n.promise},pull:function(t){var e=(0,c.createPromiseCapability)();return r.streamControllers[o].pullCall=e,r.postMessage({sourceName:s,targetName:a,stream:"pull",streamId:o,desiredSize:t.desiredSize}),e.promise},cancel:function(t){var e=(0,c.createPromiseCapability)();return r.streamControllers[o].cancelCall=e,r.streamControllers[o].isClosed=!0,r.postMessage({sourceName:s,targetName:a,stream:"cancel",reason:t,streamId:o}),e.promise}},i)},_createStreamSink:function(t){var e=this,i=this,n=this.actionHandler[t.action],r=t.streamId,o=t.desiredSize,s=this.sourceName,a=t.sourceName,l=function(t){var i=t.stream,n=t.chunk,o=t.transfers,l=t.success,h=t.reason;e.postMessage({sourceName:s,targetName:a,stream:i,streamId:r,chunk:n,success:l,reason:h},o)},u={enqueue:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments[2];if(!this.isCancelled){var n=this.desiredSize;this.desiredSize-=e,n>0&&this.desiredSize<=0&&(this.sinkCapability=(0,c.createPromiseCapability)(),this.ready=this.sinkCapability.promise),l({stream:"enqueue",chunk:t,transfers:i})}},close:function(){this.isCancelled||(this.isCancelled=!0,l({stream:"close"}),delete i.streamSinks[r])},error:function(t){this.isCancelled||(this.isCancelled=!0,l({stream:"error",reason:t}))},sinkCapability:(0,c.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:o,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[r]=u,h(n[0],[t.data,u],n[1]).then(function(){l({stream:"start_complete",success:!0})},function(t){l({stream:"start_complete",success:!1,reason:t})})},_processStreamMessage:function(t){var e=this,i=this.sourceName,n=t.sourceName,r=t.streamId,o=function(t){var o=t.stream,s=t.success,a=t.reason;e.comObj.postMessage({sourceName:i,targetName:n,stream:o,success:s,streamId:r,reason:a})},s=function(){Promise.all([e.streamControllers[t.streamId].startCall,e.streamControllers[t.streamId].pullCall,e.streamControllers[t.streamId].cancelCall].map(function(t){return t&&(e=t.promise,Promise.resolve(e).catch(function(){}));var e})).then(function(){delete e.streamControllers[t.streamId]})};switch(t.stream){case"start_complete":d(this.streamControllers[t.streamId].startCall,t.success,u(t.reason));break;case"pull_complete":d(this.streamControllers[t.streamId].pullCall,t.success,u(t.reason));break;case"pull":if(!this.streamSinks[t.streamId]){o({stream:"pull_complete",success:!0});break}this.streamSinks[t.streamId].desiredSize<=0&&t.desiredSize>0&&this.streamSinks[t.streamId].sinkCapability.resolve(),this.streamSinks[t.streamId].desiredSize=t.desiredSize,h(this.streamSinks[t.streamId].onPull).then(function(){o({stream:"pull_complete",success:!0})},function(t){o({stream:"pull_complete",success:!1,reason:t})});break;case"enqueue":(0,c.assert)(this.streamControllers[t.streamId],"enqueue should have stream controller"),this.streamControllers[t.streamId].isClosed||this.streamControllers[t.streamId].controller.enqueue(t.chunk);break;case"close":if((0,c.assert)(this.streamControllers[t.streamId],"close should have stream controller"),this.streamControllers[t.streamId].isClosed)break;this.streamControllers[t.streamId].isClosed=!0,this.streamControllers[t.streamId].controller.close(),s();break;case"error":(0,c.assert)(this.streamControllers[t.streamId],"error should have stream controller"),this.streamControllers[t.streamId].controller.error(u(t.reason)),s();break;case"cancel_complete":d(this.streamControllers[t.streamId].cancelCall,t.success,u(t.reason)),s();break;case"cancel":if(!this.streamSinks[t.streamId])break;h(this.streamSinks[t.streamId].onCancel,[u(t.reason)]).then(function(){o({stream:"cancel_complete",success:!0})},function(t){o({stream:"cancel_complete",success:!1,reason:t})}),this.streamSinks[t.streamId].sinkCapability.reject(u(t.reason)),this.streamSinks[t.streamId].isCancelled=!0,delete this.streamSinks[t.streamId];break;default:throw new Error("Unexpected stream case")}},postMessage:function(t,e){e&&this.postMessageTransfers?this.comObj.postMessage(t,e):this.comObj.postMessage(t)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},e.MessageHandler=p},function(t,e,i){"use strict";t.exports=i(138)},function(t,e,i){"use strict";var n=function(){return this}()||Function("return this")(),r=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=r&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=i(139),r)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}},function(t,e,i){"use strict";(function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i){var n,r=Object.prototype,o=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag",c="object"===e(t),u=i.regeneratorRuntime;if(u)c&&(t.exports=u);else{(u=i.regeneratorRuntime=c?t.exports:{}).wrap=w;var d="suspendedStart",p="suspendedYield",f="executing",m="completed",g={},v={};v[a]=function(){return this};var _=Object.getPrototypeOf,y=_&&_(_(I([])));y&&y!==r&&o.call(y,a)&&(v=y);var b=E.prototype=x.prototype=Object.create(v);T.prototype=b.constructor=E,E.constructor=T,E[h]=T.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===T||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,h in t||(t[h]="GeneratorFunction")),t.prototype=Object.create(b),t},u.awrap=function(t){return{__await:t}},P(C.prototype),C.prototype[l]=function(){return this},u.AsyncIterator=C,u.async=function(t,e,i,n){var r=new C(w(t,e,i,n));return u.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},P(b),b[h]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},u.values=I,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,r){return a.type="throw",a.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),h=o.call(s,"finallyLoc");if(l&&h){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),A(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;A(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:I(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),g}}}function w(t,e,i,n){var r=e&&e.prototype instanceof x?e:x,o=Object.create(r.prototype),s=new R(n||[]);return o._invoke=function(t,e,i){var n=d;return function(r,o){if(n===f)throw new Error("Generator is already running");if(n===m){if("throw"===r)throw o;return O()}for(i.method=r,i.arg=o;;){var s=i.delegate;if(s){var a=L(s,i);if(a){if(a===g)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=S(t,e,i);if("normal"===l.type){if(n=i.done?m:p,l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=m,i.method="throw",i.arg=l.arg)}}}(t,i,s),o}function S(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function x(){}function T(){}function E(){}function P(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function C(t){var i;this._invoke=function(n,r){function s(){return new Promise(function(i,s){!function i(n,r,s,a){var l=S(t[n],t,r);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"===(void 0===c?"undefined":e(c))&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(t){i("next",t,s,a)},function(t){i("throw",t,s,a)}):Promise.resolve(c).then(function(t){h.value=t,s(h)},a)}a(l.arg)}(n,r,i,s)})}return i=i?i.then(s,s):s()}}function L(t,e){var i=t.iterator[e.method];if(i===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,L(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=S(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,g;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function I(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(o.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=n,e.done=!0,e};return r.next=r}}return{next:O}}function O(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}).call(this,i(140)(t))},function(t,e,i){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1),o=i(142);var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(0,r.assert)("string"==typeof e,"Metadata: input is not a string"),e=this._repair(e);var i=(new o.SimpleXMLParser).parseFromString(e);this._metadata=Object.create(null),i&&this._parse(i)}return n(t,[{key:"_repair",value:function(t){return t.replace(/>\\376\\377([^<]+)/g,function(t,e){for(var i=e.replace(/\\([0-3])([0-7])([0-7])/g,function(t,e,i,n){return String.fromCharCode(64*e+8*i+1*n)}).replace(/&(amp|apos|gt|lt|quot);/g,function(t,e){switch(e){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error("_repair: "+e+" isn't defined.")}),n="",r=0,o=i.length;r<o;r+=2){var s=256*i.charCodeAt(r)+i.charCodeAt(r+1);n+=s>=32&&s<127&&60!==s&&62!==s&&38!==s?String.fromCharCode(s):"&#x"+(65536+s).toString(16).substring(1)+";"}return">"+n})}},{key:"_parse",value:function(t){var e=t.documentElement;if("rdf:rdf"!==e.nodeName.toLowerCase())for(e=e.firstChild;e&&"rdf:rdf"!==e.nodeName.toLowerCase();)e=e.nextSibling;var i=e?e.nodeName.toLowerCase():null;if(e&&"rdf:rdf"===i&&e.hasChildNodes())for(var n=e.childNodes,r=0,o=n.length;r<o;r++){var s=n[r];if("rdf:description"===s.nodeName.toLowerCase())for(var a=0,l=s.childNodes.length;a<l;a++)if("#text"!==s.childNodes[a].nodeName.toLowerCase()){var h=s.childNodes[a],c=h.nodeName.toLowerCase();this._metadata[c]=h.textContent.trim()}}}},{key:"get",value:function(t){return this._metadata[t]||null}},{key:"getAll",value:function(){return this._metadata}},{key:"has",value:function(t){return void 0!==this._metadata[t]}}]),t}();e.Metadata=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function a(t,e){var i=t[e];return" "===i||"\n"===i||"\r"===i||"\t"===i}var l=function(){function t(){o(this,t)}return r(t,[{key:"_resolveEntities",value:function(t){return t.replace(/&([^;]+);/g,function(t,e){if("#x"===e.substring(0,2))return String.fromCharCode(parseInt(e.substring(2),16));if("#"===e.substring(0,1))return String.fromCharCode(parseInt(e.substring(1),10));switch(e){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return this.onResolveEntity(e)})}},{key:"_parseContent",value:function(t,e){var i,n=e,r=[];function o(){for(;n<t.length&&a(t,n);)++n}for(;n<t.length&&!a(t,n)&&">"!==t[n]&&"/"!==t[n];)++n;for(i=t.substring(e,n),o();n<t.length&&">"!==t[n]&&"/"!==t[n]&&"?"!==t[n];){o();for(var s,l="";n<t.length&&!a(t,n)&&"="!==t[n];)l+=t[n],++n;if(o(),"="!==t[n])return null;++n,o();var h=t[n];if('"'!==h&&"'"!==h)return null;var c=t.indexOf(h,++n);if(c<0)return null;s=t.substring(n,c),r.push({name:l,value:this._resolveEntities(s)}),n=c+1,o()}return{name:i,attributes:r,parsed:n-e}}},{key:"_parseProcessingInstruction",value:function(t,e){var i,n=e;for(;n<t.length&&!a(t,n)&&">"!==t[n]&&"/"!==t[n];)++n;i=t.substring(e,n),function(){for(;n<t.length&&a(t,n);)++n}();for(var r=n;n<t.length&&("?"!==t[n]||">"!==t[n+1]);)++n;return{name:i,value:t.substring(r,n),parsed:n-e}}},{key:"parseXml",value:function(t){for(var e=0;e<t.length;){var i=e;if("<"===t[e]){var n=void 0;switch(t[++i]){case"/":if(++i,(n=t.indexOf(">",i))<0)return void this.onError(s.UnterminatedElement);this.onEndElement(t.substring(i,n)),i=n+1;break;case"?":++i;var r=this._parseProcessingInstruction(t,i);if("?>"!==t.substring(i+r.parsed,i+r.parsed+2))return void this.onError(s.UnterminatedXmlDeclaration);this.onPi(r.name,r.value),i+=r.parsed+2;break;case"!":if("--"===t.substring(i+1,i+3)){if((n=t.indexOf("--\x3e",i+3))<0)return void this.onError(s.UnterminatedComment);this.onComment(t.substring(i+3,n)),i=n+3}else if("[CDATA["===t.substring(i+1,i+8)){if((n=t.indexOf("]]>",i+8))<0)return void this.onError(s.UnterminatedCdat);this.onCdata(t.substring(i+8,n)),i=n+3}else{if("DOCTYPE"!==t.substring(i+1,i+8))return void this.onError(s.MalformedElement);var o=t.indexOf("[",i+8),a=!1;if((n=t.indexOf(">",i+8))<0)return void this.onError(s.UnterminatedDoctypeDeclaration);if(o>0&&n>o){if((n=t.indexOf("]>",i+8))<0)return void this.onError(s.UnterminatedDoctypeDeclaration);a=!0}var l=t.substring(i+8,n+(a?1:0));this.onDoctype(l),i=n+(a?2:1)}break;default:var h=this._parseContent(t,i);if(null===h)return void this.onError(s.MalformedElement);var c=!1;if("/>"===t.substring(i+h.parsed,i+h.parsed+2))c=!0;else if(">"!==t.substring(i+h.parsed,i+h.parsed+1))return void this.onError(s.UnterminatedElement);this.onBeginElement(h.name,h.attributes,c),i+=h.parsed+(c?2:1)}}else{for(;i<t.length&&"<"!==t[i];)i++;var u=t.substring(e,i);this.onText(this._resolveEntities(u))}e=i}}},{key:"onResolveEntity",value:function(t){return"&"+t+";"}},{key:"onPi",value:function(t,e){}},{key:"onComment",value:function(t){}},{key:"onCdata",value:function(t){}},{key:"onDoctype",value:function(t){}},{key:"onText",value:function(t){}},{key:"onBeginElement",value:function(t,e,i){}},{key:"onEndElement",value:function(t){}},{key:"onError",value:function(t){}}]),t}(),h=function(){function t(e,i){o(this,t),this.nodeName=e,this.nodeValue=i,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}return r(t,[{key:"hasChildNodes",value:function(){return this.childNodes&&this.childNodes.length>0}},{key:"firstChild",get:function(){return this.childNodes[0]}},{key:"nextSibling",get:function(){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]}},{key:"textContent",get:function(){return this.childNodes?this.childNodes.map(function(t){return t.textContent}).join(""):this.nodeValue||""}}]),t}(),c=function(t){function e(){o(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._currentFragment=null,t._stack=null,t._errorCode=s.NoError,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,l),r(e,[{key:"parseFromString",value:function(t){if(this._currentFragment=[],this._stack=[],this._errorCode=s.NoError,this.parseXml(t),this._errorCode===s.NoError){var e=n(this._currentFragment,1)[0];if(e)return{documentElement:e}}}},{key:"onResolveEntity",value:function(t){switch(t){case"apos":return"'"}return function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"onResolveEntity",this).call(this,t)}},{key:"onText",value:function(t){if(!function(t){for(var e=0,i=t.length;e<i;e++)if(!a(t,e))return!1;return!0}(t)){var e=new h("#text",t);this._currentFragment.push(e)}}},{key:"onCdata",value:function(t){var e=new h("#text",t);this._currentFragment.push(e)}},{key:"onBeginElement",value:function(t,e,i){var n=new h(t);n.childNodes=[],this._currentFragment.push(n),i||(this._stack.push(this._currentFragment),this._currentFragment=n.childNodes)}},{key:"onEndElement",value:function(t){this._currentFragment=this._stack.pop();for(var e=this._currentFragment[this._currentFragment.length-1],i=0,n=e.childNodes.length;i<n;i++)e.childNodes[i].parentNode=e}},{key:"onError",value:function(t){this._errorCode=t}}]),e}();e.SimpleXMLParser=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n,r=i(137),o=(n=r)&&n.__esModule?n:{default:n},s=i(1);function a(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var s=e[r](o),a=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}var l=function(){function t(t,e){var i=this;(0,s.assert)(e),this._queuedChunks=[];var n=t.initialData;if(n&&n.length>0){var r=new Uint8Array(n).buffer;this._queuedChunks.push(r)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._contentLength=t.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(function(t,e){i._onReceiveData({begin:t,chunk:e})}),this._pdfDataRangeTransport.addProgressListener(function(t){i._onProgress({loaded:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(function(t){i._onReceiveData({chunk:t})}),this._pdfDataRangeTransport.transportReady()}function e(t,e){this._stream=t,this._done=!1,this._filename=null,this._queuedChunks=e||[],this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}function i(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}return t.prototype={_onReceiveData:function(t){var e=new Uint8Array(t.chunk).buffer;if(void 0===t.begin)this._fullRequestReader?this._fullRequestReader._enqueue(e):this._queuedChunks.push(e);else{var i=this._rangeReaders.some(function(i){return i._begin===t.begin&&(i._enqueue(e),!0)});(0,s.assert)(i)}},_onProgress:function(t){if(this._rangeReaders.length>0){var e=this._rangeReaders[0];e.onProgress&&e.onProgress({loaded:t.loaded})}},_removeRangeReader:function(t){var e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)},getFullReader:function(){(0,s.assert)(!this._fullRequestReader);var t=this._queuedChunks;return this._queuedChunks=null,new e(this,t)},getRangeReader:function(t,e){var n=new i(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n},cancelAllRequests:function(t){this._fullRequestReader&&this._fullRequestReader.cancel(t),this._rangeReaders.slice(0).forEach(function(e){e.cancel(t)}),this._pdfDataRangeTransport.abort()}},e.prototype={_enqueue:function(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t))},get headersReady(){return this._headersReady},get filename(){return this._filename},get isRangeSupported(){return this._stream._isRangeSupported},get isStreamingSupported(){return this._stream._isStreamingSupported},get contentLength(){return this._stream._contentLength},read:function(){var t=a(o.default.mark(function t(){var e,i;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this._queuedChunks.length>0)){t.next=3;break}return e=this._queuedChunks.shift(),t.abrupt("return",{value:e,done:!1});case 3:if(!this._done){t.next=5;break}return t.abrupt("return",{value:void 0,done:!0});case 5:return i=(0,s.createPromiseCapability)(),this._requests.push(i),t.abrupt("return",i.promise);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),cancel:function(t){this._done=!0,this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[]}},i.prototype={_enqueue:function(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else this._requests.shift().resolve({value:t,done:!1}),this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[];this._done=!0,this._stream._removeRangeReader(this)}},get isStreamingSupported(){return!1},read:function(){var t=a(o.default.mark(function t(){var e,i;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._queuedChunk){t.next=4;break}return e=this._queuedChunk,this._queuedChunk=null,t.abrupt("return",{value:e,done:!1});case 4:if(!this._done){t.next=6;break}return t.abrupt("return",{value:void 0,done:!0});case 6:return i=(0,s.createPromiseCapability)(),this._requests.push(i),t.abrupt("return",i.promise);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),cancel:function(t){this._done=!0,this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[],this._stream._removeRangeReader(this)}},t}();e.PDFDataTransportStream=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLContext=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1);var o=function(){function t(e){var i=e.enable,n=void 0!==i&&i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._enabled=!0===n}return n(t,[{key:"composeSMask",value:function(t){var e=t.layer,i=t.mask,n=t.properties;return s.composeSMask(e,i,n)}},{key:"drawFigures",value:function(t){var e=t.width,i=t.height,n=t.backgroundColor,r=t.figures,o=t.context;return s.drawFigures(e,i,n,r,o)}},{key:"clear",value:function(){s.cleanup()}},{key:"isEnabled",get:function(){var t=this._enabled;return t&&(t=s.tryInitGL()),(0,r.shadow)(this,"isEnabled",t)}}]),t}(),s=function(){function t(t,e,i){var n=t.createShader(i);if(t.shaderSource(n,e),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(n);throw new Error("Error during shader compilation: "+r)}return n}function e(e,i){return t(e,i,e.VERTEX_SHADER)}function i(e,i){return t(e,i,e.FRAGMENT_SHADER)}function n(t,e){for(var i=t.createProgram(),n=0,r=e.length;n<r;++n)t.attachShader(i,e[n]);if(t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var o=t.getProgramInfoLog(i);throw new Error("Error during program linking: "+o)}return i}function r(t,e,i){t.activeTexture(i);var n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),n}var o,s;function a(){o||(s=document.createElement("canvas"),o=s.getContext("webgl",{premultipliedalpha:!1}))}var l="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",h="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",c=null;var u="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",d="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",p=null;return{tryInitGL:function(){try{return a(),!!o}catch(t){}return!1},composeSMask:function(t,u,d){var p=t.width,f=t.height;c||function(){var t,r;a(),t=s,s=null,r=o,o=null;var u=n(r,[e(r,l),i(r,h)]);r.useProgram(u);var d={};d.gl=r,d.canvas=t,d.resolutionLocation=r.getUniformLocation(u,"u_resolution"),d.positionLocation=r.getAttribLocation(u,"a_position"),d.backdropLocation=r.getUniformLocation(u,"u_backdrop"),d.subtypeLocation=r.getUniformLocation(u,"u_subtype");var p=r.getAttribLocation(u,"a_texCoord"),f=r.getUniformLocation(u,"u_image"),m=r.getUniformLocation(u,"u_mask"),g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),r.STATIC_DRAW),r.enableVertexAttribArray(p),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0),r.uniform1i(f,0),r.uniform1i(m,1),c=d}();var m=c,g=m.canvas,v=m.gl;g.width=p,g.height=f,v.viewport(0,0,v.drawingBufferWidth,v.drawingBufferHeight),v.uniform2f(m.resolutionLocation,p,f),d.backdrop?v.uniform4f(m.resolutionLocation,d.backdrop[0],d.backdrop[1],d.backdrop[2],1):v.uniform4f(m.resolutionLocation,0,0,0,0),v.uniform1i(m.subtypeLocation,"Luminosity"===d.subtype?1:0);var _=r(v,t,v.TEXTURE0),y=r(v,u,v.TEXTURE1),b=v.createBuffer();return v.bindBuffer(v.ARRAY_BUFFER,b),v.bufferData(v.ARRAY_BUFFER,new Float32Array([0,0,p,0,0,f,0,f,p,0,p,f]),v.STATIC_DRAW),v.enableVertexAttribArray(m.positionLocation),v.vertexAttribPointer(m.positionLocation,2,v.FLOAT,!1,0,0),v.clearColor(0,0,0,0),v.enable(v.BLEND),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.clear(v.COLOR_BUFFER_BIT),v.drawArrays(v.TRIANGLES,0,6),v.flush(),v.deleteTexture(_),v.deleteTexture(y),v.deleteBuffer(b),g},drawFigures:function(t,r,l,h,c){p||function(){var t,r;a(),t=s,s=null,r=o,o=null;var l=n(r,[e(r,u),i(r,d)]);r.useProgram(l);var h={};h.gl=r,h.canvas=t,h.resolutionLocation=r.getUniformLocation(l,"u_resolution"),h.scaleLocation=r.getUniformLocation(l,"u_scale"),h.offsetLocation=r.getUniformLocation(l,"u_offset"),h.positionLocation=r.getAttribLocation(l,"a_position"),h.colorLocation=r.getAttribLocation(l,"a_color"),p=h}();var f=p,m=f.canvas,g=f.gl;m.width=t,m.height=r,g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight),g.uniform2f(f.resolutionLocation,t,r);var v,_,y,b=0;for(v=0,_=h.length;v<_;v++)switch(h[v].type){case"lattice":b+=((y=h[v].coords.length/h[v].verticesPerRow|0)-1)*(h[v].verticesPerRow-1)*6;break;case"triangles":b+=h[v].coords.length}var w=new Float32Array(2*b),S=new Uint8Array(3*b),x=c.coords,T=c.colors,E=0,P=0;for(v=0,_=h.length;v<_;v++){var C=h[v],L=C.coords,k=C.colors;switch(C.type){case"lattice":var A=C.verticesPerRow;y=L.length/A|0;for(var R=1;R<y;R++)for(var I=R*A+1,O=1;O<A;O++,I++)w[E]=x[L[I-A-1]],w[E+1]=x[L[I-A-1]+1],w[E+2]=x[L[I-A]],w[E+3]=x[L[I-A]+1],w[E+4]=x[L[I-1]],w[E+5]=x[L[I-1]+1],S[P]=T[k[I-A-1]],S[P+1]=T[k[I-A-1]+1],S[P+2]=T[k[I-A-1]+2],S[P+3]=T[k[I-A]],S[P+4]=T[k[I-A]+1],S[P+5]=T[k[I-A]+2],S[P+6]=T[k[I-1]],S[P+7]=T[k[I-1]+1],S[P+8]=T[k[I-1]+2],w[E+6]=w[E+2],w[E+7]=w[E+3],w[E+8]=w[E+4],w[E+9]=w[E+5],w[E+10]=x[L[I]],w[E+11]=x[L[I]+1],S[P+9]=S[P+3],S[P+10]=S[P+4],S[P+11]=S[P+5],S[P+12]=S[P+6],S[P+13]=S[P+7],S[P+14]=S[P+8],S[P+15]=T[k[I]],S[P+16]=T[k[I]+1],S[P+17]=T[k[I]+2],E+=12,P+=18;break;case"triangles":for(var M=0,D=L.length;M<D;M++)w[E]=x[L[M]],w[E+1]=x[L[M]+1],S[P]=T[k[M]],S[P+1]=T[k[M]+1],S[P+2]=T[k[M]+2],E+=2,P+=3}}l?g.clearColor(l[0]/255,l[1]/255,l[2]/255,1):g.clearColor(0,0,0,0),g.clear(g.COLOR_BUFFER_BIT);var z=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,z),g.bufferData(g.ARRAY_BUFFER,w,g.STATIC_DRAW),g.enableVertexAttribArray(f.positionLocation),g.vertexAttribPointer(f.positionLocation,2,g.FLOAT,!1,0,0);var F=g.createBuffer();return g.bindBuffer(g.ARRAY_BUFFER,F),g.bufferData(g.ARRAY_BUFFER,S,g.STATIC_DRAW),g.enableVertexAttribArray(f.colorLocation),g.vertexAttribPointer(f.colorLocation,3,g.UNSIGNED_BYTE,!1,0,0),g.uniform2f(f.scaleLocation,c.scaleX,c.scaleY),g.uniform2f(f.offsetLocation,c.offsetX,c.offsetY),g.drawArrays(g.TRIANGLES,0,b),g.flush(),g.deleteBuffer(z),g.deleteBuffer(F),m},cleanup:function(){c&&c.canvas&&(c.canvas.width=0,c.canvas.height=0),p&&p.canvas&&(p.canvas.width=0,p.canvas.height=0),c=null,p=null}}}();e.WebGLContext=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.renderTextLayer=void 0;var n,r=i(1),o=i(3),s=(n=o)&&n.__esModule?n:{default:n};var a=function(){var t=1e5,e=/\S/;var i=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];function n(t,n,o){var s,a=document.createElement("div"),l={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(t._textDivs.push(a),s=n.str,!e.test(s))return l.isWhitespace=!0,void t._textDivProperties.set(a,l);var h=r.Util.transform(t._viewport.transform,n.transform),c=Math.atan2(h[1],h[0]),u=o[n.fontName];u.vertical&&(c+=Math.PI/2);var d,p,f=Math.sqrt(h[2]*h[2]+h[3]*h[3]),m=f;if(u.ascent?m=u.ascent*m:u.descent&&(m=(1+u.descent)*m),0===c?(d=h[4],p=h[5]-m):(d=h[4]+m*Math.sin(c),p=h[5]-m*Math.cos(c)),i[1]=d,i[3]=p,i[5]=f,i[7]=u.fontFamily,l.style=i.join(""),a.setAttribute("style",l.style),a.textContent=n.str,t._fontInspectorEnabled&&(a.dataset.fontName=n.fontName),0!==c&&(l.angle=c*(180/Math.PI)),n.str.length>1&&(u.vertical?l.canvasWidth=n.height*t._viewport.scale:l.canvasWidth=n.width*t._viewport.scale),t._textDivProperties.set(a,l),t._textContentStream&&t._layoutText(a),t._enhanceTextSelection){var g=1,v=0;0!==c&&(g=Math.cos(c),v=Math.sin(c));var _,y,b=(u.vertical?n.height:n.width)*t._viewport.scale,w=f;0!==c?(_=[g,v,-v,g,d,p],y=r.Util.getAxialAlignedBoundingBox([0,0,b,w],_)):y=[d,p,d+b,p+w],t._bounds.push({left:y[0],top:y[1],right:y[2],bottom:y[3],div:a,size:[b,w],m:_})}}function o(e){if(!e._canceled){var i=e._textDivs,n=e._capability,r=i.length;if(r>t)return e._renderingDone=!0,void n.resolve();if(!e._textContentStream)for(var o=0;o<r;o++)e._layoutText(i[o]);e._renderingDone=!0,n.resolve()}}function a(t){for(var e=t._bounds,i=t._viewport,n=function(t,e,i){var n=i.map(function(t,e){return{x1:t.left,y1:t.top,x2:t.right,y2:t.bottom,index:e,x1New:void 0,x2New:void 0}});l(t,n);var r=new Array(i.length);return n.forEach(function(t){var e=t.index;r[e]={left:t.x1New,top:0,right:t.x2New,bottom:0}}),i.map(function(e,i){var o=r[i],s=n[i];s.x1=e.top,s.y1=t-o.right,s.x2=e.bottom,s.y2=t-o.left,s.index=i,s.x1New=void 0,s.x2New=void 0}),l(e,n),n.forEach(function(t){var e=t.index;r[e].top=t.x1New,r[e].bottom=t.x2New}),r}(i.width,i.height,e),o=0;o<n.length;o++){var s=e[o].div,a=t._textDivProperties.get(s);if(0!==a.angle){var h=n[o],c=e[o],u=c.m,d=u[0],p=u[1],f=[[0,0],[0,c.size[1]],[c.size[0],0],c.size],m=new Float64Array(64);f.forEach(function(t,e){var i=r.Util.applyTransform(t,u);m[e+0]=d&&(h.left-i[0])/d,m[e+4]=p&&(h.top-i[1])/p,m[e+8]=d&&(h.right-i[0])/d,m[e+12]=p&&(h.bottom-i[1])/p,m[e+16]=p&&(h.left-i[0])/-p,m[e+20]=d&&(h.top-i[1])/d,m[e+24]=p&&(h.right-i[0])/-p,m[e+28]=d&&(h.bottom-i[1])/d,m[e+32]=d&&(h.left-i[0])/-d,m[e+36]=p&&(h.top-i[1])/-p,m[e+40]=d&&(h.right-i[0])/-d,m[e+44]=p&&(h.bottom-i[1])/-p,m[e+48]=p&&(h.left-i[0])/p,m[e+52]=d&&(h.top-i[1])/-d,m[e+56]=p&&(h.right-i[0])/p,m[e+60]=d&&(h.bottom-i[1])/-d});var g=function(t,e,i){for(var n=0,r=0;r<i;r++){var o=t[e++];o>0&&(n=n?Math.min(o,n):o)}return n},v=1+Math.min(Math.abs(d),Math.abs(p));a.paddingLeft=g(m,32,16)/v,a.paddingTop=g(m,48,16)/v,a.paddingRight=g(m,0,16)/v,a.paddingBottom=g(m,16,16)/v,t._textDivProperties.set(s,a)}else a.paddingLeft=e[o].left-n[o].left,a.paddingTop=e[o].top-n[o].top,a.paddingRight=n[o].right-e[o].right,a.paddingBottom=n[o].bottom-e[o].bottom,t._textDivProperties.set(s,a)}}function l(t,e){e.sort(function(t,e){return t.x1-e.x1||t.index-e.index});var i=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];e.forEach(function(t){for(var e=0;e<i.length&&i[e].end<=t.y1;)e++;for(var n,r,o=i.length-1;o>=0&&i[o].start>=t.y2;)o--;var s,a,l=-1/0;for(s=e;s<=o;s++){var h;(h=(r=(n=i[s]).boundary).x2>t.x1?r.index>t.index?r.x1New:t.x1:void 0===r.x2New?(r.x2+t.x1)/2:r.x2New)>l&&(l=h)}for(t.x1New=l,s=e;s<=o;s++)void 0===(r=(n=i[s]).boundary).x2New?r.x2>t.x1?r.index>t.index&&(r.x2New=r.x2):r.x2New=l:r.x2New>l&&(r.x2New=Math.max(l,r.x2));var c=[],u=null;for(s=e;s<=o;s++){var d=(r=(n=i[s]).boundary).x2>t.x2?r:t;u===d?c[c.length-1].end=n.end:(c.push({start:n.start,end:n.end,boundary:d}),u=d)}for(i[e].start<t.y1&&(c[0].start=t.y1,c.unshift({start:i[e].start,end:t.y1,boundary:i[e].boundary})),t.y2<i[o].end&&(c[c.length-1].end=t.y2,c.push({start:t.y2,end:i[o].end,boundary:i[o].boundary})),s=e;s<=o;s++)if(void 0===(r=(n=i[s]).boundary).x2New){var p=!1;for(a=e-1;!p&&a>=0&&i[a].start>=r.y1;a--)p=i[a].boundary===r;for(a=o+1;!p&&a<i.length&&i[a].end<=r.y2;a++)p=i[a].boundary===r;for(a=0;!p&&a<c.length;a++)p=c[a].boundary===r;p||(r.x2New=l)}Array.prototype.splice.apply(i,[e,o-e+1].concat(c))}),i.forEach(function(e){var i=e.boundary;void 0===i.x2New&&(i.x2New=Math.max(t,i.x2))})}function h(t){var e=t.textContent,i=t.textContentStream,n=t.container,o=t.viewport,a=t.textDivs,l=t.textContentItemsStr,h=t.enhanceTextSelection;this._textContent=e,this._textContentStream=i,this._container=n,this._viewport=o,this._textDivs=a||[],this._textContentItemsStr=l||[],this._enhanceTextSelection=!!h,this._fontInspectorEnabled=!(!s.default.FontInspector||!s.default.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._renderTimer=null,this._bounds=[]}return h.prototype={get promise(){return this._capability.promise},cancel:function(){this._reader&&(this._reader.cancel(new r.AbortException("text layer task cancelled")),this._reader=null),this._canceled=!0,null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_processItems:function(t,e){for(var i=0,r=t.length;i<r;i++)this._textContentItemsStr.push(t[i].str),n(this,t[i],e)},_layoutText:function(t){var e=this._container,i=this._textDivProperties.get(t);if(!i.isWhitespace){var n=t.style.fontSize,r=t.style.fontFamily;n===this._layoutTextLastFontSize&&r===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=n+" "+r,this._layoutTextLastFontSize=n,this._layoutTextLastFontFamily=r);var o=this._layoutTextCtx.measureText(t.textContent).width,s="";0!==i.canvasWidth&&o>0&&(i.scale=i.canvasWidth/o,s="scaleX("+i.scale+")"),0!==i.angle&&(s="rotate("+i.angle+"deg) "+s),""!==s&&(i.originalTransform=s,t.style.transform=s),this._textDivProperties.set(t,i),e.appendChild(t)}},_render:function(t){var e=this,i=(0,r.createPromiseCapability)(),n=Object.create(null),s=document.createElement("canvas");if(s.mozOpaque=!0,this._layoutTextCtx=s.getContext("2d",{alpha:!1}),this._textContent){var a=this._textContent.items,l=this._textContent.styles;this._processItems(a,l),i.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function t(){e._reader.read().then(function(r){var o=r.value;r.done?i.resolve():(Object.assign(n,o.styles),e._processItems(o.items,n),t())},i.reject)}()}i.promise.then(function(){n=null,t?e._renderTimer=setTimeout(function(){o(e),e._renderTimer=null},t):o(e)},this._capability.reject)},expandTextDivs:function(t){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(a(this),this._bounds=null);for(var e=0,i=this._textDivs.length;e<i;e++){var n=this._textDivs[e],r=this._textDivProperties.get(n);if(!r.isWhitespace)if(t){var o="",s="";1!==r.scale&&(o="scaleX("+r.scale+")"),0!==r.angle&&(o="rotate("+r.angle+"deg) "+o),0!==r.paddingLeft&&(s+=" padding-left: "+r.paddingLeft/r.scale+"px;",o+=" translateX("+-r.paddingLeft/r.scale+"px)"),0!==r.paddingTop&&(s+=" padding-top: "+r.paddingTop+"px;",o+=" translateY("+-r.paddingTop+"px)"),0!==r.paddingRight&&(s+=" padding-right: "+r.paddingRight/r.scale+"px;"),0!==r.paddingBottom&&(s+=" padding-bottom: "+r.paddingBottom+"px;"),""!==s&&n.setAttribute("style",r.style+s),""!==o&&(n.style.transform=o)}else n.style.padding=0,n.style.transform=r.originalTransform||""}}}},function(t){var e=new h({textContent:t.textContent,textContentStream:t.textContentStream,container:t.container,viewport:t.viewport,textDivs:t.textDivs,textContentItemsStr:t.textContentItemsStr,enhanceTextSelection:t.enhanceTextSelection});return e._render(t.timeout),e}}();e.renderTextLayer=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationLayer=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(130),o=i(1);function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var h=function(){function t(){l(this,t)}return n(t,null,[{key:"create",value:function(t){switch(t.data.annotationType){case o.AnnotationType.LINK:return new u(t);case o.AnnotationType.TEXT:return new d(t);case o.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new f(t);case"Btn":return t.data.radioButton?new g(t):t.data.checkBox?new m(t):new v(t);case"Ch":return new _(t)}return new p(t);case o.AnnotationType.POPUP:return new y(t);case o.AnnotationType.LINE:return new w(t);case o.AnnotationType.SQUARE:return new S(t);case o.AnnotationType.CIRCLE:return new x(t);case o.AnnotationType.POLYLINE:return new T(t);case o.AnnotationType.INK:return new P(t);case o.AnnotationType.POLYGON:return new E(t);case o.AnnotationType.HIGHLIGHT:return new C(t);case o.AnnotationType.UNDERLINE:return new L(t);case o.AnnotationType.SQUIGGLY:return new k(t);case o.AnnotationType.STRIKEOUT:return new A(t);case o.AnnotationType.STAMP:return new R(t);case o.AnnotationType.FILEATTACHMENT:return new I(t);default:return new c(t)}}}]),t}(),c=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l(this,t),this.isRenderable=i,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderInteractiveForms=e.renderInteractiveForms,this.svgFactory=e.svgFactory,i&&(this.container=this._createContainer(n))}return n(t,[{key:"_createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.data,i=this.page,n=this.viewport,r=document.createElement("section"),s=e.rect[2]-e.rect[0],a=e.rect[3]-e.rect[1];r.setAttribute("data-annotation-id",e.id);var l=o.Util.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]);if(r.style.transform="matrix("+n.transform.join(",")+")",r.style.transformOrigin=-l[0]+"px "+-l[1]+"px",!t&&e.borderStyle.width>0){r.style.borderWidth=e.borderStyle.width+"px",e.borderStyle.style!==o.AnnotationBorderStyleType.UNDERLINE&&(s-=2*e.borderStyle.width,a-=2*e.borderStyle.width);var h=e.borderStyle.horizontalCornerRadius,c=e.borderStyle.verticalCornerRadius;if(h>0||c>0){var u=h+"px / "+c+"px";r.style.borderRadius=u}switch(e.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:r.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:r.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:r.style.borderBottomStyle="solid"}e.color?r.style.borderColor=o.Util.makeCssRgb(0|e.color[0],0|e.color[1],0|e.color[2]):r.style.borderWidth=0}return r.style.left=l[0]+"px",r.style.top=l[1]+"px",r.style.width=s+"px",r.style.height=a+"px",r}},{key:"_createPopup",value:function(t,e,i){e||((e=document.createElement("div")).style.height=t.style.height,e.style.width=t.style.width,t.appendChild(e));var n=new b({container:t,trigger:e,color:i.color,title:i.title,contents:i.contents,hideWrapper:!0}).render();n.style.left=t.style.width,t.appendChild(n)}},{key:"render",value:function(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}}]),t}(),u=function(t){function e(t){l(this,e);var i=!!(t.data.url||t.data.dest||t.data.action);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="linkAnnotation";var t=this.data,e=this.linkService,i=document.createElement("a");return(0,r.addLinkAttributes)(i,{url:t.url,target:t.newWindow?r.LinkTarget.BLANK:e.externalLinkTarget,rel:e.externalLinkRel}),t.url||(t.action?this._bindNamedAction(i,t.action):this._bindLink(i,t.dest)),this.container.appendChild(i),this.container}},{key:"_bindLink",value:function(t,e){var i=this;t.href=this.linkService.getDestinationHash(e),t.onclick=function(){return e&&i.linkService.navigateTo(e),!1},e&&(t.className="internalLink")}},{key:"_bindNamedAction",value:function(t,e){var i=this;t.href=this.linkService.getAnchorUrl(""),t.onclick=function(){return i.linkService.executeNamedAction(e),!1},t.className="internalLink"}}]),e}(),d=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="textAnnotation";var t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container}}]),e}(),p=function(t){function e(){return l(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,c),n(e,[{key:"render",value:function(){return this.container}}]),e}(),f=function(t){function e(t){l(this,e);var i=t.renderInteractiveForms||!t.data.hasAppearance&&!!t.data.fieldValue;return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return a(e,p),n(e,[{key:"render",value:function(){this.container.className="textWidgetAnnotation";var t=null;if(this.renderInteractiveForms){if(this.data.multiLine?(t=document.createElement("textarea")).textContent=this.data.fieldValue:((t=document.createElement("input")).type="text",t.setAttribute("value",this.data.fieldValue)),t.disabled=this.data.readOnly,null!==this.data.maxLen&&(t.maxLength=this.data.maxLen),this.data.comb){var e=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;t.classList.add("comb"),t.style.letterSpacing="calc("+e+"px - 1ch)"}}else{(t=document.createElement("div")).textContent=this.data.fieldValue,t.style.verticalAlign="middle",t.style.display="table-cell";var i=null;this.data.fontRefName&&(i=this.page.commonObjs.getData(this.data.fontRefName)),this._setTextStyle(t,i)}return null!==this.data.textAlignment&&(t.style.textAlign=["left","center","right"][this.data.textAlignment]),this.container.appendChild(t),this.container}},{key:"_setTextStyle",value:function(t,e){var i=t.style;if(i.fontSize=this.data.fontSize+"px",i.direction=this.data.fontDirection<0?"rtl":"ltr",e){i.fontWeight=e.black?e.bold?"900":"bold":e.bold?"bold":"normal",i.fontStyle=e.italic?"italic":"normal";var n=e.loadedName?'"'+e.loadedName+'", ':"",r=e.fallbackName||"Helvetica, sans-serif";i.fontFamily=n+r}}}]),e}(),m=function(t){function e(t){return l(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,t.renderInteractiveForms))}return a(e,p),n(e,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation checkBox";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}]),e}(),g=function(t){function e(t){return l(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,t.renderInteractiveForms))}return a(e,p),n(e,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation radioButton";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="radio",t.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}]),e}(),v=function(t){function e(){return l(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,u),n(e,[{key:"render",value:function(){var t=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"render",this).call(this);return t.className="buttonWidgetAnnotation pushButton",t}}]),e}(),_=function(t){function e(t){return l(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,t.renderInteractiveForms))}return a(e,p),n(e,[{key:"render",value:function(){this.container.className="choiceWidgetAnnotation";var t=document.createElement("select");t.disabled=this.data.readOnly,this.data.combo||(t.size=this.data.options.length,this.data.multiSelect&&(t.multiple=!0));for(var e=0,i=this.data.options.length;e<i;e++){var n=this.data.options[e],r=document.createElement("option");r.textContent=n.displayValue,r.value=n.exportValue,this.data.fieldValue.includes(n.displayValue)&&r.setAttribute("selected",!0),t.appendChild(r)}return this.container.appendChild(t),this.container}}]),e}(),y=function(t){function e(t){l(this,e);var i=!(!t.data.title&&!t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return a(e,c),n(e,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var t='[data-annotation-id="'+this.data.parentId+'"]',e=this.layer.querySelector(t);if(!e)return this.container;var i=new b({container:this.container,trigger:e,color:this.data.color,title:this.data.title,contents:this.data.contents}),n=parseFloat(e.style.left),r=parseFloat(e.style.width);return this.container.style.transformOrigin=-(n+r)+"px -"+e.style.top,this.container.style.left=n+r+"px",this.container.appendChild(i.render()),this.container}}]),e}(),b=function(){function t(e){l(this,t),this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.title=e.title,this.contents=e.contents,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}return n(t,[{key:"render",value:function(){var t=document.createElement("div");t.className="popupWrapper",this.hideElement=this.hideWrapper?t:this.container,this.hideElement.setAttribute("hidden",!0);var e=document.createElement("div");e.className="popup";var i=this.color;if(i){var n=.7*(255-i[0])+i[0],r=.7*(255-i[1])+i[1],s=.7*(255-i[2])+i[2];e.style.backgroundColor=o.Util.makeCssRgb(0|n,0|r,0|s)}var a=this._formatContents(this.contents),l=document.createElement("h1");return l.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),e.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(l),e.appendChild(a),t.appendChild(e),t}},{key:"_formatContents",value:function(t){for(var e=document.createElement("p"),i=t.split(/(?:\r\n?|\n)/),n=0,r=i.length;n<r;++n){var o=i[n];e.appendChild(document.createTextNode(o)),n<r-1&&e.appendChild(document.createElement("br"))}return e}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}},{key:"_hide",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}]),t}(),w=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="lineAnnotation";var t=this.data,e=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],n=this.svgFactory.create(e,i),r=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width),r.setAttribute("stroke","transparent"),n.appendChild(r),this.container.append(n),this._createPopup(this.container,r,t),this.container}}]),e}(),S=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="squareAnnotation";var t=this.data,e=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],n=this.svgFactory.create(e,i),r=t.borderStyle.width,o=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",e-r),o.setAttribute("height",i-r),o.setAttribute("stroke-width",r),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),n.appendChild(o),this.container.append(n),this._createPopup(this.container,o,t),this.container}}]),e}(),x=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="circleAnnotation";var t=this.data,e=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],n=this.svgFactory.create(e,i),r=t.borderStyle.width,o=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-r/2),o.setAttribute("ry",i/2-r/2),o.setAttribute("stroke-width",r),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),n.appendChild(o),this.container.append(n),this._createPopup(this.container,o,t),this.container}}]),e}(),T=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents),n=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0));return n.containerClassName="polylineAnnotation",n.svgElementName="svg:polyline",n}return a(e,c),n(e,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var t=this.data,e=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],n=this.svgFactory.create(e,i),r=t.vertices,o=[],s=0,a=r.length;s<a;s++){var l=r[s].x-t.rect[0],h=t.rect[3]-r[s].y;o.push(l+","+h)}o=o.join(" ");var c=t.borderStyle.width,u=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",o),u.setAttribute("stroke-width",c),u.setAttribute("stroke","transparent"),u.setAttribute("fill","none"),n.appendChild(u),this.container.append(n),this._createPopup(this.container,u,t),this.container}}]),e}(),E=function(t){function e(t){l(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.containerClassName="polygonAnnotation",i.svgElementName="svg:polygon",i}return a(e,T),e}(),P=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents),n=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0));return n.containerClassName="inkAnnotation",n.svgElementName="svg:polyline",n}return a(e,c),n(e,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var t=this.data,e=t.rect[2]-t.rect[0],i=t.rect[3]-t.rect[1],n=this.svgFactory.create(e,i),r=t.inkLists,o=0,s=r.length;o<s;o++){for(var a=r[o],l=[],h=0,c=a.length;h<c;h++){var u=a[h].x-t.rect[0],d=t.rect[3]-a[h].y;l.push(u+","+d)}l=l.join(" ");var p=t.borderStyle.width,f=this.svgFactory.createElement(this.svgElementName);f.setAttribute("points",l),f.setAttribute("stroke-width",p),f.setAttribute("stroke","transparent"),f.setAttribute("fill","none"),this._createPopup(this.container,f,t),n.appendChild(f)}return this.container.append(n),this.container}}]),e}(),C=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),e}(),L=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),e}(),k=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),e}(),A=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),e}(),R=function(t){function e(t){l(this,e);var i=!!(t.data.hasPopup||t.data.title||t.data.contents);return s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,!0))}return a(e,c),n(e,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),e}(),I=function(t){function e(t){l(this,e);var i=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,!0)),n=i.data.file,a=n.filename,h=n.content;return i.filename=(0,r.getFilenameFromUrl)(a),i.content=h,i.linkService.eventBus&&i.linkService.eventBus.dispatch("fileattachmentannotation",{source:i,id:(0,o.stringToPDFString)(a),filename:a,content:h}),i}return a(e,c),n(e,[{key:"render",value:function(){this.container.className="fileAttachmentAnnotation";var t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container}},{key:"_download",value:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,o.warn)("Download cannot be started due to unavailable download manager")}}]),e}(),O=function(){function t(){l(this,t)}return n(t,null,[{key:"render",value:function(t){for(var e=0,i=t.annotations.length;e<i;e++){var n=t.annotations[e];if(n){var o=h.create({data:n,layer:t.div,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderInteractiveForms:t.renderInteractiveForms||!1,svgFactory:new r.DOMSVGFactory});o.isRenderable&&t.div.appendChild(o.render())}}}},{key:"update",value:function(t){for(var e=0,i=t.annotations.length;e<i;e++){var n=t.annotations[e],r=t.div.querySelector('[data-annotation-id="'+n.id+'"]');r&&(r.style.transform="matrix("+t.viewport.transform.join(",")+")")}t.div.removeAttribute("hidden")}}]),t}();e.AnnotationLayer=O},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n,r=i(1),o=i(130),s=i(4),a=(n=s)&&n.__esModule?n:{default:n};var l,h={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},c=function(){for(var t=new Uint8Array([137,80,78,71,13,10,26,10]),e=12,i=new Int32Array(256),n=0;n<256;n++){for(var o=n,s=0;s<8;s++)o=1&o?3988292384^o>>1&2147483647:o>>1&2147483647;i[n]=o}function l(t,e,n,r){var o=r,s=e.length;n[o]=s>>24&255,n[o+1]=s>>16&255,n[o+2]=s>>8&255,n[o+3]=255&s,n[o+=4]=255&t.charCodeAt(0),n[o+1]=255&t.charCodeAt(1),n[o+2]=255&t.charCodeAt(2),n[o+3]=255&t.charCodeAt(3),o+=4,n.set(e,o);var a=function(t,e,n){for(var r=-1,o=e;o<n;o++){var s=255&(r^t[o]);r=r>>>8^i[s]}return-1^r}(n,r+4,o+=e.length);n[o]=a>>24&255,n[o+1]=a>>16&255,n[o+2]=a>>8&255,n[o+3]=255&a}function h(t){var e=t.length,i=Math.ceil(e/65535),n=new Uint8Array(2+e+5*i+4),r=0;n[r++]=120,n[r++]=156;for(var o=0;e>65535;)n[r++]=0,n[r++]=255,n[r++]=255,n[r++]=0,n[r++]=0,n.set(t.subarray(o,o+65535),r),r+=65535,o+=65535,e-=65535;n[r++]=1,n[r++]=255&e,n[r++]=e>>8&255,n[r++]=255&~e,n[r++]=(65535&~e)>>8&255,n.set(t.subarray(o),r),r+=t.length-o;var s=function(t,e,i){for(var n=1,r=0,o=e;o<i;++o)r=(r+(n=(n+(255&t[o]))%65521))%65521;return r<<16|n}(t,0,t.length);return n[r++]=s>>24&255,n[r++]=s>>16&255,n[r++]=s>>8&255,n[r++]=255&s,n}function c(i,n,o,s){var c,u,d,p=i.width,f=i.height,m=i.data;switch(n){case r.ImageKind.GRAYSCALE_1BPP:u=0,c=1,d=p+7>>3;break;case r.ImageKind.RGB_24BPP:u=2,c=8,d=3*p;break;case r.ImageKind.RGBA_32BPP:u=6,c=8,d=4*p;break;default:throw new Error("invalid format")}var g,v,_=new Uint8Array((1+d)*f),y=0,b=0;for(g=0;g<f;++g)_[y++]=0,_.set(m.subarray(b,b+d),y),b+=d,y+=d;if(n===r.ImageKind.GRAYSCALE_1BPP&&s)for(y=0,g=0;g<f;g++)for(y++,v=0;v<d;v++)_[y++]^=255;var w=new Uint8Array([p>>24&255,p>>16&255,p>>8&255,255&p,f>>24&255,f>>16&255,f>>8&255,255&f,c,u,0,0,0]),S=function(t){if(!(0,a.default)())return h(t);try{var e;e=parseInt(process.versions.node)>=8?t:new Buffer(t);var i=require("zlib").deflateSync(e,{level:9});return i instanceof Uint8Array?i:new Uint8Array(i)}catch(t){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return h(t)}(_),x=t.length+3*e+w.length+S.length,T=new Uint8Array(x),E=0;return T.set(t,E),l("IHDR",w,T,E+=t.length),l("IDATA",S,T,E+=e+w.length),E+=e+S.length,l("IEND",new Uint8Array(0),T,E),(0,r.createObjectURL)(T,"image/png",o)}return function(t,e,i){return c(t,void 0===t.kind?r.ImageKind.GRAYSCALE_1BPP:t.kind,e,i)}}(),u=function(){function t(){this.fontSizeScale=1,this.fontWeight=h.fontWeight,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=h.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,e){this.x=t,this.y=e}},t}();e.SVGGraphics=l=function(){function t(t){if(Number.isInteger(t))return t.toString();var e=t.toFixed(10),i=e.length-1;if("0"!==e[i])return e;do{i--}while("0"===e[i]);return e.substring(0,"."===e[i]?i:i+1)}function e(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale("+t(e[0])+" "+t(e[3])+")";if(e[0]===e[3]&&e[1]===-e[2])return"rotate("+t(180*Math.acos(e[0])/Math.PI)+")"}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate("+t(e[4])+" "+t(e[5])+")";return"matrix("+t(e[0])+" "+t(e[1])+" "+t(e[2])+" "+t(e[3])+" "+t(e[4])+" "+t(e[5])+")"}function i(t,e,i){this.svgFactory=new o.DOMSVGFactory,this.current=new u,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=e,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!i}var n="http://www.w3.org/1999/xlink",s=["butt","round","square"],a=["miter","round","bevel"],l=0,d=0;return i.prototype={save:function(){this.transformStack.push(this.transformMatrix);var t=this.current;this.extraStack.push(t),this.current=t.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null},group:function(t){this.save(),this.executeOpTree(t),this.restore()},loadDependencies:function(t){for(var e=this,i=t.fnArray,n=i.length,o=t.argsArray,s=0;s<n;s++)if(r.OPS.dependency===i[s])for(var a=o[s],l=0,h=a.length;l<h;l++){var c,u=a[l];c="g_"===u.substring(0,2)?new Promise(function(t){e.commonObjs.get(u,t)}):new Promise(function(t){e.objs.get(u,t)}),this.current.dependencies.push(c)}return Promise.all(this.current.dependencies)},transform:function(t,e,i,n,o,s){var a=[t,e,i,n,o,s];this.transformMatrix=r.Util.transform(this.transformMatrix,a),this.tgrp=null},getSVG:function(t,e){var i=this;this.viewport=e;var n=this._initialize(e);return this.loadDependencies(t).then(function(){i.transformMatrix=r.IDENTITY_MATRIX;var e=i.convertOpList(t);return i.executeOpTree(e),n})},convertOpList:function(t){var e=t.argsArray,i=t.fnArray,n=i.length,o=[],s=[];for(var a in r.OPS)o[r.OPS[a]]=a;for(var l=0;l<n;l++){var h=i[l];s.push({fnId:h,fn:o[h],args:e[l]})}return function(t){for(var e=[],i=[],n=t.length,r=0;r<n;r++)"save"!==t[r].fn?"restore"===t[r].fn?e=i.pop():e.push(t[r]):(e.push({fnId:92,fn:"group",items:[]}),i.push(e),e=e[e.length-1].items);return e}(s)},executeOpTree:function(t){for(var e=t.length,i=0;i<e;i++){var n=t[i].fn,o=t[i].fnId,s=t[i].args;switch(0|o){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(s);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(s[0],s[1]);break;case r.OPS.setFont:this.setFont(s);break;case r.OPS.showText:case r.OPS.showSpacedText:this.showText(s[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(s[0],s[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(s[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(s[0]);break;case r.OPS.setHScale:this.setHScale(s[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(s[0],s[1],s[2],s[3],s[4],s[5]);break;case r.OPS.setTextRise:this.setTextRise(s[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(s[0]);break;case r.OPS.setLineWidth:this.setLineWidth(s[0]);break;case r.OPS.setLineJoin:this.setLineJoin(s[0]);break;case r.OPS.setLineCap:this.setLineCap(s[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(s[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(s[0],s[1],s[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(s[0],s[1],s[2]);break;case r.OPS.setDash:this.setDash(s[0],s[1]);break;case r.OPS.setGState:this.setGState(s[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintJpegXObject:this.paintJpegXObject(s[0],s[1],s[2]);break;case r.OPS.paintImageXObject:this.paintImageXObject(s[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(s[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(s[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(s[0],s[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(s[0],s[1],s[2],s[3],s[4],s[5]);break;case r.OPS.constructPath:this.constructPath(s[0],s[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(t[i].items);break;default:(0,r.warn)("Unimplemented operator "+n)}}},setWordSpacing:function(t){this.current.wordSpacing=t},setCharSpacing:function(t){this.current.charSpacing=t},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(e,i,n,r,o,s){var a=this.current;this.current.textMatrix=this.current.lineMatrix=[e,i,n,r,o,s],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,a.xcoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",t(a.fontSize)+"px"),a.tspan.setAttributeNS(null,"y",t(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.appendChild(a.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=r.IDENTITY_MATRIX,this.current.lineMatrix=r.IDENTITY_MATRIX,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.txtElement=this.svgFactory.createElement("svg:text"),this.current.txtgrp=this.svgFactory.createElement("svg:g"),this.current.xcoords=[]},moveText:function(e,i){var n=this.current;this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i,n.xcoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",t(n.fontSize)+"px"),n.tspan.setAttributeNS(null,"y",t(-n.y))},showText:function(i){var n=this.current,o=n.font,s=n.fontSize;if(0!==s){var a,l=n.charSpacing,c=n.wordSpacing,u=n.fontDirection,d=n.textHScale*u,p=i.length,f=o.vertical,m=s*n.fontMatrix[0],g=0;for(a=0;a<p;++a){var v=i[a];if(null!==v)if((0,r.isNum)(v))g+=-v*s*.001;else{var _=v.width,y=v.fontChar,b=_*m+((v.isSpace?c:0)+l)*u;v.isInFont||o.missingFile?(n.xcoords.push(n.x+g*d),n.tspan.textContent+=y,g+=b):g+=b}else g+=u*c}f?n.y-=g*d:n.x+=g*d,n.tspan.setAttributeNS(null,"x",n.xcoords.map(t).join(" ")),n.tspan.setAttributeNS(null,"y",t(-n.y)),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",t(n.fontSize)+"px"),n.fontStyle!==h.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==h.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);var w=n.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;w===r.TextRenderingMode.FILL||w===r.TextRenderingMode.FILL_STROKE?(n.fillColor!==h.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),w!==r.TextRenderingMode.STROKE&&w!==r.TextRenderingMode.FILL_STROKE||this._setStrokeAttributes(n.tspan);var S=n.textMatrix;0!==n.textRise&&((S=S.slice())[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",e(S)+" scale(1, -1)"),n.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.txtElement.appendChild(n.tspan),n.txtgrp.appendChild(n.txtElement),this._ensureTransformGroup().appendChild(n.txtElement)}},setLeadingMoveText:function(t,e){this.setLeading(-e),this.moveText(t,e)},addFontStyle:function(t){this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var e=(0,r.createObjectURL)(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'+t.loadedName+'"; src: url('+e+"); }\n"},setFont:function(e){var i=this.current,n=this.commonObjs.get(e[0]),o=e[1];this.current.font=n,this.embedFonts&&n.data&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),i.fontMatrix=n.fontMatrix?n.fontMatrix:r.FONT_IDENTITY_MATRIX;var s=n.black?n.bold?"bolder":"bold":n.bold?"bold":"normal",a=n.italic?"italic":"normal";o<0?(o=-o,i.fontDirection=-1):i.fontDirection=1,i.fontSize=o,i.fontFamily=n.loadedName,i.fontWeight=s,i.fontStyle=a,i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"y",t(-i.y)),i.xcoords=[]},endText:function(){var t=this.current;t.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&t.txtElement&&t.txtElement.hasChildNodes()&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())},setLineWidth:function(t){this.current.lineWidth=t},setLineCap:function(t){this.current.lineCap=s[t]},setLineJoin:function(t){this.current.lineJoin=a[t]},setMiterLimit:function(t){this.current.miterLimit=t},setStrokeAlpha:function(t){this.current.strokeAlpha=t},setStrokeRGBColor:function(t,e,i){var n=r.Util.makeCssRgb(t,e,i);this.current.strokeColor=n},setFillAlpha:function(t){this.current.fillAlpha=t},setFillRGBColor:function(t,e,i){var n=r.Util.makeCssRgb(t,e,i);this.current.fillColor=n,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[]},setDash:function(t,e){this.current.dashArray=t,this.current.dashPhase=e},constructPath:function(e,i){var n=this.current,o=n.x,s=n.y;n.path=this.svgFactory.createElement("svg:path");for(var a=[],l=e.length,h=0,c=0;h<l;h++)switch(0|e[h]){case r.OPS.rectangle:o=i[c++],s=i[c++];var u=o+i[c++],d=s+i[c++];a.push("M",t(o),t(s),"L",t(u),t(s),"L",t(u),t(d),"L",t(o),t(d),"Z");break;case r.OPS.moveTo:o=i[c++],s=i[c++],a.push("M",t(o),t(s));break;case r.OPS.lineTo:o=i[c++],s=i[c++],a.push("L",t(o),t(s));break;case r.OPS.curveTo:o=i[c+4],s=i[c+5],a.push("C",t(i[c]),t(i[c+1]),t(i[c+2]),t(i[c+3]),t(o),t(s)),c+=6;break;case r.OPS.curveTo2:o=i[c+2],s=i[c+3],a.push("C",t(o),t(s),t(i[c]),t(i[c+1]),t(i[c+2]),t(i[c+3])),c+=4;break;case r.OPS.curveTo3:o=i[c+2],s=i[c+3],a.push("C",t(i[c]),t(i[c+1]),t(o),t(s),t(o),t(s)),c+=4;break;case r.OPS.closePath:a.push("Z")}n.path.setAttributeNS(null,"d",a.join(" ")),n.path.setAttributeNS(null,"fill","none"),this._ensureTransformGroup().appendChild(n.path),n.element=n.path,n.setCurrentPoint(o,s)},endPath:function(){if(this.pendingClip){var t=this.current,i="clippath"+l;l++;var n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",i),n.setAttributeNS(null,"transform",e(this.transformMatrix));var r=t.element.cloneNode(!0);"evenodd"===this.pendingClip?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.appendChild(r),this.defs.appendChild(n),t.activeClipUrl&&(t.clipGroup=null,this.extraStack.forEach(function(t){t.clipGroup=null}),n.setAttributeNS(null,"clip-path",t.activeClipUrl)),t.activeClipUrl="url(#"+i+")",this.tgrp=null}},clip:function(t){this.pendingClip=t},closePath:function(){var t=this.current;if(t.path){var e=t.path.getAttributeNS(null,"d");e+="Z",t.path.setAttributeNS(null,"d",e)}},setLeading:function(t){this.current.leading=-t},setTextRise:function(t){this.current.textRise=t},setTextRenderingMode:function(t){this.current.textRenderingMode=t},setHScale:function(t){this.current.textHScale=t/100},setGState:function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e],o=n[0],s=n[1];switch(o){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,r.warn)("Unimplemented graphic state "+o)}}},fill:function(){var t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())},stroke:function(){var t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())},_setStrokeAttributes:function(e){var i=this.current;e.setAttributeNS(null,"stroke",i.strokeColor),e.setAttributeNS(null,"stroke-opacity",i.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",t(i.miterLimit)),e.setAttributeNS(null,"stroke-linecap",i.lineCap),e.setAttributeNS(null,"stroke-linejoin",i.lineJoin),e.setAttributeNS(null,"stroke-width",t(i.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",i.dashArray.map(t).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",t(i.dashPhase)+"px")},eoFill:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.closePath(),this.eoFillStroke()},paintSolidColorImageMask:function(){var t=this.current,e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",t.fillColor),this._ensureTransformGroup().appendChild(e)},paintJpegXObject:function(e,i,r){var o=this.objs.get(e),s=this.svgFactory.createElement("svg:image");s.setAttributeNS(n,"xlink:href",o.src),s.setAttributeNS(null,"width",t(i)),s.setAttributeNS(null,"height",t(r)),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",t(-r)),s.setAttributeNS(null,"transform","scale("+t(1/i)+" "+t(-1/r)+")"),this._ensureTransformGroup().appendChild(s)},paintImageXObject:function(t){var e=this.objs.get(t);e?this.paintInlineImageXObject(e):(0,r.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e,i){var r=e.width,o=e.height,s=c(e,this.forceDataSchema,!!i),a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",t(r)),a.setAttributeNS(null,"height",t(o)),this.current.element=a,this.clip("nonzero");var l=this.svgFactory.createElement("svg:image");l.setAttributeNS(n,"xlink:href",s),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",t(-o)),l.setAttributeNS(null,"width",t(r)+"px"),l.setAttributeNS(null,"height",t(o)+"px"),l.setAttributeNS(null,"transform","scale("+t(1/r)+" "+t(-1/o)+")"),i?i.appendChild(l):this._ensureTransformGroup().appendChild(l)},paintImageMaskXObject:function(e){var i=this.current,n=e.width,r=e.height,o=i.fillColor;i.maskId="mask"+d++;var s=this.svgFactory.createElement("svg:mask");s.setAttributeNS(null,"id",i.maskId);var a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",t(n)),a.setAttributeNS(null,"height",t(r)),a.setAttributeNS(null,"fill",o),a.setAttributeNS(null,"mask","url(#"+i.maskId+")"),this.defs.appendChild(s),this._ensureTransformGroup().appendChild(a),this.paintInlineImageXObject(e,s)},paintFormXObjectBegin:function(e,i){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),Array.isArray(i)&&4===i.length){var n=i[2]-i[0],r=i[3]-i[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",i[0]),o.setAttributeNS(null,"y",i[1]),o.setAttributeNS(null,"width",t(n)),o.setAttributeNS(null,"height",t(r)),this.current.element=o,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){},_initialize:function(t){var i=this.svgFactory.create(t.width,t.height),n=this.svgFactory.createElement("svg:defs");i.appendChild(n),this.defs=n;var r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",e(t.transform)),i.appendChild(r),this.svg=r,i},_ensureClipGroup:function(){if(!this.current.clipGroup){var t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(t),this.current.clipGroup=t}return this.current.clipGroup},_ensureTransformGroup:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}},i}(),e.SVGGraphics=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n,r=i(137),o=(n=r)&&n.__esModule?n:{default:n},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),l=i(149);function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var s=e[r](o),a=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var p=require("fs"),f=require("http"),m=require("https"),g=require("url"),v=/^file:\/\/\/[a-zA-Z]:\//;var _=function(){function t(e){var i,n;d(this,t),this.source=e,this.url=(i=e.url,"file:"===(n=g.parse(i)).protocol||n.host?n:/^[a-z]:[/\\]/i.test(i)?g.parse("file:///"+i):(n.host||(n.protocol="file:"),n)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequest=null,this._rangeRequestReaders=[]}return s(t,[{key:"getFullReader",value:function(){return(0,a.assert)(!this._fullRequest),this._fullRequest=this.isFsUrl?new T(this):new S(this),this._fullRequest}},{key:"getRangeReader",value:function(t,e){var i=this.isFsUrl?new E(this,t,e):new x(this,t,e);return this._rangeRequestReaders.push(i),i}},{key:"cancelAllRequests",value:function(t){this._fullRequest&&this._fullRequest.cancel(t),this._rangeRequestReaders.slice(0).forEach(function(e){e.cancel(t)})}}]),t}(),y=function(){function t(e){d(this,t),this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;var i=e.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)(),this._headersCapability=(0,a.createPromiseCapability)()}return s(t,[{key:"read",value:function(){var t=u(o.default.mark(function t(){var e,i;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._readCapability.promise;case 2:if(!this._done){t.next=4;break}return t.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){t.next=6;break}throw this._storedError;case 6:if(null!==(e=this._readableStream.read())){t.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),t.abrupt("return",this.read());case 10:return this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),i=new Uint8Array(e).buffer,t.abrupt("return",{value:i,done:!1});case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}},{key:"_error",value:function(t){this._storedError=t,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(t){var e=this;this._readableStream=t,t.on("readable",function(){e._readCapability.resolve()}),t.on("end",function(){t.destroy(),e._done=!0,e._readCapability.resolve()}),t.on("error",function(t){e._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),t}(),b=function(){function t(e){d(this,t),this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)();var i=e.source;this._isStreamingSupported=!i.disableStream}return s(t,[{key:"read",value:function(){var t=u(o.default.mark(function t(){var e,i;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._readCapability.promise;case 2:if(!this._done){t.next=4;break}return t.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){t.next=6;break}throw this._storedError;case 6:if(null!==(e=this._readableStream.read())){t.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),t.abrupt("return",this.read());case 10:return this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded}),i=new Uint8Array(e).buffer,t.abrupt("return",{value:i,done:!1});case 14:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}},{key:"_error",value:function(t){this._storedError=t,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(t){var e=this;this._readableStream=t,t.on("readable",function(){e._readCapability.resolve()}),t.on("end",function(){t.destroy(),e._done=!0,e._readCapability.resolve()}),t.on("error",function(t){e._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),t}();function w(t,e){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:e}}var S=function(t){function e(t){d(this,e);var i=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=function(e){if(404===e.statusCode){var n=new a.MissingPDFException('Missing PDF "'+i._url+'".');return i._storedError=n,void i._headersCapability.reject(n)}i._headersCapability.resolve(),i._setReadableStream(e);var r=function(t){return i._readableStream.headers[t.toLowerCase()]},o=(0,l.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:t.isHttp,rangeChunkSize:i._rangeChunkSize,disableRange:i._disableRange}),s=o.allowRangeRequests,h=o.suggestedLength;i._isRangeSupported=s,i._contentLength=h||i._contentLength,i._filename=(0,l.extractFilenameFromHeader)(r)};return i._request=null,"http:"===i._url.protocol?i._request=f.request(w(i._url,t.httpHeaders),n):i._request=m.request(w(i._url,t.httpHeaders),n),i._request.on("error",function(t){i._storedError=t,i._headersCapability.reject(t)}),i._request.end(),i}return c(e,y),e}(),x=function(t){function e(t,i,n){d(this,e);var r=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));for(var o in r._httpHeaders={},t.httpHeaders){var s=t.httpHeaders[o];void 0!==s&&(r._httpHeaders[o]=s)}r._httpHeaders.Range="bytes="+i+"-"+(n-1);var l=function(t){if(404!==t.statusCode)r._setReadableStream(t);else{var e=new a.MissingPDFException('Missing PDF "'+r._url+'".');r._storedError=e}};return r._request=null,"http:"===r._url.protocol?r._request=f.request(w(r._url,r._httpHeaders),l):r._request=m.request(w(r._url,r._httpHeaders),l),r._request.on("error",function(t){r._storedError=t}),r._request.end(),r}return c(e,b),e}(),T=function(t){function e(t){d(this,e);var i=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),n=decodeURIComponent(i._url.path);return v.test(i._url.href)&&(n=n.replace(/^\//,"")),p.lstat(n,function(t,e){if(t)return"ENOENT"===t.code&&(t=new a.MissingPDFException('Missing PDF "'+n+'".')),i._storedError=t,void i._headersCapability.reject(t);i._contentLength=e.size,i._setReadableStream(p.createReadStream(n)),i._headersCapability.resolve()}),i}return c(e,y),e}(),E=function(t){function e(t,i,n){d(this,e);var r=h(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),o=decodeURIComponent(r._url.path);return v.test(r._url.href)&&(o=o.replace(/^\//,"")),r._setReadableStream(p.createReadStream(o,{start:i,end:n-1})),r}return c(e,b),e}();e.PDFNodeStream=_},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateResponseStatus=e.validateRangeRequestCapabilities=e.extractFilenameFromHeader=e.createResponseStatusError=void 0;var n=i(1),r=i(150);e.createResponseStatusError=function(t,e){return 404===t||0===t&&/^file:/.test(e)?new n.MissingPDFException('Missing PDF "'+e+'".'):new n.UnexpectedResponseException("Unexpected server response ("+t+') while retrieving PDF "'+e+'".',t)},e.extractFilenameFromHeader=function(t){var e=t("Content-Disposition");if(e){var i=(0,r.getFilenameFromContentDispositionHeader)(e);if(/\.pdf$/i.test(i))return i}return null},e.validateRangeRequestCapabilities=function(t){var e=t.getResponseHeader,i=t.isHttp,r=t.rangeChunkSize,o=t.disableRange;(0,n.assert)(r>0,"Range chunk size must be larger than zero");var s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(e("Content-Length"),10);return Number.isInteger(a)?(s.suggestedLength=a,a<=2*r?s:o||!i?s:"bytes"!==e("Accept-Ranges")?s:"identity"!==(e("Content-Encoding")||"identity")?s:(s.allowRangeRequests=!0,s)):s},e.validateResponseStatus=function(t){return 200===t||206===t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.getFilenameFromContentDispositionHeader=function(t){var e=!0,i=s("filename\\*","i").exec(t);if(i){var r=h(i=i[1]);return l(r=u(r=c(r=unescape(r))))}if(i=function(t){for(var e=[],i=void 0,r=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(i=r.exec(t));){var o=i,a=n(o,4),l=a[1],u=a[2],d=a[3];if((l=parseInt(l,10))in e){if(0===l)break}else e[l]=[u,d]}for(var p=[],f=0;f<e.length&&f in e;++f){var m=n(e[f],2),g=m[0],v=m[1];v=h(v),g&&(v=unescape(v),0===f&&(v=c(v))),p.push(v)}return p.join("")}(t))return l(u(i));if(i=s("filename","i").exec(t)){var o=h(i=i[1]);return l(o=u(o))}function s(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function a(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{for(var n=new TextDecoder(t,{fatal:!0}),r=new Array(i.length),o=0;o<i.length;++o)r[o]=i.charCodeAt(o);i=n.decode(new Uint8Array(r)),e=!1}catch(n){if(/^utf-?8$/i.test(t))try{i=decodeURIComponent(escape(i)),e=!1}catch(t){}}}return i}function l(t){return e&&/[\x80-\xff]/.test(t)&&(t=a("utf-8",t),e&&(t=a("iso-8859-1",t))),t}function h(t){if('"'===t.charAt(0)){for(var e=t.slice(1).split('\\"'),i=0;i<e.length;++i){var n=e[i].indexOf('"');-1!==n&&(e[i]=e[i].slice(0,n),e.length=i+1),e[i]=e[i].replace(/\\(.)/g,"$1")}t=e.join('"')}return t}function c(t){var e=t.indexOf("'");return-1===e?t:a(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function u(t){return"=?"!==t.slice(0,2)||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(t,e,i,n){if("q"===i||"Q"===i)return a(e,n=(n=n.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}));try{n=atob(n)}catch(t){}return a(e,n)})}return""}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n,r=i(137),o=(n=r)&&n.__esModule?n:{default:n},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),l=i(149);function h(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var s=e[r](o),a=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e,i){return{method:"GET",headers:t,signal:i&&i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}var d=function(){function t(e){c(this,t),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return s(t,[{key:"getFullReader",value:function(){return(0,a.assert)(!this._fullRequestReader),this._fullRequestReader=new p(this),this._fullRequestReader}},{key:"getRangeReader",value:function(t,e){var i=new f(this,t,e);return this._rangeRequestReaders.push(i),i}},{key:"cancelAllRequests",value:function(t){this._fullRequestReader&&this._fullRequestReader.cancel(t),this._rangeRequestReaders.slice(0).forEach(function(e){e.cancel(t)})}}]),t}(),p=function(){function t(e){var i=this;c(this,t),this._stream=e,this._reader=null,this._loaded=0,this._filename=null;var n=e.source;for(var r in this._withCredentials=n.withCredentials,this._contentLength=n.length,this._headersCapability=(0,a.createPromiseCapability)(),this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._headers=new Headers,this._stream.httpHeaders){var o=this._stream.httpHeaders[r];void 0!==o&&this._headers.append(r,o)}var s=n.url;fetch(s,u(this._headers,this._withCredentials,this._abortController)).then(function(t){if(!(0,l.validateResponseStatus)(t.status))throw(0,l.createResponseStatusError)(t.status,s);i._reader=t.body.getReader(),i._headersCapability.resolve();var e=function(e){return t.headers.get(e)},n=(0,l.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:i._stream.isHttp,rangeChunkSize:i._rangeChunkSize,disableRange:i._disableRange}),r=n.allowRangeRequests,o=n.suggestedLength;i._isRangeSupported=r,i._contentLength=o||i._contentLength,i._filename=(0,l.extractFilenameFromHeader)(e),!i._isStreamingSupported&&i._isRangeSupported&&i.cancel(new a.AbortException("streaming is disabled"))}).catch(this._headersCapability.reject),this.onProgress=null}return s(t,[{key:"read",value:function(){var t=h(o.default.mark(function t(){var e,i,n,r;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._headersCapability.promise;case 2:return t.next=4,this._reader.read();case 4:if(e=t.sent,i=e.value,!(n=e.done)){t.next=9;break}return t.abrupt("return",{value:i,done:n});case 9:return this._loaded+=i.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),r=new Uint8Array(i).buffer,t.abrupt("return",{value:r,done:!1});case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),t}(),f=function(){function t(e,i,n){var r=this;c(this,t),this._stream=e,this._reader=null,this._loaded=0;var o=e.source;for(var s in this._withCredentials=o.withCredentials,this._readCapability=(0,a.createPromiseCapability)(),this._isStreamingSupported=!o.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=new Headers,this._stream.httpHeaders){var h=this._stream.httpHeaders[s];void 0!==h&&this._headers.append(s,h)}var d=i+"-"+(n-1);this._headers.append("Range","bytes="+d);var p=o.url;fetch(p,u(this._headers,this._withCredentials,this._abortController)).then(function(t){if(!(0,l.validateResponseStatus)(t.status))throw(0,l.createResponseStatusError)(t.status,p);r._readCapability.resolve(),r._reader=t.body.getReader()}),this.onProgress=null}return s(t,[{key:"read",value:function(){var t=h(o.default.mark(function t(){var e,i,n,r;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._readCapability.promise;case 2:return t.next=4,this._reader.read();case 4:if(e=t.sent,i=e.value,!(n=e.done)){t.next=9;break}return t.abrupt("return",{value:i,done:n});case 9:return this._loaded+=i.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),r=new Uint8Array(i).buffer,t.abrupt("return",{value:r,done:!1});case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"cancel",value:function(t){this._reader&&this._reader.cancel(t),this._abortController&&this._abortController.abort()}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),t}();e.PDFFetchStream=d},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NetworkManager=e.PDFNetworkStream=void 0;var n=a(i(137)),r=i(1),o=i(149),s=a(i(3));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,i){return function n(r,o){try{var s=e[r](o),a=s.value}catch(t){return void i(t)}if(!s.done)return Promise.resolve(a).then(function(t){n("next",t)},function(t){n("throw",t)});t(a)}("next")})}}function h(t,e){this.url=t,e=e||{},this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this.withCredentials=e.withCredentials||!1,this.getXhr=e.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null),this.loadedRequests=Object.create(null)}function c(t){var e=t.response;return"string"!=typeof e?e:(0,r.stringToBytes)(e).buffer}var u=function(){try{var t=new XMLHttpRequest;return t.open("GET",s.default.location.href),t.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===t.responseType}catch(t){return!1}}();function d(t){this._source=t,this._manager=new h(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}function p(t,e){this._manager=t;var i={onHeadersReceived:this._onHeadersReceived.bind(this),onProgressiveData:e.disableStream?null:this._onProgressiveData.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=(0,r.createPromiseCapability)(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}function f(t,e,i){this._manager=t;var n={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=t.requestRange(e,i,n),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}h.prototype={requestRange:function(t,e,i){var n={begin:t,end:e};for(var r in i)n[r]=i[r];return this.request(n)},requestFull:function(t){return this.request(t)},request:function(t){var e=this.getXhr(),i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};for(var r in e.open("GET",this.url),e.withCredentials=this.withCredentials,this.httpHeaders){var o=this.httpHeaders[r];void 0!==o&&e.setRequestHeader(r,o)}if(this.isHttp&&"begin"in t&&"end"in t){var s=t.begin+"-"+(t.end-1);e.setRequestHeader("Range","bytes="+s),n.expectedStatus=206}else n.expectedStatus=200;return u&&!!t.onProgressiveData?(e.responseType="moz-chunked-arraybuffer",n.onProgressiveData=t.onProgressiveData,n.mozChunked=!0):e.responseType="arraybuffer",t.onError&&(e.onerror=function(i){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i},onProgress:function(t,e){var i=this.pendingRequests[t];if(i){if(i.mozChunked){var n=c(i.xhr);i.onProgressiveData(n)}var r=i.onProgress;r&&r(e)}},onStateChange:function(t,e){var i=this.pendingRequests[t];if(i){var n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4===n.readyState&&t in this.pendingRequests)if(delete this.pendingRequests[t],0===n.status&&this.isHttp)i.onError&&i.onError(n.status);else{var r=n.status||200;if(200===r&&206===i.expectedStatus||r===i.expectedStatus){this.loadedRequests[t]=!0;var o=c(n);if(206===r){var s=n.getResponseHeader("Content-Range"),a=/bytes (\d+)-(\d+)\/(\d+)/.exec(s),l=parseInt(a[1],10);i.onDone({begin:l,chunk:o})}else i.onProgressiveData?i.onDone(null):o?i.onDone({begin:0,chunk:o}):i.onError&&i.onError(n.status)}else i.onError&&i.onError(n.status)}}},hasPendingRequests:function(){for(var t in this.pendingRequests)return!0;return!1},getRequestXhr:function(t){return this.pendingRequests[t].xhr},isStreamingRequest:function(t){return!!this.pendingRequests[t].onProgressiveData},isPendingRequest:function(t){return t in this.pendingRequests},isLoadedRequest:function(t){return t in this.loadedRequests},abortAllRequests:function(){for(var t in this.pendingRequests)this.abortRequest(0|t)},abortRequest:function(t){var e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}},d.prototype={_onRangeRequestReaderClosed:function(t){var e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)},getFullReader:function(){return(0,r.assert)(!this._fullRequestReader),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader},getRangeReader:function(t,e){var i=new f(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i},cancelAllRequests:function(t){this._fullRequestReader&&this._fullRequestReader.cancel(t),this._rangeRequestReaders.slice(0).forEach(function(e){e.cancel(t)})}},p.prototype={_onHeadersReceived:function(){var t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=function(t){return e.getResponseHeader(t)},n=(0,o.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),r=n.allowRangeRequests,s=n.suggestedLength;r&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(i);var a=this._manager;a.isStreamingRequest(t)?this._isStreamingSupported=!0:this._isRangeSupported&&a.abortRequest(t),this._headersReceivedCapability.resolve()},_onProgressiveData:function(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t)},_onDone:function(t){t&&this._onProgressiveData(t.chunk),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[])},_onError:function(t){var e=this._url,i=(0,o.createResponseStatusError)(t,e);this._storedError=i,this._headersReceivedCapability.reject(i),this._requests.forEach(function(t){t.reject(i)}),this._requests=[],this._cachedChunks=[]},_onProgress:function(t){this.onProgress&&this.onProgress({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})},get filename(){return this._filename},get isRangeSupported(){return this._isRangeSupported},get isStreamingSupported(){return this._isStreamingSupported},get contentLength(){return this._contentLength},get headersReady(){return this._headersReceivedCapability.promise},read:function(){var t=l(n.default.mark(function t(){var e,i;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._storedError){t.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){t.next=5;break}return e=this._cachedChunks.shift(),t.abrupt("return",{value:e,done:!1});case 5:if(!this._done){t.next=7;break}return t.abrupt("return",{value:void 0,done:!0});case 7:return i=(0,r.createPromiseCapability)(),this._requests.push(i),t.abrupt("return",i.promise);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),cancel:function(t){this._done=!0,this._headersReceivedCapability.reject(t),this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},f.prototype={_close:function(){this.onClosed&&this.onClosed(this)},_onDone:function(t){var e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e;this._done=!0,this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[],this._close()},_onProgress:function(t){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:t.loaded})},get isStreamingSupported(){return!1},read:function(){var t=l(n.default.mark(function t(){var e,i;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this._queuedChunk){t.next=4;break}return e=this._queuedChunk,this._queuedChunk=null,t.abrupt("return",{value:e,done:!1});case 4:if(!this._done){t.next=6;break}return t.abrupt("return",{value:void 0,done:!0});case 6:return i=(0,r.createPromiseCapability)(),this._requests.push(i),t.abrupt("return",i.promise);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),cancel:function(t){this._done=!0,this._requests.forEach(function(t){t.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},e.PDFNetworkStream=d,e.NetworkManager=h}])}),function(t,e){"function"==typeof define&&define.amd?define([],e):"undefined"!=typeof exports?e():(e(),t.FileSaver={})}(this,function(){"use strict";function t(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){r(n.response,e,i)},n.onerror=function(){console.error("could not download file")},n.send()}function e(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype?function(r,o,s){var a=n.URL||n.webkitURL,l=document.createElement("a");o=o||r.name||"download",l.download=o,l.rel="noopener","string"==typeof r?(l.href=r,l.origin===location.origin?i(l):e(l.href)?t(r,o,s):i(l,l.target="_blank")):(l.href=a.createObjectURL(r),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(n,r,o){if(r=r||n.name||"download","string"!=typeof n)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(n,o),r);else if(e(n))t(n,r,o);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){i(s)})}}:function(e,i,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,i,r);var s="application/octet-stream"===e.type,a=/constructor/i.test(n.HTMLElement)||n.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&a)&&"object"==typeof FileReader){var h=new FileReader;h.onloadend=function(){var t=h.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},h.readAsDataURL(e)}else{var c=n.URL||n.webkitURL,u=c.createObjectURL(e);o?o.location=u:location.href=u,o=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});n.saveAs=r.saveAs=r,"undefined"!=typeof module&&(module.exports=r)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.L={})}(this,function(t){"use strict";var e=Object.freeze;function i(t){var e,i,n,r;for(i=1,n=arguments.length;i<n;i++)for(e in r=arguments[i])t[e]=r[e];return t}Object.freeze=function(t){return t};var n=Object.create||function(t){return r.prototype=t,new r};function r(){}function o(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}}var s=0;function a(t){return t._leaflet_id=t._leaflet_id||++s,t._leaflet_id}function l(t,e,i){var n,r,o,s;return s=function(){n=!1,r&&(o.apply(i,r),r=!1)},o=function(){n?r=arguments:(t.apply(i,arguments),setTimeout(s,e),n=!0)}}function h(t,e,i){var n=e[1],r=e[0],o=n-r;return t===n&&i?t:((t-r)%o+o)%o+r}function c(){return!1}function u(t,e){return e=void 0===e?6:e,+(Math.round(t+"e+"+e)+"e-"+e)}function d(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function p(t){return d(t).split(/\s+/)}function f(t,e){for(var i in t.hasOwnProperty("options")||(t.options=t.options?n(t.options):{}),e)t.options[i]=e[i];return t.options}function m(t,e,i){var n=[];for(var r in t)n.push(encodeURIComponent(i?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")}var g=/\{ *([\w_-]+) *\}/g;function v(t,e){return t.replace(g,function(t,i){var n=e[i];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(e)),n})}var _=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var b="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var S=0;function x(t){var e=+new Date,i=Math.max(0,16-(e-S));return S=e+i,window.setTimeout(t,i)}var T=window.requestAnimationFrame||w("RequestAnimationFrame")||x,E=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function P(t,e,i){if(!i||T!==x)return T.call(window,o(t,e));t.call(e)}function C(t){t&&E.call(window,t)}var k=(Object.freeze||Object)({freeze:e,extend:i,create:n,bind:o,lastId:s,stamp:a,throttle:l,wrapNum:h,falseFn:c,formatNum:u,trim:d,splitWords:p,setOptions:f,getParamString:m,template:v,isArray:_,indexOf:y,emptyImageUrl:b,requestFn:T,cancelFn:E,requestAnimFrame:P,cancelAnimFrame:C});function A(){}A.extend=function(t){function e(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()}var r=e.__super__=this.prototype,o=n(r);for(var s in(o.constructor=e).prototype=o,this)this.hasOwnProperty(s)&&"prototype"!==s&&"__super__"!==s&&(e[s]=this[s]);return t.statics&&(i(e,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=_(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),i.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=i(n(o.options),t.options)),i(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},A.include=function(t){return i(this.prototype,t),this},A.mergeOptions=function(t){return i(this.prototype.options,t),this},A.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this};var R={on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else for(var r=0,o=(t=p(t)).length;r<o;r++)this._on(t[r],e,i);return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else for(var r=0,o=(t=p(t)).length;r<o;r++)this._off(t[r],e,i);else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var n=this._events[t];n||(n=[],this._events[t]=n),i===this&&(i=void 0);for(var r={fn:e,ctx:i},o=n,s=0,a=o.length;s<a;s++)if(o[s].fn===e&&o[s].ctx===i)return;o.push(r)},_off:function(t,e,i){var n,r,o;if(this._events&&(n=this._events[t]))if(e){if(i===this&&(i=void 0),n)for(r=0,o=n.length;r<o;r++){var s=n[r];if(s.ctx===i&&s.fn===e)return s.fn=c,this._firingCount&&(this._events[t]=n=n.slice()),void n.splice(r,1)}}else{for(r=0,o=n.length;r<o;r++)n[r].fn=c;delete this._events[t]}},fire:function(t,e,n){if(!this.listens(t,n))return this;var r=i({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var s=0,a=o.length;s<a;s++){var l=o[s];l.fn.call(l.ctx||this,r)}this._firingCount--}}return n&&this._propagateEvent(r),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var r=o(function(){this.off(t,e,i).off(t,r,i)},this);return this.on(t,e,i).on(t,r,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[a(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[a(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,i({layer:t.target,propagatedFrom:t.target},t),!0)}};R.addEventListener=R.on,R.removeEventListener=R.clearAllEventListeners=R.off,R.addOneTimeEventListener=R.once,R.fireEvent=R.fire,R.hasEventListeners=R.listens;var I=A.extend(R);function O(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e}var M=Math.trunc||function(t){return 0<t?Math.floor(t):Math.ceil(t)};function D(t,e,i){return t instanceof O?t:_(t)?new O(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new O(t.x,t.y):new O(t,e,i)}function z(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function F(t,e){return!t||t instanceof z?t:new z(t,e)}function N(t,e){if(t)for(var i=e?[t,e]:t,n=0,r=i.length;n<r;n++)this.extend(i[n])}function B(t,e){return t instanceof N?t:new N(t,e)}function j(t,e,i){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==i&&(this.alt=+i)}function H(t,e,i){return t instanceof j?t:_(t)&&"object"!=typeof t[0]?3===t.length?new j(t[0],t[1],t[2]):2===t.length?new j(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new j(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new j(t,e,i)}O.prototype={clone:function(){return new O(this.x,this.y)},add:function(t){return this.clone()._add(D(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(D(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new O(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new O(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=M(this.x),this.y=M(this.y),this},distanceTo:function(t){var e=(t=D(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=D(t)).x===this.x&&t.y===this.y},contains:function(t){return t=D(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},z.prototype={extend:function(t){return t=D(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new O((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new O(this.min.x,this.max.y)},getTopRight:function(){return new O(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof O?D(t):F(t))instanceof z?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=F(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>=e.x&&n.x<=i.x,s=r.y>=e.y&&n.y<=i.y;return o&&s},overlaps:function(t){t=F(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>e.x&&n.x<i.x,s=r.y>e.y&&n.y<i.y;return o&&s},isValid:function(){return!(!this.min||!this.max)}},N.prototype={extend:function(t){var e,i,n=this._southWest,r=this._northEast;if(t instanceof j)i=e=t;else{if(!(t instanceof N))return t?this.extend(H(t)||B(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||r?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),r.lat=Math.max(i.lat,r.lat),r.lng=Math.max(i.lng,r.lng)):(this._southWest=new j(e.lat,e.lng),this._northEast=new j(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new N(new j(e.lat-n,e.lng-r),new j(i.lat+n,i.lng+r))},getCenter:function(){return new j((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new j(this.getNorth(),this.getWest())},getSouthEast:function(){return new j(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof j||"lat"in t?H(t):B(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof N?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=B(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&n.lat<=i.lat,s=r.lng>=e.lng&&n.lng<=i.lng;return o&&s},overlaps:function(t){t=B(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>e.lat&&n.lat<i.lat,s=r.lng>e.lng&&n.lng<i.lng;return o&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=B(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}};var U,q={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t);return new z(this.transformation.transform(e.min,i),this.transformation.transform(e.max,i))},infinite:!(j.prototype={equals:function(t,e){return!!t&&(t=H(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+u(this.lat,t)+", "+u(this.lng,t)+")"},distanceTo:function(t){return W.distance(this,H(t))},wrap:function(){return W.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return B([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new j(this.lat,this.lng,this.alt)}}),wrapLatLng:function(t){var e=this.wrapLng?h(t.lng,this.wrapLng,!0):t.lng;return new j(this.wrapLat?h(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),i=this.wrapLatLng(e),n=e.lat-i.lat,r=e.lng-i.lng;if(0==n&&0==r)return t;var o=t.getSouthWest(),s=t.getNorthEast();return new N(new j(o.lat-n,o.lng-r),new j(s.lat-n,s.lng-r))}},W=i({},q,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,r=e.lat*i,o=Math.sin((e.lat-t.lat)*i/2),s=Math.sin((e.lng-t.lng)*i/2),a=o*o+Math.cos(n)*Math.cos(r)*s*s,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),G=6378137,V={R:G,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=Math.sin(n*e);return new O(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new j((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(U=G*Math.PI,new z([-U,-U],[U,U]))};function Z(t,e,i,n){if(_(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=i,this._d=n}function X(t,e,i,n){return new Z(t,e,i,n)}Z.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new O((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Y,$=i({},W,{code:"EPSG:3857",projection:V,transformation:(Y=.5/(Math.PI*V.R),X(Y,.5,-Y,.5))}),K=i({},$,{code:"EPSG:900913"});function Q(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function J(t,e){var i,n,r,o,s,a,l="";for(i=0,r=t.length;i<r;i++){for(n=0,o=(s=t[i]).length;n<o;n++)l+=(n?"L":"M")+(a=s[n]).x+" "+a.y;l+=e?At?"z":"x":""}return l||"M0 0"}var tt=document.documentElement.style,et="ActiveXObject"in window,it=et&&!document.addEventListener,nt="msLaunchUri"in navigator&&!("documentMode"in document),rt=It("webkit"),ot=It("android"),st=It("android 2")||It("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),lt=ot&&It("Google")&&at<537&&!("AudioNode"in window),ht=!!window.opera,ct=It("chrome"),ut=It("gecko")&&!rt&&!ht&&!et,dt=!ct&&It("safari"),pt=It("phantom"),ft="OTransition"in tt,mt=0===navigator.platform.indexOf("Win"),gt=et&&"transition"in tt,vt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!st,_t="MozPerspective"in tt,yt=!window.L_DISABLE_3D&&(gt||vt||_t)&&!ft&&!pt,bt="undefined"!=typeof orientation||It("mobile"),wt=bt&&rt,St=bt&&vt,xt=!window.PointerEvent&&window.MSPointerEvent,Tt=!(!window.PointerEvent&&!xt),Et=!window.L_NO_TOUCH&&(Tt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Pt=bt&&ht,Ct=bt&&ut,Lt=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),kt=!!document.createElement("canvas").getContext,At=!(!document.createElementNS||!Q("svg").createSVGRect),Rt=!At&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function It(t){return 0<=navigator.userAgent.toLowerCase().indexOf(t)}var Ot=(Object.freeze||Object)({ie:et,ielt9:it,edge:nt,webkit:rt,android:ot,android23:st,androidStock:lt,opera:ht,chrome:ct,gecko:ut,safari:dt,phantom:pt,opera12:ft,win:mt,ie3d:gt,webkit3d:vt,gecko3d:_t,any3d:yt,mobile:bt,mobileWebkit:wt,mobileWebkit3d:St,msPointer:xt,pointer:Tt,touch:Et,mobileOpera:Pt,mobileGecko:Ct,retina:Lt,canvas:kt,svg:At,vml:Rt}),Mt=xt?"MSPointerDown":"pointerdown",Dt=xt?"MSPointerMove":"pointermove",zt=xt?"MSPointerUp":"pointerup",Ft=xt?"MSPointerCancel":"pointercancel",Nt=["INPUT","SELECT","OPTION"],Bt={},jt=!1,Ht=0;function Ut(t){Bt[t.pointerId]=t,Ht++}function qt(t){Bt[t.pointerId]&&(Bt[t.pointerId]=t)}function Wt(t){delete Bt[t.pointerId],Ht--}function Gt(t,e){for(var i in t.touches=[],Bt)t.touches.push(Bt[i]);t.changedTouches=[t],e(t)}var Vt=xt?"MSPointerDown":Tt?"pointerdown":"touchstart",Zt=xt?"MSPointerUp":Tt?"pointerup":"touchend",Xt="_leaflet_";var Yt,$t,Kt,Qt,Jt,te=ge(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ee=ge(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ie="webkitTransition"===ee||"OTransition"===ee?ee+"End":"transitionend";function ne(t){return"string"==typeof t?document.getElementById(t):t}function re(t,e){var i=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!i||"auto"===i)&&document.defaultView){var n=document.defaultView.getComputedStyle(t,null);i=n?n[e]:null}return"auto"===i?null:i}function oe(t,e,i){var n=document.createElement(t);return n.className=e||"",i&&i.appendChild(n),n}function se(t){var e=t.parentNode;e&&e.removeChild(t)}function ae(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function le(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function he(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ce(t,e){if(void 0!==t.classList)return t.classList.contains(e);var i=fe(t);return 0<i.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)}function ue(t,e){if(void 0!==t.classList)for(var i=p(e),n=0,r=i.length;n<r;n++)t.classList.add(i[n]);else if(!ce(t,e)){var o=fe(t);pe(t,(o?o+" ":"")+e)}}function de(t,e){void 0!==t.classList?t.classList.remove(e):pe(t,d((" "+fe(t)+" ").replace(" "+e+" "," ")))}function pe(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function fe(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function me(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}(t,e)}function ge(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}function ve(t,e,i){var n=e||new O(0,0);t.style[te]=(gt?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")}function _e(t,e){t._leaflet_pos=e,yt?ve(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function ye(t){return t._leaflet_pos||new O(0,0)}if("onselectstart"in document)Yt=function(){Le(window,"selectstart",ze)},$t=function(){Ae(window,"selectstart",ze)};else{var be=ge(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yt=function(){if(be){var t=document.documentElement.style;Kt=t[be],t[be]="none"}},$t=function(){be&&(document.documentElement.style[be]=Kt,Kt=void 0)}}function we(){Le(window,"dragstart",ze)}function Se(){Ae(window,"dragstart",ze)}function xe(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Te(),Jt=(Qt=t).style.outline,t.style.outline="none",Le(window,"keydown",Te))}function Te(){Qt&&(Qt.style.outline=Jt,Jt=Qt=void 0,Ae(window,"keydown",Te))}function Ee(t){for(;!((t=t.parentNode).offsetWidth&&t.offsetHeight||t===document.body););return t}function Pe(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Ce=(Object.freeze||Object)({TRANSFORM:te,TRANSITION:ee,TRANSITION_END:ie,get:ne,getStyle:re,create:oe,remove:se,empty:ae,toFront:le,toBack:he,hasClass:ce,addClass:ue,removeClass:de,setClass:pe,getClass:fe,setOpacity:me,testProp:ge,setTransform:ve,setPosition:_e,getPosition:ye,disableTextSelection:Yt,enableTextSelection:$t,disableImageDrag:we,enableImageDrag:Se,preventOutline:xe,restoreOutline:Te,getSizedParentNode:Ee,getScale:Pe});function Le(t,e,i,n){if("object"==typeof e)for(var r in e)Re(t,r,e[r],i);else for(var o=0,s=(e=p(e)).length;o<s;o++)Re(t,e[o],i,n);return this}var ke="_leaflet_events";function Ae(t,e,i,n){if("object"==typeof e)for(var r in e)Ie(t,r,e[r],i);else if(e)for(var o=0,s=(e=p(e)).length;o<s;o++)Ie(t,e[o],i,n);else{for(var a in t[ke])Ie(t,a,t[ke][a]);delete t[ke]}return this}function Re(t,e,i,n){var r=e+a(i)+(n?"_"+a(n):"");if(t[ke]&&t[ke][r])return this;var s=function(e){return i.call(n||t,e||window.event)},l=s;Tt&&0===e.indexOf("touch")?function(t,e,i,n){"touchstart"===e?function(t,e,i){var n=o(function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(Nt.indexOf(t.target.tagName)<0))return;ze(t)}Gt(t,e)});t["_leaflet_touchstart"+i]=n,t.addEventListener(Mt,n,!1),jt||(document.documentElement.addEventListener(Mt,Ut,!0),document.documentElement.addEventListener(Dt,qt,!0),document.documentElement.addEventListener(zt,Wt,!0),document.documentElement.addEventListener(Ft,Wt,!0),jt=!0)}(t,i,n):"touchmove"===e?function(t,e,i){var n=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&Gt(t,e)};t["_leaflet_touchmove"+i]=n,t.addEventListener(Dt,n,!1)}(t,i,n):"touchend"===e&&function(t,e,i){var n=function(t){Gt(t,e)};t["_leaflet_touchend"+i]=n,t.addEventListener(zt,n,!1),t.addEventListener(Ft,n,!1)}(t,i,n)}(t,e,s,r):!Et||"dblclick"!==e||Tt&&ct?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",s,!1):"mouseenter"===e||"mouseleave"===e?(s=function(e){e=e||window.event,Ge(t,e)&&l(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1)):("click"===e&&ot&&(s=function(t){!function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=He&&i-He;if(n&&100<n&&n<500||t.target._simulatedClick&&!t._simulated)return Fe(t);He=i,e(t)}(t,l)}),t.addEventListener(e,s,!1)):"attachEvent"in t&&t.attachEvent("on"+e,s):function(t,e,i){var n,r,o=!1;function s(t){var e;if(Tt){if(!nt||"mouse"===t.pointerType)return;e=Ht}else e=t.touches.length;if(!(1<e)){var i=Date.now(),s=i-(n||i);r=t.touches?t.touches[0]:t,o=0<s&&s<=250,n=i}}function a(t){if(o&&!r.cancelBubble){if(Tt){if(!nt||"mouse"===t.pointerType)return;var i,s,a={};for(s in r)i=r[s],a[s]=i&&i.bind?i.bind(r):i;r=a}r.type="dblclick",r.button=0,e(r),n=null}}t[Xt+Vt+i]=s,t[Xt+Zt+i]=a,t[Xt+"dblclick"+i]=e,t.addEventListener(Vt,s,!1),t.addEventListener(Zt,a,!1),t.addEventListener("dblclick",e,!1)}(t,s,r),t[ke]=t[ke]||{},t[ke][r]=s}function Ie(t,e,i,n){var r=e+a(i)+(n?"_"+a(n):""),o=t[ke]&&t[ke][r];if(!o)return this;Tt&&0===e.indexOf("touch")?function(t,e,i){var n=t["_leaflet_"+e+r];"touchstart"===e?t.removeEventListener(Mt,n,!1):"touchmove"===e?t.removeEventListener(Dt,n,!1):"touchend"===e&&(t.removeEventListener(zt,n,!1),t.removeEventListener(Ft,n,!1))}(t,e):!Et||"dblclick"!==e||Tt&&ct?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",o,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o):function(t,e){var i=t[Xt+Vt+e],n=t[Xt+Zt+e],r=t[Xt+"dblclick"+e];t.removeEventListener(Vt,i,!1),t.removeEventListener(Zt,n,!1),nt||t.removeEventListener("dblclick",r,!1)}(t,r),t[ke][r]=null}function Oe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,We(t),this}function Me(t){return Re(t,"mousewheel",Oe),this}function De(t){return Le(t,"mousedown touchstart dblclick",Oe),Re(t,"click",qe),this}function ze(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Fe(t){return ze(t),Oe(t),this}function Ne(t,e){if(!e)return new O(t.clientX,t.clientY);var i=Pe(e),n=i.boundingClientRect;return new O((t.clientX-n.left)/i.x-e.clientLeft,(t.clientY-n.top)/i.y-e.clientTop)}var Be=mt&&ct?2*window.devicePixelRatio:ut?window.devicePixelRatio:1;function je(t){return nt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/Be:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var He,Ue={};function qe(t){Ue[t.type]=!0}function We(t){var e=Ue[t.type];return Ue[t.type]=!1,e}function Ge(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t}var Ve=(Object.freeze||Object)({on:Le,off:Ae,stopPropagation:Oe,disableScrollPropagation:Me,disableClickPropagation:De,preventDefault:ze,stop:Fe,getMousePosition:Ne,getWheelDelta:je,fakeStop:qe,skipped:We,isExternalTarget:Ge,addListener:Le,removeListener:Ae}),Ze=I.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=ye(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),_e(this._el,i),this.fire("step")},_complete:function(){C(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),Xe=I.extend({options:{crs:$,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=f(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(H(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ee&&yt&&!Pt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Le(this._proxy,ie,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(H(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&!0!==n&&(void 0!==n.animate&&(n.zoom=i({animate:n.animate},n.zoom),n.pan=i({animate:n.animate,duration:n.duration},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),o=(t instanceof O?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/n),s=this.containerPointToLatLng(r.add(o));return this.setView(s,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():B(t);var i=D(e.paddingTopLeft||e.padding||[0,0]),n=D(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===1/0)return{center:t.getCenter(),zoom:r};var o=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),r),a=this.project(t.getNorthEast(),r);return{center:this.unproject(s.add(a).divideBy(2).add(o),r),zoom:r}},fitBounds:function(t,e){if(!(t=B(t)).isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=D(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ze,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){ue(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,i){if(!1===(i=i||{}).animate||!yt)return this.setView(t,e,i);this._stop();var n=this.project(this.getCenter()),r=this.project(t),o=this.getSize(),s=this._zoom;t=H(t),e=void 0===e?s:e;var a=Math.max(o.x,o.y),l=a*this.getZoomScale(s,e),h=r.distanceTo(n)||1,c=1.42,u=c*c;function d(t){var e=(l*l-a*a+(t?-1:1)*u*u*h*h)/(2*(t?l:a)*u*h),i=Math.sqrt(e*e+1)-e;return i<1e-9?-18:Math.log(i)}function p(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t){return(Math.exp(t)+Math.exp(-t))/2}var m=d(0);var g=Date.now(),v=(d(1)-m)/c,_=i.duration?1e3*i.duration:1e3*v*.8;return this._moveStart(!0,i.noMoveStart),function i(){var o=(Date.now()-g)/_,l=function(t){return 1-Math.pow(1-t,1.5)}(o)*v;o<=1?(this._flyToFrame=P(i,this),this._move(this.unproject(n.add(r.subtract(n).multiplyBy(function(t){return a*(f(m)*function(t){return p(t)/f(t)}(m+c*t)-p(m))/u}(l)/h)),s),this.getScaleZoom(a/function(t){return a*(f(m)/f(m+c*t))}(l),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(t){return(t=B(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,B(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},panInside:function(t,e){var i=D((e=e||{}).paddingTopLeft||e.padding||[0,0]),n=D(e.paddingBottomRight||e.padding||[0,0]),r=this.getCenter(),o=this.project(r),s=this.project(t),a=this.getPixelBounds(),l=a.getSize().divideBy(2),h=F([a.min.add(i),a.max.subtract(n)]);if(!h.contains(s)){this._enforcingBounds=!0;var c=o.subtract(s),u=D(s.x+c.x,s.y+c.y);(s.x<h.min.x||s.x>h.max.x)&&(u.x=o.x-c.x,0<c.x?u.x+=l.x-i.x:u.x-=l.x-n.x),(s.y<h.min.y||s.y>h.max.y)&&(u.y=o.y-c.y,0<c.y?u.y+=l.y-i.y:u.y-=l.y-n.y),this.panTo(this.unproject(u),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=i({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),r=e.divideBy(2).round(),s=n.divideBy(2).round(),a=r.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=i({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o(this._handleGeolocationResponse,this),n=o(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=new j(t.coords.latitude,t.coords.longitude),i=e.toBounds(2*t.coords.accuracy),n=this._locateOptions;if(n.setView){var r=this.getBoundsZoom(i);this.setView(e,n.maxZoom?Math.min(r,n.maxZoom):r)}var o={latlng:e,bounds:i,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(o[s]=t.coords[s]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),se(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(C(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)se(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var i=oe("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new N(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=B(t),i=D(i||[0,0]);var n=this.getZoom()||0,r=this.getMinZoom(),o=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(i),h=F(this.project(a,n),this.project(s,n)).getSize(),c=yt?this.options.zoomSnap:1,u=l.x/h.x,d=l.y/h.y,p=e?Math.max(u,d):Math.min(u,d);return n=this.getScaleZoom(p,n),c&&(n=Math.round(n/(c/100))*(c/100),n=e?Math.ceil(n/c)*c:Math.floor(n/c)*c),Math.max(r,Math.min(o,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new O(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new z(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=void 0===e?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var i=this.options.crs;e=void 0===e?this._zoom:e;var n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(H(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(D(t),e)},layerPointToLatLng:function(t){var e=D(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(H(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(H(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(B(t))},distance:function(t,e){return this.options.crs.distance(H(t),H(e))},containerPointToLayerPoint:function(t){return D(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return D(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(D(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(H(t)))},mouseEventToContainerPoint:function(t){return Ne(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ne(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Le(e,"scroll",this._onScroll,this),this._containerId=a(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&yt,ue(t,"leaflet-container"+(Et?" leaflet-touch":"")+(Lt?" leaflet-retina":"")+(it?" leaflet-oldie":"")+(dt?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=re(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_e(this._mapPane,new O(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ue(t.markerPane,"leaflet-zoom-hide"),ue(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){_e(this._mapPane,new O(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n,!1)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,i){void 0===e&&(e=this._zoom);var n=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(n||i&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return C(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){_e(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={};var e=t?Ae:Le;e((this._targets[a(this._container)]=this)._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),yt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){C(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],r="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,s=!1;o;){if((i=this._targets[a(o)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){s=!0;break}if(i&&i.listens(e,!0)){if(r&&!Ge(o,t))break;if(n.push(i),r)break}if(o===this._container)break;o=o.parentNode}return n.length||s||r||!Ge(o,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!We(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||xe(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if("click"===t.type){var r=i({},t);r.type="preclick",this._fireDOMEvent(r,r.type,n)}if(!t._stopped&&(n=(n||[]).concat(this._findEventTargets(t,e))).length){var o=n[0];"contextmenu"===e&&o.listens(e,!0)&&ze(t);var s={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var a=o.getLatLng&&(!o._radius||o._radius<=10);s.containerPoint=a?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=a?o.getLatLng():this.layerPointToLatLng(s.layerPoint)}for(var l=0;l<n.length;l++)if(n[l].fire(e,s,!0),s.originalEvent._stopped||!1===n[l].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return ye(this._mapPane)||new O(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return F([this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),r=this.getSize().divideBy(2),o=new z(n.subtract(r),n.add(r)),s=this._getBoundsOffset(o,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new z(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=F(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),r=n.min.subtract(t.min),o=n.max.subtract(t.max);return new O(this._rebound(r.x,-o.x),this._rebound(r.y,-o.y))},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=yt?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){de(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i)||(this.panBy(i,e),0))},_createAnimProxy:function(){var t=this._proxy=oe("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(t){var e=te,i=this._proxy.style[e];ve(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),e=this.getZoom();ve(this._proxy,this.project(t,e),this.getZoomScale(e,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){se(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/n);return!(!0!==i.animate&&!this.getSize().contains(r)||(P(function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,i,n){this._mapPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&de(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),P(function(){this._moveEnd(!0)},this))}});function Ye(t){return new $e(t)}var $e=A.extend({options:{position:"topright"},initialize:function(t){f(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return ue(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map&&(se(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null),this},_refocusOnMap:function(t){this._map&&t&&0<t.screenX&&0<t.screenY&&this._map.getContainer().focus()}});Xe.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",i=this._controlContainer=oe("div",e+"control-container",this._container);function n(n,r){var o=e+n+" "+e+r;t[n+r]=oe("div",o,i)}n("top","left"),n("top","right"),n("bottom","left"),n("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)se(this._controlCorners[t]);se(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ke=$e.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(t,e,i){for(var n in f(this,i),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){this._initLayout(),this._update(),(this._map=t).on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return $e.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(a(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):de(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return de(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=oe("div",t),i=this.options.collapsed;e.setAttribute("aria-haspopup",!0),De(e),Me(e);var n=this._section=oe("section",t+"-list");i&&(this._map.on("click",this.collapse,this),ot||Le(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var r=this._layersLink=oe("a",t+"-toggle",e);r.href="#",r.title="Layers",Et?(Le(r,"click",Fe),Le(r,"click",this.expand,this)):Le(r,"focus",this.expand,this),i||this.expand(),this._baseLayersList=oe("div",t+"-base",n),this._separator=oe("div",t+"-separator",n),this._overlaysList=oe("div",t+"-overlays",n),e.appendChild(n)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&a(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.sortLayers&&this._layers.sort(o(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ae(this._baseLayersList),ae(this._overlaysList),this._layerControlInputs=[];var t,e,i,n,r=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,r+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&1<r,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(a(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(t){var e,i=document.createElement("label"),n=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=n):e=this._createRadioElement("leaflet-base-layers_"+a(this),n),this._layerControlInputs.push(e),e.layerId=a(t.layer),Le(e,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+t.name;var o=document.createElement("div");return i.appendChild(o),o.appendChild(e),o.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(i),this._checkDisabledLayers(),i},_onInputClick:function(){var t,e,i=this._layerControlInputs,n=[],r=[];this._handlingClick=!0;for(var o=i.length-1;0<=o;o--)t=i[o],e=this._getLayer(t.layerId).layer,t.checked?n.push(e):t.checked||r.push(e);for(o=0;o<r.length;o++)this._map.hasLayer(r[o])&&this._map.removeLayer(r[o]);for(o=0;o<n.length;o++)this._map.hasLayer(n[o])||this._map.addLayer(n[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,i=this._layerControlInputs,n=this._map.getZoom(),r=i.length-1;0<=r;r--)t=i[r],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&n<e.options.minZoom||void 0!==e.options.maxZoom&&n>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Qe=$e.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=oe("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,r){var o=oe("a",i,n);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),De(o),Le(o,"click",Fe),Le(o,"click",r,this),Le(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";de(this._zoomInButton,e),de(this._zoomOutButton,e),!this._disabled&&t._zoom!==t.getMinZoom()||ue(this._zoomOutButton,e),!this._disabled&&t._zoom!==t.getMaxZoom()||ue(this._zoomInButton,e)}});Xe.mergeOptions({zoomControl:!0}),Xe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Qe,this.addControl(this.zoomControl))});var Je=$e.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=oe("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=oe("div",e,i)),t.imperial&&(this._iScale=oe("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,r=3.2808399*t;5280<r?(e=r/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(r),this._updateScale(this._iScale,n+" ft",n/r))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(10<=i?10:5<=i?5:3<=i?3:2<=i?2:1)}}),ti=$e.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){f(this,t),this._attributions={}},onAdd:function(t){for(var e in(t.attributionControl=this)._container=oe("div","leaflet-control-attribution"),De(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t&&(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update()),this},removeAttribution:function(t){return t&&this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}});Xe.mergeOptions({attributionControl:!0}),Xe.addInitHook(function(){this.options.attributionControl&&(new ti).addTo(this)}),$e.Layers=Ke,$e.Zoom=Qe,$e.Scale=Je,$e.Attribution=ti,Ye.layers=function(t,e,i){return new Ke(t,e,i)},Ye.zoom=function(t){return new Qe(t)},Ye.scale=function(t){return new Je(t)},Ye.attribution=function(t){return new ti(t)};var ei=A.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled&&(this._enabled=!1,this.removeHooks()),this},enabled:function(){return!!this._enabled}});ei.addTo=function(t,e){return t.addHandler(e,this),this};var ii,ni={Events:R},ri=Et?"touchstart mousedown":"mousedown",oi={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},si={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},ai=I.extend({options:{clickTolerance:3},initialize:function(t,e,i,n){f(this,n),this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(Le(this._dragStartTarget,ri,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ai._dragging===this&&this.finishDrag(),Ae(this._dragStartTarget,ri,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!ce(this._element,"leaflet-zoom-anim")&&!(ai._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||((ai._dragging=this)._preventOutline&&xe(this._element),we(),Yt(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,i=Ee(this._element);this._startPoint=new O(e.clientX,e.clientY),this._parentScale=Pe(i),Le(document,si[t.type],this._onMove,this),Le(document,oi[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&1<t.touches.length)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new O(e.clientX,e.clientY)._subtract(this._startPoint);(i.x||i.y)&&(Math.abs(i.x)+Math.abs(i.y)<this.options.clickTolerance||(i.x/=this._parentScale.x,i.y/=this._parentScale.y,ze(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=ye(this._element).subtract(i),ue(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(i),this._moving=!0,C(this._animRequest),this._lastEvent=t,this._animRequest=P(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),_e(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in de(document.body,"leaflet-dragging"),this._lastTarget&&(de(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),si)Ae(document,si[t],this._onMove,this),Ae(document,oi[t],this._onUp,this);Se(),$t(),this._moved&&this._moving&&(C(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,ai._dragging=!1}});function li(t,e){if(!e||!t.length)return t.slice();var i=e*e;return function(t,e){var i=t.length,n=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(i);n[0]=n[i-1]=1,function t(e,i,n,r,o){var s,a,l,h=0;for(a=r+1;a<=o-1;a++)h<(l=pi(e[a],e[r],e[o],!0))&&(s=a,h=l);n<h&&(i[s]=1,t(e,i,n,r,s),t(e,i,n,s,o))}(t,n,e,0,i-1);var r,o=[];for(r=0;r<i;r++)n[r]&&o.push(t[r]);return o}(t=function(t,e){for(var i=[t[0]],n=1,r=0,o=t.length;n<o;n++)s=t[n],e<(l=(a=t[r]).x-s.x)*l+(h=a.y-s.y)*h&&(i.push(t[n]),r=n);var s,a,l,h;return r<o-1&&i.push(t[o-1]),i}(t,i),i)}function hi(t,e,i){return Math.sqrt(pi(t,e,i,!0))}function ci(t,e,i,n,r){var o,s,a,l=n?ii:di(t,i),h=di(e,i);for(ii=h;;){if(!(l|h))return[t,e];if(l&h)return!1;a=di(s=ui(t,e,o=l||h,i,r),i),o===l?(t=s,l=a):(e=s,h=a)}}function ui(t,e,i,n,r){var o,s,a=e.x-t.x,l=e.y-t.y,h=n.min,c=n.max;return 8&i?(o=t.x+a*(c.y-t.y)/l,s=c.y):4&i?(o=t.x+a*(h.y-t.y)/l,s=h.y):2&i?(o=c.x,s=t.y+l*(c.x-t.x)/a):1&i&&(o=h.x,s=t.y+l*(h.x-t.x)/a),new O(o,s,r)}function di(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i}function pi(t,e,i,n){var r,o=e.x,s=e.y,a=i.x-o,l=i.y-s,h=a*a+l*l;return 0<h&&(1<(r=((t.x-o)*a+(t.y-s)*l)/h)?(o=i.x,s=i.y):0<r&&(o+=a*r,s+=l*r)),a=t.x-o,l=t.y-s,n?a*a+l*l:new O(o,s)}function fi(t){return!_(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function mi(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fi(t)}var gi=(Object.freeze||Object)({simplify:li,pointToSegmentDistance:hi,closestPointOnSegment:function(t,e,i){return pi(t,e,i)},clipSegment:ci,_getEdgeIntersection:ui,_getBitCode:di,_sqClosestPointOnSegment:pi,isFlat:fi,_flat:mi});function vi(t,e,i){var n,r,o,s,a,l,h,c,u,d=[1,4,2,8];for(r=0,h=t.length;r<h;r++)t[r]._code=di(t[r],e);for(s=0;s<4;s++){for(c=d[s],n=[],r=0,o=(h=t.length)-1;r<h;o=r++)a=t[r],l=t[o],a._code&c?l._code&c||((u=ui(l,a,c,e,i))._code=di(u,e),n.push(u)):(l._code&c&&((u=ui(l,a,c,e,i))._code=di(u,e),n.push(u)),n.push(a));t=n}return t}var _i,yi=(Object.freeze||Object)({clipPolygon:vi}),bi={project:function(t){return new O(t.lng,t.lat)},unproject:function(t){return new j(t.y,t.x)},bounds:new z([-180,-90],[180,90])},wi={R:6378137,R_MINOR:6356752.314245179,bounds:new z([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,r=this.R_MINOR/i,o=Math.sqrt(1-r*r),s=o*Math.sin(n),a=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),o/2);return n=-i*Math.log(Math.max(a,1e-10)),new O(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,r=this.R_MINOR/n,o=Math.sqrt(1-r*r),s=Math.exp(-t.y/n),a=Math.PI/2-2*Math.atan(s),l=0,h=.1;l<15&&1e-7<Math.abs(h);l++)e=o*Math.sin(a),e=Math.pow((1-e)/(1+e),o/2),a+=h=Math.PI/2-2*Math.atan(s*e)-a;return new j(a*i,t.x*i/n)}},Si=(Object.freeze||Object)({LonLat:bi,Mercator:wi,SphericalMercator:V}),xi=i({},W,{code:"EPSG:3395",projection:wi,transformation:(_i=.5/(Math.PI*wi.R),X(_i,.5,-_i,.5))}),Ti=i({},W,{code:"EPSG:4326",projection:bi,transformation:X(1/180,1,-1/180,.5)}),Ei=i({},q,{projection:bi,transformation:X(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0});q.Earth=W,q.EPSG3395=xi,q.EPSG3857=$,q.EPSG900913=K,q.EPSG4326=Ti,q.Simple=Ei;var Pi=I.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[a(t)]=this},removeInteractiveTarget:function(t){return delete this._map._targets[a(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});Xe.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=a(t);return this._layers[e]||((this._layers[e]=t)._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=a(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null),this},hasLayer:function(t){return!!t&&a(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){for(var e=0,i=(t=t?_(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[a(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=a(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,i=this._getZoomSpan();for(var n in this._zoomBoundLayers){var r=this._zoomBoundLayers[n].options;t=void 0===r.minZoom?t:Math.min(t,r.minZoom),e=void 0===r.maxZoom?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,i!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ci=Pi.extend({initialize:function(t,e){var i,n;if(f(this,e),this._layers={},t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return a(t)}}),Li=Ci.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ci.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ci.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new N;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),ki=A.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){f(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var r=D(n),o=D("shadow"===e&&i.shadowAnchor||i.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Lt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),Ai=ki.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Ai.imagePath||(Ai.imagePath=this._detectIconPath()),(this.options.imagePath||Ai.imagePath)+ki.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=oe("div","leaflet-default-icon-path",document.body),e=re(t,"background-image")||re(t,"backgroundImage");return document.body.removeChild(t),null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Ri=ei.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new ai(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ue(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&de(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,i=e._map,n=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,o=ye(e._icon),s=i.getPixelBounds(),a=i.getPixelOrigin(),l=F(s.min._subtract(a).add(r),s.max._subtract(a).subtract(r));if(!l.contains(o)){var h=D((Math.max(l.max.x,o.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(n);i.panBy(h,{animate:!1}),this._draggable._newPos._add(h),this._draggable._startPos._add(h),_e(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=P(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(C(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,i=e._shadow,n=ye(e._icon),r=e._map.layerPointToLatLng(n);i&&_e(i,n),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){C(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Ii=Pi.extend({options:{icon:new Ai,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){f(this,e),this._latlng=H(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=H(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),"IMG"===i.tagName&&(i.alt=t.alt||"")),ue(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),o=!1;r!==this._shadow&&(this._removeShadow(),o=!0),r&&(ue(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),se(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&se(this._shadow),this._shadow=null},_setPos:function(t){_e(this._icon,t),this._shadow&&_e(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ri)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ri(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&me(this._icon,t),this._shadow&&me(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Oi=Pi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return f(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t.hasOwnProperty("weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Mi=Oi.extend({options:{fill:!0,radius:10},initialize:function(t,e){f(this,e),this._latlng=H(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=H(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Oi.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new z(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Di=Mi.extend({initialize:function(t,e,n){if("number"==typeof e&&(e=i({},n,{radius:e})),f(this,e),this._latlng=H(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Oi.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===W.distance){var r=Math.PI/180,o=this._mRadius/W.R/r,s=i.project([e+o,t]),a=i.project([e-o,t]),l=s.add(a).divideBy(2),h=i.unproject(l).lat,c=Math.acos((Math.cos(o*r)-Math.sin(e*r)*Math.sin(h*r))/(Math.cos(e*r)*Math.cos(h*r)))/r;!isNaN(c)&&0!==c||(c=o/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-i.project([h,t-c]).x,this._radiusY=l.y-s.y}else{var u=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(u).x}this._updateBounds()}}),zi=Oi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){f(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,r=null,o=pi,s=0,a=this._parts.length;s<a;s++)for(var l=this._parts[s],h=1,c=l.length;h<c;h++){var u=o(t,e=l[h-1],i=l[h],!0);u<n&&(n=u,r=o(t,e,i))}return r&&(r.distance=Math.sqrt(n)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a=this._rings[0],l=a.length;if(!l)return null;for(e=t=0;t<l-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(n=t=0;t<l-1;t++)if(r=a[t],o=a[t+1],e<(n+=i=r.distanceTo(o)))return s=(n-e)/i,this._map.layerPointToLatLng([o.x-s*(o.x-r.x),o.y-s*(o.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=H(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new N,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return fi(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=fi(t),n=0,r=t.length;n<r;n++)i?(e[n]=H(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new z;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new O(t,t);this._pxBounds=new z([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,i){var n,r,o=t[0]instanceof j,s=t.length;if(o){for(r=[],n=0;n<s;n++)r[n]=this._map.latLngToLayerPoint(t[n]),i.extend(r[n]);e.push(r)}else for(n=0;n<s;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,i,n,r,o,s,a,l=this._parts;for(n=e=0,r=this._rings.length;e<r;e++)for(i=0,o=(a=this._rings[e]).length;i<o-1;i++)(s=ci(a[i],a[i+1],t,i,!0))&&(l[n]=l[n]||[],l[n].push(s[0]),s[1]===a[i+1]&&i!==o-2||(l[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=li(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var i,n,r,o,s,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(i=0,o=this._parts.length;i<o;i++)for(n=0,r=(s=(a=this._parts[i]).length)-1;n<s;r=n++)if((e||0!==n)&&hi(t,a[r],a[n])<=l)return!0;return!1}});zi._flat=mi;var Fi=zi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,r,o,s,a,l,h=this._rings[0],c=h.length;if(!c)return null;for(o=s=a=0,t=0,e=c-1;t<c;e=t++)i=h[t],n=h[e],r=i.y*n.x-n.y*i.x,s+=(i.x+n.x)*r,a+=(i.y+n.y)*r,o+=3*r;return l=0===o?h[0]:[s/o,a/o],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=zi.prototype._convertLatLngs.call(this,t),i=e.length;return 2<=i&&e[0]instanceof j&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){zi.prototype._setLatLngs.call(this,t),fi(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fi(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new O(e,e);if(t=new z(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var n,r=0,o=this._rings.length;r<o;r++)(n=vi(this._rings[r],t,!0)).length&&this._parts.push(n)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,i,n,r,o,s,a,l,h=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(r=0,a=this._parts.length;r<a;r++)for(o=0,s=(l=(e=this._parts[r]).length)-1;o<l;s=o++)i=e[o],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(h=!h);return h||zi.prototype._containsPoint.call(this,t,!0)}}),Ni=Li.extend({initialize:function(t,e){f(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=_(t)?t:t.features;if(r){for(e=0,i=r.length;e<i;e++)((n=r[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var s=Bi(t,o);return s?(s.feature=Gi(t),s.defaultOptions=s.options,this.resetStyle(s),o.onEachFeature&&o.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=i({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Bi(t,e){var i,n,r,o,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,l=[],h=e&&e.pointToLayer,c=e&&e.coordsToLatLng||ji;if(!a&&!s)return null;switch(s.type){case"Point":return i=c(a),h?h(t,i):new Ii(i);case"MultiPoint":for(r=0,o=a.length;r<o;r++)i=c(a[r]),l.push(h?h(t,i):new Ii(i));return new Li(l);case"LineString":case"MultiLineString":return n=Hi(a,"LineString"===s.type?0:1,c),new zi(n,e);case"Polygon":case"MultiPolygon":return n=Hi(a,"Polygon"===s.type?1:2,c),new Fi(n,e);case"GeometryCollection":for(r=0,o=s.geometries.length;r<o;r++){var u=Bi({geometry:s.geometries[r],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new Li(l);default:throw new Error("Invalid GeoJSON object.")}}function ji(t){return new j(t[1],t[0],t[2])}function Hi(t,e,i){for(var n,r=[],o=0,s=t.length;o<s;o++)n=e?Hi(t[o],e-1,i):(i||ji)(t[o]),r.push(n);return r}function Ui(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[u(t.lng,e),u(t.lat,e),u(t.alt,e)]:[u(t.lng,e),u(t.lat,e)]}function qi(t,e,i,n){for(var r=[],o=0,s=t.length;o<s;o++)r.push(e?qi(t[o],e-1,i,n):Ui(t[o],n));return!e&&i&&r.push(r[0]),r}function Wi(t,e){return t.feature?i({},t.feature,{geometry:e}):Gi(e)}function Gi(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Vi={toGeoJSON:function(t){return Wi(this,{type:"Point",coordinates:Ui(this.getLatLng(),t)})}};function Zi(t,e){return new Ni(t,e)}Ii.include(Vi),Di.include(Vi),Mi.include(Vi),zi.include({toGeoJSON:function(t){var e=!fi(this._latlngs);return Wi(this,{type:(e?"Multi":"")+"LineString",coordinates:qi(this._latlngs,e?1:0,!1,t)})}}),Fi.include({toGeoJSON:function(t){var e=!fi(this._latlngs),i=e&&!fi(this._latlngs[0]),n=qi(this._latlngs,i?2:e?1:0,!0,t);return e||(n=[n]),Wi(this,{type:(i?"Multi":"")+"Polygon",coordinates:n})}}),Ci.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(i){e.push(i.toGeoJSON(t).geometry.coordinates)}),Wi(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var i="GeometryCollection"===e,n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(i)n.push(r.geometry);else{var o=Gi(r);"FeatureCollection"===o.type?n.push.apply(n,o.features):n.push(o)}}}),i?Wi(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}});var Xi=Zi,Yi=Pi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,i){this._url=t,this._bounds=B(e),f(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){se(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&le(this._image),this},bringToBack:function(){return this._map&&he(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=B(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:oe("img");ue(e,"leaflet-image-layer"),this._zoomAnimated&&ue(e,"leaflet-zoom-animated"),this.options.className&&ue(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=o(this.fire,this,"load"),e.onerror=o(this._overlayOnError,this,"error"),!this.options.crossOrigin&&""!==this.options.crossOrigin||(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ve(this._image,i,e)},_reset:function(){var t=this._image,e=new z(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();_e(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){me(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),$i=Yi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:oe("video");if(ue(e,"leaflet-image-layer"),this._zoomAnimated&&ue(e,"leaflet-zoom-animated"),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=o(this.fire,this,"load"),t){for(var i=e.getElementsByTagName("source"),n=[],r=0;r<i.length;r++)n.push(i[r].src);this._url=0<i.length?n:[e.src]}else{_(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&e.style.hasOwnProperty("objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var s=0;s<this._url.length;s++){var a=oe("source");a.src=this._url[s],e.appendChild(a)}}}}),Ki=Yi.extend({_initImage:function(){var t=this._image=this._url;ue(t,"leaflet-image-layer"),this._zoomAnimated&&ue(t,"leaflet-zoom-animated"),t.onselectstart=c,t.onmousemove=c}}),Qi=Pi.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){f(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&me(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&me(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(me(this._container,0),this._removeTimeout=setTimeout(o(se,void 0,this._container),200)):se(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=H(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&le(this._container),this},bringToBack:function(){return this._map&&he(this._container),this},_prepareOpen:function(t,e,i){if(e instanceof Pi||(i=e,e=t),e instanceof Li)for(var n in t._layers){e=t._layers[n];break}if(!i)if(e.getCenter)i=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");i=e.getLatLng()}return this._source=e,this.update(),i},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=D(this.options.offset),i=this._getAnchor();this._zoomAnimated?_e(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}}),Ji=Qi.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Qi.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Oi||this._source.on("preclick",Oe))},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Oi||this._source.off("preclick",Oe))},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=oe("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),i=this._wrapper=oe("div",t+"-content-wrapper",e);if(this._contentNode=oe("div",t+"-content",i),De(i),Me(this._contentNode),Le(i,"contextmenu",Oe),this._tipContainer=oe("div",t+"-tip-container",e),this._tip=oe("div",t+"-tip",this._tipContainer),this.options.closeButton){var n=this._closeButton=oe("a",t+"-close-button",e);n.href="#close",n.innerHTML="&#215;",Le(n,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight,o="leaflet-popup-scrolled";r&&r<n?(e.height=r+"px",ue(t,o)):de(t,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();_e(this._container,e.add(i))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(re(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,r=new O(this._containerLeft,-i-this._containerBottom);r._add(ye(this._container));var o=t.layerPointToContainerPoint(r),s=D(this.options.autoPanPadding),a=D(this.options.autoPanPaddingTopLeft||s),l=D(this.options.autoPanPaddingBottomRight||s),h=t.getSize(),c=0,u=0;o.x+n+l.x>h.x&&(c=o.x+n-h.x+l.x),o.x-c-a.x<0&&(c=o.x-a.x),o.y+i+l.y>h.y&&(u=o.y+i-h.y+l.y),o.y-u-a.y<0&&(u=o.y-a.y),(c||u)&&t.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(t){this._close(),Fe(t)},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});Xe.mergeOptions({closePopupOnClick:!0}),Xe.include({openPopup:function(t,e,i){return t instanceof Ji||(t=new Ji(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Pi.include({bindPopup:function(t,e){return t instanceof Ji?(f(t,e),(this._popup=t)._source=this):(this._popup&&!e||(this._popup=new Ji(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Fe(t),e instanceof Oi?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var tn=Qi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Qi.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Qi.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Qi.prototype.getEvents.call(this);return Et&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=oe("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),r=e.layerPointToContainerPoint(t),o=this.options.direction,s=i.offsetWidth,a=i.offsetHeight,l=D(this.options.offset),h=this._getAnchor();t="top"===o?t.add(D(-s/2+l.x,-a+l.y+h.y,!0)):"bottom"===o?t.subtract(D(s/2-l.x,-l.y,!0)):"center"===o?t.subtract(D(s/2+l.x,a/2-h.y+l.y,!0)):"right"===o||"auto"===o&&r.x<n.x?(o="right",t.add(D(l.x+h.x,h.y-a/2+l.y,!0))):(o="left",t.subtract(D(s+h.x-l.x,a/2-h.y-l.y,!0))),de(i,"leaflet-tooltip-right"),de(i,"leaflet-tooltip-left"),de(i,"leaflet-tooltip-top"),de(i,"leaflet-tooltip-bottom"),ue(i,"leaflet-tooltip-"+o),_e(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&me(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});Xe.include({openTooltip:function(t,e,i){return t instanceof tn||(t=new tn(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Pi.include({bindTooltip:function(t,e){return t instanceof tn?(f(t,e),(this._tooltip=t)._source=this):(this._tooltip&&!e||(this._tooltip=new tn(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),Et&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(ue(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(de(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}});var en=ki.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),i=this.options;if(i.html instanceof Element?(ae(e),e.appendChild(i.html)):e.innerHTML=!1!==i.html?i.html:"",i.bgPos){var n=D(i.bgPos);e.style.backgroundPosition=-n.x+"px "+-n.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});ki.Default=Ai;var nn=Pi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:bt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){f(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),se(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(le(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(he(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=l(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof O?t:new O(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-1/0,1/0),r=0,o=i.length;r<o;r++)e=i[r].style.zIndex,i[r]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!it){me(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var r=this._tiles[n];if(r.current&&r.loaded){var o=Math.min(1,(t-r.loaded)/200);me(r.el,o),o<1?e=!0:(r.active?i=!0:this._onOpaqueTile(r),r.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(C(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=oe("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var i in this._levels)this._levels[i].el.children.length||i===t?(this._levels[i].el.style.zIndex=e-Math.abs(t-i),this._onUpdateLevel(i)):(se(this._levels[i].el),this._removeTilesAtZoom(i),this._onRemoveLevel(i),delete this._levels[i]);var n=this._levels[t],r=this._map;return n||((n=this._levels[t]={}).el=oe("div","leaflet-tile-container leaflet-zoom-animated",this._container),n.el.style.zIndex=e,n.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),n.zoom=t,this._setZoomTransform(n,r.getCenter(),r.getZoom()),n.el.offsetWidth,this._onCreateLevel(n)),this._level=n}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)se(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,i,n){var r=Math.floor(t/2),o=Math.floor(e/2),s=i-1,a=new O(+r,+o);a.z=+s;var l=this._tileCoordsToKey(a),h=this._tiles[l];return h&&h.active?h.retain=!0:(h&&h.loaded&&(h.retain=!0),n<s&&this._retainParent(r,o,s,n))},_retainChildren:function(t,e,i,n){for(var r=2*t;r<2*t+2;r++)for(var o=2*e;o<2*e+2;o++){var s=new O(r,o);s.z=i+1;var a=this._tileCoordsToKey(s),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(r,o,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,i,n){var r=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom)&&(r=void 0);var o=this.options.updateWhenZooming&&r!==this._tileZoom;n&&!o||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),r=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();yt?ve(t.el,r,n):_e(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),r=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*n);return new z(r.subtract(o),r.add(o))},_update:function(t){var e=this._map;if(e){var i=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var n=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(n),o=r.getCenter(),s=[],a=this.options.keepBuffer,l=new z(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var h in this._tiles){var c=this._tiles[h].coords;c.z===this._tileZoom&&l.contains(new O(c.x,c.y))||(this._tiles[h].current=!1)}if(1<Math.abs(i-this._tileZoom))this._setView(t,i);else{for(var u=r.min.y;u<=r.max.y;u++)for(var d=r.min.x;d<=r.max.x;d++){var p=new O(d,u);if(p.z=this._tileZoom,this._isValidTile(p)){var f=this._tiles[this._tileCoordsToKey(p)];f?f.current=!0:s.push(p)}}if(s.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)}),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(d=0;d<s.length;d++)this._addTile(s[d],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return B(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),r=n.add(i);return[e.unproject(n,t.z),e.unproject(r,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),i=new N(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new O(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(se(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){ue(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,it&&this.options.opacity<1&&me(t,this.options.opacity),ot&&!st&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),o(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&P(o(this._tileReady,this,t,null,r)),_e(r,i),this._tiles[n]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);(i=this._tiles[n])&&(i.loaded=+new Date,this._map._fadeAnimated?(me(i.el,0),C(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(ue(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),it||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new O(this._wrapX?h(t.x,this._wrapX):t.x,this._wrapY?h(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new z(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),rn=nn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=f(this,e)).detectRetina&&Lt&&0<e.maxZoom&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),ot||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var i=document.createElement("img");return Le(i,"load",o(this._tileOnLoad,this,e,i)),Le(i,"error",o(this._tileOnError,this,e,i)),!this.options.crossOrigin&&""!==this.options.crossOrigin||(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i.alt="",i.setAttribute("role","presentation"),i.src=this.getTileUrl(t),i},getTileUrl:function(t){var e={r:Lt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=n),e["-y"]=n}return v(this._url,i(e,this.options))},_tileOnLoad:function(t,e){it?setTimeout(o(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.getAttribute("src")!==n&&(e.src=n),t(i,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=c,e.onerror=c,e.complete||(e.src=b,se(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return lt||e.el.setAttribute("src",b),nn.prototype._removeTile.call(this,t)},_tileReady:function(t,e,i){if(this._map&&(!i||i.getAttribute("src")!==b))return nn.prototype._tileReady.call(this,t,e,i)}});function on(t,e){return new rn(t,e)}var sn=rn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n=i({},this.defaultWmsParams);for(var r in e)r in this.options||(n[r]=e[r]);var o=(e=f(this,e)).detectRetina&&Lt?2:1,s=this.getTileSize();n.width=s.x*o,n.height=s.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,rn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),i=this._crs,n=F(i.project(e[0]),i.project(e[1])),r=n.min,o=n.max,s=(1.3<=this._wmsVersion&&this._crs===Ti?[r.y,r.x,o.y,o.x]:[r.x,r.y,o.x,o.y]).join(","),a=rn.prototype.getTileUrl.call(this,t);return a+m(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return i(this.wmsParams,t),e||this.redraw(),this}});rn.WMS=sn,on.wms=function(t,e){return new sn(t,e)};var an=Pi.extend({options:{padding:.1,tolerance:0},initialize:function(t){f(this,t),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=ye(this._container),r=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),s=this._map.project(t,e).subtract(o),a=r.multiplyBy(-i).add(n).add(r).subtract(s);yt?ve(this._container,a,i):_e(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new z(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ln=an.extend({getEvents:function(){var t=an.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){an.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Le(t,"mousemove",l(this._onMouseMove,32,this),this),Le(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Le(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){C(this._redrawRequest),delete this._ctx,se(this._container),Ae(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){an.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=Lt?2:1;_e(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",Lt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){an.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t);var e=(this._layers[a(t)]=t)._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[a(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,i,n=t.options.dashArray.split(/[, ]+/),r=[];for(i=0;i<n.length;i++){if(e=Number(n[i]),isNaN(e))return;r.push(e)}t.options._dashArray=r}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new z,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var i=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,i.x,i.y),this._ctx.clip()}this._drawing=!0;for(var n=this._drawFirst;n;n=n.next)t=n.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var i,n,r,o,s=t._parts,a=s.length,l=this._ctx;if(a){for(l.beginPath(),i=0;i<a;i++){for(n=0,r=s[i].length;n<r;n++)o=s[i][n],l[n?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||n)/n;1!=r&&(i.save(),i.scale(1,r)),i.beginPath(),i.arc(e.x,e.y/r,n,0,2*Math.PI,!1),1!=r&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&0!==i.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(t){for(var e,i,n=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(n)&&!this._map._draggableMoved(e)&&(i=e);i&&(qe(t),this._fireEvent([i],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(de(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var i,n,r=this._drawFirst;r;r=r.next)(i=r.layer).options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(ue(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;i&&((i.prev=n)?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,(this._drawLast.next=e).next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var i=e.next,n=e.prev;n&&((n.next=i)?i.prev=n:n&&(this._drawLast=n),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function hn(t){return kt?new ln(t):null}var cn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),un={_initContainer:function(){this._container=oe("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(an.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=cn("shape");ue(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=cn("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;se(e),t.removeInteractiveTarget(e),delete this._layers[a(t)]},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,r=t._container;r.stroked=!!n.stroke,r.filled=!!n.fill,n.stroke?(e||(e=t._stroke=cn("stroke")),r.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=_(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(r.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=cn("fill")),r.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(r.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){le(t._container)},_bringToBack:function(t){he(t._container)}},dn=Rt?cn:Q,pn=an.extend({getEvents:function(){var t=an.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=dn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=dn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){se(this._container),Ae(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){an.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),_e(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=dn("path");t.options.className&&ue(e,t.options.className),t.options.interactive&&ue(e,"leaflet-interactive"),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){se(t._path),t.removeInteractiveTarget(t._path),delete this._layers[a(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,J(t._parts,e))},_updateCircle:function(t){var e=t._point,i=Math.max(Math.round(t._radius),1),n="a"+i+","+(Math.max(Math.round(t._radiusY),1)||i)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+n+2*i+",0 "+n+2*-i+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){le(t._path)},_bringToBack:function(t){he(t._path)}});function fn(t){return At||Rt?new pn(t):null}Rt&&pn.include(un),Xe.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&hn(t)||fn(t)}});var mn=Fi.extend({initialize:function(t,e){Fi.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=B(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});pn.create=dn,pn.pointsToPath=J,Ni.geometryToLayer=Bi,Ni.coordsToLatLng=ji,Ni.coordsToLatLngs=Hi,Ni.latLngToCoords=Ui,Ni.latLngsToCoords=qi,Ni.getFeature=Wi,Ni.asFeature=Gi,Xe.mergeOptions({boxZoom:!0});var gn=ei.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Le(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ae(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){se(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),Yt(),we(),this._startPoint=this._map.mouseEventToContainerPoint(t),Le(document,{contextmenu:Fe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=oe("div","leaflet-zoom-box",this._container),ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new z(this._point,this._startPoint),i=e.getSize();_e(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(se(this._box),de(this._container,"leaflet-crosshair")),$t(),Se(),Ae(document,{contextmenu:Fe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var e=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});Xe.addInitHook("addHandler","boxZoom",gn),Xe.mergeOptions({doubleClickZoom:!0});var vn=ei.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,r=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});Xe.addInitHook("addHandler","doubleClickZoom",vn),Xe.mergeOptions({dragging:!0,inertia:!st,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var _n=ei.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new ai(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){de(this._map._container,"leaflet-grab"),de(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=B(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;1<this._positions.length&&50<t-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,r=(n-e+i)%t+e-i,o=(n+e+i)%t-e-i,s=Math.abs(r+i)<Math.abs(o+i)?r:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,a=r.multiplyBy(s/o),l=a.distanceTo([0,0]),h=Math.min(i.inertiaMaxSpeed,l),c=a.multiplyBy(h/l),u=h/(i.inertiaDeceleration*s),d=c.multiplyBy(-u/2).round();d.x||d.y?(d=e._limitOffset(d,e.options.maxBounds),P(function(){e.panBy(d,{duration:u,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}});Xe.addInitHook("addHandler","dragging",_n),Xe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yn=ei.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Le(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ae(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,i=t.scrollTop||e.scrollTop,n=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(n,i)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},r=this.keyCodes;for(e=0,i=r.left.length;e<i;e++)n[r.left[e]]=[-1*t,0];for(e=0,i=r.right.length;e<i;e++)n[r.right[e]]=[t,0];for(e=0,i=r.down.length;e<i;e++)n[r.down[e]]=[0,t];for(e=0,i=r.up.length;e<i;e++)n[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},r=this.keyCodes;for(e=0,i=r.zoomIn.length;e<i;e++)n[r.zoomIn[e]]=t;for(e=0,i=r.zoomOut.length;e<i;e++)n[r.zoomOut[e]]=-t},_addHooks:function(){Le(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ae(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys)n._panAnim&&n._panAnim._inProgress||(e=this._panKeys[i],t.shiftKey&&(e=D(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds));else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i||!n._popup||!n._popup.options.closeOnEscapeKey)return;n.closePopup()}Fe(t)}}});Xe.addInitHook("addHandler","keyboard",yn),Xe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bn=ei.extend({addHooks:function(){Le(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ae(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=je(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),n),Fe(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,o=i?Math.ceil(r/i)*i:r,s=t._limitZoom(e+(0<this._delta?o:-o))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});Xe.addInitHook("addHandler","scrollWheelZoom",bn),Xe.mergeOptions({tap:!0,tapTolerance:15});var wn=ei.extend({addHooks:function(){Le(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ae(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(ze(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new O(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&ue(i,"leaflet-active"),this._holdTimeout=setTimeout(o(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),this._simulateEvent("mousedown",e),Le(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Ae(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&de(i,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new O(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var i=document.createEvent("MouseEvents");i._simulated=!0,e.target._simulatedClick=!0,i.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}});Et&&!Tt&&Xe.addInitHook("addHandler","tap",wn),Xe.mergeOptions({touchZoom:Et&&!st,bounceAtZoomLimits:!0});var Sn=ei.extend({addHooks:function(){ue(this._map._container,"leaflet-touch-zoom"),Le(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){de(this._map._container,"leaflet-touch-zoom"),Ae(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(i.add(n)._divideBy(2))),this._startDist=i.distanceTo(n),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Le(document,"touchmove",this._onTouchMove,this),Le(document,"touchend",this._onTouchEnd,this),ze(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),r=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&1<r)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1==r)return}else{var s=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1==r&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),C(this._animRequest);var a=o(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=P(a,this,!0),ze(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,C(this._animRequest),Ae(document,"touchmove",this._onTouchMove),Ae(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});Xe.addInitHook("addHandler","touchZoom",Sn),Xe.BoxZoom=gn,Xe.DoubleClickZoom=vn,Xe.Drag=_n,Xe.Keyboard=yn,Xe.ScrollWheelZoom=bn,Xe.Tap=wn,Xe.TouchZoom=Sn,Object.freeze=e,t.version="1.5.1+build.2e3e0ffb",t.Control=$e,t.control=Ye,t.Browser=Ot,t.Evented=I,t.Mixin=ni,t.Util=k,t.Class=A,t.Handler=ei,t.extend=i,t.bind=o,t.stamp=a,t.setOptions=f,t.DomEvent=Ve,t.DomUtil=Ce,t.PosAnimation=Ze,t.Draggable=ai,t.LineUtil=gi,t.PolyUtil=yi,t.Point=O,t.point=D,t.Bounds=z,t.bounds=F,t.Transformation=Z,t.transformation=X,t.Projection=Si,t.LatLng=j,t.latLng=H,t.LatLngBounds=N,t.latLngBounds=B,t.CRS=q,t.GeoJSON=Ni,t.geoJSON=Zi,t.geoJson=Xi,t.Layer=Pi,t.LayerGroup=Ci,t.layerGroup=function(t,e){return new Ci(t,e)},t.FeatureGroup=Li,t.featureGroup=function(t){return new Li(t)},t.ImageOverlay=Yi,t.imageOverlay=function(t,e,i){return new Yi(t,e,i)},t.VideoOverlay=$i,t.videoOverlay=function(t,e,i){return new $i(t,e,i)},t.SVGOverlay=Ki,t.svgOverlay=function(t,e,i){return new Ki(t,e,i)},t.DivOverlay=Qi,t.Popup=Ji,t.popup=function(t,e){return new Ji(t,e)},t.Tooltip=tn,t.tooltip=function(t,e){return new tn(t,e)},t.Icon=ki,t.icon=function(t){return new ki(t)},t.DivIcon=en,t.divIcon=function(t){return new en(t)},t.Marker=Ii,t.marker=function(t,e){return new Ii(t,e)},t.TileLayer=rn,t.tileLayer=on,t.GridLayer=nn,t.gridLayer=function(t){return new nn(t)},t.SVG=pn,t.svg=fn,t.Renderer=an,t.Canvas=ln,t.canvas=hn,t.Path=Oi,t.CircleMarker=Mi,t.circleMarker=function(t,e){return new Mi(t,e)},t.Circle=Di,t.circle=function(t,e,i){return new Di(t,e,i)},t.Polyline=zi,t.polyline=function(t,e){return new zi(t,e)},t.Polygon=Fi,t.polygon=function(t,e){return new Fi(t,e)},t.Rectangle=mn,t.rectangle=function(t,e){return new mn(t,e)},t.Map=Xe,t.map=function(t,e){return new Xe(t,e)};var xn=window.L;t.noConflict=function(){return window.L=xn,this},window.L=t}),function(t,e,i){L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=e.getLatLngs(),n=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(n,!1)}},addVertex:function(t){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);!this.options.allowIntersection&&e||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent,i=e.clientX,n=e.clientY;this._startPoint.call(this,i,n)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent,i=e.clientX,n=e.clientY;this._endPoint.call(this,i,n,t),this._clickHandled=null},_endPoint:function(e,i,n){if(this._mouseDownOrigin){var r=L.point(e,i).distanceTo(this._mouseDownOrigin),o=this._calculateFinishDistance(n.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(n.latlng),this._finishShape()):o<10&&L.Browser.touch?this._finishShape():Math.abs(r)<9*(t.devicePixelRatio||1)&&this.addVertex(n.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,i,n=t.originalEvent;!n.touches||!n.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=n.touches[0].clientX,i=n.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,i),this._endPoint.call(this,e,i,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var n=this._map.latLngToContainerPoint(i.getLatLng()),r=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),o=this._map.latLngToContainerPoint(r.getLatLng());e=n.distanceTo(o)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,n,r,o=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),s=this.options.guidelineDistance,a=this.options.maxGuideLineLength,l=o>a?o-a:s;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));l<o;l+=this.options.guidelineDistance)i=l/o,n={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},(r=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(r,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,i=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,n,r=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=r-(e?2:1),n=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=n*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?i&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&e?this._measurementRunningTotal+this._map.distance(e,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function(t,e){for(;(t=t.parentElement)&&!t.classList.contains(e););return t}(t.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,n=L.Draw.SimpleShape.prototype._getTooltipText.call(this),r=this._shape,o=this.options.showArea;return r&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=o?L.GeometryUtil.readableArea(e,this.options.metric):""),{text:n.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,n=this.options.showRadius,r=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),e=this._shape.getRadius().toFixed(1);var o="";n&&(o=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,r,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:o})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,n=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=n+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.original.className&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,n,r,o,s=this._defaultShape();for(t=0,i=s.length;t<i;t++)(n=this._createMarker(s[t],t)).on("click",this._onMarkerClick,this),n.on("contextmenu",this._onContextMenu,this),this._markers.push(n);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[e],o=this._markers[t],this._createMiddleMarker(r,o),this._updatePrevNext(r,o))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,i=this._poly,n=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),i.options.poly){var r=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(e._origLatLng,n),e.setLatLng(n);var o=i.options.color;i.setStyle({color:this.options.drawError.color}),r&&r.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:o}),r&&r.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var s=this._poly.getLatLngs();this._poly._convertLatLngs(s,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._defaultShape().length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){var e=t.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:e,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),n=t.target;L.extend(n._origLatLng,i),n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,n,r,o=this._getMiddleLatLng(t,e),s=this._createMarker(o);s.setOpacity(.6),t._middleRight=e._middleLeft=s,n=function(){s.off("touchmove",n,this);var r=e._index;s._index=r,s.off("click",i,this).on("click",this._onMarkerClick,this),o.lat=s.getLatLng().lat,o.lng=s.getLatLng().lng,this._spliceLatLngs(r,0,o),this._markers.splice(r,0,s),s.setOpacity(1),this._updateIndexes(r,1),e._index++,this._updatePrevNext(t,s),this._updatePrevNext(s,e),this._poly.fire("editstart")},r=function(){s.off("dragstart",n,this),s.off("dragend",r,this),s.off("touchmove",n,this),this._createMiddleMarker(t,s),this._createMiddleMarker(s,e)},i=function(){n.call(this),r.call(this),this._fireEdit()},s.on("click",i,this).on("dragstart",n,this).on("dragend",r,this).on("touchmove",n,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,n=i.project(t.getLatLng()),r=i.project(e.getLatLng());return i.unproject(n._add(r)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),i=t.target,n=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target._cornerIndex;this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)},_onMarkerDragEnd:function(t){var e,i=t.target;i===this._moveMarker&&(e=this._shape.getBounds().getCenter(),i.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),n=this._shape.getBounds().getCenter(),r=[],o=0,s=i.length;o<s;o++)e=[i[o].lat-n.lat,i[o].lng-n.lng],r.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var i={};if(void 0!==t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if("touch"!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var n=this._map.mouseEventToContainerPoint(i),r=this._map.mouseEventToLayerPoint(i),o=this._map.layerPointToLatLng(r);this._map.fire(e,{latlng:o,layerPoint:r,containerPoint:n,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");return r>0&&parseInt(e.substring(r+5,e.indexOf(".",r)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var r=e.indexOf("Edge/");return r>0&&parseInt(e.substring(r+5,e.indexOf(".",r)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,n=t.length;i<n;i++)Array.isArray(t[i])?e.push(L.LatLngUtil.cloneLatLngs(t[i])):e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,n=t.length,r=0,o=Math.PI/180;if(n>2){for(var s=0;s<n;s++)e=t[s],r+=((i=t[(s+1)%n]).lng-e.lng)*o*(2+Math.sin(e.lat*o)+Math.sin(i.lat*o));r=6378137*r*6378137/2}return Math.abs(r)},formattedNumber:function(t,e){var i=parseFloat(t).toFixed(e),n=L.drawLocal.format&&L.drawLocal.format.numeric,r=n&&n.delimiters,o=r&&r.thousands,s=r&&r.decimal;if(o||s){var a=i.split(".");i=o?a[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o):a[0],s=s||".",a.length>1&&(i=i+s+a[1])}return i},readableArea:function(e,i,n){var r,o;n=L.Util.extend({},t,n);return i?(o=["ha","m"],type=typeof i,"string"===type?o=[i]:"boolean"!==type&&(o=i),r=e>=1e6&&-1!==o.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*e,n.km)+" km²":e>=1e4&&-1!==o.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*e,n.ha)+" ha":L.GeometryUtil.formattedNumber(e,n.m)+" m²"):r=(e/=.836127)>=3097600?L.GeometryUtil.formattedNumber(e/3097600,n.mi)+" mi²":e>=4840?L.GeometryUtil.formattedNumber(e/4840,n.ac)+" acres":L.GeometryUtil.formattedNumber(e,n.yd)+" yd²",r},readableDistance:function(e,i,n,r,o){var s;o=L.Util.extend({},t,o);switch(i?"string"==typeof i?i:"metric":n?"feet":r?"nauticalMile":"yards"){case"metric":s=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,o.km)+" km":L.GeometryUtil.formattedNumber(e,o.m)+" m";break;case"feet":e*=3.28083,s=L.GeometryUtil.formattedNumber(e,o.ft)+" ft";break;case"nauticalMile":e*=.53996,s=L.GeometryUtil.formattedNumber(e/1e3,o.nm)+" nm";break;case"yards":default:s=(e*=1.09361)>1760?L.GeometryUtil.formattedNumber(e/1760,o.mi)+" miles":L.GeometryUtil.formattedNumber(e,o.yd)+" yd"}return s},isVersion07x:function(){var t=L.version.split(".");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,n){return this._checkCounterclockwise(t,i,n)!==this._checkCounterclockwise(e,i,n)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,n)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,n=this._getProjectedPoints(),r=n?n.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=r-1;t>=3;t--)if(e=n[t-1],i=n[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._getProjectedPoints(),n=i?i.length:0,r=i?i[n-1]:null,o=n-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(r,t,o,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),i=e?e.length:0;return!e||(i+=t||0)<=3},_lineSegmentsIntersectsRange:function(t,e,i,n){var r,o,s=this._getProjectedPoints();n=n||0;for(var a=i;a>n;a--)if(r=s[a-1],o=s[a],L.LineUtil.segmentsIntersect(t,e,r,o))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),i=0;i<e.length;i++)t.push(this._map.latLngToLayerPoint(e[i]));return t}}),L.Polygon.include({intersects:function(){var t,e,i,n,r=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=r.length,e=r[0],i=r[t-1],n=t-2,this._lineSegmentsIntersectsRange(i,e,n,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),n=!1;for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&(e=this._toolbars[r].addToolbar(t))&&(n||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),n=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(".");1===parseInt(e[0],10)&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),n=0,r=this._toolbarClass||"",o=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<o.length;e++)o[e].enabled&&this._initModeHandler(o[e].handler,this._toolbarContainer,n++,r,o[e].title);if(n)return this._lastButtonIndex=--n,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,n,r){var o=t.type;this._modes[o]={},this._modes[o].handler=t,this._modes[o].button=this._createButton({type:o,title:r,className:n+"-"+o,container:e,callback:this._modes[o].handler.enable,context:this._modes[o].handler}),this._modes[o].buttonIndex=i,this._modes[o].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),i=L.DomUtil.create("span","sr-only",t.container);e.href="#",e.appendChild(i),t.title&&(e.title=t.title,i.innerHTML=t.title),t.text&&(e.innerHTML=t.text,i.innerHTML=t.text);var n=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,n,t.callback,t.context),e},_disposeButton:function(t,e){var i=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,i,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,n,r,o=this._actionsContainer,s=this.getActions(t),a=s.length;for(i=0,n=this._actionButtons.length;i<n;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];o.firstChild;)o.removeChild(o.firstChild);for(var l=0;l<a;l++)"enabled"in s[l]&&!s[l].enabled||(e=L.DomUtil.create("li","",o),r=this._createButton({title:s[l].title,text:s[l].text,container:e,callback:s[l].callback,context:s[l].context}),this._actionButtons.push({button:r,callback:s[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(this._visible&&(i.style.visibility="inherit"),L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,i,n=t.layer||t.target||t;this._backupLayer(n),this.options.poly&&(i=L.Util.extend({},this.options.poly),n.options.poly=i),this.options.selectedPathOptions&&((e=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(e.color=n.options.color,e.fillColor=n.options.fillColor),n.options.original=L.extend({},n.options),n.options.editing=e),n instanceof L.Marker?(n.editing&&n.editing.enable(),n.dragging.enable(),n.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):n.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),n=this._map.layerPointToLatLng(i);t.target.setLatLng(n)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(t){this._removeLayer({layer:t})},this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document),function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,o,a){(a=a||e||t.jQuery)&&(o.prototype.option||(o.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){return"string"==typeof t?function(t,e,n){var r,o="$()."+i+'("'+e+'")';return t.each(function(t,l){var h=a.data(l,i);if(h){var c=h[e];if(c&&"_"!=e.charAt(0)){var u=c.apply(h,n);r=void 0===r?u:r}else s(o+" is not a valid method")}else s(i+" not initialized. Cannot call methods, i.e. "+o)}),void 0!==r?r:t}(this,t,r.call(arguments,1)):(function(t,e){t.each(function(t,n){var r=a.data(n,i);r?(r.option(e),r._init()):(r=new o(n,e),a.data(n,i,r))})}(this,t),this)},n(a))}function n(t){!t||t&&t.bridget||(t.bridget=i)}var r=Array.prototype.slice,o=t.console,s=void 0===o?function(){}:function(t){o.error(t)};return n(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r];n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"function"==typeof define&&define.amd?define("get-size/get-size",e):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}function e(t){var e=getComputedStyle(t);return e||o("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}function i(){if(!l){l=!0;var i=document.createElement("div");i.style.width="200px",i.style.padding="1px 2px 3px 4px",i.style.borderStyle="solid",i.style.borderWidth="1px 2px 3px 4px",i.style.boxSizing="border-box";var o=document.body||document.documentElement;o.appendChild(i);var s=e(i);r=200==Math.round(t(s.width)),n.isBoxSizeOuter=r,o.removeChild(i)}}function n(n){if(i(),"string"==typeof n&&(n=document.querySelector(n)),n&&"object"==typeof n&&n.nodeType){var o=e(n);if("none"==o.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;a>e;e++)t[s[e]]=0;return t}();var l={};l.width=n.offsetWidth,l.height=n.offsetHeight;for(var h=l.isBorderBox="border-box"==o.boxSizing,c=0;a>c;c++){var u=s[c],d=o[u],p=parseFloat(d);l[u]=isNaN(p)?0:p}var f=l.paddingLeft+l.paddingRight,m=l.paddingTop+l.paddingBottom,g=l.marginLeft+l.marginRight,v=l.marginTop+l.marginBottom,_=l.borderLeftWidth+l.borderRightWidth,y=l.borderTopWidth+l.borderBottomWidth,b=h&&r,w=t(o.width);!1!==w&&(l.width=w+(b?0:f+_));var S=t(o.height);return!1!==S&&(l.height=S+(b?0:m+y)),l.innerWidth=l.width-(f+_),l.innerHeight=l.height-(m+y),l.outerWidth=l.width+g,l.outerHeight=l.height+v,l}}var r,o="undefined"==typeof console?function(){}:function(t){console.error(t)},s=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],a=s.length,l=!1;return n}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i]+"MatchesSelector";if(t[n])return n}}();return function(e,i){return e[t](i)}}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={extend:function(t,e){for(var i in e)t[i]=e[i];return t},modulo:function(t,e){return(t%e+e)%e}},n=Array.prototype.slice;i.makeArray=function(t){return Array.isArray(t)?t:null===t||void 0===t?[]:"object"==typeof t&&"number"==typeof t.length?n.call(t):[t]},i.removeFrom=function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1)},i.getParent=function(t,i){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,n){var r=[];return(t=i.makeArray(t)).forEach(function(t){if(t instanceof HTMLElement){if(!n)return void r.push(t);e(t,n)&&r.push(t);for(var i=t.querySelectorAll(n),o=0;o<i.length;o++)r.push(i[o])}}),r},i.debounceMethod=function(t,e,i){i=i||100;var n=t.prototype[e],r=e+"Timeout";t.prototype[e]=function(){var t=this[r];clearTimeout(t);var e=arguments,o=this;this[r]=setTimeout(function(){n.apply(o,e),delete o[r]},i)}},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var r=t.console;return i.htmlInit=function(e,n){i.docReady(function(){var o=i.toDashed(n),s="data-"+o,a=document.querySelectorAll("["+s+"]"),l=document.querySelectorAll(".js-"+o),h=i.makeArray(a).concat(i.makeArray(l)),c=s+"-options",u=t.jQuery;h.forEach(function(t){var i,o=t.getAttribute(s)||t.getAttribute(c);try{i=o&&JSON.parse(o)}catch(e){return void(r&&r.error("Error parsing "+s+" on "+t.className+": "+e))}var a=new e(t,i);u&&u.data(t,n,a)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t.EvEmitter,t.getSize))}(window,function(t,e){"use strict";function i(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var n=document.documentElement.style,r="string"==typeof n.transition?"transition":"WebkitTransition",o="string"==typeof n.transform?"transform":"WebkitTransform",s={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[r],a={transform:o,transition:r,transitionDuration:r+"Duration",transitionProperty:r+"Property",transitionDelay:r+"Delay"},l=i.prototype=Object.create(t.prototype);l.constructor=i,l._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},l.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.getSize=function(){this.size=e(this.element)},l.css=function(t){var e=this.element.style;for(var i in t){e[a[i]||i]=t[i]}},l.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),n=t[e?"left":"right"],r=t[i?"top":"bottom"],o=parseFloat(n),s=parseFloat(r),a=this.layout.size;-1!=n.indexOf("%")&&(o=o/100*a.width),-1!=r.indexOf("%")&&(s=s/100*a.height),o=isNaN(o)?0:o,s=isNaN(s)?0:s,o-=e?a.paddingLeft:a.paddingRight,s-=i?a.paddingTop:a.paddingBottom,this.position.x=o,this.position.y=s},l.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),r=i?"paddingLeft":"paddingRight",o=i?"left":"right",s=i?"right":"left",a=this.position.x+t[r];e[o]=this.getXValue(a),e[s]="";var l=n?"paddingTop":"paddingBottom",h=n?"top":"bottom",c=n?"bottom":"top",u=this.position.y+t[l];e[h]=this.getYValue(u),e[c]="",this.css(e),this.emitEvent("layout",[this])},l.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},l.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},l._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,r=t==this.position.x&&e==this.position.y;if(this.setPosition(t,e),!r||this.isTransitioning){var o=t-i,s=e-n,a={};a.transform=this.getTranslate(o,s),this.transition({to:a,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},l.getTranslate=function(t,e){var i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop");return"translate3d("+(t=i?t:-t)+"px, "+(e=n?e:-e)+"px, 0)"},l.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},l.moveTo=l._transitionTo,l.setPosition=function(t,e){this.position.x=parseFloat(t),this.position.y=parseFloat(e)},l._nonTransition=function(t){for(var e in this.css(t.to),t.isCleaning&&this._removeStyles(t.to),t.onTransitionEnd)t.onTransitionEnd[e].call(this)},l.transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);this.element.offsetHeight;null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var h="opacity,"+function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}(o);l.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:h,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(s,this,!1)}},l.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},l.onotransitionend=function(t){this.ontransitionend(t)};var c={"-webkit-transform":"transform"};l.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,i=c[t.propertyName]||t.propertyName;if(delete e.ingProperties[i],function(t){for(var e in t)return!1;return!0}(e.ingProperties)&&this.disableTransition(),i in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[i]),i in e.onEnd)e.onEnd[i].call(this),delete e.onEnd[i];this.emitEvent("transitionEnd",[this])}},l.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(s,this,!1),this.isTransitioning=!1},l._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var u={transitionProperty:"",transitionDuration:"",transitionDelay:""};return l.removeTransitionStyles=function(){this.css(u)},l.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},l.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},l.remove=function(){return r&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},l.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},l.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},l.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},l.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},l.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},l.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},i}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,r,o){return e(t,i,n,r,o)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,n,r){"use strict";function o(t,e){var i=n.getQueryElement(t);if(i){this.element=i,l&&(this.$element=l(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e);var r=++c;this.element.outlayerGUID=r,u[r]=this,this._create(),this._getOption("initLayout")&&this.layout()}else a&&a.error("Bad element for "+this.constructor.namespace+": "+(i||t))}function s(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}var a=t.console,l=t.jQuery,h=function(){},c=0,u={};o.namespace="outlayer",o.Item=r,o.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var d=o.prototype;n.extend(d,e.prototype),d.option=function(t){n.extend(this.options,t)},d._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},o.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},d._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),n.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},d.reloadItems=function(){this.items=this._itemize(this.element.children)},d._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],r=0;r<e.length;r++){var o=new i(e[r],this);n.push(o)}return n},d._filterFindItemElements=function(t){return n.filterFindElements(t,this.options.itemSelector)},d.getItemElements=function(){return this.items.map(function(t){return t.element})},d.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},d._init=d.layout,d._resetLayout=function(){this.getSize()},d.getSize=function(){this.size=i(this.element)},d._getMeasurement=function(t,e){var n,r=this.options[t];r?("string"==typeof r?n=this.element.querySelector(r):r instanceof HTMLElement&&(n=r),this[t]=n?i(n)[e]:r):this[t]=0},d.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},d._getItemsForLayout=function(t){return t.filter(function(t){return!t.isIgnored})},d._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var n=this._getItemLayoutPosition(t);n.item=t,n.isInstant=e||t.isLayoutInstant,i.push(n)},this),this._processLayoutQueue(i)}},d._getItemLayoutPosition=function(){return{x:0,y:0}},d._processLayoutQueue=function(t){this.updateStagger(),t.forEach(function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)},this)},d.updateStagger=function(){var t=this.options.stagger;return null===t||void 0===t?void(this.stagger=0):(this.stagger=function(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),i=e&&e[1],n=e&&e[2];return i.length?(i=parseFloat(i))*(p[n]||1):0}(t),this.stagger)},d._positionItem=function(t,e,i,n,r){n?t.goTo(e,i):(t.stagger(r*this.stagger),t.moveTo(e,i))},d._postLayout=function(){this.resizeContainer()},d.resizeContainer=function(){if(this._getOption("resizeContainer")){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},d._getContainerSize=h,d._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},d._emitCompleteOnItems=function(t,e){function i(){r.dispatchEvent(t+"Complete",null,[e])}function n(){++s==o&&i()}var r=this,o=e.length;if(e&&o){var s=0;e.forEach(function(e){e.once(t,n)})}else i()},d.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),l)if(this.$element=this.$element||l(this.element),e){var r=l.Event(e);r.type=t,this.$element.trigger(r,i)}else this.$element.trigger(t,i)},d.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},d.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},d.stamp=function(t){(t=this._find(t))&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},d.unstamp=function(t){(t=this._find(t))&&t.forEach(function(t){n.removeFrom(this.stamps,t),this.unignore(t)},this)},d._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n.makeArray(t)):void 0},d._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},d._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},d._manageStamp=h,d._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,r=i(t);return{left:e.left-n.left-r.marginLeft,top:e.top-n.top-r.marginTop,right:n.right-e.right-r.marginRight,bottom:n.bottom-e.bottom-r.marginBottom}},d.handleEvent=n.handleEvent,d.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},d.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},d.onresize=function(){this.resize()},n.debounceMethod(o,"onresize",100),d.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},d.needsResizeLayout=function(){var t=i(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},d.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},d.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},d.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},d.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.reveal()})}},d.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.hide()})}},d.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},d.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},d.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i}},d.getItems=function(t){var e=[];return(t=n.makeArray(t)).forEach(function(t){var i=this.getItem(t);i&&e.push(i)},this),e},d.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),n.removeFrom(this.items,t)},this)},d.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy()}),this.unbindResize();var e=this.element.outlayerGUID;delete u[e],delete this.element.outlayerGUID,l&&l.removeData(this.element,this.constructor.namespace)},o.data=function(t){var e=(t=n.getQueryElement(t))&&t.outlayerGUID;return e&&u[e]},o.create=function(t,e){var i=s(o);return i.defaults=n.extend({},o.defaults),n.extend(i.defaults,e),i.compatOptions=n.extend({},o.compatOptions),i.namespace=t,i.data=o.data,i.Item=s(r),n.htmlInit(i,t),l&&l.bridget&&l.bridget(t,i),i};var p={ms:1,s:1e3};return o.Item=r,o}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window,function(t,e){var i=t.create("masonry");i.compatOptions.fitWidth="isFitWidth";var n=i.prototype;return n._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},n.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}var n=this.columnWidth+=this.gutter,r=this.containerWidth+this.gutter,o=r/n,s=n-r%n;o=Math[s&&1>s?"round":"floor"](o),this.cols=Math.max(o,1)},n.getContainerWidth=function(){var t=this._getOption("fitWidth")?this.element.parentNode:this.element,i=e(t);this.containerWidth=i&&i.innerWidth},n._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=Math[e&&1>e?"round":"ceil"](t.size.outerWidth/this.columnWidth);i=Math.min(i,this.cols);for(var n=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](i,t),r={x:this.columnWidth*n.col,y:n.y},o=n.y+t.size.outerHeight,s=i+n.col,a=n.col;s>a;a++)this.colYs[a]=o;return r},n._getTopColPosition=function(t){var e=this._getTopColGroup(t),i=Math.min.apply(Math,e);return{col:e.indexOf(i),y:i}},n._getTopColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++)e[n]=this._getColGroupY(n,t);return e},n._getColGroupY=function(t,e){if(2>e)return this.colYs[t];var i=this.colYs.slice(t,t+e);return Math.max.apply(Math,i)},n._getHorizontalColPosition=function(t,e){var i=this.horizontalColIndex%this.cols;i=t>1&&i+t>this.cols?0:i;var n=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=n?i+t:this.horizontalColIndex,{col:i,y:this._getColGroupY(i,t)}},n._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),r=this._getOption("originLeft")?n.left:n.right,o=r+i.outerWidth,s=Math.floor(r/this.columnWidth);s=Math.max(0,s);var a=Math.floor(o/this.columnWidth);a-=o%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var l=(this._getOption("originTop")?n.top:n.bottom)+i.outerHeight,h=s;a>=h;h++)this.colYs[h]=Math.max(l,this.colYs[h])},n._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},n._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},n.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},i});